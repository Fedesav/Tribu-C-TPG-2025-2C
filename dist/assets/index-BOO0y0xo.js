var LJ=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var yKe=LJ((HKe,ab)=>{function HJ(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Pw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function DJ(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ZY={exports:{}},gA={},JY={exports:{}},Et={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WS=Symbol.for("react.element"),FJ=Symbol.for("react.portal"),kJ=Symbol.for("react.fragment"),VJ=Symbol.for("react.strict_mode"),$J=Symbol.for("react.profiler"),UJ=Symbol.for("react.provider"),BJ=Symbol.for("react.context"),WJ=Symbol.for("react.forward_ref"),jJ=Symbol.for("react.suspense"),zJ=Symbol.for("react.memo"),GJ=Symbol.for("react.lazy"),_$=Symbol.iterator;function YJ(n){return n===null||typeof n!="object"?null:(n=_$&&n[_$]||n["@@iterator"],typeof n=="function"?n:null)}var e3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},t3=Object.assign,n3={};function Kp(n,e,t){this.props=n,this.context=e,this.refs=n3,this.updater=t||e3}Kp.prototype.isReactComponent={};Kp.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Kp.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function r3(){}r3.prototype=Kp.prototype;function cL(n,e,t){this.props=n,this.context=e,this.refs=n3,this.updater=t||e3}var hL=cL.prototype=new r3;hL.constructor=cL;t3(hL,Kp.prototype);hL.isPureReactComponent=!0;var P$=Array.isArray,i3=Object.prototype.hasOwnProperty,dL={current:null},s3={key:!0,ref:!0,__self:!0,__source:!0};function o3(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)i3.call(e,r)&&!s3.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:WS,type:n,key:s,ref:o,props:i,_owner:dL.current}}function KJ(n,e){return{$$typeof:WS,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function fL(n){return typeof n=="object"&&n!==null&&n.$$typeof===WS}function XJ(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var x$=/\/+/g;function JN(n,e){return typeof n=="object"&&n!==null&&n.key!=null?XJ(""+n.key):e.toString(36)}function oT(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case WS:case FJ:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+JN(o,0):r,P$(i)?(t="",n!=null&&(t=n.replace(x$,"$&/")+"/"),oT(i,e,t,"",function(u){return u})):i!=null&&(fL(i)&&(i=KJ(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(x$,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",P$(n))for(var a=0;a<n.length;a++){s=n[a];var l=r+JN(s,a);o+=oT(s,e,t,l,i)}else if(l=YJ(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=r+JN(s,a++),o+=oT(s,e,t,l,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function HC(n,e,t){if(n==null)return n;var r=[],i=0;return oT(n,r,"","",function(s){return e.call(t,s,i++)}),r}function qJ(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var qi={current:null},aT={transition:null},QJ={ReactCurrentDispatcher:qi,ReactCurrentBatchConfig:aT,ReactCurrentOwner:dL};function a3(){throw Error("act(...) is not supported in production builds of React.")}Et.Children={map:HC,forEach:function(n,e,t){HC(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return HC(n,function(){e++}),e},toArray:function(n){return HC(n,function(e){return e})||[]},only:function(n){if(!fL(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Et.Component=Kp;Et.Fragment=kJ;Et.Profiler=$J;Et.PureComponent=cL;Et.StrictMode=VJ;Et.Suspense=jJ;Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QJ;Et.act=a3;Et.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=t3({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=dL.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)i3.call(e,l)&&!s3.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:WS,type:n.type,key:i,ref:s,props:r,_owner:o}};Et.createContext=function(n){return n={$$typeof:BJ,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:UJ,_context:n},n.Consumer=n};Et.createElement=o3;Et.createFactory=function(n){var e=o3.bind(null,n);return e.type=n,e};Et.createRef=function(){return{current:null}};Et.forwardRef=function(n){return{$$typeof:WJ,render:n}};Et.isValidElement=fL;Et.lazy=function(n){return{$$typeof:GJ,_payload:{_status:-1,_result:n},_init:qJ}};Et.memo=function(n,e){return{$$typeof:zJ,type:n,compare:e===void 0?null:e}};Et.startTransition=function(n){var e=aT.transition;aT.transition={};try{n()}finally{aT.transition=e}};Et.unstable_act=a3;Et.useCallback=function(n,e){return qi.current.useCallback(n,e)};Et.useContext=function(n){return qi.current.useContext(n)};Et.useDebugValue=function(){};Et.useDeferredValue=function(n){return qi.current.useDeferredValue(n)};Et.useEffect=function(n,e){return qi.current.useEffect(n,e)};Et.useId=function(){return qi.current.useId()};Et.useImperativeHandle=function(n,e,t){return qi.current.useImperativeHandle(n,e,t)};Et.useInsertionEffect=function(n,e){return qi.current.useInsertionEffect(n,e)};Et.useLayoutEffect=function(n,e){return qi.current.useLayoutEffect(n,e)};Et.useMemo=function(n,e){return qi.current.useMemo(n,e)};Et.useReducer=function(n,e,t){return qi.current.useReducer(n,e,t)};Et.useRef=function(n){return qi.current.useRef(n)};Et.useState=function(n){return qi.current.useState(n)};Et.useSyncExternalStore=function(n,e,t){return qi.current.useSyncExternalStore(n,e,t)};Et.useTransition=function(){return qi.current.useTransition()};Et.version="18.3.1";JY.exports=Et;var te=JY.exports;const l3=DJ(te),ZJ=HJ({__proto__:null,default:l3},[te]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JJ=te,eee=Symbol.for("react.element"),tee=Symbol.for("react.fragment"),nee=Object.prototype.hasOwnProperty,ree=JJ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,iee={key:!0,ref:!0,__self:!0,__source:!0};function u3(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)nee.call(e,r)&&!iee.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:eee,type:n,key:s,ref:o,props:i,_owner:ree.current}}gA.Fragment=tee;gA.jsx=u3;gA.jsxs=u3;ZY.exports=gA;var Z=ZY.exports,oP={},c3={exports:{}},vo={},h3={exports:{}},d3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(re,ae){var le=re.length;re.push(ae);e:for(;0<le;){var ye=le-1>>>1,ze=re[ye];if(0<i(ze,ae))re[ye]=ae,re[le]=ze,le=ye;else break e}}function t(re){return re.length===0?null:re[0]}function r(re){if(re.length===0)return null;var ae=re[0],le=re.pop();if(le!==ae){re[0]=le;e:for(var ye=0,ze=re.length,et=ze>>>1;ye<et;){var v=2*(ye+1)-1,R=re[v],A=v+1,W=re[A];if(0>i(R,le))A<ze&&0>i(W,R)?(re[ye]=W,re[A]=le,ye=A):(re[ye]=R,re[v]=le,ye=v);else if(A<ze&&0>i(W,le))re[ye]=W,re[A]=le,ye=A;else break e}}return ae}function i(re,ae){var le=re.sortIndex-ae.sortIndex;return le!==0?le:re.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,f=!1,m=!1,g=!1,C=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(re){for(var ae=t(u);ae!==null;){if(ae.callback===null)r(u);else if(ae.startTime<=re)r(u),ae.sortIndex=ae.expirationTime,e(l,ae);else break;ae=t(u)}}function E(re){if(g=!1,S(re),!m)if(t(l)!==null)m=!0,ke(P);else{var ae=t(u);ae!==null&&be(E,ae.startTime-re)}}function P(re,ae){m=!1,g&&(g=!1,y(D),D=-1),f=!0;var le=d;try{for(S(ae),h=t(l);h!==null&&(!(h.expirationTime>ae)||re&&!J());){var ye=h.callback;if(typeof ye=="function"){h.callback=null,d=h.priorityLevel;var ze=ye(h.expirationTime<=ae);ae=n.unstable_now(),typeof ze=="function"?h.callback=ze:h===t(l)&&r(l),S(ae)}else r(l);h=t(l)}if(h!==null)var et=!0;else{var v=t(u);v!==null&&be(E,v.startTime-ae),et=!1}return et}finally{h=null,d=le,f=!1}}var _=!1,I=null,D=-1,Q=5,F=-1;function J(){return!(n.unstable_now()-F<Q)}function q(){if(I!==null){var re=n.unstable_now();F=re;var ae=!0;try{ae=I(!0,re)}finally{ae?ie():(_=!1,I=null)}}else _=!1}var ie;if(typeof w=="function")ie=function(){w(q)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ee=fe.port2;fe.port1.onmessage=q,ie=function(){Ee.postMessage(null)}}else ie=function(){C(q,0)};function ke(re){I=re,_||(_=!0,ie())}function be(re,ae){D=C(function(){re(n.unstable_now())},ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(re){re.callback=null},n.unstable_continueExecution=function(){m||f||(m=!0,ke(P))},n.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<re?Math.floor(1e3/re):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(re){switch(d){case 1:case 2:case 3:var ae=3;break;default:ae=d}var le=d;d=ae;try{return re()}finally{d=le}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(re,ae){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var le=d;d=re;try{return ae()}finally{d=le}},n.unstable_scheduleCallback=function(re,ae,le){var ye=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?ye+le:ye):le=ye,re){case 1:var ze=-1;break;case 2:ze=250;break;case 5:ze=1073741823;break;case 4:ze=1e4;break;default:ze=5e3}return ze=le+ze,re={id:c++,callback:ae,priorityLevel:re,startTime:le,expirationTime:ze,sortIndex:-1},le>ye?(re.sortIndex=le,e(u,re),t(l)===null&&re===t(u)&&(g?(y(D),D=-1):g=!0,be(E,le-ye))):(re.sortIndex=ze,e(l,re),m||f||(m=!0,ke(P))),re},n.unstable_shouldYield=J,n.unstable_wrapCallback=function(re){var ae=d;return function(){var le=d;d=ae;try{return re.apply(this,arguments)}finally{d=le}}}})(d3);h3.exports=d3;var see=h3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oee=te,fo=see;function oe(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f3=new Set,jy={};function ig(n,e){Np(n,e),Np(n+"Capture",e)}function Np(n,e){for(jy[n]=e,n=0;n<e.length;n++)f3.add(e[n])}var oc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),aP=Object.prototype.hasOwnProperty,aee=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,L$={},H$={};function lee(n){return aP.call(H$,n)?!0:aP.call(L$,n)?!1:aee.test(n)?H$[n]=!0:(L$[n]=!0,!1)}function uee(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function cee(n,e,t,r){if(e===null||typeof e>"u"||uee(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Qi(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var li={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){li[n]=new Qi(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];li[e]=new Qi(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){li[n]=new Qi(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){li[n]=new Qi(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){li[n]=new Qi(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){li[n]=new Qi(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){li[n]=new Qi(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){li[n]=new Qi(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){li[n]=new Qi(n,5,!1,n.toLowerCase(),null,!1,!1)});var gL=/[\-:]([a-z])/g;function mL(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(gL,mL);li[e]=new Qi(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(gL,mL);li[e]=new Qi(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(gL,mL);li[e]=new Qi(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){li[n]=new Qi(n,1,!1,n.toLowerCase(),null,!1,!1)});li.xlinkHref=new Qi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){li[n]=new Qi(n,1,!1,n.toLowerCase(),null,!0,!0)});function pL(n,e,t,r){var i=li.hasOwnProperty(e)?li[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(cee(e,t,i,r)&&(t=null),r||i===null?lee(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var mc=oee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,DC=Symbol.for("react.element"),Om=Symbol.for("react.portal"),_m=Symbol.for("react.fragment"),vL=Symbol.for("react.strict_mode"),lP=Symbol.for("react.profiler"),g3=Symbol.for("react.provider"),m3=Symbol.for("react.context"),wL=Symbol.for("react.forward_ref"),uP=Symbol.for("react.suspense"),cP=Symbol.for("react.suspense_list"),yL=Symbol.for("react.memo"),Jc=Symbol.for("react.lazy"),p3=Symbol.for("react.offscreen"),D$=Symbol.iterator;function yv(n){return n===null||typeof n!="object"?null:(n=D$&&n[D$]||n["@@iterator"],typeof n=="function"?n:null)}var kn=Object.assign,eM;function xw(n){if(eM===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);eM=e&&e[1]||""}return`
`+eM+n}var tM=!1;function nM(n,e){if(!n||tM)return"";tM=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{tM=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?xw(n):""}function hee(n){switch(n.tag){case 5:return xw(n.type);case 16:return xw("Lazy");case 13:return xw("Suspense");case 19:return xw("SuspenseList");case 0:case 2:case 15:return n=nM(n.type,!1),n;case 11:return n=nM(n.type.render,!1),n;case 1:return n=nM(n.type,!0),n;default:return""}}function hP(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case _m:return"Fragment";case Om:return"Portal";case lP:return"Profiler";case vL:return"StrictMode";case uP:return"Suspense";case cP:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case m3:return(n.displayName||"Context")+".Consumer";case g3:return(n._context.displayName||"Context")+".Provider";case wL:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case yL:return e=n.displayName||null,e!==null?e:hP(n.type)||"Memo";case Jc:e=n._payload,n=n._init;try{return hP(n(e))}catch{}}return null}function dee(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return hP(e);case 8:return e===vL?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zh(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function v3(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function fee(n){var e=v3(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function FC(n){n._valueTracker||(n._valueTracker=fee(n))}function w3(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=v3(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function lb(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function dP(n,e){var t=e.checked;return kn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function F$(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=zh(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function y3(n,e){e=e.checked,e!=null&&pL(n,"checked",e,!1)}function fP(n,e){y3(n,e);var t=zh(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?gP(n,e.type,t):e.hasOwnProperty("defaultValue")&&gP(n,e.type,zh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function k$(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function gP(n,e,t){(e!=="number"||lb(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Lw=Array.isArray;function ip(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+zh(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function mP(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(oe(91));return kn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function V$(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(oe(92));if(Lw(t)){if(1<t.length)throw Error(oe(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:zh(t)}}function S3(n,e){var t=zh(e.value),r=zh(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function $$(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function C3(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pP(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?C3(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var kC,E3=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(kC=kC||document.createElement("div"),kC.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=kC.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function zy(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Jw={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gee=["Webkit","ms","Moz","O"];Object.keys(Jw).forEach(function(n){gee.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Jw[e]=Jw[n]})});function R3(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Jw.hasOwnProperty(n)&&Jw[n]?(""+e).trim():e+"px"}function T3(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=R3(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var mee=kn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vP(n,e){if(e){if(mee[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(oe(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(oe(62))}}function wP(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yP=null;function SL(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var SP=null,sp=null,op=null;function U$(n){if(n=GS(n)){if(typeof SP!="function")throw Error(oe(280));var e=n.stateNode;e&&(e=yA(e),SP(n.stateNode,n.type,e))}}function b3(n){sp?op?op.push(n):op=[n]:sp=n}function A3(){if(sp){var n=sp,e=op;if(op=sp=null,U$(n),e)for(n=0;n<e.length;n++)U$(e[n])}}function N3(n,e){return n(e)}function M3(){}var rM=!1;function I3(n,e,t){if(rM)return n(e,t);rM=!0;try{return N3(n,e,t)}finally{rM=!1,(sp!==null||op!==null)&&(M3(),A3())}}function Gy(n,e){var t=n.stateNode;if(t===null)return null;var r=yA(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(oe(231,e,typeof t));return t}var CP=!1;if(oc)try{var Sv={};Object.defineProperty(Sv,"passive",{get:function(){CP=!0}}),window.addEventListener("test",Sv,Sv),window.removeEventListener("test",Sv,Sv)}catch{CP=!1}function pee(n,e,t,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var ey=!1,ub=null,cb=!1,EP=null,vee={onError:function(n){ey=!0,ub=n}};function wee(n,e,t,r,i,s,o,a,l){ey=!1,ub=null,pee.apply(vee,arguments)}function yee(n,e,t,r,i,s,o,a,l){if(wee.apply(this,arguments),ey){if(ey){var u=ub;ey=!1,ub=null}else throw Error(oe(198));cb||(cb=!0,EP=u)}}function sg(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function O3(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function B$(n){if(sg(n)!==n)throw Error(oe(188))}function See(n){var e=n.alternate;if(!e){if(e=sg(n),e===null)throw Error(oe(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return B$(i),n;if(s===r)return B$(i),e;s=s.sibling}throw Error(oe(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o)throw Error(oe(189))}}if(t.alternate!==r)throw Error(oe(190))}if(t.tag!==3)throw Error(oe(188));return t.stateNode.current===t?n:e}function _3(n){return n=See(n),n!==null?P3(n):null}function P3(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=P3(n);if(e!==null)return e;n=n.sibling}return null}var x3=fo.unstable_scheduleCallback,W$=fo.unstable_cancelCallback,Cee=fo.unstable_shouldYield,Eee=fo.unstable_requestPaint,rr=fo.unstable_now,Ree=fo.unstable_getCurrentPriorityLevel,CL=fo.unstable_ImmediatePriority,L3=fo.unstable_UserBlockingPriority,hb=fo.unstable_NormalPriority,Tee=fo.unstable_LowPriority,H3=fo.unstable_IdlePriority,mA=null,zl=null;function bee(n){if(zl&&typeof zl.onCommitFiberRoot=="function")try{zl.onCommitFiberRoot(mA,n,void 0,(n.current.flags&128)===128)}catch{}}var Wa=Math.clz32?Math.clz32:Mee,Aee=Math.log,Nee=Math.LN2;function Mee(n){return n>>>=0,n===0?32:31-(Aee(n)/Nee|0)|0}var VC=64,$C=4194304;function Hw(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function db(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?r=Hw(a):(s&=o,s!==0&&(r=Hw(s)))}else o=t&~i,o!==0?r=Hw(o):s!==0&&(r=Hw(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Wa(e),i=1<<t,r|=n[t],e&=~i;return r}function Iee(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oee(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Wa(s),a=1<<o,l=i[o];l===-1?(!(a&t)||a&r)&&(i[o]=Iee(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function RP(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function D3(){var n=VC;return VC<<=1,!(VC&4194240)&&(VC=64),n}function iM(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function jS(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Wa(e),n[e]=t}function _ee(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Wa(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function EL(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Wa(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var Jt=0;function F3(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var k3,RL,V3,$3,U3,TP=!1,UC=[],Nh=null,Mh=null,Ih=null,Yy=new Map,Ky=new Map,uh=[],Pee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function j$(n,e){switch(n){case"focusin":case"focusout":Nh=null;break;case"dragenter":case"dragleave":Mh=null;break;case"mouseover":case"mouseout":Ih=null;break;case"pointerover":case"pointerout":Yy.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ky.delete(e.pointerId)}}function Cv(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=GS(e),e!==null&&RL(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function xee(n,e,t,r,i){switch(e){case"focusin":return Nh=Cv(Nh,n,e,t,r,i),!0;case"dragenter":return Mh=Cv(Mh,n,e,t,r,i),!0;case"mouseover":return Ih=Cv(Ih,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return Yy.set(s,Cv(Yy.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ky.set(s,Cv(Ky.get(s)||null,n,e,t,r,i)),!0}return!1}function B3(n){var e=Sf(n.target);if(e!==null){var t=sg(e);if(t!==null){if(e=t.tag,e===13){if(e=O3(t),e!==null){n.blockedOn=e,U3(n.priority,function(){V3(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function lT(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=bP(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);yP=r,t.target.dispatchEvent(r),yP=null}else return e=GS(t),e!==null&&RL(e),n.blockedOn=t,!1;e.shift()}return!0}function z$(n,e,t){lT(n)&&t.delete(e)}function Lee(){TP=!1,Nh!==null&&lT(Nh)&&(Nh=null),Mh!==null&&lT(Mh)&&(Mh=null),Ih!==null&&lT(Ih)&&(Ih=null),Yy.forEach(z$),Ky.forEach(z$)}function Ev(n,e){n.blockedOn===e&&(n.blockedOn=null,TP||(TP=!0,fo.unstable_scheduleCallback(fo.unstable_NormalPriority,Lee)))}function Xy(n){function e(i){return Ev(i,n)}if(0<UC.length){Ev(UC[0],n);for(var t=1;t<UC.length;t++){var r=UC[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Nh!==null&&Ev(Nh,n),Mh!==null&&Ev(Mh,n),Ih!==null&&Ev(Ih,n),Yy.forEach(e),Ky.forEach(e),t=0;t<uh.length;t++)r=uh[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<uh.length&&(t=uh[0],t.blockedOn===null);)B3(t),t.blockedOn===null&&uh.shift()}var ap=mc.ReactCurrentBatchConfig,fb=!0;function Hee(n,e,t,r){var i=Jt,s=ap.transition;ap.transition=null;try{Jt=1,TL(n,e,t,r)}finally{Jt=i,ap.transition=s}}function Dee(n,e,t,r){var i=Jt,s=ap.transition;ap.transition=null;try{Jt=4,TL(n,e,t,r)}finally{Jt=i,ap.transition=s}}function TL(n,e,t,r){if(fb){var i=bP(n,e,t,r);if(i===null)gM(n,e,r,gb,t),j$(n,r);else if(xee(i,n,e,t,r))r.stopPropagation();else if(j$(n,r),e&4&&-1<Pee.indexOf(n)){for(;i!==null;){var s=GS(i);if(s!==null&&k3(s),s=bP(n,e,t,r),s===null&&gM(n,e,r,gb,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else gM(n,e,r,null,t)}}var gb=null;function bP(n,e,t,r){if(gb=null,n=SL(r),n=Sf(n),n!==null)if(e=sg(n),e===null)n=null;else if(t=e.tag,t===13){if(n=O3(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return gb=n,null}function W3(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ree()){case CL:return 1;case L3:return 4;case hb:case Tee:return 16;case H3:return 536870912;default:return 16}default:return 16}}var ph=null,bL=null,uT=null;function j3(){if(uT)return uT;var n,e=bL,t=e.length,r,i="value"in ph?ph.value:ph.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return uT=i.slice(n,1<r?1-r:void 0)}function cT(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function BC(){return!0}function G$(){return!1}function wo(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?BC:G$,this.isPropagationStopped=G$,this}return kn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=BC)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=BC)},persist:function(){},isPersistent:BC}),e}var Xp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},AL=wo(Xp),zS=kn({},Xp,{view:0,detail:0}),Fee=wo(zS),sM,oM,Rv,pA=kn({},zS,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:NL,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Rv&&(Rv&&n.type==="mousemove"?(sM=n.screenX-Rv.screenX,oM=n.screenY-Rv.screenY):oM=sM=0,Rv=n),sM)},movementY:function(n){return"movementY"in n?n.movementY:oM}}),Y$=wo(pA),kee=kn({},pA,{dataTransfer:0}),Vee=wo(kee),$ee=kn({},zS,{relatedTarget:0}),aM=wo($ee),Uee=kn({},Xp,{animationName:0,elapsedTime:0,pseudoElement:0}),Bee=wo(Uee),Wee=kn({},Xp,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),jee=wo(Wee),zee=kn({},Xp,{data:0}),K$=wo(zee),Gee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Kee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xee(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Kee[n])?!!e[n]:!1}function NL(){return Xee}var qee=kn({},zS,{key:function(n){if(n.key){var e=Gee[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=cT(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Yee[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:NL,charCode:function(n){return n.type==="keypress"?cT(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?cT(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Qee=wo(qee),Zee=kn({},pA,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),X$=wo(Zee),Jee=kn({},zS,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:NL}),ete=wo(Jee),tte=kn({},Xp,{propertyName:0,elapsedTime:0,pseudoElement:0}),nte=wo(tte),rte=kn({},pA,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ite=wo(rte),ste=[9,13,27,32],ML=oc&&"CompositionEvent"in window,ty=null;oc&&"documentMode"in document&&(ty=document.documentMode);var ote=oc&&"TextEvent"in window&&!ty,z3=oc&&(!ML||ty&&8<ty&&11>=ty),q$=" ",Q$=!1;function G3(n,e){switch(n){case"keyup":return ste.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Y3(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Pm=!1;function ate(n,e){switch(n){case"compositionend":return Y3(e);case"keypress":return e.which!==32?null:(Q$=!0,q$);case"textInput":return n=e.data,n===q$&&Q$?null:n;default:return null}}function lte(n,e){if(Pm)return n==="compositionend"||!ML&&G3(n,e)?(n=j3(),uT=bL=ph=null,Pm=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return z3&&e.locale!=="ko"?null:e.data;default:return null}}var ute={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Z$(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!ute[n.type]:e==="textarea"}function K3(n,e,t,r){b3(r),e=mb(e,"onChange"),0<e.length&&(t=new AL("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var ny=null,qy=null;function cte(n){sK(n,0)}function vA(n){var e=Hm(n);if(w3(e))return n}function hte(n,e){if(n==="change")return e}var X3=!1;if(oc){var lM;if(oc){var uM="oninput"in document;if(!uM){var J$=document.createElement("div");J$.setAttribute("oninput","return;"),uM=typeof J$.oninput=="function"}lM=uM}else lM=!1;X3=lM&&(!document.documentMode||9<document.documentMode)}function eU(){ny&&(ny.detachEvent("onpropertychange",q3),qy=ny=null)}function q3(n){if(n.propertyName==="value"&&vA(qy)){var e=[];K3(e,qy,n,SL(n)),I3(cte,e)}}function dte(n,e,t){n==="focusin"?(eU(),ny=e,qy=t,ny.attachEvent("onpropertychange",q3)):n==="focusout"&&eU()}function fte(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return vA(qy)}function gte(n,e){if(n==="click")return vA(e)}function mte(n,e){if(n==="input"||n==="change")return vA(e)}function pte(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ya=typeof Object.is=="function"?Object.is:pte;function Qy(n,e){if(Ya(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!aP.call(e,i)||!Ya(n[i],e[i]))return!1}return!0}function tU(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function nU(n,e){var t=tU(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=tU(t)}}function Q3(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Q3(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Z3(){for(var n=window,e=lb();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=lb(n.document)}return e}function IL(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function vte(n){var e=Z3(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Q3(t.ownerDocument.documentElement,t)){if(r!==null&&IL(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=nU(t,s);var o=nU(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var wte=oc&&"documentMode"in document&&11>=document.documentMode,xm=null,AP=null,ry=null,NP=!1;function rU(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;NP||xm==null||xm!==lb(r)||(r=xm,"selectionStart"in r&&IL(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ry&&Qy(ry,r)||(ry=r,r=mb(AP,"onSelect"),0<r.length&&(e=new AL("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=xm)))}function WC(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Lm={animationend:WC("Animation","AnimationEnd"),animationiteration:WC("Animation","AnimationIteration"),animationstart:WC("Animation","AnimationStart"),transitionend:WC("Transition","TransitionEnd")},cM={},J3={};oc&&(J3=document.createElement("div").style,"AnimationEvent"in window||(delete Lm.animationend.animation,delete Lm.animationiteration.animation,delete Lm.animationstart.animation),"TransitionEvent"in window||delete Lm.transitionend.transition);function wA(n){if(cM[n])return cM[n];if(!Lm[n])return n;var e=Lm[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in J3)return cM[n]=e[t];return n}var eK=wA("animationend"),tK=wA("animationiteration"),nK=wA("animationstart"),rK=wA("transitionend"),iK=new Map,iU="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ed(n,e){iK.set(n,e),ig(e,[n])}for(var hM=0;hM<iU.length;hM++){var dM=iU[hM],yte=dM.toLowerCase(),Ste=dM[0].toUpperCase()+dM.slice(1);ed(yte,"on"+Ste)}ed(eK,"onAnimationEnd");ed(tK,"onAnimationIteration");ed(nK,"onAnimationStart");ed("dblclick","onDoubleClick");ed("focusin","onFocus");ed("focusout","onBlur");ed(rK,"onTransitionEnd");Np("onMouseEnter",["mouseout","mouseover"]);Np("onMouseLeave",["mouseout","mouseover"]);Np("onPointerEnter",["pointerout","pointerover"]);Np("onPointerLeave",["pointerout","pointerover"]);ig("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ig("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ig("onBeforeInput",["compositionend","keypress","textInput","paste"]);ig("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ig("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ig("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dw="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cte=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dw));function sU(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,yee(r,e,void 0,n),n.currentTarget=null}function sK(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;sU(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;sU(i,a,u),s=l}}}if(cb)throw n=EP,cb=!1,EP=null,n}function dn(n,e){var t=e[PP];t===void 0&&(t=e[PP]=new Set);var r=n+"__bubble";t.has(r)||(oK(e,n,2,!1),t.add(r))}function fM(n,e,t){var r=0;e&&(r|=4),oK(t,n,r,e)}var jC="_reactListening"+Math.random().toString(36).slice(2);function Zy(n){if(!n[jC]){n[jC]=!0,f3.forEach(function(t){t!=="selectionchange"&&(Cte.has(t)||fM(t,!1,n),fM(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[jC]||(e[jC]=!0,fM("selectionchange",!1,e))}}function oK(n,e,t,r){switch(W3(e)){case 1:var i=Hee;break;case 4:i=Dee;break;default:i=TL}t=i.bind(null,e,t,n),i=void 0,!CP||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function gM(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Sf(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}I3(function(){var u=s,c=SL(t),h=[];e:{var d=iK.get(n);if(d!==void 0){var f=AL,m=n;switch(n){case"keypress":if(cT(t)===0)break e;case"keydown":case"keyup":f=Qee;break;case"focusin":m="focus",f=aM;break;case"focusout":m="blur",f=aM;break;case"beforeblur":case"afterblur":f=aM;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Y$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Vee;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=ete;break;case eK:case tK:case nK:f=Bee;break;case rK:f=nte;break;case"scroll":f=Fee;break;case"wheel":f=ite;break;case"copy":case"cut":case"paste":f=jee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=X$}var g=(e&4)!==0,C=!g&&n==="scroll",y=g?d!==null?d+"Capture":null:d;g=[];for(var w=u,S;w!==null;){S=w;var E=S.stateNode;if(S.tag===5&&E!==null&&(S=E,y!==null&&(E=Gy(w,y),E!=null&&g.push(Jy(w,E,S)))),C)break;w=w.return}0<g.length&&(d=new f(d,m,null,t,c),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",f=n==="mouseout"||n==="pointerout",d&&t!==yP&&(m=t.relatedTarget||t.fromElement)&&(Sf(m)||m[ac]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(m=t.relatedTarget||t.toElement,f=u,m=m?Sf(m):null,m!==null&&(C=sg(m),m!==C||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=u),f!==m)){if(g=Y$,E="onMouseLeave",y="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(g=X$,E="onPointerLeave",y="onPointerEnter",w="pointer"),C=f==null?d:Hm(f),S=m==null?d:Hm(m),d=new g(E,w+"leave",f,t,c),d.target=C,d.relatedTarget=S,E=null,Sf(c)===u&&(g=new g(y,w+"enter",m,t,c),g.target=S,g.relatedTarget=C,E=g),C=E,f&&m)t:{for(g=f,y=m,w=0,S=g;S;S=Sg(S))w++;for(S=0,E=y;E;E=Sg(E))S++;for(;0<w-S;)g=Sg(g),w--;for(;0<S-w;)y=Sg(y),S--;for(;w--;){if(g===y||y!==null&&g===y.alternate)break t;g=Sg(g),y=Sg(y)}g=null}else g=null;f!==null&&oU(h,d,f,g,!1),m!==null&&C!==null&&oU(h,C,m,g,!0)}}e:{if(d=u?Hm(u):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var P=hte;else if(Z$(d))if(X3)P=mte;else{P=fte;var _=dte}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(P=gte);if(P&&(P=P(n,u))){K3(h,P,t,c);break e}_&&_(n,d,u),n==="focusout"&&(_=d._wrapperState)&&_.controlled&&d.type==="number"&&gP(d,"number",d.value)}switch(_=u?Hm(u):window,n){case"focusin":(Z$(_)||_.contentEditable==="true")&&(xm=_,AP=u,ry=null);break;case"focusout":ry=AP=xm=null;break;case"mousedown":NP=!0;break;case"contextmenu":case"mouseup":case"dragend":NP=!1,rU(h,t,c);break;case"selectionchange":if(wte)break;case"keydown":case"keyup":rU(h,t,c)}var I;if(ML)e:{switch(n){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Pm?G3(n,t)&&(D="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(D="onCompositionStart");D&&(z3&&t.locale!=="ko"&&(Pm||D!=="onCompositionStart"?D==="onCompositionEnd"&&Pm&&(I=j3()):(ph=c,bL="value"in ph?ph.value:ph.textContent,Pm=!0)),_=mb(u,D),0<_.length&&(D=new K$(D,n,null,t,c),h.push({event:D,listeners:_}),I?D.data=I:(I=Y3(t),I!==null&&(D.data=I)))),(I=ote?ate(n,t):lte(n,t))&&(u=mb(u,"onBeforeInput"),0<u.length&&(c=new K$("onBeforeInput","beforeinput",null,t,c),h.push({event:c,listeners:u}),c.data=I))}sK(h,e)})}function Jy(n,e,t){return{instance:n,listener:e,currentTarget:t}}function mb(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Gy(n,t),s!=null&&r.unshift(Jy(n,s,i)),s=Gy(n,e),s!=null&&r.push(Jy(n,s,i))),n=n.return}return r}function Sg(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function oU(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Gy(t,s),l!=null&&o.unshift(Jy(t,l,a))):i||(l=Gy(t,s),l!=null&&o.push(Jy(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var Ete=/\r\n?/g,Rte=/\u0000|\uFFFD/g;function aU(n){return(typeof n=="string"?n:""+n).replace(Ete,`
`).replace(Rte,"")}function zC(n,e,t){if(e=aU(e),aU(n)!==e&&t)throw Error(oe(425))}function pb(){}var MP=null,IP=null;function OP(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var _P=typeof setTimeout=="function"?setTimeout:void 0,Tte=typeof clearTimeout=="function"?clearTimeout:void 0,lU=typeof Promise=="function"?Promise:void 0,bte=typeof queueMicrotask=="function"?queueMicrotask:typeof lU<"u"?function(n){return lU.resolve(null).then(n).catch(Ate)}:_P;function Ate(n){setTimeout(function(){throw n})}function mM(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Xy(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Xy(e)}function Oh(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function uU(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var qp=Math.random().toString(36).slice(2),Fl="__reactFiber$"+qp,eS="__reactProps$"+qp,ac="__reactContainer$"+qp,PP="__reactEvents$"+qp,Nte="__reactListeners$"+qp,Mte="__reactHandles$"+qp;function Sf(n){var e=n[Fl];if(e)return e;for(var t=n.parentNode;t;){if(e=t[ac]||t[Fl]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=uU(n);n!==null;){if(t=n[Fl])return t;n=uU(n)}return e}n=t,t=n.parentNode}return null}function GS(n){return n=n[Fl]||n[ac],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Hm(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(oe(33))}function yA(n){return n[eS]||null}var xP=[],Dm=-1;function td(n){return{current:n}}function gn(n){0>Dm||(n.current=xP[Dm],xP[Dm]=null,Dm--)}function cn(n,e){Dm++,xP[Dm]=n.current,n.current=e}var Gh={},Ii=td(Gh),bs=td(!1),$f=Gh;function Mp(n,e){var t=n.type.contextTypes;if(!t)return Gh;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function As(n){return n=n.childContextTypes,n!=null}function vb(){gn(bs),gn(Ii)}function cU(n,e,t){if(Ii.current!==Gh)throw Error(oe(168));cn(Ii,e),cn(bs,t)}function aK(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(oe(108,dee(n)||"Unknown",i));return kn({},t,r)}function wb(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Gh,$f=Ii.current,cn(Ii,n),cn(bs,bs.current),!0}function hU(n,e,t){var r=n.stateNode;if(!r)throw Error(oe(169));t?(n=aK(n,e,$f),r.__reactInternalMemoizedMergedChildContext=n,gn(bs),gn(Ii),cn(Ii,n)):gn(bs),cn(bs,t)}var Wu=null,SA=!1,pM=!1;function lK(n){Wu===null?Wu=[n]:Wu.push(n)}function Ite(n){SA=!0,lK(n)}function nd(){if(!pM&&Wu!==null){pM=!0;var n=0,e=Jt;try{var t=Wu;for(Jt=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Wu=null,SA=!1}catch(i){throw Wu!==null&&(Wu=Wu.slice(n+1)),x3(CL,nd),i}finally{Jt=e,pM=!1}}return null}var Fm=[],km=0,yb=null,Sb=0,Vo=[],$o=0,Uf=null,zu=1,Gu="";function sf(n,e){Fm[km++]=Sb,Fm[km++]=yb,yb=n,Sb=e}function uK(n,e,t){Vo[$o++]=zu,Vo[$o++]=Gu,Vo[$o++]=Uf,Uf=n;var r=zu;n=Gu;var i=32-Wa(r)-1;r&=~(1<<i),t+=1;var s=32-Wa(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,zu=1<<32-Wa(e)+i|t<<i|r,Gu=s+n}else zu=1<<s|t<<i|r,Gu=n}function OL(n){n.return!==null&&(sf(n,1),uK(n,1,0))}function _L(n){for(;n===yb;)yb=Fm[--km],Fm[km]=null,Sb=Fm[--km],Fm[km]=null;for(;n===Uf;)Uf=Vo[--$o],Vo[$o]=null,Gu=Vo[--$o],Vo[$o]=null,zu=Vo[--$o],Vo[$o]=null}var co=null,oo=null,Tn=!1,La=null;function cK(n,e){var t=jo(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function dU(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,co=n,oo=Oh(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,co=n,oo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Uf!==null?{id:zu,overflow:Gu}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=jo(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,co=n,oo=null,!0):!1;default:return!1}}function LP(n){return(n.mode&1)!==0&&(n.flags&128)===0}function HP(n){if(Tn){var e=oo;if(e){var t=e;if(!dU(n,e)){if(LP(n))throw Error(oe(418));e=Oh(t.nextSibling);var r=co;e&&dU(n,e)?cK(r,t):(n.flags=n.flags&-4097|2,Tn=!1,co=n)}}else{if(LP(n))throw Error(oe(418));n.flags=n.flags&-4097|2,Tn=!1,co=n}}}function fU(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;co=n}function GC(n){if(n!==co)return!1;if(!Tn)return fU(n),Tn=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!OP(n.type,n.memoizedProps)),e&&(e=oo)){if(LP(n))throw hK(),Error(oe(418));for(;e;)cK(n,e),e=Oh(e.nextSibling)}if(fU(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(oe(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){oo=Oh(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}oo=null}}else oo=co?Oh(n.stateNode.nextSibling):null;return!0}function hK(){for(var n=oo;n;)n=Oh(n.nextSibling)}function Ip(){oo=co=null,Tn=!1}function PL(n){La===null?La=[n]:La.push(n)}var Ote=mc.ReactCurrentBatchConfig;function Tv(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(oe(309));var r=t.stateNode}if(!r)throw Error(oe(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(oe(284));if(!t._owner)throw Error(oe(290,n))}return n}function YC(n,e){throw n=Object.prototype.toString.call(e),Error(oe(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function gU(n){var e=n._init;return e(n._payload)}function dK(n){function e(y,w){if(n){var S=y.deletions;S===null?(y.deletions=[w],y.flags|=16):S.push(w)}}function t(y,w){if(!n)return null;for(;w!==null;)e(y,w),w=w.sibling;return null}function r(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function i(y,w){return y=Lh(y,w),y.index=0,y.sibling=null,y}function s(y,w,S){return y.index=S,n?(S=y.alternate,S!==null?(S=S.index,S<w?(y.flags|=2,w):S):(y.flags|=2,w)):(y.flags|=1048576,w)}function o(y){return n&&y.alternate===null&&(y.flags|=2),y}function a(y,w,S,E){return w===null||w.tag!==6?(w=RM(S,y.mode,E),w.return=y,w):(w=i(w,S),w.return=y,w)}function l(y,w,S,E){var P=S.type;return P===_m?c(y,w,S.props.children,E,S.key):w!==null&&(w.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Jc&&gU(P)===w.type)?(E=i(w,S.props),E.ref=Tv(y,w,S),E.return=y,E):(E=vT(S.type,S.key,S.props,null,y.mode,E),E.ref=Tv(y,w,S),E.return=y,E)}function u(y,w,S,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==S.containerInfo||w.stateNode.implementation!==S.implementation?(w=TM(S,y.mode,E),w.return=y,w):(w=i(w,S.children||[]),w.return=y,w)}function c(y,w,S,E,P){return w===null||w.tag!==7?(w=Lf(S,y.mode,E,P),w.return=y,w):(w=i(w,S),w.return=y,w)}function h(y,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return w=RM(""+w,y.mode,S),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case DC:return S=vT(w.type,w.key,w.props,null,y.mode,S),S.ref=Tv(y,null,w),S.return=y,S;case Om:return w=TM(w,y.mode,S),w.return=y,w;case Jc:var E=w._init;return h(y,E(w._payload),S)}if(Lw(w)||yv(w))return w=Lf(w,y.mode,S,null),w.return=y,w;YC(y,w)}return null}function d(y,w,S,E){var P=w!==null?w.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return P!==null?null:a(y,w,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case DC:return S.key===P?l(y,w,S,E):null;case Om:return S.key===P?u(y,w,S,E):null;case Jc:return P=S._init,d(y,w,P(S._payload),E)}if(Lw(S)||yv(S))return P!==null?null:c(y,w,S,E,null);YC(y,S)}return null}function f(y,w,S,E,P){if(typeof E=="string"&&E!==""||typeof E=="number")return y=y.get(S)||null,a(w,y,""+E,P);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case DC:return y=y.get(E.key===null?S:E.key)||null,l(w,y,E,P);case Om:return y=y.get(E.key===null?S:E.key)||null,u(w,y,E,P);case Jc:var _=E._init;return f(y,w,S,_(E._payload),P)}if(Lw(E)||yv(E))return y=y.get(S)||null,c(w,y,E,P,null);YC(w,E)}return null}function m(y,w,S,E){for(var P=null,_=null,I=w,D=w=0,Q=null;I!==null&&D<S.length;D++){I.index>D?(Q=I,I=null):Q=I.sibling;var F=d(y,I,S[D],E);if(F===null){I===null&&(I=Q);break}n&&I&&F.alternate===null&&e(y,I),w=s(F,w,D),_===null?P=F:_.sibling=F,_=F,I=Q}if(D===S.length)return t(y,I),Tn&&sf(y,D),P;if(I===null){for(;D<S.length;D++)I=h(y,S[D],E),I!==null&&(w=s(I,w,D),_===null?P=I:_.sibling=I,_=I);return Tn&&sf(y,D),P}for(I=r(y,I);D<S.length;D++)Q=f(I,y,D,S[D],E),Q!==null&&(n&&Q.alternate!==null&&I.delete(Q.key===null?D:Q.key),w=s(Q,w,D),_===null?P=Q:_.sibling=Q,_=Q);return n&&I.forEach(function(J){return e(y,J)}),Tn&&sf(y,D),P}function g(y,w,S,E){var P=yv(S);if(typeof P!="function")throw Error(oe(150));if(S=P.call(S),S==null)throw Error(oe(151));for(var _=P=null,I=w,D=w=0,Q=null,F=S.next();I!==null&&!F.done;D++,F=S.next()){I.index>D?(Q=I,I=null):Q=I.sibling;var J=d(y,I,F.value,E);if(J===null){I===null&&(I=Q);break}n&&I&&J.alternate===null&&e(y,I),w=s(J,w,D),_===null?P=J:_.sibling=J,_=J,I=Q}if(F.done)return t(y,I),Tn&&sf(y,D),P;if(I===null){for(;!F.done;D++,F=S.next())F=h(y,F.value,E),F!==null&&(w=s(F,w,D),_===null?P=F:_.sibling=F,_=F);return Tn&&sf(y,D),P}for(I=r(y,I);!F.done;D++,F=S.next())F=f(I,y,D,F.value,E),F!==null&&(n&&F.alternate!==null&&I.delete(F.key===null?D:F.key),w=s(F,w,D),_===null?P=F:_.sibling=F,_=F);return n&&I.forEach(function(q){return e(y,q)}),Tn&&sf(y,D),P}function C(y,w,S,E){if(typeof S=="object"&&S!==null&&S.type===_m&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case DC:e:{for(var P=S.key,_=w;_!==null;){if(_.key===P){if(P=S.type,P===_m){if(_.tag===7){t(y,_.sibling),w=i(_,S.props.children),w.return=y,y=w;break e}}else if(_.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Jc&&gU(P)===_.type){t(y,_.sibling),w=i(_,S.props),w.ref=Tv(y,_,S),w.return=y,y=w;break e}t(y,_);break}else e(y,_);_=_.sibling}S.type===_m?(w=Lf(S.props.children,y.mode,E,S.key),w.return=y,y=w):(E=vT(S.type,S.key,S.props,null,y.mode,E),E.ref=Tv(y,w,S),E.return=y,y=E)}return o(y);case Om:e:{for(_=S.key;w!==null;){if(w.key===_)if(w.tag===4&&w.stateNode.containerInfo===S.containerInfo&&w.stateNode.implementation===S.implementation){t(y,w.sibling),w=i(w,S.children||[]),w.return=y,y=w;break e}else{t(y,w);break}else e(y,w);w=w.sibling}w=TM(S,y.mode,E),w.return=y,y=w}return o(y);case Jc:return _=S._init,C(y,w,_(S._payload),E)}if(Lw(S))return m(y,w,S,E);if(yv(S))return g(y,w,S,E);YC(y,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,w!==null&&w.tag===6?(t(y,w.sibling),w=i(w,S),w.return=y,y=w):(t(y,w),w=RM(S,y.mode,E),w.return=y,y=w),o(y)):t(y,w)}return C}var Op=dK(!0),fK=dK(!1),Cb=td(null),Eb=null,Vm=null,xL=null;function LL(){xL=Vm=Eb=null}function HL(n){var e=Cb.current;gn(Cb),n._currentValue=e}function DP(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function lp(n,e){Eb=n,xL=Vm=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Es=!0),n.firstContext=null)}function Xo(n){var e=n._currentValue;if(xL!==n)if(n={context:n,memoizedValue:e,next:null},Vm===null){if(Eb===null)throw Error(oe(308));Vm=n,Eb.dependencies={lanes:0,firstContext:n}}else Vm=Vm.next=n;return e}var Cf=null;function DL(n){Cf===null?Cf=[n]:Cf.push(n)}function gK(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,DL(e)):(t.next=i.next,i.next=t),e.interleaved=t,lc(n,r)}function lc(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var eh=!1;function FL(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mK(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function tc(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function _h(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,xt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,lc(n,t)}return i=r.interleaved,i===null?(e.next=e,DL(r)):(e.next=i.next,i.next=e),r.interleaved=e,lc(n,t)}function hT(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,EL(n,t)}}function mU(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Rb(n,e,t,r){var i=n.updateQueue;eh=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=n.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,c=u=l=null,a=s;do{var d=a.lane,f=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=n,g=a;switch(d=e,f=t,g.tag){case 1:if(m=g.payload,typeof m=="function"){h=m.call(f,h,d);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,d=typeof m=="function"?m.call(f,h,d):m,d==null)break e;h=kn({},h,d);break e;case 2:eh=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=h):c=c.next=f,o|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Wf|=o,n.lanes=o,n.memoizedState=h}}function pU(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(oe(191,i));i.call(r)}}}var YS={},Gl=td(YS),tS=td(YS),nS=td(YS);function Ef(n){if(n===YS)throw Error(oe(174));return n}function kL(n,e){switch(cn(nS,e),cn(tS,n),cn(Gl,YS),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pP(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=pP(e,n)}gn(Gl),cn(Gl,e)}function _p(){gn(Gl),gn(tS),gn(nS)}function pK(n){Ef(nS.current);var e=Ef(Gl.current),t=pP(e,n.type);e!==t&&(cn(tS,n),cn(Gl,t))}function VL(n){tS.current===n&&(gn(Gl),gn(tS))}var On=td(0);function Tb(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var vM=[];function $L(){for(var n=0;n<vM.length;n++)vM[n]._workInProgressVersionPrimary=null;vM.length=0}var dT=mc.ReactCurrentDispatcher,wM=mc.ReactCurrentBatchConfig,Bf=0,Ln=null,Or=null,zr=null,bb=!1,iy=!1,rS=0,_te=0;function di(){throw Error(oe(321))}function UL(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ya(n[t],e[t]))return!1;return!0}function BL(n,e,t,r,i,s){if(Bf=s,Ln=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,dT.current=n===null||n.memoizedState===null?Hte:Dte,n=t(r,i),iy){s=0;do{if(iy=!1,rS=0,25<=s)throw Error(oe(301));s+=1,zr=Or=null,e.updateQueue=null,dT.current=Fte,n=t(r,i)}while(iy)}if(dT.current=Ab,e=Or!==null&&Or.next!==null,Bf=0,zr=Or=Ln=null,bb=!1,e)throw Error(oe(300));return n}function WL(){var n=rS!==0;return rS=0,n}function Ml(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zr===null?Ln.memoizedState=zr=n:zr=zr.next=n,zr}function qo(){if(Or===null){var n=Ln.alternate;n=n!==null?n.memoizedState:null}else n=Or.next;var e=zr===null?Ln.memoizedState:zr.next;if(e!==null)zr=e,Or=n;else{if(n===null)throw Error(oe(310));Or=n,n={memoizedState:Or.memoizedState,baseState:Or.baseState,baseQueue:Or.baseQueue,queue:Or.queue,next:null},zr===null?Ln.memoizedState=zr=n:zr=zr.next=n}return zr}function iS(n,e){return typeof e=="function"?e(n):e}function yM(n){var e=qo(),t=e.queue;if(t===null)throw Error(oe(311));t.lastRenderedReducer=n;var r=Or,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((Bf&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,Ln.lanes|=c,Wf|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Ya(r,e.memoizedState)||(Es=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Ln.lanes|=s,Wf|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function SM(n){var e=qo(),t=e.queue;if(t===null)throw Error(oe(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Ya(s,e.memoizedState)||(Es=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function vK(){}function wK(n,e){var t=Ln,r=qo(),i=e(),s=!Ya(r.memoizedState,i);if(s&&(r.memoizedState=i,Es=!0),r=r.queue,jL(CK.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||zr!==null&&zr.memoizedState.tag&1){if(t.flags|=2048,sS(9,SK.bind(null,t,r,i,e),void 0,null),Kr===null)throw Error(oe(349));Bf&30||yK(t,e,i)}return i}function yK(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ln.updateQueue,e===null?(e={lastEffect:null,stores:null},Ln.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function SK(n,e,t,r){e.value=t,e.getSnapshot=r,EK(e)&&RK(n)}function CK(n,e,t){return t(function(){EK(e)&&RK(n)})}function EK(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ya(n,t)}catch{return!0}}function RK(n){var e=lc(n,1);e!==null&&ja(e,n,1,-1)}function vU(n){var e=Ml();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:iS,lastRenderedState:n},e.queue=n,n=n.dispatch=Lte.bind(null,Ln,n),[e.memoizedState,n]}function sS(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Ln.updateQueue,e===null?(e={lastEffect:null,stores:null},Ln.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function TK(){return qo().memoizedState}function fT(n,e,t,r){var i=Ml();Ln.flags|=n,i.memoizedState=sS(1|e,t,void 0,r===void 0?null:r)}function CA(n,e,t,r){var i=qo();r=r===void 0?null:r;var s=void 0;if(Or!==null){var o=Or.memoizedState;if(s=o.destroy,r!==null&&UL(r,o.deps)){i.memoizedState=sS(e,t,s,r);return}}Ln.flags|=n,i.memoizedState=sS(1|e,t,s,r)}function wU(n,e){return fT(8390656,8,n,e)}function jL(n,e){return CA(2048,8,n,e)}function bK(n,e){return CA(4,2,n,e)}function AK(n,e){return CA(4,4,n,e)}function NK(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function MK(n,e,t){return t=t!=null?t.concat([n]):null,CA(4,4,NK.bind(null,e,n),t)}function zL(){}function IK(n,e){var t=qo();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&UL(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function OK(n,e){var t=qo();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&UL(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function _K(n,e,t){return Bf&21?(Ya(t,e)||(t=D3(),Ln.lanes|=t,Wf|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Es=!0),n.memoizedState=t)}function Pte(n,e){var t=Jt;Jt=t!==0&&4>t?t:4,n(!0);var r=wM.transition;wM.transition={};try{n(!1),e()}finally{Jt=t,wM.transition=r}}function PK(){return qo().memoizedState}function xte(n,e,t){var r=xh(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},xK(n))LK(e,t);else if(t=gK(n,e,t,r),t!==null){var i=Yi();ja(t,n,r,i),HK(t,e,r)}}function Lte(n,e,t){var r=xh(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(xK(n))LK(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(i.hasEagerState=!0,i.eagerState=a,Ya(a,o)){var l=e.interleaved;l===null?(i.next=i,DL(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=gK(n,e,i,r),t!==null&&(i=Yi(),ja(t,n,r,i),HK(t,e,r))}}function xK(n){var e=n.alternate;return n===Ln||e!==null&&e===Ln}function LK(n,e){iy=bb=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function HK(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,EL(n,t)}}var Ab={readContext:Xo,useCallback:di,useContext:di,useEffect:di,useImperativeHandle:di,useInsertionEffect:di,useLayoutEffect:di,useMemo:di,useReducer:di,useRef:di,useState:di,useDebugValue:di,useDeferredValue:di,useTransition:di,useMutableSource:di,useSyncExternalStore:di,useId:di,unstable_isNewReconciler:!1},Hte={readContext:Xo,useCallback:function(n,e){return Ml().memoizedState=[n,e===void 0?null:e],n},useContext:Xo,useEffect:wU,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,fT(4194308,4,NK.bind(null,e,n),t)},useLayoutEffect:function(n,e){return fT(4194308,4,n,e)},useInsertionEffect:function(n,e){return fT(4,2,n,e)},useMemo:function(n,e){var t=Ml();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Ml();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=xte.bind(null,Ln,n),[r.memoizedState,n]},useRef:function(n){var e=Ml();return n={current:n},e.memoizedState=n},useState:vU,useDebugValue:zL,useDeferredValue:function(n){return Ml().memoizedState=n},useTransition:function(){var n=vU(!1),e=n[0];return n=Pte.bind(null,n[1]),Ml().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Ln,i=Ml();if(Tn){if(t===void 0)throw Error(oe(407));t=t()}else{if(t=e(),Kr===null)throw Error(oe(349));Bf&30||yK(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,wU(CK.bind(null,r,s,n),[n]),r.flags|=2048,sS(9,SK.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Ml(),e=Kr.identifierPrefix;if(Tn){var t=Gu,r=zu;t=(r&~(1<<32-Wa(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=rS++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=_te++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Dte={readContext:Xo,useCallback:IK,useContext:Xo,useEffect:jL,useImperativeHandle:MK,useInsertionEffect:bK,useLayoutEffect:AK,useMemo:OK,useReducer:yM,useRef:TK,useState:function(){return yM(iS)},useDebugValue:zL,useDeferredValue:function(n){var e=qo();return _K(e,Or.memoizedState,n)},useTransition:function(){var n=yM(iS)[0],e=qo().memoizedState;return[n,e]},useMutableSource:vK,useSyncExternalStore:wK,useId:PK,unstable_isNewReconciler:!1},Fte={readContext:Xo,useCallback:IK,useContext:Xo,useEffect:jL,useImperativeHandle:MK,useInsertionEffect:bK,useLayoutEffect:AK,useMemo:OK,useReducer:SM,useRef:TK,useState:function(){return SM(iS)},useDebugValue:zL,useDeferredValue:function(n){var e=qo();return Or===null?e.memoizedState=n:_K(e,Or.memoizedState,n)},useTransition:function(){var n=SM(iS)[0],e=qo().memoizedState;return[n,e]},useMutableSource:vK,useSyncExternalStore:wK,useId:PK,unstable_isNewReconciler:!1};function Na(n,e){if(n&&n.defaultProps){e=kn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function FP(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:kn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var EA={isMounted:function(n){return(n=n._reactInternals)?sg(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Yi(),i=xh(n),s=tc(r,i);s.payload=e,t!=null&&(s.callback=t),e=_h(n,s,i),e!==null&&(ja(e,n,i,r),hT(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Yi(),i=xh(n),s=tc(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=_h(n,s,i),e!==null&&(ja(e,n,i,r),hT(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Yi(),r=xh(n),i=tc(t,r);i.tag=2,e!=null&&(i.callback=e),e=_h(n,i,r),e!==null&&(ja(e,n,r,t),hT(e,n,r))}};function yU(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Qy(t,r)||!Qy(i,s):!0}function DK(n,e,t){var r=!1,i=Gh,s=e.contextType;return typeof s=="object"&&s!==null?s=Xo(s):(i=As(e)?$f:Ii.current,r=e.contextTypes,s=(r=r!=null)?Mp(n,i):Gh),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=EA,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function SU(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&EA.enqueueReplaceState(e,e.state,null)}function kP(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},FL(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Xo(s):(s=As(e)?$f:Ii.current,i.context=Mp(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(FP(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&EA.enqueueReplaceState(i,i.state,null),Rb(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Pp(n,e){try{var t="",r=e;do t+=hee(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function CM(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function VP(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var kte=typeof WeakMap=="function"?WeakMap:Map;function FK(n,e,t){t=tc(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Mb||(Mb=!0,XP=r),VP(n,e)},t}function kK(n,e,t){t=tc(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){VP(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){VP(n,e),typeof r!="function"&&(Ph===null?Ph=new Set([this]):Ph.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function CU(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new kte;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=Zte.bind(null,n,e,t),e.then(n,n))}function EU(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function RU(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=tc(-1,1),e.tag=2,_h(t,e,1))),t.lanes|=1),n)}var Vte=mc.ReactCurrentOwner,Es=!1;function Ui(n,e,t,r){e.child=n===null?fK(e,null,t,r):Op(e,n.child,t,r)}function TU(n,e,t,r,i){t=t.render;var s=e.ref;return lp(e,i),r=BL(n,e,t,r,s,i),t=WL(),n!==null&&!Es?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,uc(n,e,i)):(Tn&&t&&OL(e),e.flags|=1,Ui(n,e,r,i),e.child)}function bU(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!JL(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,VK(n,e,s,r,i)):(n=vT(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Qy,t(o,r)&&n.ref===e.ref)return uc(n,e,i)}return e.flags|=1,n=Lh(s,r),n.ref=e.ref,n.return=e,e.child=n}function VK(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(Qy(s,r)&&n.ref===e.ref)if(Es=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(Es=!0);else return e.lanes=n.lanes,uc(n,e,i)}return $P(n,e,t,r,i)}function $K(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},cn(Um,to),to|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,cn(Um,to),to|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,cn(Um,to),to|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,cn(Um,to),to|=r;return Ui(n,e,i,t),e.child}function UK(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function $P(n,e,t,r,i){var s=As(t)?$f:Ii.current;return s=Mp(e,s),lp(e,i),t=BL(n,e,t,r,s,i),r=WL(),n!==null&&!Es?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,uc(n,e,i)):(Tn&&r&&OL(e),e.flags|=1,Ui(n,e,t,i),e.child)}function AU(n,e,t,r,i){if(As(t)){var s=!0;wb(e)}else s=!1;if(lp(e,i),e.stateNode===null)gT(n,e),DK(e,t,r),kP(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Xo(u):(u=As(t)?$f:Ii.current,u=Mp(e,u));var c=t.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&SU(e,o,r,u),eh=!1;var d=e.memoizedState;o.state=d,Rb(e,r,o,i),l=e.memoizedState,a!==r||d!==l||bs.current||eh?(typeof c=="function"&&(FP(e,t,c,r),l=e.memoizedState),(a=eh||yU(e,t,a,r,d,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,mK(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Na(e.type,a),o.props=u,h=e.pendingProps,d=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Xo(l):(l=As(t)?$f:Ii.current,l=Mp(e,l));var f=t.getDerivedStateFromProps;(c=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&SU(e,o,r,l),eh=!1,d=e.memoizedState,o.state=d,Rb(e,r,o,i);var m=e.memoizedState;a!==h||d!==m||bs.current||eh?(typeof f=="function"&&(FP(e,t,f,r),m=e.memoizedState),(u=eh||yU(e,t,u,r,d,m,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return UP(n,e,t,r,s,i)}function UP(n,e,t,r,i,s){UK(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&hU(e,t,!1),uc(n,e,s);r=e.stateNode,Vte.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Op(e,n.child,null,s),e.child=Op(e,null,a,s)):Ui(n,e,a,s),e.memoizedState=r.state,i&&hU(e,t,!0),e.child}function BK(n){var e=n.stateNode;e.pendingContext?cU(n,e.pendingContext,e.pendingContext!==e.context):e.context&&cU(n,e.context,!1),kL(n,e.containerInfo)}function NU(n,e,t,r,i){return Ip(),PL(i),e.flags|=256,Ui(n,e,t,r),e.child}var BP={dehydrated:null,treeContext:null,retryLane:0};function WP(n){return{baseLanes:n,cachePool:null,transitions:null}}function WK(n,e,t){var r=e.pendingProps,i=On.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),cn(On,i&1),n===null)return HP(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=bA(o,r,0,null),n=Lf(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=WP(t),e.memoizedState=BP,n):GL(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return $te(n,e,o,r,a,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Lh(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Lh(a,s):(s=Lf(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?WP(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=BP,r}return s=n.child,n=s.sibling,r=Lh(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function GL(n,e){return e=bA({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function KC(n,e,t,r){return r!==null&&PL(r),Op(e,n.child,null,t),n=GL(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function $te(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=CM(Error(oe(422))),KC(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=bA({mode:"visible",children:r.children},i,0,null),s=Lf(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Op(e,n.child,null,o),e.child.memoizedState=WP(o),e.memoizedState=BP,s);if(!(e.mode&1))return KC(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(oe(419)),r=CM(s,r,void 0),KC(n,e,o,r)}if(a=(o&n.childLanes)!==0,Es||a){if(r=Kr,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,lc(n,i),ja(r,n,i,-1))}return ZL(),r=CM(Error(oe(421))),KC(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=Jte.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,oo=Oh(i.nextSibling),co=e,Tn=!0,La=null,n!==null&&(Vo[$o++]=zu,Vo[$o++]=Gu,Vo[$o++]=Uf,zu=n.id,Gu=n.overflow,Uf=e),e=GL(e,r.children),e.flags|=4096,e)}function MU(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),DP(n.return,e,t)}function EM(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function jK(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Ui(n,e,r.children,t),r=On.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&MU(n,t,e);else if(n.tag===19)MU(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(cn(On,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Tb(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),EM(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Tb(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}EM(e,!0,t,null,s);break;case"together":EM(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function gT(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function uc(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Wf|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(oe(153));if(e.child!==null){for(n=e.child,t=Lh(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Lh(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Ute(n,e,t){switch(e.tag){case 3:BK(e),Ip();break;case 5:pK(e);break;case 1:As(e.type)&&wb(e);break;case 4:kL(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;cn(Cb,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(cn(On,On.current&1),e.flags|=128,null):t&e.child.childLanes?WK(n,e,t):(cn(On,On.current&1),n=uc(n,e,t),n!==null?n.sibling:null);cn(On,On.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return jK(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),cn(On,On.current),r)break;return null;case 22:case 23:return e.lanes=0,$K(n,e,t)}return uc(n,e,t)}var zK,jP,GK,YK;zK=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};jP=function(){};GK=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Ef(Gl.current);var s=null;switch(t){case"input":i=dP(n,i),r=dP(n,r),s=[];break;case"select":i=kn({},i,{value:void 0}),r=kn({},r,{value:void 0}),s=[];break;case"textarea":i=mP(n,i),r=mP(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=pb)}vP(t,r);var o;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(jy.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(jy.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&dn("scroll",n),s||a===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};YK=function(n,e,t,r){t!==r&&(e.flags|=4)};function bv(n,e){if(!Tn)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function fi(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function Bte(n,e,t){var r=e.pendingProps;switch(_L(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fi(e),null;case 1:return As(e.type)&&vb(),fi(e),null;case 3:return r=e.stateNode,_p(),gn(bs),gn(Ii),$L(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(GC(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,La!==null&&(ZP(La),La=null))),jP(n,e),fi(e),null;case 5:VL(e);var i=Ef(nS.current);if(t=e.type,n!==null&&e.stateNode!=null)GK(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(oe(166));return fi(e),null}if(n=Ef(Gl.current),GC(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Fl]=e,r[eS]=s,n=(e.mode&1)!==0,t){case"dialog":dn("cancel",r),dn("close",r);break;case"iframe":case"object":case"embed":dn("load",r);break;case"video":case"audio":for(i=0;i<Dw.length;i++)dn(Dw[i],r);break;case"source":dn("error",r);break;case"img":case"image":case"link":dn("error",r),dn("load",r);break;case"details":dn("toggle",r);break;case"input":F$(r,s),dn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},dn("invalid",r);break;case"textarea":V$(r,s),dn("invalid",r)}vP(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&zC(r.textContent,a,n),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&zC(r.textContent,a,n),i=["children",""+a]):jy.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&dn("scroll",r)}switch(t){case"input":FC(r),k$(r,s,!0);break;case"textarea":FC(r),$$(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=pb)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=C3(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Fl]=e,n[eS]=r,zK(n,e,!1,!1),e.stateNode=n;e:{switch(o=wP(t,r),t){case"dialog":dn("cancel",n),dn("close",n),i=r;break;case"iframe":case"object":case"embed":dn("load",n),i=r;break;case"video":case"audio":for(i=0;i<Dw.length;i++)dn(Dw[i],n);i=r;break;case"source":dn("error",n),i=r;break;case"img":case"image":case"link":dn("error",n),dn("load",n),i=r;break;case"details":dn("toggle",n),i=r;break;case"input":F$(n,r),i=dP(n,r),dn("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=kn({},r,{value:void 0}),dn("invalid",n);break;case"textarea":V$(n,r),i=mP(n,r),dn("invalid",n);break;default:i=r}vP(t,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?T3(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&E3(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&zy(n,l):typeof l=="number"&&zy(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(jy.hasOwnProperty(s)?l!=null&&s==="onScroll"&&dn("scroll",n):l!=null&&pL(n,s,l,o))}switch(t){case"input":FC(n),k$(n,r,!1);break;case"textarea":FC(n),$$(n);break;case"option":r.value!=null&&n.setAttribute("value",""+zh(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?ip(n,!!r.multiple,s,!1):r.defaultValue!=null&&ip(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=pb)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return fi(e),null;case 6:if(n&&e.stateNode!=null)YK(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(oe(166));if(t=Ef(nS.current),Ef(Gl.current),GC(e)){if(r=e.stateNode,t=e.memoizedProps,r[Fl]=e,(s=r.nodeValue!==t)&&(n=co,n!==null))switch(n.tag){case 3:zC(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&zC(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Fl]=e,e.stateNode=r}return fi(e),null;case 13:if(gn(On),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Tn&&oo!==null&&e.mode&1&&!(e.flags&128))hK(),Ip(),e.flags|=98560,s=!1;else if(s=GC(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(oe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(oe(317));s[Fl]=e}else Ip(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;fi(e),s=!1}else La!==null&&(ZP(La),La=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||On.current&1?Pr===0&&(Pr=3):ZL())),e.updateQueue!==null&&(e.flags|=4),fi(e),null);case 4:return _p(),jP(n,e),n===null&&Zy(e.stateNode.containerInfo),fi(e),null;case 10:return HL(e.type._context),fi(e),null;case 17:return As(e.type)&&vb(),fi(e),null;case 19:if(gn(On),s=e.memoizedState,s===null)return fi(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)bv(s,!1);else{if(Pr!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Tb(n),o!==null){for(e.flags|=128,bv(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return cn(On,On.current&1|2),e.child}n=n.sibling}s.tail!==null&&rr()>xp&&(e.flags|=128,r=!0,bv(s,!1),e.lanes=4194304)}else{if(!r)if(n=Tb(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),bv(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Tn)return fi(e),null}else 2*rr()-s.renderingStartTime>xp&&t!==1073741824&&(e.flags|=128,r=!0,bv(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=rr(),e.sibling=null,t=On.current,cn(On,r?t&1|2:t&1),e):(fi(e),null);case 22:case 23:return QL(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?to&1073741824&&(fi(e),e.subtreeFlags&6&&(e.flags|=8192)):fi(e),null;case 24:return null;case 25:return null}throw Error(oe(156,e.tag))}function Wte(n,e){switch(_L(e),e.tag){case 1:return As(e.type)&&vb(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return _p(),gn(bs),gn(Ii),$L(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return VL(e),null;case 13:if(gn(On),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(oe(340));Ip()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return gn(On),null;case 4:return _p(),null;case 10:return HL(e.type._context),null;case 22:case 23:return QL(),null;case 24:return null;default:return null}}var XC=!1,Ti=!1,jte=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function $m(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Yn(n,e,r)}else t.current=null}function zP(n,e,t){try{t()}catch(r){Yn(n,e,r)}}var IU=!1;function zte(n,e){if(MP=fb,n=Z3(),IL(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=n,d=null;t:for(;;){for(var f;h!==t||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===n)break t;if(d===t&&++u===i&&(a=o),d===s&&++c===r&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(IP={focusedElem:n,selectionRange:t},fb=!1,Oe=e;Oe!==null;)if(e=Oe,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Oe=n;else for(;Oe!==null;){e=Oe;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,C=m.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:Na(e.type,g),C);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(E){Yn(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,Oe=n;break}Oe=e.return}return m=IU,IU=!1,m}function sy(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&zP(e,t,s)}i=i.next}while(i!==r)}}function RA(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function GP(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function KK(n){var e=n.alternate;e!==null&&(n.alternate=null,KK(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Fl],delete e[eS],delete e[PP],delete e[Nte],delete e[Mte])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function XK(n){return n.tag===5||n.tag===3||n.tag===4}function OU(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||XK(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function YP(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=pb));else if(r!==4&&(n=n.child,n!==null))for(YP(n,e,t),n=n.sibling;n!==null;)YP(n,e,t),n=n.sibling}function KP(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(KP(n,e,t),n=n.sibling;n!==null;)KP(n,e,t),n=n.sibling}var ri=null,_a=!1;function Ac(n,e,t){for(t=t.child;t!==null;)qK(n,e,t),t=t.sibling}function qK(n,e,t){if(zl&&typeof zl.onCommitFiberUnmount=="function")try{zl.onCommitFiberUnmount(mA,t)}catch{}switch(t.tag){case 5:Ti||$m(t,e);case 6:var r=ri,i=_a;ri=null,Ac(n,e,t),ri=r,_a=i,ri!==null&&(_a?(n=ri,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):ri.removeChild(t.stateNode));break;case 18:ri!==null&&(_a?(n=ri,t=t.stateNode,n.nodeType===8?mM(n.parentNode,t):n.nodeType===1&&mM(n,t),Xy(n)):mM(ri,t.stateNode));break;case 4:r=ri,i=_a,ri=t.stateNode.containerInfo,_a=!0,Ac(n,e,t),ri=r,_a=i;break;case 0:case 11:case 14:case 15:if(!Ti&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&zP(t,e,o),i=i.next}while(i!==r)}Ac(n,e,t);break;case 1:if(!Ti&&($m(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Yn(t,e,a)}Ac(n,e,t);break;case 21:Ac(n,e,t);break;case 22:t.mode&1?(Ti=(r=Ti)||t.memoizedState!==null,Ac(n,e,t),Ti=r):Ac(n,e,t);break;default:Ac(n,e,t)}}function _U(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new jte),e.forEach(function(r){var i=ene.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function da(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ri=a.stateNode,_a=!1;break e;case 3:ri=a.stateNode.containerInfo,_a=!0;break e;case 4:ri=a.stateNode.containerInfo,_a=!0;break e}a=a.return}if(ri===null)throw Error(oe(160));qK(s,o,i),ri=null,_a=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Yn(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)QK(e,n),e=e.sibling}function QK(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(da(e,n),rl(n),r&4){try{sy(3,n,n.return),RA(3,n)}catch(g){Yn(n,n.return,g)}try{sy(5,n,n.return)}catch(g){Yn(n,n.return,g)}}break;case 1:da(e,n),rl(n),r&512&&t!==null&&$m(t,t.return);break;case 5:if(da(e,n),rl(n),r&512&&t!==null&&$m(t,t.return),n.flags&32){var i=n.stateNode;try{zy(i,"")}catch(g){Yn(n,n.return,g)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&y3(i,s),wP(a,o);var u=wP(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?T3(i,h):c==="dangerouslySetInnerHTML"?E3(i,h):c==="children"?zy(i,h):pL(i,c,h,u)}switch(a){case"input":fP(i,s);break;case"textarea":S3(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?ip(i,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?ip(i,!!s.multiple,s.defaultValue,!0):ip(i,!!s.multiple,s.multiple?[]:"",!1))}i[eS]=s}catch(g){Yn(n,n.return,g)}}break;case 6:if(da(e,n),rl(n),r&4){if(n.stateNode===null)throw Error(oe(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(g){Yn(n,n.return,g)}}break;case 3:if(da(e,n),rl(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Xy(e.containerInfo)}catch(g){Yn(n,n.return,g)}break;case 4:da(e,n),rl(n);break;case 13:da(e,n),rl(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(XL=rr())),r&4&&_U(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(Ti=(u=Ti)||c,da(e,n),Ti=u):da(e,n),rl(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(Oe=n,c=n.child;c!==null;){for(h=Oe=c;Oe!==null;){switch(d=Oe,f=d.child,d.tag){case 0:case 11:case 14:case 15:sy(4,d,d.return);break;case 1:$m(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){Yn(r,t,g)}}break;case 5:$m(d,d.return);break;case 22:if(d.memoizedState!==null){xU(h);continue}}f!==null?(f.return=d,Oe=f):xU(h)}c=c.sibling}e:for(c=null,h=n;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=R3("display",o))}catch(g){Yn(n,n.return,g)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Yn(n,n.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:da(e,n),rl(n),r&4&&_U(n);break;case 21:break;default:da(e,n),rl(n)}}function rl(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(XK(t)){var r=t;break e}t=t.return}throw Error(oe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(zy(i,""),r.flags&=-33);var s=OU(n);KP(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=OU(n);YP(n,a,o);break;default:throw Error(oe(161))}}catch(l){Yn(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Gte(n,e,t){Oe=n,ZK(n)}function ZK(n,e,t){for(var r=(n.mode&1)!==0;Oe!==null;){var i=Oe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||XC;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Ti;a=XC;var u=Ti;if(XC=o,(Ti=l)&&!u)for(Oe=i;Oe!==null;)o=Oe,l=o.child,o.tag===22&&o.memoizedState!==null?LU(i):l!==null?(l.return=o,Oe=l):LU(i);for(;s!==null;)Oe=s,ZK(s),s=s.sibling;Oe=i,XC=a,Ti=u}PU(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Oe=s):PU(n)}}function PU(n){for(;Oe!==null;){var e=Oe;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ti||RA(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ti)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Na(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&pU(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}pU(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Xy(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}Ti||e.flags&512&&GP(e)}catch(d){Yn(e,e.return,d)}}if(e===n){Oe=null;break}if(t=e.sibling,t!==null){t.return=e.return,Oe=t;break}Oe=e.return}}function xU(n){for(;Oe!==null;){var e=Oe;if(e===n){Oe=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Oe=t;break}Oe=e.return}}function LU(n){for(;Oe!==null;){var e=Oe;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{RA(4,e)}catch(l){Yn(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Yn(e,i,l)}}var s=e.return;try{GP(e)}catch(l){Yn(e,s,l)}break;case 5:var o=e.return;try{GP(e)}catch(l){Yn(e,o,l)}}}catch(l){Yn(e,e.return,l)}if(e===n){Oe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Oe=a;break}Oe=e.return}}var Yte=Math.ceil,Nb=mc.ReactCurrentDispatcher,YL=mc.ReactCurrentOwner,Go=mc.ReactCurrentBatchConfig,xt=0,Kr=null,vr=null,oi=0,to=0,Um=td(0),Pr=0,oS=null,Wf=0,TA=0,KL=0,oy=null,ps=null,XL=0,xp=1/0,Lu=null,Mb=!1,XP=null,Ph=null,qC=!1,vh=null,Ib=0,ay=0,qP=null,mT=-1,pT=0;function Yi(){return xt&6?rr():mT!==-1?mT:mT=rr()}function xh(n){return n.mode&1?xt&2&&oi!==0?oi&-oi:Ote.transition!==null?(pT===0&&(pT=D3()),pT):(n=Jt,n!==0||(n=window.event,n=n===void 0?16:W3(n.type)),n):1}function ja(n,e,t,r){if(50<ay)throw ay=0,qP=null,Error(oe(185));jS(n,t,r),(!(xt&2)||n!==Kr)&&(n===Kr&&(!(xt&2)&&(TA|=t),Pr===4&&ch(n,oi)),Ns(n,r),t===1&&xt===0&&!(e.mode&1)&&(xp=rr()+500,SA&&nd()))}function Ns(n,e){var t=n.callbackNode;Oee(n,e);var r=db(n,n===Kr?oi:0);if(r===0)t!==null&&W$(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&W$(t),e===1)n.tag===0?Ite(HU.bind(null,n)):lK(HU.bind(null,n)),bte(function(){!(xt&6)&&nd()}),t=null;else{switch(F3(r)){case 1:t=CL;break;case 4:t=L3;break;case 16:t=hb;break;case 536870912:t=H3;break;default:t=hb}t=o4(t,JK.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function JK(n,e){if(mT=-1,pT=0,xt&6)throw Error(oe(327));var t=n.callbackNode;if(up()&&n.callbackNode!==t)return null;var r=db(n,n===Kr?oi:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Ob(n,r);else{e=r;var i=xt;xt|=2;var s=t4();(Kr!==n||oi!==e)&&(Lu=null,xp=rr()+500,xf(n,e));do try{qte();break}catch(a){e4(n,a)}while(!0);LL(),Nb.current=s,xt=i,vr!==null?e=0:(Kr=null,oi=0,e=Pr)}if(e!==0){if(e===2&&(i=RP(n),i!==0&&(r=i,e=QP(n,i))),e===1)throw t=oS,xf(n,0),ch(n,r),Ns(n,rr()),t;if(e===6)ch(n,r);else{if(i=n.current.alternate,!(r&30)&&!Kte(i)&&(e=Ob(n,r),e===2&&(s=RP(n),s!==0&&(r=s,e=QP(n,s))),e===1))throw t=oS,xf(n,0),ch(n,r),Ns(n,rr()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(oe(345));case 2:of(n,ps,Lu);break;case 3:if(ch(n,r),(r&130023424)===r&&(e=XL+500-rr(),10<e)){if(db(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){Yi(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=_P(of.bind(null,n,ps,Lu),e);break}of(n,ps,Lu);break;case 4:if(ch(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-Wa(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=rr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Yte(r/1960))-r,10<r){n.timeoutHandle=_P(of.bind(null,n,ps,Lu),r);break}of(n,ps,Lu);break;case 5:of(n,ps,Lu);break;default:throw Error(oe(329))}}}return Ns(n,rr()),n.callbackNode===t?JK.bind(null,n):null}function QP(n,e){var t=oy;return n.current.memoizedState.isDehydrated&&(xf(n,e).flags|=256),n=Ob(n,e),n!==2&&(e=ps,ps=t,e!==null&&ZP(e)),n}function ZP(n){ps===null?ps=n:ps.push.apply(ps,n)}function Kte(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Ya(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ch(n,e){for(e&=~KL,e&=~TA,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Wa(e),r=1<<t;n[t]=-1,e&=~r}}function HU(n){if(xt&6)throw Error(oe(327));up();var e=db(n,0);if(!(e&1))return Ns(n,rr()),null;var t=Ob(n,e);if(n.tag!==0&&t===2){var r=RP(n);r!==0&&(e=r,t=QP(n,r))}if(t===1)throw t=oS,xf(n,0),ch(n,e),Ns(n,rr()),t;if(t===6)throw Error(oe(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,of(n,ps,Lu),Ns(n,rr()),null}function qL(n,e){var t=xt;xt|=1;try{return n(e)}finally{xt=t,xt===0&&(xp=rr()+500,SA&&nd())}}function jf(n){vh!==null&&vh.tag===0&&!(xt&6)&&up();var e=xt;xt|=1;var t=Go.transition,r=Jt;try{if(Go.transition=null,Jt=1,n)return n()}finally{Jt=r,Go.transition=t,xt=e,!(xt&6)&&nd()}}function QL(){to=Um.current,gn(Um)}function xf(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Tte(t)),vr!==null)for(t=vr.return;t!==null;){var r=t;switch(_L(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&vb();break;case 3:_p(),gn(bs),gn(Ii),$L();break;case 5:VL(r);break;case 4:_p();break;case 13:gn(On);break;case 19:gn(On);break;case 10:HL(r.type._context);break;case 22:case 23:QL()}t=t.return}if(Kr=n,vr=n=Lh(n.current,null),oi=to=e,Pr=0,oS=null,KL=TA=Wf=0,ps=oy=null,Cf!==null){for(e=0;e<Cf.length;e++)if(t=Cf[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}Cf=null}return n}function e4(n,e){do{var t=vr;try{if(LL(),dT.current=Ab,bb){for(var r=Ln.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}bb=!1}if(Bf=0,zr=Or=Ln=null,iy=!1,rS=0,YL.current=null,t===null||t.return===null){Pr=1,oS=e,vr=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=oi,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=EU(o);if(f!==null){f.flags&=-257,RU(f,o,a,s,e),f.mode&1&&CU(s,u,e),e=f,l=u;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){CU(s,u,e),ZL();break e}l=Error(oe(426))}}else if(Tn&&a.mode&1){var C=EU(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),RU(C,o,a,s,e),PL(Pp(l,a));break e}}s=l=Pp(l,a),Pr!==4&&(Pr=2),oy===null?oy=[s]:oy.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=FK(s,l,e);mU(s,y);break e;case 1:a=l;var w=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Ph===null||!Ph.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var E=kK(s,a,e);mU(s,E);break e}}s=s.return}while(s!==null)}r4(t)}catch(P){e=P,vr===t&&t!==null&&(vr=t=t.return);continue}break}while(!0)}function t4(){var n=Nb.current;return Nb.current=Ab,n===null?Ab:n}function ZL(){(Pr===0||Pr===3||Pr===2)&&(Pr=4),Kr===null||!(Wf&268435455)&&!(TA&268435455)||ch(Kr,oi)}function Ob(n,e){var t=xt;xt|=2;var r=t4();(Kr!==n||oi!==e)&&(Lu=null,xf(n,e));do try{Xte();break}catch(i){e4(n,i)}while(!0);if(LL(),xt=t,Nb.current=r,vr!==null)throw Error(oe(261));return Kr=null,oi=0,Pr}function Xte(){for(;vr!==null;)n4(vr)}function qte(){for(;vr!==null&&!Cee();)n4(vr)}function n4(n){var e=s4(n.alternate,n,to);n.memoizedProps=n.pendingProps,e===null?r4(n):vr=e,YL.current=null}function r4(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Wte(t,e),t!==null){t.flags&=32767,vr=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Pr=6,vr=null;return}}else if(t=Bte(t,e,to),t!==null){vr=t;return}if(e=e.sibling,e!==null){vr=e;return}vr=e=n}while(e!==null);Pr===0&&(Pr=5)}function of(n,e,t){var r=Jt,i=Go.transition;try{Go.transition=null,Jt=1,Qte(n,e,t,r)}finally{Go.transition=i,Jt=r}return null}function Qte(n,e,t,r){do up();while(vh!==null);if(xt&6)throw Error(oe(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(oe(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(_ee(n,s),n===Kr&&(vr=Kr=null,oi=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||qC||(qC=!0,o4(hb,function(){return up(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Go.transition,Go.transition=null;var o=Jt;Jt=1;var a=xt;xt|=4,YL.current=null,zte(n,t),QK(t,n),vte(IP),fb=!!MP,IP=MP=null,n.current=t,Gte(t),Eee(),xt=a,Jt=o,Go.transition=s}else n.current=t;if(qC&&(qC=!1,vh=n,Ib=i),s=n.pendingLanes,s===0&&(Ph=null),bee(t.stateNode),Ns(n,rr()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Mb)throw Mb=!1,n=XP,XP=null,n;return Ib&1&&n.tag!==0&&up(),s=n.pendingLanes,s&1?n===qP?ay++:(ay=0,qP=n):ay=0,nd(),null}function up(){if(vh!==null){var n=F3(Ib),e=Go.transition,t=Jt;try{if(Go.transition=null,Jt=16>n?16:n,vh===null)var r=!1;else{if(n=vh,vh=null,Ib=0,xt&6)throw Error(oe(331));var i=xt;for(xt|=4,Oe=n.current;Oe!==null;){var s=Oe,o=s.child;if(Oe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Oe=u;Oe!==null;){var c=Oe;switch(c.tag){case 0:case 11:case 15:sy(8,c,s)}var h=c.child;if(h!==null)h.return=c,Oe=h;else for(;Oe!==null;){c=Oe;var d=c.sibling,f=c.return;if(KK(c),c===u){Oe=null;break}if(d!==null){d.return=f,Oe=d;break}Oe=f}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var C=g.sibling;g.sibling=null,g=C}while(g!==null)}}Oe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Oe=o;else e:for(;Oe!==null;){if(s=Oe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:sy(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,Oe=y;break e}Oe=s.return}}var w=n.current;for(Oe=w;Oe!==null;){o=Oe;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,Oe=S;else e:for(o=w;Oe!==null;){if(a=Oe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:RA(9,a)}}catch(P){Yn(a,a.return,P)}if(a===o){Oe=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,Oe=E;break e}Oe=a.return}}if(xt=i,nd(),zl&&typeof zl.onPostCommitFiberRoot=="function")try{zl.onPostCommitFiberRoot(mA,n)}catch{}r=!0}return r}finally{Jt=t,Go.transition=e}}return!1}function DU(n,e,t){e=Pp(t,e),e=FK(n,e,1),n=_h(n,e,1),e=Yi(),n!==null&&(jS(n,1,e),Ns(n,e))}function Yn(n,e,t){if(n.tag===3)DU(n,n,t);else for(;e!==null;){if(e.tag===3){DU(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ph===null||!Ph.has(r))){n=Pp(t,n),n=kK(e,n,1),e=_h(e,n,1),n=Yi(),e!==null&&(jS(e,1,n),Ns(e,n));break}}e=e.return}}function Zte(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Yi(),n.pingedLanes|=n.suspendedLanes&t,Kr===n&&(oi&t)===t&&(Pr===4||Pr===3&&(oi&130023424)===oi&&500>rr()-XL?xf(n,0):KL|=t),Ns(n,e)}function i4(n,e){e===0&&(n.mode&1?(e=$C,$C<<=1,!($C&130023424)&&($C=4194304)):e=1);var t=Yi();n=lc(n,e),n!==null&&(jS(n,e,t),Ns(n,t))}function Jte(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),i4(n,t)}function ene(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(e),i4(n,t)}var s4;s4=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||bs.current)Es=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Es=!1,Ute(n,e,t);Es=!!(n.flags&131072)}else Es=!1,Tn&&e.flags&1048576&&uK(e,Sb,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;gT(n,e),n=e.pendingProps;var i=Mp(e,Ii.current);lp(e,t),i=BL(null,e,r,n,i,t);var s=WL();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,As(r)?(s=!0,wb(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,FL(e),i.updater=EA,e.stateNode=i,i._reactInternals=e,kP(e,r,n,t),e=UP(null,e,r,!0,s,t)):(e.tag=0,Tn&&s&&OL(e),Ui(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(gT(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=nne(r),n=Na(r,n),i){case 0:e=$P(null,e,r,n,t);break e;case 1:e=AU(null,e,r,n,t);break e;case 11:e=TU(null,e,r,n,t);break e;case 14:e=bU(null,e,r,Na(r.type,n),t);break e}throw Error(oe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Na(r,i),$P(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Na(r,i),AU(n,e,r,i,t);case 3:e:{if(BK(e),n===null)throw Error(oe(387));r=e.pendingProps,s=e.memoizedState,i=s.element,mK(n,e),Rb(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Pp(Error(oe(423)),e),e=NU(n,e,r,t,i);break e}else if(r!==i){i=Pp(Error(oe(424)),e),e=NU(n,e,r,t,i);break e}else for(oo=Oh(e.stateNode.containerInfo.firstChild),co=e,Tn=!0,La=null,t=fK(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Ip(),r===i){e=uc(n,e,t);break e}Ui(n,e,r,t)}e=e.child}return e;case 5:return pK(e),n===null&&HP(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,OP(r,i)?o=null:s!==null&&OP(r,s)&&(e.flags|=32),UK(n,e),Ui(n,e,o,t),e.child;case 6:return n===null&&HP(e),null;case 13:return WK(n,e,t);case 4:return kL(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Op(e,null,r,t):Ui(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Na(r,i),TU(n,e,r,i,t);case 7:return Ui(n,e,e.pendingProps,t),e.child;case 8:return Ui(n,e,e.pendingProps.children,t),e.child;case 12:return Ui(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,cn(Cb,r._currentValue),r._currentValue=o,s!==null)if(Ya(s.value,o)){if(s.children===i.children&&!bs.current){e=uc(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=tc(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),DP(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(oe(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),DP(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ui(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,lp(e,t),i=Xo(i),r=r(i),e.flags|=1,Ui(n,e,r,t),e.child;case 14:return r=e.type,i=Na(r,e.pendingProps),i=Na(r.type,i),bU(n,e,r,i,t);case 15:return VK(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Na(r,i),gT(n,e),e.tag=1,As(r)?(n=!0,wb(e)):n=!1,lp(e,t),DK(e,r,i),kP(e,r,i,t),UP(null,e,r,!0,n,t);case 19:return jK(n,e,t);case 22:return $K(n,e,t)}throw Error(oe(156,e.tag))};function o4(n,e){return x3(n,e)}function tne(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jo(n,e,t,r){return new tne(n,e,t,r)}function JL(n){return n=n.prototype,!(!n||!n.isReactComponent)}function nne(n){if(typeof n=="function")return JL(n)?1:0;if(n!=null){if(n=n.$$typeof,n===wL)return 11;if(n===yL)return 14}return 2}function Lh(n,e){var t=n.alternate;return t===null?(t=jo(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function vT(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")JL(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case _m:return Lf(t.children,i,s,e);case vL:o=8,i|=8;break;case lP:return n=jo(12,t,e,i|2),n.elementType=lP,n.lanes=s,n;case uP:return n=jo(13,t,e,i),n.elementType=uP,n.lanes=s,n;case cP:return n=jo(19,t,e,i),n.elementType=cP,n.lanes=s,n;case p3:return bA(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case g3:o=10;break e;case m3:o=9;break e;case wL:o=11;break e;case yL:o=14;break e;case Jc:o=16,r=null;break e}throw Error(oe(130,n==null?n:typeof n,""))}return e=jo(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function Lf(n,e,t,r){return n=jo(7,n,r,e),n.lanes=t,n}function bA(n,e,t,r){return n=jo(22,n,r,e),n.elementType=p3,n.lanes=t,n.stateNode={isHidden:!1},n}function RM(n,e,t){return n=jo(6,n,null,e),n.lanes=t,n}function TM(n,e,t){return e=jo(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function rne(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=iM(0),this.expirationTimes=iM(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=iM(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function eH(n,e,t,r,i,s,o,a,l){return n=new rne(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=jo(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},FL(s),n}function ine(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Om,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function a4(n){if(!n)return Gh;n=n._reactInternals;e:{if(sg(n)!==n||n.tag!==1)throw Error(oe(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(As(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(oe(171))}if(n.tag===1){var t=n.type;if(As(t))return aK(n,t,e)}return e}function l4(n,e,t,r,i,s,o,a,l){return n=eH(t,r,!0,n,i,s,o,a,l),n.context=a4(null),t=n.current,r=Yi(),i=xh(t),s=tc(r,i),s.callback=e??null,_h(t,s,i),n.current.lanes=i,jS(n,i,r),Ns(n,r),n}function AA(n,e,t,r){var i=e.current,s=Yi(),o=xh(i);return t=a4(t),e.context===null?e.context=t:e.pendingContext=t,e=tc(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=_h(i,e,o),n!==null&&(ja(n,i,o,s),hT(n,i,o)),o}function _b(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function FU(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function tH(n,e){FU(n,e),(n=n.alternate)&&FU(n,e)}function sne(){return null}var u4=typeof reportError=="function"?reportError:function(n){console.error(n)};function nH(n){this._internalRoot=n}NA.prototype.render=nH.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(oe(409));AA(n,e,null,null)};NA.prototype.unmount=nH.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;jf(function(){AA(null,n,null,null)}),e[ac]=null}};function NA(n){this._internalRoot=n}NA.prototype.unstable_scheduleHydration=function(n){if(n){var e=$3();n={blockedOn:null,target:n,priority:e};for(var t=0;t<uh.length&&e!==0&&e<uh[t].priority;t++);uh.splice(t,0,n),t===0&&B3(n)}};function rH(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function MA(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function kU(){}function one(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=_b(o);s.call(u)}}var o=l4(e,r,n,0,null,!1,!1,"",kU);return n._reactRootContainer=o,n[ac]=o.current,Zy(n.nodeType===8?n.parentNode:n),jf(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=_b(l);a.call(u)}}var l=eH(n,0,!1,null,null,!1,!1,"",kU);return n._reactRootContainer=l,n[ac]=l.current,Zy(n.nodeType===8?n.parentNode:n),jf(function(){AA(e,l,t,r)}),l}function IA(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=_b(o);a.call(l)}}AA(e,o,n,i)}else o=one(t,e,n,i,r);return _b(o)}k3=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Hw(e.pendingLanes);t!==0&&(EL(e,t|1),Ns(e,rr()),!(xt&6)&&(xp=rr()+500,nd()))}break;case 13:jf(function(){var r=lc(n,1);if(r!==null){var i=Yi();ja(r,n,1,i)}}),tH(n,1)}};RL=function(n){if(n.tag===13){var e=lc(n,134217728);if(e!==null){var t=Yi();ja(e,n,134217728,t)}tH(n,134217728)}};V3=function(n){if(n.tag===13){var e=xh(n),t=lc(n,e);if(t!==null){var r=Yi();ja(t,n,e,r)}tH(n,e)}};$3=function(){return Jt};U3=function(n,e){var t=Jt;try{return Jt=n,e()}finally{Jt=t}};SP=function(n,e,t){switch(e){case"input":if(fP(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=yA(r);if(!i)throw Error(oe(90));w3(r),fP(r,i)}}}break;case"textarea":S3(n,t);break;case"select":e=t.value,e!=null&&ip(n,!!t.multiple,e,!1)}};N3=qL;M3=jf;var ane={usingClientEntryPoint:!1,Events:[GS,Hm,yA,b3,A3,qL]},Av={findFiberByHostInstance:Sf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lne={bundleType:Av.bundleType,version:Av.version,rendererPackageName:Av.rendererPackageName,rendererConfig:Av.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mc.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=_3(n),n===null?null:n.stateNode},findFiberByHostInstance:Av.findFiberByHostInstance||sne,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var QC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!QC.isDisabled&&QC.supportsFiber)try{mA=QC.inject(lne),zl=QC}catch{}}vo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ane;vo.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rH(e))throw Error(oe(200));return ine(n,e,null,t)};vo.createRoot=function(n,e){if(!rH(n))throw Error(oe(299));var t=!1,r="",i=u4;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=eH(n,1,!1,null,null,t,!1,r,i),n[ac]=e.current,Zy(n.nodeType===8?n.parentNode:n),new nH(e)};vo.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(oe(188)):(n=Object.keys(n).join(","),Error(oe(268,n)));return n=_3(e),n=n===null?null:n.stateNode,n};vo.flushSync=function(n){return jf(n)};vo.hydrate=function(n,e,t){if(!MA(e))throw Error(oe(200));return IA(null,n,e,!0,t)};vo.hydrateRoot=function(n,e,t){if(!rH(n))throw Error(oe(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=u4;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=l4(e,null,n,1,t??null,i,!1,s,o),n[ac]=e.current,Zy(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new NA(e)};vo.render=function(n,e,t){if(!MA(e))throw Error(oe(200));return IA(null,n,e,!1,t)};vo.unmountComponentAtNode=function(n){if(!MA(n))throw Error(oe(40));return n._reactRootContainer?(jf(function(){IA(null,null,n,!1,function(){n._reactRootContainer=null,n[ac]=null})}),!0):!1};vo.unstable_batchedUpdates=qL;vo.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!MA(t))throw Error(oe(200));if(n==null||n._reactInternals===void 0)throw Error(oe(38));return IA(n,e,t,!1,r)};vo.version="18.3.1-next-f1338f8080-20240426";function c4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c4)}catch(n){console.error(n)}}c4(),c3.exports=vo;var une=c3.exports,VU=une;oP.createRoot=VU.createRoot,oP.hydrateRoot=VU.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function aS(){return aS=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},aS.apply(this,arguments)}var wh;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(wh||(wh={}));const $U="popstate";function cne(n){n===void 0&&(n={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return JP("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:Pb(i)}return dne(e,t,null,n)}function Hn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function iH(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function hne(){return Math.random().toString(36).substr(2,8)}function UU(n,e){return{usr:n.state,key:n.key,idx:e}}function JP(n,e,t,r){return t===void 0&&(t=null),aS({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Qp(e):e,{state:t,key:e&&e.key||r||hne()})}function Pb(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Qp(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function dne(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=wh.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(aS({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function h(){a=wh.Pop;let C=c(),y=C==null?null:C-u;u=C,l&&l({action:a,location:g.location,delta:y})}function d(C,y){a=wh.Push;let w=JP(g.location,C,y);u=c()+1;let S=UU(w,u),E=g.createHref(w);try{o.pushState(S,"",E)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(E)}s&&l&&l({action:a,location:g.location,delta:1})}function f(C,y){a=wh.Replace;let w=JP(g.location,C,y);u=c();let S=UU(w,u),E=g.createHref(w);o.replaceState(S,"",E),s&&l&&l({action:a,location:g.location,delta:0})}function m(C){let y=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof C=="string"?C:Pb(C);return w=w.replace(/ $/,"%20"),Hn(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let g={get action(){return a},get location(){return n(i,o)},listen(C){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener($U,h),l=C,()=>{i.removeEventListener($U,h),l=null}},createHref(C){return e(i,C)},createURL:m,encodeLocation(C){let y=m(C);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:d,replace:f,go(C){return o.go(C)}};return g}var BU;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(BU||(BU={}));function fne(n,e,t){return t===void 0&&(t="/"),gne(n,e,t)}function gne(n,e,t,r){let i=typeof e=="string"?Qp(e):e,s=Lp(i.pathname||"/",t);if(s==null)return null;let o=h4(n);mne(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=Ane(s);a=Tne(o[l],u)}return a}function h4(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Hn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Hh([r,l.relativePath]),c=t.concat(l);s.children&&s.children.length>0&&(Hn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),h4(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:Ene(u,s.index),routesMeta:c})};return n.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of d4(s.path))i(s,o,l)}),e}function d4(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=d4(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function mne(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Rne(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const pne=/^:[\w-]+$/,vne=3,wne=2,yne=1,Sne=10,Cne=-2,WU=n=>n==="*";function Ene(n,e){let t=n.split("/"),r=t.length;return t.some(WU)&&(r+=Cne),e&&(r+=wne),t.filter(i=>!WU(i)).reduce((i,s)=>i+(pne.test(s)?vne:s===""?yne:Sne),r)}function Rne(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function Tne(n,e,t){let{routesMeta:r}=n,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=ex({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:Hh([s,h.pathname]),pathnameBase:_ne(Hh([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=Hh([s,h.pathnameBase]))}return o}function ex(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=bne(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((u,c,h)=>{let{paramName:d,isOptional:f}=c;if(d==="*"){let g=a[h]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const m=a[h];return f&&!m?u[d]=void 0:u[d]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:n}}function bne(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),iH(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function Ane(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return iH(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Lp(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const Nne=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mne=n=>Nne.test(n);function Ine(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Qp(n):n,s;if(t)if(Mne(t))s=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),iH(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+t))}t.startsWith("/")?s=jU(t.substring(1),"/"):s=jU(t,e)}else s=e;return{pathname:s,search:Pne(r),hash:xne(i)}}function jU(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function bM(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function One(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function sH(n,e){let t=One(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function oH(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=Qp(n):(i=aS({},n),Hn(!i.pathname||!i.pathname.includes("?"),bM("?","pathname","search",i)),Hn(!i.pathname||!i.pathname.includes("#"),bM("#","pathname","hash",i)),Hn(!i.search||!i.search.includes("#"),bM("#","search","hash",i)));let s=n===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=t;else{let h=e.length-1;if(!r&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=Ine(i,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Hh=n=>n.join("/").replace(/\/\/+/g,"/"),_ne=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Pne=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,xne=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Lne(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const f4=["post","put","patch","delete"];new Set(f4);const Hne=["get",...f4];new Set(Hne);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lS(){return lS=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},lS.apply(this,arguments)}const OA=te.createContext(null),g4=te.createContext(null),nu=te.createContext(null),_A=te.createContext(null),rd=te.createContext({outlet:null,matches:[],isDataRoute:!1}),m4=te.createContext(null);function Dne(n,e){let{relative:t}=e===void 0?{}:e;Zp()||Hn(!1);let{basename:r,navigator:i}=te.useContext(nu),{hash:s,pathname:o,search:a}=PA(n,{relative:t}),l=o;return r!=="/"&&(l=o==="/"?r:Hh([r,o])),i.createHref({pathname:l,search:a,hash:s})}function Zp(){return te.useContext(_A)!=null}function Jp(){return Zp()||Hn(!1),te.useContext(_A).location}function p4(n){te.useContext(nu).static||te.useLayoutEffect(n)}function v4(){let{isDataRoute:n}=te.useContext(rd);return n?Xne():Fne()}function Fne(){Zp()||Hn(!1);let n=te.useContext(OA),{basename:e,future:t,navigator:r}=te.useContext(nu),{matches:i}=te.useContext(rd),{pathname:s}=Jp(),o=JSON.stringify(sH(i,t.v7_relativeSplatPath)),a=te.useRef(!1);return p4(()=>{a.current=!0}),te.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let h=oH(u,JSON.parse(o),s,c.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Hh([e,h.pathname])),(c.replace?r.replace:r.push)(h,c.state,c)},[e,r,o,s,n])}function PA(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=te.useContext(nu),{matches:i}=te.useContext(rd),{pathname:s}=Jp(),o=JSON.stringify(sH(i,r.v7_relativeSplatPath));return te.useMemo(()=>oH(n,JSON.parse(o),s,t==="path"),[n,o,s,t])}function kne(n,e){return Vne(n,e)}function Vne(n,e,t,r){Zp()||Hn(!1);let{navigator:i}=te.useContext(nu),{matches:s}=te.useContext(rd),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Jp(),c;if(e){var h;let C=typeof e=="string"?Qp(e):e;l==="/"||(h=C.pathname)!=null&&h.startsWith(l)||Hn(!1),c=C}else c=u;let d=c.pathname||"/",f=d;if(l!=="/"){let C=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(C.length).join("/")}let m=fne(n,{pathname:f}),g=jne(m&&m.map(C=>Object.assign({},C,{params:Object.assign({},a,C.params),pathname:Hh([l,i.encodeLocation?i.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?l:Hh([l,i.encodeLocation?i.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),s,t,r);return e&&g?te.createElement(_A.Provider,{value:{location:lS({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:wh.Pop}},g):g}function $ne(){let n=Kne(),e=Lne(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return te.createElement(te.Fragment,null,te.createElement("h2",null,"Unexpected Application Error!"),te.createElement("h3",{style:{fontStyle:"italic"}},e),t?te.createElement("pre",{style:i},t):null,null)}const Une=te.createElement($ne,null);class Bne extends te.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?te.createElement(rd.Provider,{value:this.props.routeContext},te.createElement(m4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Wne(n){let{routeContext:e,match:t,children:r}=n,i=te.useContext(OA);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),te.createElement(rd.Provider,{value:e},r)}function jne(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var s;if(!t)return null;if(t.errors)n=t.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=(i=t)==null?void 0:i.errors;if(a!=null){let c=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);c>=0||Hn(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(t&&r&&r.v7_partialHydration)for(let c=0;c<o.length;c++){let h=o[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=c),h.route.id){let{loaderData:d,errors:f}=t,m=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||m){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,h,d)=>{let f,m=!1,g=null,C=null;t&&(f=a&&h.route.id?a[h.route.id]:void 0,g=h.route.errorElement||Une,l&&(u<0&&d===0?(qne("route-fallback"),m=!0,C=null):u===d&&(m=!0,C=h.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,d+1)),w=()=>{let S;return f?S=g:m?S=C:h.route.Component?S=te.createElement(h.route.Component,null):h.route.element?S=h.route.element:S=c,te.createElement(Wne,{match:h,routeContext:{outlet:c,matches:y,isDataRoute:t!=null},children:S})};return t&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?te.createElement(Bne,{location:t.location,revalidation:t.revalidation,component:g,error:f,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var w4=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(w4||{}),y4=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(y4||{});function zne(n){let e=te.useContext(OA);return e||Hn(!1),e}function Gne(n){let e=te.useContext(g4);return e||Hn(!1),e}function Yne(n){let e=te.useContext(rd);return e||Hn(!1),e}function S4(n){let e=Yne(),t=e.matches[e.matches.length-1];return t.route.id||Hn(!1),t.route.id}function Kne(){var n;let e=te.useContext(m4),t=Gne(),r=S4();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Xne(){let{router:n}=zne(w4.UseNavigateStable),e=S4(y4.UseNavigateStable),t=te.useRef(!1);return p4(()=>{t.current=!0}),te.useCallback(function(i,s){s===void 0&&(s={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,lS({fromRouteId:e},s)))},[n,e])}const zU={};function qne(n,e,t){zU[n]||(zU[n]=!0)}function Qne(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function GU(n){let{to:e,replace:t,state:r,relative:i}=n;Zp()||Hn(!1);let{future:s,static:o}=te.useContext(nu),{matches:a}=te.useContext(rd),{pathname:l}=Jp(),u=v4(),c=oH(e,sH(a,s.v7_relativeSplatPath),l,i==="path"),h=JSON.stringify(c);return te.useEffect(()=>u(JSON.parse(h),{replace:t,state:r,relative:i}),[u,h,i,t,r]),null}function Fw(n){Hn(!1)}function Zne(n){let{basename:e="/",children:t=null,location:r,navigationType:i=wh.Pop,navigator:s,static:o=!1,future:a}=n;Zp()&&Hn(!1);let l=e.replace(/^\/*/,"/"),u=te.useMemo(()=>({basename:l,navigator:s,static:o,future:lS({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=Qp(r));let{pathname:c="/",search:h="",hash:d="",state:f=null,key:m="default"}=r,g=te.useMemo(()=>{let C=Lp(c,l);return C==null?null:{location:{pathname:C,search:h,hash:d,state:f,key:m},navigationType:i}},[l,c,h,d,f,m,i]);return g==null?null:te.createElement(nu.Provider,{value:u},te.createElement(_A.Provider,{children:t,value:g}))}function Jne(n){let{children:e,location:t}=n;return kne(tx(e),t)}new Promise(()=>{});function tx(n,e){e===void 0&&(e=[]);let t=[];return te.Children.forEach(n,(r,i)=>{if(!te.isValidElement(r))return;let s=[...e,i];if(r.type===te.Fragment){t.push.apply(t,tx(r.props.children,s));return}r.type!==Fw&&Hn(!1),!r.props.index||!r.props.children||Hn(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=tx(r.props.children,s)),t.push(o)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xb(){return xb=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},xb.apply(this,arguments)}function C4(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function ere(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function tre(n,e){return n.button===0&&(!e||e==="_self")&&!ere(n)}const nre=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],rre=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],ire="6";try{window.__reactRouterVersion=ire}catch{}const sre=te.createContext({isTransitioning:!1}),ore="startTransition",YU=ZJ[ore];function are(n){let{basename:e,children:t,future:r,window:i}=n,s=te.useRef();s.current==null&&(s.current=cne({window:i,v5Compat:!0}));let o=s.current,[a,l]=te.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},c=te.useCallback(h=>{u&&YU?YU(()=>l(h)):l(h)},[l,u]);return te.useLayoutEffect(()=>o.listen(c),[o,c]),te.useEffect(()=>Qne(r),[r]),te.createElement(Zne,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:r})}const lre=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ure=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cre=te.forwardRef(function(e,t){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:c,viewTransition:h}=e,d=C4(e,nre),{basename:f}=te.useContext(nu),m,g=!1;if(typeof u=="string"&&ure.test(u)&&(m=u,lre))try{let S=new URL(window.location.href),E=u.startsWith("//")?new URL(S.protocol+u):new URL(u),P=Lp(E.pathname,f);E.origin===S.origin&&P!=null?u=P+E.search+E.hash:g=!0}catch{}let C=Dne(u,{relative:i}),y=dre(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:i,viewTransition:h});function w(S){r&&r(S),S.defaultPrevented||y(S)}return te.createElement("a",xb({},d,{href:m||C,onClick:g||s?r:w,ref:t,target:l}))}),KU=te.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:o=!1,style:a,to:l,viewTransition:u,children:c}=e,h=C4(e,rre),d=PA(l,{relative:h.relative}),f=Jp(),m=te.useContext(g4),{navigator:g,basename:C}=te.useContext(nu),y=m!=null&&fre(d)&&u===!0,w=g.encodeLocation?g.encodeLocation(d).pathname:d.pathname,S=f.pathname,E=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;i||(S=S.toLowerCase(),E=E?E.toLowerCase():null,w=w.toLowerCase()),E&&C&&(E=Lp(E,C)||E);const P=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let _=S===w||!o&&S.startsWith(w)&&S.charAt(P)==="/",I=E!=null&&(E===w||!o&&E.startsWith(w)&&E.charAt(w.length)==="/"),D={isActive:_,isPending:I,isTransitioning:y},Q=_?r:void 0,F;typeof s=="function"?F=s(D):F=[s,_?"active":null,I?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let J=typeof a=="function"?a(D):a;return te.createElement(cre,xb({},h,{"aria-current":Q,className:F,ref:t,style:J,to:l,viewTransition:u}),typeof c=="function"?c(D):c)});var nx;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(nx||(nx={}));var XU;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(XU||(XU={}));function hre(n){let e=te.useContext(OA);return e||Hn(!1),e}function dre(n,e){let{target:t,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=v4(),u=Jp(),c=PA(n,{relative:o});return te.useCallback(h=>{if(tre(h,t)){h.preventDefault();let d=r!==void 0?r:Pb(u)===Pb(c);l(n,{replace:d,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,c,r,i,t,n,s,o,a])}function fre(n,e){e===void 0&&(e={});let t=te.useContext(sre);t==null&&Hn(!1);let{basename:r}=hre(nx.useViewTransitionState),i=PA(n,{relative:e.relative});if(!t.isTransitioning)return!1;let s=Lp(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Lp(t.nextLocation.pathname,r)||t.nextLocation.pathname;return ex(i.pathname,o)!=null||ex(i.pathname,s)!=null}const aH="";async function AM(n){const e=await fetch(`${aH}/api/tarifas?anio=${n}`);if(!e.ok)throw new Error("No se pudo obtener las tarifas");return e.json()}async function gre(){const n=await fetch(`${aH}/api/costos`);if(!n.ok)throw new Error("No se pudo obtener los costos");return n.json()}async function mre(n){if(!n.length)return;if(!(await fetch(`${aH}/api/tarifas`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)throw new Error("Error al guardar las tarifas")}var Nv=function(n){return n&&n.Math===Math&&n},ur=Nv(typeof globalThis=="object"&&globalThis)||Nv(typeof window=="object"&&window)||Nv(typeof self=="object"&&self)||Nv(typeof Pw=="object"&&Pw)||Nv(typeof Pw=="object"&&Pw)||function(){return this}()||Function("return this")(),lH={},wr=function(n){try{return!!n()}catch{return!0}},pre=wr,ra=!pre(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),vre=wr,xA=!vre(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),wre=xA,ZC=Function.prototype.call,yr=wre?ZC.bind(ZC):function(){return ZC.apply(ZC,arguments)},E4={},R4={}.propertyIsEnumerable,T4=Object.getOwnPropertyDescriptor,yre=T4&&!R4.call({1:2},1);E4.f=yre?function(e){var t=T4(this,e);return!!t&&t.enumerable}:R4;var LA=function(n,e){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:e}},b4=xA,A4=Function.prototype,rx=A4.call,Sre=b4&&A4.bind.bind(rx,rx),cr=b4?Sre:function(n){return function(){return rx.apply(n,arguments)}},N4=cr,Cre=N4({}.toString),Ere=N4("".slice),og=function(n){return Ere(Cre(n),8,-1)},Rre=cr,Tre=wr,bre=og,NM=Object,Are=Rre("".split),Nre=Tre(function(){return!NM("z").propertyIsEnumerable(0)})?function(n){return bre(n)==="String"?Are(n,""):NM(n)}:NM,uH=function(n){return n==null},Mre=uH,Ire=TypeError,KS=function(n){if(Mre(n))throw new Ire("Can't call method on "+n);return n},Ore=Nre,_re=KS,XS=function(n){return Ore(_re(n))},MM=typeof document=="object"&&document.all,Sr=typeof MM>"u"&&MM!==void 0?function(n){return typeof n=="function"||n===MM}:function(n){return typeof n=="function"},Pre=Sr,ia=function(n){return typeof n=="object"?n!==null:Pre(n)},IM=ur,xre=Sr,Lre=function(n){return xre(n)?n:void 0},ev=function(n,e){return arguments.length<2?Lre(IM[n]):IM[n]&&IM[n][e]},Hre=cr,qS=Hre({}.isPrototypeOf),Dre=ur,qU=Dre.navigator,QU=qU&&qU.userAgent,HA=QU?String(QU):"",M4=ur,OM=HA,ZU=M4.process,JU=M4.Deno,eB=ZU&&ZU.versions||JU&&JU.version,tB=eB&&eB.v8,Ha,Lb;tB&&(Ha=tB.split("."),Lb=Ha[0]>0&&Ha[0]<4?1:+(Ha[0]+Ha[1]));!Lb&&OM&&(Ha=OM.match(/Edge\/(\d+)/),(!Ha||Ha[1]>=74)&&(Ha=OM.match(/Chrome\/(\d+)/),Ha&&(Lb=+Ha[1])));var Fre=Lb,nB=Fre,kre=wr,Vre=ur,$re=Vre.String,cH=!!Object.getOwnPropertySymbols&&!kre(function(){var n=Symbol("symbol detection");return!$re(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&nB&&nB<41}),Ure=cH,I4=Ure&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Bre=ev,Wre=Sr,jre=qS,zre=I4,Gre=Object,hH=zre?function(n){return typeof n=="symbol"}:function(n){var e=Bre("Symbol");return Wre(e)&&jre(e.prototype,Gre(n))},Yre=String,DA=function(n){try{return Yre(n)}catch{return"Object"}},Kre=Sr,Xre=DA,qre=TypeError,Ps=function(n){if(Kre(n))return n;throw new qre(Xre(n)+" is not a function")},Qre=Ps,Zre=uH,QS=function(n,e){var t=n[e];return Zre(t)?void 0:Qre(t)},_M=yr,PM=Sr,xM=ia,Jre=TypeError,eie=function(n,e){var t,r;if(e==="string"&&PM(t=n.toString)&&!xM(r=_M(t,n))||PM(t=n.valueOf)&&!xM(r=_M(t,n))||e!=="string"&&PM(t=n.toString)&&!xM(r=_M(t,n)))return r;throw new Jre("Can't convert object to primitive value")},O4={exports:{}},rB=ur,tie=Object.defineProperty,dH=function(n,e){try{tie(rB,n,{value:e,configurable:!0,writable:!0})}catch{rB[n]=e}return e},nie=ur,rie=dH,iB="__core-js_shared__",sB=O4.exports=nie[iB]||rie(iB,{});(sB.versions||(sB.versions=[])).push({version:"3.46.0",mode:"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"});var fH=O4.exports,oB=fH,_4=function(n,e){return oB[n]||(oB[n]=e||{})},iie=KS,sie=Object,tv=function(n){return sie(iie(n))},oie=cr,aie=tv,lie=oie({}.hasOwnProperty),sa=Object.hasOwn||function(e,t){return lie(aie(e),t)},uie=cr,cie=0,hie=Math.random(),die=uie(1.1.toString),P4=function(n){return"Symbol("+(n===void 0?"":n)+")_"+die(++cie+hie,36)},fie=ur,gie=_4,aB=sa,mie=P4,pie=cH,vie=I4,Bm=fie.Symbol,LM=gie("wks"),wie=vie?Bm.for||Bm:Bm&&Bm.withoutSetter||mie,Qa=function(n){return aB(LM,n)||(LM[n]=pie&&aB(Bm,n)?Bm[n]:wie("Symbol."+n)),LM[n]},yie=yr,lB=ia,uB=hH,Sie=QS,Cie=eie,Eie=Qa,Rie=TypeError,Tie=Eie("toPrimitive"),bie=function(n,e){if(!lB(n)||uB(n))return n;var t=Sie(n,Tie),r;if(t){if(e===void 0&&(e="default"),r=yie(t,n,e),!lB(r)||uB(r))return r;throw new Rie("Can't convert object to primitive value")}return e===void 0&&(e="number"),Cie(n,e)},Aie=bie,Nie=hH,x4=function(n){var e=Aie(n,"string");return Nie(e)?e:e+""},Mie=ur,cB=ia,ix=Mie.document,Iie=cB(ix)&&cB(ix.createElement),gH=function(n){return Iie?ix.createElement(n):{}},Oie=ra,_ie=wr,Pie=gH,L4=!Oie&&!_ie(function(){return Object.defineProperty(Pie("div"),"a",{get:function(){return 7}}).a!==7}),xie=ra,Lie=yr,Hie=E4,Die=LA,Fie=XS,kie=x4,Vie=sa,$ie=L4,hB=Object.getOwnPropertyDescriptor;lH.f=xie?hB:function(e,t){if(e=Fie(e),t=kie(t),$ie)try{return hB(e,t)}catch{}if(Vie(e,t))return Die(!Lie(Hie.f,e,t),e[t])};var pc={},Uie=ra,Bie=wr,H4=Uie&&Bie(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Wie=ia,jie=String,zie=TypeError,Cr=function(n){if(Wie(n))return n;throw new zie(jie(n)+" is not an object")},Gie=ra,Yie=L4,Kie=H4,JC=Cr,dB=x4,Xie=TypeError,HM=Object.defineProperty,qie=Object.getOwnPropertyDescriptor,DM="enumerable",FM="configurable",kM="writable";pc.f=Gie?Kie?function(e,t,r){if(JC(e),t=dB(t),JC(r),typeof e=="function"&&t==="prototype"&&"value"in r&&kM in r&&!r[kM]){var i=qie(e,t);i&&i[kM]&&(e[t]=r.value,r={configurable:FM in r?r[FM]:i[FM],enumerable:DM in r?r[DM]:i[DM],writable:!1})}return HM(e,t,r)}:HM:function(e,t,r){if(JC(e),t=dB(t),JC(r),Yie)try{return HM(e,t,r)}catch{}if("get"in r||"set"in r)throw new Xie("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var Qie=ra,Zie=pc,Jie=LA,nv=Qie?function(n,e,t){return Zie.f(n,e,Jie(1,t))}:function(n,e,t){return n[e]=t,n},D4={exports:{}},sx=ra,ese=sa,F4=Function.prototype,tse=sx&&Object.getOwnPropertyDescriptor,nse=ese(F4,"name"),rse=nse&&(!sx||sx&&tse(F4,"name").configurable),ise={CONFIGURABLE:rse},sse=cr,ose=Sr,ox=fH,ase=sse(Function.toString);ose(ox.inspectSource)||(ox.inspectSource=function(n){return ase(n)});var lse=ox.inspectSource,use=ur,cse=Sr,fB=use.WeakMap,hse=cse(fB)&&/native code/.test(String(fB)),dse=_4,fse=P4,gB=dse("keys"),mH=function(n){return gB[n]||(gB[n]=fse(n))},pH={},gse=hse,k4=ur,mse=ia,pse=nv,VM=sa,$M=fH,vse=mH,wse=pH,mB="Object already initialized",ax=k4.TypeError,yse=k4.WeakMap,Hb,uS,Db,Sse=function(n){return Db(n)?uS(n):Hb(n,{})},Cse=function(n){return function(e){var t;if(!mse(e)||(t=uS(e)).type!==n)throw new ax("Incompatible receiver, "+n+" required");return t}};if(gse||$M.state){var il=$M.state||($M.state=new yse);il.get=il.get,il.has=il.has,il.set=il.set,Hb=function(n,e){if(il.has(n))throw new ax(mB);return e.facade=n,il.set(n,e),e},uS=function(n){return il.get(n)||{}},Db=function(n){return il.has(n)}}else{var Cg=vse("state");wse[Cg]=!0,Hb=function(n,e){if(VM(n,Cg))throw new ax(mB);return e.facade=n,pse(n,Cg,e),e},uS=function(n){return VM(n,Cg)?n[Cg]:{}},Db=function(n){return VM(n,Cg)}}var V4={set:Hb,get:uS,has:Db,enforce:Sse,getterFor:Cse},vH=cr,Ese=wr,Rse=Sr,eE=sa,lx=ra,Tse=ise.CONFIGURABLE,bse=lse,$4=V4,Ase=$4.enforce,Nse=$4.get,pB=String,wT=Object.defineProperty,Mse=vH("".slice),Ise=vH("".replace),Ose=vH([].join),_se=lx&&!Ese(function(){return wT(function(){},"length",{value:8}).length!==8}),Pse=String(String).split("String"),xse=D4.exports=function(n,e,t){Mse(pB(e),0,7)==="Symbol("&&(e="["+Ise(pB(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!eE(n,"name")||Tse&&n.name!==e)&&(lx?wT(n,"name",{value:e,configurable:!0}):n.name=e),_se&&t&&eE(t,"arity")&&n.length!==t.arity&&wT(n,"length",{value:t.arity});try{t&&eE(t,"constructor")&&t.constructor?lx&&wT(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch{}var r=Ase(n);return eE(r,"source")||(r.source=Ose(Pse,typeof e=="string"?e:"")),n};Function.prototype.toString=xse(function(){return Rse(this)&&Nse(this).source||bse(this)},"toString");var U4=D4.exports,Lse=Sr,Hse=pc,Dse=U4,Fse=dH,wH=function(n,e,t,r){r||(r={});var i=r.enumerable,s=r.name!==void 0?r.name:e;if(Lse(t)&&Dse(t,s,r),r.global)i?n[e]=t:Fse(e,t);else{try{r.unsafe?n[e]&&(i=!0):delete n[e]}catch{}i?n[e]=t:Hse.f(n,e,{value:t,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return n},B4={},kse=Math.ceil,Vse=Math.floor,$se=Math.trunc||function(e){var t=+e;return(t>0?Vse:kse)(t)},Use=$se,ZS=function(n){var e=+n;return e!==e||e===0?0:Use(e)},Bse=ZS,Wse=Math.max,jse=Math.min,zse=function(n,e){var t=Bse(n);return t<0?Wse(t+e,0):jse(t,e)},Gse=ZS,Yse=Math.min,Kse=function(n){var e=Gse(n);return e>0?Yse(e,9007199254740991):0},Xse=Kse,rv=function(n){return Xse(n.length)},qse=XS,Qse=zse,Zse=rv,Jse=function(n){return function(e,t,r){var i=qse(e),s=Zse(i);if(s===0)return!n&&-1;var o=Qse(r,s),a;if(n&&t!==t){for(;s>o;)if(a=i[o++],a!==a)return!0}else for(;s>o;o++)if((n||o in i)&&i[o]===t)return n||o||0;return!n&&-1}},eoe={indexOf:Jse(!1)},toe=cr,UM=sa,noe=XS,roe=eoe.indexOf,ioe=pH,vB=toe([].push),W4=function(n,e){var t=noe(n),r=0,i=[],s;for(s in t)!UM(ioe,s)&&UM(t,s)&&vB(i,s);for(;e.length>r;)UM(t,s=e[r++])&&(~roe(i,s)||vB(i,s));return i},yH=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],soe=W4,ooe=yH,aoe=ooe.concat("length","prototype");B4.f=Object.getOwnPropertyNames||function(e){return soe(e,aoe)};var j4={};j4.f=Object.getOwnPropertySymbols;var loe=ev,uoe=cr,coe=B4,hoe=j4,doe=Cr,foe=uoe([].concat),goe=loe("Reflect","ownKeys")||function(e){var t=coe.f(doe(e)),r=hoe.f;return r?foe(t,r(e)):t},wB=sa,moe=goe,poe=lH,voe=pc,z4=function(n,e,t){for(var r=moe(e),i=voe.f,s=poe.f,o=0;o<r.length;o++){var a=r[o];!wB(n,a)&&!(t&&wB(t,a))&&i(n,a,s(e,a))}},woe=wr,yoe=Sr,Soe=/#|\.prototype\./,JS=function(n,e){var t=Eoe[Coe(n)];return t===Toe?!0:t===Roe?!1:yoe(e)?woe(e):!!e},Coe=JS.normalize=function(n){return String(n).replace(Soe,".").toLowerCase()},Eoe=JS.data={},Roe=JS.NATIVE="N",Toe=JS.POLYFILL="P",boe=JS,tE=ur,Aoe=lH.f,Noe=nv,Moe=wH,Ioe=dH,Ooe=z4,_oe=boe,an=function(n,e){var t=n.target,r=n.global,i=n.stat,s,o,a,l,u,c;if(r?o=tE:i?o=tE[t]||Ioe(t,{}):o=tE[t]&&tE[t].prototype,o)for(a in e){if(u=e[a],n.dontCallGetSet?(c=Aoe(o,a),l=c&&c.value):l=o[a],s=_oe(r?a:t+(i?".":"#")+a,n.forced),!s&&l!==void 0){if(typeof u==typeof l)continue;Ooe(u,l)}(n.sham||l&&l.sham)&&Noe(u,"sham",!0),Moe(o,a,u,n)}},Poe=xA,G4=Function.prototype,yB=G4.apply,SB=G4.call,eC=typeof Reflect=="object"&&Reflect.apply||(Poe?SB.bind(yB):function(){return SB.apply(yB,arguments)}),xoe=cr,Loe=Ps,Y4=function(n,e,t){try{return xoe(Loe(Object.getOwnPropertyDescriptor(n,e)[t]))}catch{}},Hoe=ia,Doe=function(n){return Hoe(n)||n===null},Foe=Doe,koe=String,Voe=TypeError,$oe=function(n){if(Foe(n))return n;throw new Voe("Can't set "+koe(n)+" as a prototype")},Uoe=Y4,Boe=ia,Woe=KS,joe=$oe,K4=Object.setPrototypeOf||("__proto__"in{}?function(){var n=!1,e={},t;try{t=Uoe(Object.prototype,"__proto__","set"),t(e,[]),n=e instanceof Array}catch{}return function(i,s){return Woe(i),joe(s),Boe(i)&&(n?t(i,s):i.__proto__=s),i}}():void 0),zoe=pc.f,Goe=function(n,e,t){t in n||zoe(n,t,{configurable:!0,get:function(){return e[t]},set:function(r){e[t]=r}})},Yoe=Sr,Koe=ia,CB=K4,Xoe=function(n,e,t){var r,i;return CB&&Yoe(r=e.constructor)&&r!==t&&Koe(i=r.prototype)&&i!==t.prototype&&CB(n,i),n},qoe=Qa,Qoe=qoe("toStringTag"),X4={};X4[Qoe]="z";var Zoe=String(X4)==="[object z]",Joe=Zoe,eae=Sr,yT=og,tae=Qa,nae=tae("toStringTag"),rae=Object,iae=yT(function(){return arguments}())==="Arguments",sae=function(n,e){try{return n[e]}catch{}},q4=Joe?yT:function(n){var e,t,r;return n===void 0?"Undefined":n===null?"Null":typeof(t=sae(e=rae(n),nae))=="string"?t:iae?yT(e):(r=yT(e))==="Object"&&eae(e.callee)?"Arguments":r},oae=q4,aae=String,FA=function(n){if(oae(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return aae(n)},lae=FA,uae=function(n,e){return n===void 0?arguments.length<2?"":e:lae(n)},cae=ia,hae=nv,dae=function(n,e){cae(e)&&"cause"in e&&hae(n,"cause",e.cause)},fae=cr,Q4=Error,gae=fae("".replace),mae=function(n){return String(new Q4(n).stack)}("zxcasd"),Z4=/\n\s*at [^:]*:[^\n]*/,pae=Z4.test(mae),vae=function(n,e){if(pae&&typeof n=="string"&&!Q4.prepareStackTrace)for(;e--;)n=gae(n,Z4,"");return n},wae=wr,yae=LA,Sae=!wae(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",yae(1,7)),n.stack!==7):!0}),Cae=nv,Eae=vae,Rae=Sae,EB=Error.captureStackTrace,Tae=function(n,e,t,r){Rae&&(EB?EB(n,e):Cae(n,"stack",Eae(t,r)))},RB=ev,bae=sa,TB=nv,Aae=qS,bB=K4,AB=z4,NB=Goe,Nae=Xoe,Mae=uae,Iae=dae,Oae=Tae,_ae=ra,Pae=function(n,e,t,r){var i="stackTraceLimit",s=r?2:1,o=n.split("."),a=o[o.length-1],l=RB.apply(null,o);if(l){var u=l.prototype;if(bae(u,"cause")&&delete u.cause,!t)return l;var c=RB("Error"),h=e(function(d,f){var m=Mae(r?f:d,void 0),g=r?new l(d):new l;return m!==void 0&&TB(g,"message",m),Oae(g,h,g.stack,2),this&&Aae(u,this)&&Nae(g,this,h),arguments.length>s&&Iae(g,arguments[s]),g});h.prototype=u,a!=="Error"?bB?bB(h,c):AB(h,c,{name:!0}):_ae&&i in l&&(NB(h,l,i),NB(h,l,"prepareStackTrace")),AB(h,l);try{u.name!==a&&TB(u,"name",a),u.constructor=h}catch{}return h}},J4=an,xae=ur,ru=eC,e6=Pae,ux="WebAssembly",MB=xae[ux],Fb=new Error("e",{cause:7}).cause!==7,ag=function(n,e){var t={};t[n]=e6(n,e,Fb),J4({global:!0,constructor:!0,arity:1,forced:Fb},t)},SH=function(n,e){if(MB&&MB[n]){var t={};t[n]=e6(ux+"."+n,e,Fb),J4({target:ux,stat:!0,constructor:!0,arity:1,forced:Fb},t)}};ag("Error",function(n){return function(t){return ru(n,this,arguments)}});ag("EvalError",function(n){return function(t){return ru(n,this,arguments)}});ag("RangeError",function(n){return function(t){return ru(n,this,arguments)}});ag("ReferenceError",function(n){return function(t){return ru(n,this,arguments)}});ag("SyntaxError",function(n){return function(t){return ru(n,this,arguments)}});ag("TypeError",function(n){return function(t){return ru(n,this,arguments)}});ag("URIError",function(n){return function(t){return ru(n,this,arguments)}});SH("CompileError",function(n){return function(t){return ru(n,this,arguments)}});SH("LinkError",function(n){return function(t){return ru(n,this,arguments)}});SH("RuntimeError",function(n){return function(t){return ru(n,this,arguments)}});var Lae=og,t6=Array.isArray||function(e){return Lae(e)==="Array"},Hae=ra,Dae=t6,Fae=TypeError,kae=Object.getOwnPropertyDescriptor,Vae=Hae&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(n){return n instanceof TypeError}}(),n6=Vae?function(n,e){if(Dae(n)&&!kae(n,"length").writable)throw new Fae("Cannot set read only .length");return n.length=e}:function(n,e){return n.length=e},$ae=TypeError,Uae=9007199254740991,r6=function(n){if(n>Uae)throw $ae("Maximum allowed index exceeded");return n},Bae=an,Wae=tv,jae=rv,zae=n6,Gae=r6,Yae=wr,Kae=Yae(function(){return[].push.call({length:4294967296},1)!==4294967297}),Xae=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(n){return n instanceof TypeError}},qae=Kae||!Xae();Bae({target:"Array",proto:!0,arity:1,forced:qae},{push:function(e){var t=Wae(this),r=jae(t),i=arguments.length;Gae(r+i);for(var s=0;s<i;s++)t[r]=arguments[s],r++;return zae(t,r),r}});var Qae=rv,Zae=function(n,e,t){for(var r=0,i=arguments.length>2?t:Qae(e),s=new n(i);i>r;)s[r]=e[r++];return s},Jae=ur,ele=function(n,e){var t=Jae[n],r=t&&t.prototype;return r&&r[e]},i6={},tle=W4,nle=yH,rle=Object.keys||function(e){return tle(e,nle)},ile=ra,sle=H4,ole=pc,ale=Cr,lle=XS,ule=rle;i6.f=ile&&!sle?Object.defineProperties:function(e,t){ale(e);for(var r=lle(t),i=ule(t),s=i.length,o=0,a;s>o;)ole.f(e,a=i[o++],r[a]);return e};var cle=ev,s6=cle("document","documentElement"),hle=Cr,dle=i6,IB=yH,fle=pH,gle=s6,mle=gH,ple=mH,OB=">",_B="<",cx="prototype",hx="script",o6=ple("IE_PROTO"),BM=function(){},a6=function(n){return _B+hx+OB+n+_B+"/"+hx+OB},PB=function(n){n.write(a6("")),n.close();var e=n.parentWindow.Object;return n=null,e},vle=function(){var n=mle("iframe"),e="java"+hx+":",t;return n.style.display="none",gle.appendChild(n),n.src=String(e),t=n.contentWindow.document,t.open(),t.write(a6("document.F=Object")),t.close(),t.F},nE,ST=function(){try{nE=new ActiveXObject("htmlfile")}catch{}ST=typeof document<"u"?document.domain&&nE?PB(nE):vle():PB(nE);for(var n=IB.length;n--;)delete ST[cx][IB[n]];return ST()};fle[o6]=!0;var l6=Object.create||function(e,t){var r;return e!==null?(BM[cx]=hle(e),r=new BM,BM[cx]=null,r[o6]=e):r=ST(),t===void 0?r:dle.f(r,t)},wle=Qa,yle=l6,Sle=pc.f,dx=wle("unscopables"),fx=Array.prototype;fx[dx]===void 0&&Sle(fx,dx,{configurable:!0,value:yle(null)});var kA=function(n){fx[dx][n]=!0},Cle=an,Ele=cr,Rle=Ps,Tle=XS,ble=Zae,Ale=ele,Nle=kA,Mle=Array,Ile=Ele(Ale("Array","sort"));Cle({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&Rle(e);var t=Tle(this),r=ble(Mle,t);return Ile(r,e)}});Nle("toSorted");var Ole=qS,_le=TypeError,Ple=function(n,e){if(Ole(e,n))return n;throw new _le("Incorrect invocation")},xle=wr,Lle=!xle(function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype}),Hle=sa,Dle=Sr,Fle=tv,kle=mH,Vle=Lle,xB=kle("IE_PROTO"),gx=Object,$le=gx.prototype,u6=Vle?gx.getPrototypeOf:function(n){var e=Fle(n);if(Hle(e,xB))return e[xB];var t=e.constructor;return Dle(t)&&e instanceof t?t.prototype:e instanceof gx?$le:null},LB=U4,Ule=pc,Ble=function(n,e,t){return t.get&&LB(t.get,e,{getter:!0}),t.set&&LB(t.set,e,{setter:!0}),Ule.f(n,e,t)},Wle=ra,jle=pc,zle=LA,c6=function(n,e,t){Wle?jle.f(n,e,zle(0,t)):n[e]=t},Gle=wr,Yle=Sr,Kle=ia,HB=u6,Xle=wH,qle=Qa,mx=qle("iterator"),zf,WM,jM;[].keys&&(jM=[].keys(),"next"in jM&&(WM=HB(HB(jM)),WM!==Object.prototype&&(zf=WM)));var Qle=!Kle(zf)||Gle(function(){var n={};return zf[mx].call(n)!==n});Qle&&(zf={});Yle(zf[mx])||Xle(zf,mx,function(){return this});var h6={IteratorPrototype:zf},Zle=an,Jle=ur,eue=Ple,tue=Cr,nue=Sr,rue=u6,iue=Ble,sue=c6,oue=wr,CH=sa,aue=Qa,Yl=h6.IteratorPrototype,lue=ra,zM="constructor",d6="Iterator",DB=aue("toStringTag"),f6=TypeError,GM=Jle[d6],g6=!nue(GM)||GM.prototype!==Yl||!oue(function(){GM({})}),EH=function(){if(eue(this,Yl),rue(this)===Yl)throw new f6("Abstract class Iterator not directly constructable")},m6=function(n,e){lue?iue(Yl,n,{configurable:!0,get:function(){return e},set:function(t){if(tue(this),this===Yl)throw new f6("You can't redefine this property");CH(this,n)?this[n]=t:sue(this,n,t)}}):Yl[n]=e};CH(Yl,DB)||m6(DB,d6);(g6||!CH(Yl,zM)||Yl[zM]===Object)&&m6(zM,EH);EH.prototype=Yl;Zle({global:!0,constructor:!0,forced:g6},{Iterator:EH});var uue=og,cue=cr,hue=function(n){if(uue(n)==="Function")return cue(n)},FB=hue,due=Ps,fue=xA,gue=FB(FB.bind),p6=function(n,e){return due(n),e===void 0?n:fue?gue(n,e):function(){return n.apply(e,arguments)}},v6={},mue=Qa,pue=v6,vue=mue("iterator"),wue=Array.prototype,yue=function(n){return n!==void 0&&(pue.Array===n||wue[vue]===n)},Sue=q4,kB=QS,Cue=uH,Eue=v6,Rue=Qa,Tue=Rue("iterator"),RH=function(n){if(!Cue(n))return kB(n,Tue)||kB(n,"@@iterator")||Eue[Sue(n)]},bue=yr,Aue=Ps,Nue=Cr,Mue=DA,Iue=RH,Oue=TypeError,_ue=function(n,e){var t=arguments.length<2?Iue(n):e;if(Aue(t))return Nue(bue(t,n));throw new Oue(Mue(n)+" is not iterable")},Pue=yr,VB=Cr,xue=QS,xs=function(n,e,t){var r,i;VB(n);try{if(r=xue(n,"return"),!r){if(e==="throw")throw t;return t}r=Pue(r,n)}catch(s){i=!0,r=s}if(e==="throw")throw t;if(i)throw r;return VB(r),t},Lue=p6,Hue=yr,Due=Cr,Fue=DA,kue=yue,Vue=rv,$B=qS,$ue=_ue,Uue=RH,UB=xs,Bue=TypeError,CT=function(n,e){this.stopped=n,this.result=e},BB=CT.prototype,iv=function(n,e,t){var r=t&&t.that,i=!!(t&&t.AS_ENTRIES),s=!!(t&&t.IS_RECORD),o=!!(t&&t.IS_ITERATOR),a=!!(t&&t.INTERRUPTED),l=Lue(e,r),u,c,h,d,f,m,g,C=function(w){return u&&UB(u,"normal"),new CT(!0,w)},y=function(w){return i?(Due(w),a?l(w[0],w[1],C):l(w[0],w[1])):a?l(w,C):l(w)};if(s)u=n.iterator;else if(o)u=n;else{if(c=Uue(n),!c)throw new Bue(Fue(n)+" is not iterable");if(kue(c)){for(h=0,d=Vue(n);d>h;h++)if(f=y(n[h]),f&&$B(BB,f))return f;return new CT(!1)}u=$ue(n,c)}for(m=s?n.next:u.next;!(g=Hue(m,u)).done;){try{f=y(g.value)}catch(w){UB(u,"throw",w)}if(typeof f=="object"&&f&&$B(BB,f))return f}return new CT(!1)},iu=function(n){return{iterator:n,next:n.next,done:!1}},Wue=ur,id=function(n,e){var t=Wue.Iterator,r=t&&t.prototype,i=r&&r[n],s=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(o){o instanceof e||(s=!1)}if(!s)return i},jue=an,zue=yr,Gue=iv,Yue=Ps,Kue=Cr,Xue=iu,que=xs,Que=id,YM=Que("every",TypeError);jue({target:"Iterator",proto:!0,real:!0,forced:YM},{every:function(e){Kue(this);try{Yue(e)}catch(i){que(this,"throw",i)}if(YM)return zue(YM,this,e);var t=Xue(this),r=0;return!Gue(t,function(i,s){if(!e(i,r++))return s()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});var Zue=wH,Jue=function(n,e,t){for(var r in e)Zue(n,r,e[r],t);return n},ece=function(n,e){return{value:n,done:e}},tce=xs,nce=function(n,e,t){for(var r=n.length-1;r>=0;r--)if(n[r]!==void 0)try{t=tce(n[r].iterator,e,t)}catch(i){e="throw",t=i}if(e==="throw")throw t;return t},rce=yr,ice=l6,sce=nv,oce=Jue,ace=Qa,w6=V4,lce=QS,uce=h6.IteratorPrototype,rE=ece,iE=xs,cce=nce,hce=ace("toStringTag"),y6="IteratorHelper",S6="WrapForValidIterator",KM="normal",WB="throw",dce=w6.set,C6=function(n){var e=w6.getterFor(n?S6:y6);return oce(ice(uce),{next:function(){var r=e(this);if(n)return r.nextHandler();if(r.done)return rE(void 0,!0);try{var i=r.nextHandler();return r.returnHandlerResult?i:rE(i,r.done)}catch(s){throw r.done=!0,s}},return:function(){var t=e(this),r=t.iterator;if(t.done=!0,n){var i=lce(r,"return");return i?rce(i,r):rE(void 0,!0)}if(t.inner)try{iE(t.inner.iterator,KM)}catch(s){return iE(r,WB,s)}if(t.openIters)try{cce(t.openIters,KM)}catch(s){return iE(r,WB,s)}return r&&iE(r,KM),rE(void 0,!0)}})},fce=C6(!0),E6=C6(!1);sce(E6,hce,"Iterator Helper");var TH=function(n,e,t){var r=function(s,o){o?(o.iterator=s.iterator,o.next=s.next):o=s,o.type=e?S6:y6,o.returnHandlerResult=!!t,o.nextHandler=n,o.counter=0,o.done=!1,dce(this,o)};return r.prototype=e?fce:E6,r},gce=Cr,mce=xs,R6=function(n,e,t,r){try{return r?e(gce(t)[0],t[1]):e(t)}catch(i){mce(n,"throw",i)}},bH=function(n,e){var t=typeof Iterator=="function"&&Iterator.prototype[n];if(t)try{t.call({next:null},e).next()}catch{return!0}},pce=an,T6=yr,vce=Ps,b6=Cr,wce=iu,yce=TH,Sce=R6,Cce=xs,Ece=bH,Rce=id,A6=!Ece("filter",function(){}),px=!A6&&Rce("filter",TypeError),Tce=A6||px,bce=yce(function(){for(var n=this.iterator,e=this.predicate,t=this.next,r,i,s;;){if(r=b6(T6(t,n)),i=this.done=!!r.done,i)return;if(s=r.value,Sce(n,e,[s,this.counter++],!0))return s}});pce({target:"Iterator",proto:!0,real:!0,forced:Tce},{filter:function(e){b6(this);try{vce(e)}catch(t){Cce(this,"throw",t)}return px?T6(px,this,e):new bce(wce(this),{predicate:e})}});var Ace=an,Nce=yr,Mce=iv,Ice=Ps,Oce=Cr,_ce=iu,Pce=xs,xce=id,XM=xce("find",TypeError);Ace({target:"Iterator",proto:!0,real:!0,forced:XM},{find:function(e){Oce(this);try{Ice(e)}catch(i){Pce(this,"throw",i)}if(XM)return Nce(XM,this,e);var t=_ce(this),r=0;return Mce(t,function(i,s){if(e(i,r++))return s(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});var Lce=an,N6=yr,Hce=Ps,M6=Cr,Dce=iu,Fce=TH,kce=R6,Vce=xs,$ce=bH,Uce=id,I6=!$ce("map",function(){}),vx=!I6&&Uce("map",TypeError),Bce=I6||vx,Wce=Fce(function(){var n=this.iterator,e=M6(N6(this.next,n)),t=this.done=!!e.done;if(!t)return kce(n,this.mapper,[e.value,this.counter++],!0)});Lce({target:"Iterator",proto:!0,real:!0,forced:Bce},{map:function(e){M6(this);try{Hce(e)}catch(t){Vce(this,"throw",t)}return vx?N6(vx,this,e):new Wce(Dce(this),{mapper:e})}});var jce=an,zce=iv,Gce=Ps,Yce=Cr,Kce=iu,Xce=xs,qce=id,Qce=eC,Zce=wr,O6=TypeError,_6=Zce(function(){[].keys().reduce(function(){},void 0)}),qM=!_6&&qce("reduce",O6);jce({target:"Iterator",proto:!0,real:!0,forced:_6||qM},{reduce:function(e){Yce(this);try{Gce(e)}catch(o){Xce(this,"throw",o)}var t=arguments.length<2,r=t?void 0:arguments[1];if(qM)return Qce(qM,this,t?[e]:[e,r]);var i=Kce(this),s=0;if(zce(i,function(o){t?(t=!1,r=o):r=e(r,o,s),s++},{IS_RECORD:!0}),t)throw new O6("Reduce of empty iterator with no initial value");return r}});//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var P6;function se(){return P6.apply(null,arguments)}function Jce(n){P6=n}function Ka(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function Hf(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function Ft(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function AH(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var e;for(e in n)if(Ft(n,e))return!1;return!0}function us(n){return n===void 0}function cc(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function tC(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function x6(n,e){var t=[],r,i=n.length;for(r=0;r<i;++r)t.push(e(n[r],r));return t}function yh(n,e){for(var t in e)Ft(e,t)&&(n[t]=e[t]);return Ft(e,"toString")&&(n.toString=e.toString),Ft(e,"valueOf")&&(n.valueOf=e.valueOf),n}function su(n,e,t,r){return n5(n,e,t,r,!0).utc()}function ehe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function lt(n){return n._pf==null&&(n._pf=ehe()),n._pf}var wx;Array.prototype.some?wx=Array.prototype.some:wx=function(n){var e=Object(this),t=e.length>>>0,r;for(r=0;r<t;r++)if(r in e&&n.call(this,e[r],r,e))return!0;return!1};function NH(n){var e=null,t=!1,r=n._d&&!isNaN(n._d.getTime());if(r&&(e=lt(n),t=wx.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t),n._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=r;else return r;return n._isValid}function VA(n){var e=su(NaN);return n!=null?yh(lt(e),n):lt(e).userInvalidated=!0,e}var jB=se.momentProperties=[],QM=!1;function MH(n,e){var t,r,i,s=jB.length;if(us(e._isAMomentObject)||(n._isAMomentObject=e._isAMomentObject),us(e._i)||(n._i=e._i),us(e._f)||(n._f=e._f),us(e._l)||(n._l=e._l),us(e._strict)||(n._strict=e._strict),us(e._tzm)||(n._tzm=e._tzm),us(e._isUTC)||(n._isUTC=e._isUTC),us(e._offset)||(n._offset=e._offset),us(e._pf)||(n._pf=lt(e)),us(e._locale)||(n._locale=e._locale),s>0)for(t=0;t<s;t++)r=jB[t],i=e[r],us(i)||(n[r]=i);return n}function nC(n){MH(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),QM===!1&&(QM=!0,se.updateOffset(this),QM=!1)}function Xa(n){return n instanceof nC||n!=null&&n._isAMomentObject!=null}function L6(n){se.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function oa(n,e){var t=!0;return yh(function(){if(se.deprecationHandler!=null&&se.deprecationHandler(null,n),t){var r=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])Ft(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];r.push(i)}L6(n+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var zB={};function H6(n,e){se.deprecationHandler!=null&&se.deprecationHandler(n,e),zB[n]||(L6(e),zB[n]=!0)}se.suppressDeprecationWarnings=!1;se.deprecationHandler=null;function ou(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function the(n){var e,t;for(t in n)Ft(n,t)&&(e=n[t],ou(e)?this[t]=e:this["_"+t]=e);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function yx(n,e){var t=yh({},n),r;for(r in e)Ft(e,r)&&(Hf(n[r])&&Hf(e[r])?(t[r]={},yh(t[r],n[r]),yh(t[r],e[r])):e[r]!=null?t[r]=e[r]:delete t[r]);for(r in n)Ft(n,r)&&!Ft(e,r)&&Hf(n[r])&&(t[r]=yh({},t[r]));return t}function IH(n){n!=null&&this.set(n)}var Sx;Object.keys?Sx=Object.keys:Sx=function(n){var e,t=[];for(e in n)Ft(n,e)&&t.push(e);return t};var nhe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function rhe(n,e,t){var r=this._calendar[n]||this._calendar.sameElse;return ou(r)?r.call(e,t):r}function Zl(n,e,t){var r=""+Math.abs(n),i=e-r.length,s=n>=0;return(s?t?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var OH=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,sE=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ZM={},cp={};function We(n,e,t,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),n&&(cp[n]=i),e&&(cp[e[0]]=function(){return Zl(i.apply(this,arguments),e[1],e[2])}),t&&(cp[t]=function(){return this.localeData().ordinal(i.apply(this,arguments),n)})}function ihe(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function she(n){var e=n.match(OH),t,r;for(t=0,r=e.length;t<r;t++)cp[e[t]]?e[t]=cp[e[t]]:e[t]=ihe(e[t]);return function(i){var s="",o;for(o=0;o<r;o++)s+=ou(e[o])?e[o].call(i,n):e[o];return s}}function ET(n,e){return n.isValid()?(e=D6(e,n.localeData()),ZM[e]=ZM[e]||she(e),ZM[e](n)):n.localeData().invalidDate()}function D6(n,e){var t=5;function r(i){return e.longDateFormat(i)||i}for(sE.lastIndex=0;t>=0&&sE.test(n);)n=n.replace(sE,r),sE.lastIndex=0,t-=1;return n}var ohe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ahe(n){var e=this._longDateFormat[n],t=this._longDateFormat[n.toUpperCase()];return e||!t?e:(this._longDateFormat[n]=t.match(OH).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[n])}var lhe="Invalid date";function uhe(){return this._invalidDate}var che="%d",hhe=/\d{1,2}/;function dhe(n){return this._ordinal.replace("%d",n)}var fhe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ghe(n,e,t,r){var i=this._relativeTime[t];return ou(i)?i(n,e,t,r):i.replace(/%d/i,n)}function mhe(n,e){var t=this._relativeTime[n>0?"future":"past"];return ou(t)?t(e):t.replace(/%s/i,e)}var GB={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function aa(n){return typeof n=="string"?GB[n]||GB[n.toLowerCase()]:void 0}function _H(n){var e={},t,r;for(r in n)Ft(n,r)&&(t=aa(r),t&&(e[t]=n[r]));return e}var phe={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function vhe(n){var e=[],t;for(t in n)Ft(n,t)&&e.push({unit:t,priority:phe[t]});return e.sort(function(r,i){return r.priority-i.priority}),e}var F6=/\d/,yo=/\d\d/,k6=/\d{3}/,PH=/\d{4}/,$A=/[+-]?\d{6}/,pn=/\d\d?/,V6=/\d\d\d\d?/,$6=/\d\d\d\d\d\d?/,UA=/\d{1,3}/,xH=/\d{1,4}/,BA=/[+-]?\d{1,6}/,sv=/\d+/,WA=/[+-]?\d+/,whe=/Z|[+-]\d\d:?\d\d/gi,jA=/Z|[+-]\d\d(?::?\d\d)?/gi,yhe=/[+-]?\d+(\.\d{1,3})?/,rC=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ov=/^[1-9]\d?/,LH=/^([1-9]\d|\d)/,kb;kb={};function Ie(n,e,t){kb[n]=ou(e)?e:function(r,i){return r&&t?t:e}}function She(n,e){return Ft(kb,n)?kb[n](e._strict,e._locale):new RegExp(Che(n))}function Che(n){return nc(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,i,s){return t||r||i||s}))}function nc(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Uo(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function Tt(n){var e=+n,t=0;return e!==0&&isFinite(e)&&(t=Uo(e)),t}var Cx={};function nn(n,e){var t,r=e,i;for(typeof n=="string"&&(n=[n]),cc(e)&&(r=function(s,o){o[e]=Tt(s)}),i=n.length,t=0;t<i;t++)Cx[n[t]]=r}function iC(n,e){nn(n,function(t,r,i,s){i._w=i._w||{},e(t,i._w,i,s)})}function Ehe(n,e,t){e!=null&&Ft(Cx,n)&&Cx[n](e,t._a,t,n)}function zA(n){return n%4===0&&n%100!==0||n%400===0}var Mi=0,Yu=1,kl=2,xr=3,$a=4,Ku=5,Rf=6,Rhe=7,The=8;We("Y",0,0,function(){var n=this.year();return n<=9999?Zl(n,4):"+"+n});We(0,["YY",2],0,function(){return this.year()%100});We(0,["YYYY",4],0,"year");We(0,["YYYYY",5],0,"year");We(0,["YYYYYY",6,!0],0,"year");Ie("Y",WA);Ie("YY",pn,yo);Ie("YYYY",xH,PH);Ie("YYYYY",BA,$A);Ie("YYYYYY",BA,$A);nn(["YYYYY","YYYYYY"],Mi);nn("YYYY",function(n,e){e[Mi]=n.length===2?se.parseTwoDigitYear(n):Tt(n)});nn("YY",function(n,e){e[Mi]=se.parseTwoDigitYear(n)});nn("Y",function(n,e){e[Mi]=parseInt(n,10)});function ly(n){return zA(n)?366:365}se.parseTwoDigitYear=function(n){return Tt(n)+(Tt(n)>68?1900:2e3)};var U6=av("FullYear",!0);function bhe(){return zA(this.year())}function av(n,e){return function(t){return t!=null?(B6(this,n,t),se.updateOffset(this,e),this):cS(this,n)}}function cS(n,e){if(!n.isValid())return NaN;var t=n._d,r=n._isUTC;switch(e){case"Milliseconds":return r?t.getUTCMilliseconds():t.getMilliseconds();case"Seconds":return r?t.getUTCSeconds():t.getSeconds();case"Minutes":return r?t.getUTCMinutes():t.getMinutes();case"Hours":return r?t.getUTCHours():t.getHours();case"Date":return r?t.getUTCDate():t.getDate();case"Day":return r?t.getUTCDay():t.getDay();case"Month":return r?t.getUTCMonth():t.getMonth();case"FullYear":return r?t.getUTCFullYear():t.getFullYear();default:return NaN}}function B6(n,e,t){var r,i,s,o,a;if(!(!n.isValid()||isNaN(t))){switch(r=n._d,i=n._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(t):r.setMilliseconds(t));case"Seconds":return void(i?r.setUTCSeconds(t):r.setSeconds(t));case"Minutes":return void(i?r.setUTCMinutes(t):r.setMinutes(t));case"Hours":return void(i?r.setUTCHours(t):r.setHours(t));case"Date":return void(i?r.setUTCDate(t):r.setDate(t));case"FullYear":break;default:return}s=t,o=n.month(),a=n.date(),a=a===29&&o===1&&!zA(s)?28:a,i?r.setUTCFullYear(s,o,a):r.setFullYear(s,o,a)}}function Ahe(n){return n=aa(n),ou(this[n])?this[n]():this}function Nhe(n,e){if(typeof n=="object"){n=_H(n);var t=vhe(n),r,i=t.length;for(r=0;r<i;r++)this[t[r].unit](n[t[r].unit])}else if(n=aa(n),ou(this[n]))return this[n](e);return this}function Mhe(n,e){return(n%e+e)%e}var tr;Array.prototype.indexOf?tr=Array.prototype.indexOf:tr=function(n){var e;for(e=0;e<this.length;++e)if(this[e]===n)return e;return-1};function HH(n,e){if(isNaN(n)||isNaN(e))return NaN;var t=Mhe(e,12);return n+=(e-t)/12,t===1?zA(n)?29:28:31-t%7%2}We("M",["MM",2],"Mo",function(){return this.month()+1});We("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});We("MMMM",0,0,function(n){return this.localeData().months(this,n)});Ie("M",pn,ov);Ie("MM",pn,yo);Ie("MMM",function(n,e){return e.monthsShortRegex(n)});Ie("MMMM",function(n,e){return e.monthsRegex(n)});nn(["M","MM"],function(n,e){e[Yu]=Tt(n)-1});nn(["MMM","MMMM"],function(n,e,t,r){var i=t._locale.monthsParse(n,r,t._strict);i!=null?e[Yu]=i:lt(t).invalidMonth=n});var Ihe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),W6="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),j6=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ohe=rC,_he=rC;function Phe(n,e){return n?Ka(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||j6).test(e)?"format":"standalone"][n.month()]:Ka(this._months)?this._months:this._months.standalone}function xhe(n,e){return n?Ka(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[j6.test(e)?"format":"standalone"][n.month()]:Ka(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Lhe(n,e,t){var r,i,s,o=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)s=su([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(s,"").toLocaleLowerCase();return t?e==="MMM"?(i=tr.call(this._shortMonthsParse,o),i!==-1?i:null):(i=tr.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=tr.call(this._shortMonthsParse,o),i!==-1?i:(i=tr.call(this._longMonthsParse,o),i!==-1?i:null)):(i=tr.call(this._longMonthsParse,o),i!==-1?i:(i=tr.call(this._shortMonthsParse,o),i!==-1?i:null))}function Hhe(n,e,t){var r,i,s;if(this._monthsParseExact)return Lhe.call(this,n,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=su([2e3,r]),t&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!t&&!this._monthsParse[r]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[r].test(n))return r;if(t&&e==="MMM"&&this._shortMonthsParse[r].test(n))return r;if(!t&&this._monthsParse[r].test(n))return r}}function z6(n,e){if(!n.isValid())return n;if(typeof e=="string"){if(/^\d+$/.test(e))e=Tt(e);else if(e=n.localeData().monthsParse(e),!cc(e))return n}var t=e,r=n.date();return r=r<29?r:Math.min(r,HH(n.year(),t)),n._isUTC?n._d.setUTCMonth(t,r):n._d.setMonth(t,r),n}function G6(n){return n!=null?(z6(this,n),se.updateOffset(this,!0),this):cS(this,"Month")}function Dhe(){return HH(this.year(),this.month())}function Fhe(n){return this._monthsParseExact?(Ft(this,"_monthsRegex")||Y6.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(Ft(this,"_monthsShortRegex")||(this._monthsShortRegex=Ohe),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function khe(n){return this._monthsParseExact?(Ft(this,"_monthsRegex")||Y6.call(this),n?this._monthsStrictRegex:this._monthsRegex):(Ft(this,"_monthsRegex")||(this._monthsRegex=_he),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function Y6(){function n(l,u){return u.length-l.length}var e=[],t=[],r=[],i,s,o,a;for(i=0;i<12;i++)s=su([2e3,i]),o=nc(this.monthsShort(s,"")),a=nc(this.months(s,"")),e.push(o),t.push(a),r.push(a),r.push(o);e.sort(n),t.sort(n),r.sort(n),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Vhe(n,e,t,r,i,s,o){var a;return n<100&&n>=0?(a=new Date(n+400,e,t,r,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(n)):a=new Date(n,e,t,r,i,s,o),a}function hS(n){var e,t;return n<100&&n>=0?(t=Array.prototype.slice.call(arguments),t[0]=n+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(n)):e=new Date(Date.UTC.apply(null,arguments)),e}function Vb(n,e,t){var r=7+e-t,i=(7+hS(n,0,r).getUTCDay()-e)%7;return-i+r-1}function K6(n,e,t,r,i){var s=(7+t-r)%7,o=Vb(n,r,i),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=n-1,u=ly(l)+a):a>ly(n)?(l=n+1,u=a-ly(n)):(l=n,u=a),{year:l,dayOfYear:u}}function dS(n,e,t){var r=Vb(n.year(),e,t),i=Math.floor((n.dayOfYear()-r-1)/7)+1,s,o;return i<1?(o=n.year()-1,s=i+rc(o,e,t)):i>rc(n.year(),e,t)?(s=i-rc(n.year(),e,t),o=n.year()+1):(o=n.year(),s=i),{week:s,year:o}}function rc(n,e,t){var r=Vb(n,e,t),i=Vb(n+1,e,t);return(ly(n)-r+i)/7}We("w",["ww",2],"wo","week");We("W",["WW",2],"Wo","isoWeek");Ie("w",pn,ov);Ie("ww",pn,yo);Ie("W",pn,ov);Ie("WW",pn,yo);iC(["w","ww","W","WW"],function(n,e,t,r){e[r.substr(0,1)]=Tt(n)});function $he(n){return dS(n,this._week.dow,this._week.doy).week}var Uhe={dow:0,doy:6};function Bhe(){return this._week.dow}function Whe(){return this._week.doy}function jhe(n){var e=this.localeData().week(this);return n==null?e:this.add((n-e)*7,"d")}function zhe(n){var e=dS(this,1,4).week;return n==null?e:this.add((n-e)*7,"d")}We("d",0,"do","day");We("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});We("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});We("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});We("e",0,0,"weekday");We("E",0,0,"isoWeekday");Ie("d",pn);Ie("e",pn);Ie("E",pn);Ie("dd",function(n,e){return e.weekdaysMinRegex(n)});Ie("ddd",function(n,e){return e.weekdaysShortRegex(n)});Ie("dddd",function(n,e){return e.weekdaysRegex(n)});iC(["dd","ddd","dddd"],function(n,e,t,r){var i=t._locale.weekdaysParse(n,r,t._strict);i!=null?e.d=i:lt(t).invalidWeekday=n});iC(["d","e","E"],function(n,e,t,r){e[r]=Tt(n)});function Ghe(n,e){return typeof n!="string"?n:isNaN(n)?(n=e.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function Yhe(n,e){return typeof n=="string"?e.weekdaysParse(n)%7||7:isNaN(n)?null:n}function DH(n,e){return n.slice(e,7).concat(n.slice(0,e))}var Khe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),X6="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Xhe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),qhe=rC,Qhe=rC,Zhe=rC;function Jhe(n,e){var t=Ka(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return n===!0?DH(t,this._week.dow):n?t[n.day()]:t}function ede(n){return n===!0?DH(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function tde(n){return n===!0?DH(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function nde(n,e,t){var r,i,s,o=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)s=su([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(s,"").toLocaleLowerCase();return t?e==="dddd"?(i=tr.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=tr.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=tr.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=tr.call(this._weekdaysParse,o),i!==-1||(i=tr.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=tr.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=tr.call(this._shortWeekdaysParse,o),i!==-1||(i=tr.call(this._weekdaysParse,o),i!==-1)?i:(i=tr.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=tr.call(this._minWeekdaysParse,o),i!==-1||(i=tr.call(this._weekdaysParse,o),i!==-1)?i:(i=tr.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function rde(n,e,t){var r,i,s;if(this._weekdaysParseExact)return nde.call(this,n,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=su([2e3,1]).day(r),t&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(s.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[r].test(n))return r;if(t&&e==="ddd"&&this._shortWeekdaysParse[r].test(n))return r;if(t&&e==="dd"&&this._minWeekdaysParse[r].test(n))return r;if(!t&&this._weekdaysParse[r].test(n))return r}}function ide(n){if(!this.isValid())return n!=null?this:NaN;var e=cS(this,"Day");return n!=null?(n=Ghe(n,this.localeData()),this.add(n-e,"d")):e}function sde(n){if(!this.isValid())return n!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return n==null?e:this.add(n-e,"d")}function ode(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var e=Yhe(n,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function ade(n){return this._weekdaysParseExact?(Ft(this,"_weekdaysRegex")||FH.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(Ft(this,"_weekdaysRegex")||(this._weekdaysRegex=qhe),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function lde(n){return this._weekdaysParseExact?(Ft(this,"_weekdaysRegex")||FH.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ft(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Qhe),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function ude(n){return this._weekdaysParseExact?(Ft(this,"_weekdaysRegex")||FH.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ft(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Zhe),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function FH(){function n(c,h){return h.length-c.length}var e=[],t=[],r=[],i=[],s,o,a,l,u;for(s=0;s<7;s++)o=su([2e3,1]).day(s),a=nc(this.weekdaysMin(o,"")),l=nc(this.weekdaysShort(o,"")),u=nc(this.weekdays(o,"")),e.push(a),t.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(n),t.sort(n),r.sort(n),i.sort(n),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function kH(){return this.hours()%12||12}function cde(){return this.hours()||24}We("H",["HH",2],0,"hour");We("h",["hh",2],0,kH);We("k",["kk",2],0,cde);We("hmm",0,0,function(){return""+kH.apply(this)+Zl(this.minutes(),2)});We("hmmss",0,0,function(){return""+kH.apply(this)+Zl(this.minutes(),2)+Zl(this.seconds(),2)});We("Hmm",0,0,function(){return""+this.hours()+Zl(this.minutes(),2)});We("Hmmss",0,0,function(){return""+this.hours()+Zl(this.minutes(),2)+Zl(this.seconds(),2)});function q6(n,e){We(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}q6("a",!0);q6("A",!1);function Q6(n,e){return e._meridiemParse}Ie("a",Q6);Ie("A",Q6);Ie("H",pn,LH);Ie("h",pn,ov);Ie("k",pn,ov);Ie("HH",pn,yo);Ie("hh",pn,yo);Ie("kk",pn,yo);Ie("hmm",V6);Ie("hmmss",$6);Ie("Hmm",V6);Ie("Hmmss",$6);nn(["H","HH"],xr);nn(["k","kk"],function(n,e,t){var r=Tt(n);e[xr]=r===24?0:r});nn(["a","A"],function(n,e,t){t._isPm=t._locale.isPM(n),t._meridiem=n});nn(["h","hh"],function(n,e,t){e[xr]=Tt(n),lt(t).bigHour=!0});nn("hmm",function(n,e,t){var r=n.length-2;e[xr]=Tt(n.substr(0,r)),e[$a]=Tt(n.substr(r)),lt(t).bigHour=!0});nn("hmmss",function(n,e,t){var r=n.length-4,i=n.length-2;e[xr]=Tt(n.substr(0,r)),e[$a]=Tt(n.substr(r,2)),e[Ku]=Tt(n.substr(i)),lt(t).bigHour=!0});nn("Hmm",function(n,e,t){var r=n.length-2;e[xr]=Tt(n.substr(0,r)),e[$a]=Tt(n.substr(r))});nn("Hmmss",function(n,e,t){var r=n.length-4,i=n.length-2;e[xr]=Tt(n.substr(0,r)),e[$a]=Tt(n.substr(r,2)),e[Ku]=Tt(n.substr(i))});function hde(n){return(n+"").toLowerCase().charAt(0)==="p"}var dde=/[ap]\.?m?\.?/i,fde=av("Hours",!0);function gde(n,e,t){return n>11?t?"pm":"PM":t?"am":"AM"}var Z6={calendar:nhe,longDateFormat:ohe,invalidDate:lhe,ordinal:che,dayOfMonthOrdinalParse:hhe,relativeTime:fhe,months:Ihe,monthsShort:W6,week:Uhe,weekdays:Khe,weekdaysMin:Xhe,weekdaysShort:X6,meridiemParse:dde},En={},Mv={},fS;function mde(n,e){var t,r=Math.min(n.length,e.length);for(t=0;t<r;t+=1)if(n[t]!==e[t])return t;return r}function YB(n){return n&&n.toLowerCase().replace("_","-")}function pde(n){for(var e=0,t,r,i,s;e<n.length;){for(s=YB(n[e]).split("-"),t=s.length,r=YB(n[e+1]),r=r?r.split("-"):null;t>0;){if(i=GA(s.slice(0,t).join("-")),i)return i;if(r&&r.length>=t&&mde(s,r)>=t-1)break;t--}e++}return fS}function vde(n){return!!(n&&n.match("^[^/\\\\]*$"))}function GA(n){var e=null,t;if(En[n]===void 0&&typeof ab<"u"&&ab&&ab.exports&&vde(n))try{e=fS._abbr,t=require,t("./locale/"+n),Dh(e)}catch{En[n]=null}return En[n]}function Dh(n,e){var t;return n&&(us(e)?t=vc(n):t=VH(n,e),t?fS=t:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),fS._abbr}function VH(n,e){if(e!==null){var t,r=Z6;if(e.abbr=n,En[n]!=null)H6("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=En[n]._config;else if(e.parentLocale!=null)if(En[e.parentLocale]!=null)r=En[e.parentLocale]._config;else if(t=GA(e.parentLocale),t!=null)r=t._config;else return Mv[e.parentLocale]||(Mv[e.parentLocale]=[]),Mv[e.parentLocale].push({name:n,config:e}),null;return En[n]=new IH(yx(r,e)),Mv[n]&&Mv[n].forEach(function(i){VH(i.name,i.config)}),Dh(n),En[n]}else return delete En[n],null}function wde(n,e){if(e!=null){var t,r,i=Z6;En[n]!=null&&En[n].parentLocale!=null?En[n].set(yx(En[n]._config,e)):(r=GA(n),r!=null&&(i=r._config),e=yx(i,e),r==null&&(e.abbr=n),t=new IH(e),t.parentLocale=En[n],En[n]=t),Dh(n)}else En[n]!=null&&(En[n].parentLocale!=null?(En[n]=En[n].parentLocale,n===Dh()&&Dh(n)):En[n]!=null&&delete En[n]);return En[n]}function vc(n){var e;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return fS;if(!Ka(n)){if(e=GA(n),e)return e;n=[n]}return pde(n)}function yde(){return Sx(En)}function $H(n){var e,t=n._a;return t&&lt(n).overflow===-2&&(e=t[Yu]<0||t[Yu]>11?Yu:t[kl]<1||t[kl]>HH(t[Mi],t[Yu])?kl:t[xr]<0||t[xr]>24||t[xr]===24&&(t[$a]!==0||t[Ku]!==0||t[Rf]!==0)?xr:t[$a]<0||t[$a]>59?$a:t[Ku]<0||t[Ku]>59?Ku:t[Rf]<0||t[Rf]>999?Rf:-1,lt(n)._overflowDayOfYear&&(e<Mi||e>kl)&&(e=kl),lt(n)._overflowWeeks&&e===-1&&(e=Rhe),lt(n)._overflowWeekday&&e===-1&&(e=The),lt(n).overflow=e),n}var Sde=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Cde=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ede=/Z|[+-]\d\d(?::?\d\d)?/,oE=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],JM=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Rde=/^\/?Date\((-?\d+)/i,Tde=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,bde={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function J6(n){var e,t,r=n._i,i=Sde.exec(r)||Cde.exec(r),s,o,a,l,u=oE.length,c=JM.length;if(i){for(lt(n).iso=!0,e=0,t=u;e<t;e++)if(oE[e][1].exec(i[1])){o=oE[e][0],s=oE[e][2]!==!1;break}if(o==null){n._isValid=!1;return}if(i[3]){for(e=0,t=c;e<t;e++)if(JM[e][1].exec(i[3])){a=(i[2]||" ")+JM[e][0];break}if(a==null){n._isValid=!1;return}}if(!s&&a!=null){n._isValid=!1;return}if(i[4])if(Ede.exec(i[4]))l="Z";else{n._isValid=!1;return}n._f=o+(a||"")+(l||""),BH(n)}else n._isValid=!1}function Ade(n,e,t,r,i,s){var o=[Nde(n),W6.indexOf(e),parseInt(t,10),parseInt(r,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function Nde(n){var e=parseInt(n,10);return e<=49?2e3+e:e<=999?1900+e:e}function Mde(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Ide(n,e,t){if(n){var r=X6.indexOf(n),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return lt(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function Ode(n,e,t){if(n)return bde[n];if(e)return 0;var r=parseInt(t,10),i=r%100,s=(r-i)/100;return s*60+i}function e5(n){var e=Tde.exec(Mde(n._i)),t;if(e){if(t=Ade(e[4],e[3],e[2],e[5],e[6],e[7]),!Ide(e[1],t,n))return;n._a=t,n._tzm=Ode(e[8],e[9],e[10]),n._d=hS.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),lt(n).rfc2822=!0}else n._isValid=!1}function _de(n){var e=Rde.exec(n._i);if(e!==null){n._d=new Date(+e[1]);return}if(J6(n),n._isValid===!1)delete n._isValid;else return;if(e5(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:se.createFromInputFallback(n)}se.createFromInputFallback=oa("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function gm(n,e,t){return n??e??t}function Pde(n){var e=new Date(se.now());return n._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function UH(n){var e,t,r=[],i,s,o;if(!n._d){for(i=Pde(n),n._w&&n._a[kl]==null&&n._a[Yu]==null&&xde(n),n._dayOfYear!=null&&(o=gm(n._a[Mi],i[Mi]),(n._dayOfYear>ly(o)||n._dayOfYear===0)&&(lt(n)._overflowDayOfYear=!0),t=hS(o,0,n._dayOfYear),n._a[Yu]=t.getUTCMonth(),n._a[kl]=t.getUTCDate()),e=0;e<3&&n._a[e]==null;++e)n._a[e]=r[e]=i[e];for(;e<7;e++)n._a[e]=r[e]=n._a[e]==null?e===2?1:0:n._a[e];n._a[xr]===24&&n._a[$a]===0&&n._a[Ku]===0&&n._a[Rf]===0&&(n._nextDay=!0,n._a[xr]=0),n._d=(n._useUTC?hS:Vhe).apply(null,r),s=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[xr]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==s&&(lt(n).weekdayMismatch=!0)}}function xde(n){var e,t,r,i,s,o,a,l,u;e=n._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,t=gm(e.GG,n._a[Mi],dS(mn(),1,4).year),r=gm(e.W,1),i=gm(e.E,1),(i<1||i>7)&&(l=!0)):(s=n._locale._week.dow,o=n._locale._week.doy,u=dS(mn(),s,o),t=gm(e.gg,n._a[Mi],u.year),r=gm(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),r<1||r>rc(t,s,o)?lt(n)._overflowWeeks=!0:l!=null?lt(n)._overflowWeekday=!0:(a=K6(t,r,i,s,o),n._a[Mi]=a.year,n._dayOfYear=a.dayOfYear)}se.ISO_8601=function(){};se.RFC_2822=function(){};function BH(n){if(n._f===se.ISO_8601){J6(n);return}if(n._f===se.RFC_2822){e5(n);return}n._a=[],lt(n).empty=!0;var e=""+n._i,t,r,i,s,o,a=e.length,l=0,u,c;for(i=D6(n._f,n._locale).match(OH)||[],c=i.length,t=0;t<c;t++)s=i[t],r=(e.match(She(s,n))||[])[0],r&&(o=e.substr(0,e.indexOf(r)),o.length>0&&lt(n).unusedInput.push(o),e=e.slice(e.indexOf(r)+r.length),l+=r.length),cp[s]?(r?lt(n).empty=!1:lt(n).unusedTokens.push(s),Ehe(s,r,n)):n._strict&&!r&&lt(n).unusedTokens.push(s);lt(n).charsLeftOver=a-l,e.length>0&&lt(n).unusedInput.push(e),n._a[xr]<=12&&lt(n).bigHour===!0&&n._a[xr]>0&&(lt(n).bigHour=void 0),lt(n).parsedDateParts=n._a.slice(0),lt(n).meridiem=n._meridiem,n._a[xr]=Lde(n._locale,n._a[xr],n._meridiem),u=lt(n).era,u!==null&&(n._a[Mi]=n._locale.erasConvertYear(u,n._a[Mi])),UH(n),$H(n)}function Lde(n,e,t){var r;return t==null?e:n.meridiemHour!=null?n.meridiemHour(e,t):(n.isPM!=null&&(r=n.isPM(t),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function Hde(n){var e,t,r,i,s,o,a=!1,l=n._f.length;if(l===0){lt(n).invalidFormat=!0,n._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=MH({},n),n._useUTC!=null&&(e._useUTC=n._useUTC),e._f=n._f[i],BH(e),NH(e)&&(o=!0),s+=lt(e).charsLeftOver,s+=lt(e).unusedTokens.length*10,lt(e).score=s,a?s<r&&(r=s,t=e):(r==null||s<r||o)&&(r=s,t=e,o&&(a=!0));yh(n,t||e)}function Dde(n){if(!n._d){var e=_H(n._i),t=e.day===void 0?e.date:e.day;n._a=x6([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),UH(n)}}function Fde(n){var e=new nC($H(t5(n)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function t5(n){var e=n._i,t=n._f;return n._locale=n._locale||vc(n._l),e===null||t===void 0&&e===""?VA({nullInput:!0}):(typeof e=="string"&&(n._i=e=n._locale.preparse(e)),Xa(e)?new nC($H(e)):(tC(e)?n._d=e:Ka(t)?Hde(n):t?BH(n):kde(n),NH(n)||(n._d=null),n))}function kde(n){var e=n._i;us(e)?n._d=new Date(se.now()):tC(e)?n._d=new Date(e.valueOf()):typeof e=="string"?_de(n):Ka(e)?(n._a=x6(e.slice(0),function(t){return parseInt(t,10)}),UH(n)):Hf(e)?Dde(n):cc(e)?n._d=new Date(e):se.createFromInputFallback(n)}function n5(n,e,t,r,i){var s={};return(e===!0||e===!1)&&(r=e,e=void 0),(t===!0||t===!1)&&(r=t,t=void 0),(Hf(n)&&AH(n)||Ka(n)&&n.length===0)&&(n=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=t,s._i=n,s._f=e,s._strict=r,Fde(s)}function mn(n,e,t,r){return n5(n,e,t,r,!1)}var Vde=oa("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=mn.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:VA()}),$de=oa("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=mn.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:VA()});function r5(n,e){var t,r;if(e.length===1&&Ka(e[0])&&(e=e[0]),!e.length)return mn();for(t=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][n](t))&&(t=e[r]);return t}function Ude(){var n=[].slice.call(arguments,0);return r5("isBefore",n)}function Bde(){var n=[].slice.call(arguments,0);return r5("isAfter",n)}var Wde=function(){return Date.now?Date.now():+new Date},Iv=["year","quarter","month","week","day","hour","minute","second","millisecond"];function jde(n){var e,t=!1,r,i=Iv.length;for(e in n)if(Ft(n,e)&&!(tr.call(Iv,e)!==-1&&(n[e]==null||!isNaN(n[e]))))return!1;for(r=0;r<i;++r)if(n[Iv[r]]){if(t)return!1;parseFloat(n[Iv[r]])!==Tt(n[Iv[r]])&&(t=!0)}return!0}function zde(){return this._isValid}function Gde(){return Za(NaN)}function YA(n){var e=_H(n),t=e.year||0,r=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=jde(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+r*3+t*12,this._data={},this._locale=vc(),this._bubble()}function RT(n){return n instanceof YA}function Ex(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function Yde(n,e,t){var r=Math.min(n.length,e.length),i=Math.abs(n.length-e.length),s=0,o;for(o=0;o<r;o++)Tt(n[o])!==Tt(e[o])&&s++;return s+i}function i5(n,e){We(n,0,0,function(){var t=this.utcOffset(),r="+";return t<0&&(t=-t,r="-"),r+Zl(~~(t/60),2)+e+Zl(~~t%60,2)})}i5("Z",":");i5("ZZ","");Ie("Z",jA);Ie("ZZ",jA);nn(["Z","ZZ"],function(n,e,t){t._useUTC=!0,t._tzm=WH(jA,n)});var Kde=/([\+\-]|\d\d)/gi;function WH(n,e){var t=(e||"").match(n),r,i,s;return t===null?null:(r=t[t.length-1]||[],i=(r+"").match(Kde)||["-",0,0],s=+(i[1]*60)+Tt(i[2]),s===0?0:i[0]==="+"?s:-s)}function jH(n,e){var t,r;return e._isUTC?(t=e.clone(),r=(Xa(n)||tC(n)?n.valueOf():mn(n).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+r),se.updateOffset(t,!1),t):mn(n).local()}function Rx(n){return-Math.round(n._d.getTimezoneOffset())}se.updateOffset=function(){};function Xde(n,e,t){var r=this._offset||0,i;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=WH(jA,n),n===null)return this}else Math.abs(n)<16&&!t&&(n=n*60);return!this._isUTC&&e&&(i=Rx(this)),this._offset=n,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==n&&(!e||this._changeInProgress?a5(this,Za(n-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,se.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:Rx(this)}function qde(n,e){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,e),this):-this.utcOffset()}function Qde(n){return this.utcOffset(0,n)}function Zde(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(Rx(this),"m")),this}function Jde(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=WH(whe,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function efe(n){return this.isValid()?(n=n?mn(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function tfe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function nfe(){if(!us(this._isDSTShifted))return this._isDSTShifted;var n={},e;return MH(n,this),n=t5(n),n._a?(e=n._isUTC?su(n._a):mn(n._a),this._isDSTShifted=this.isValid()&&Yde(n._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function rfe(){return this.isValid()?!this._isUTC:!1}function ife(){return this.isValid()?this._isUTC:!1}function s5(){return this.isValid()?this._isUTC&&this._offset===0:!1}var sfe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,ofe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Za(n,e){var t=n,r=null,i,s,o;return RT(n)?t={ms:n._milliseconds,d:n._days,M:n._months}:cc(n)||!isNaN(+n)?(t={},e?t[e]=+n:t.milliseconds=+n):(r=sfe.exec(n))?(i=r[1]==="-"?-1:1,t={y:0,d:Tt(r[kl])*i,h:Tt(r[xr])*i,m:Tt(r[$a])*i,s:Tt(r[Ku])*i,ms:Tt(Ex(r[Rf]*1e3))*i}):(r=ofe.exec(n))?(i=r[1]==="-"?-1:1,t={y:gd(r[2],i),M:gd(r[3],i),w:gd(r[4],i),d:gd(r[5],i),h:gd(r[6],i),m:gd(r[7],i),s:gd(r[8],i)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(o=afe(mn(t.from),mn(t.to)),t={},t.ms=o.milliseconds,t.M=o.months),s=new YA(t),RT(n)&&Ft(n,"_locale")&&(s._locale=n._locale),RT(n)&&Ft(n,"_isValid")&&(s._isValid=n._isValid),s}Za.fn=YA.prototype;Za.invalid=Gde;function gd(n,e){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*e}function KB(n,e){var t={};return t.months=e.month()-n.month()+(e.year()-n.year())*12,n.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+n.clone().add(t.months,"M"),t}function afe(n,e){var t;return n.isValid()&&e.isValid()?(e=jH(e,n),n.isBefore(e)?t=KB(n,e):(t=KB(e,n),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function o5(n,e){return function(t,r){var i,s;return r!==null&&!isNaN(+r)&&(H6(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=t,t=r,r=s),i=Za(t,r),a5(this,i,n),this}}function a5(n,e,t,r){var i=e._milliseconds,s=Ex(e._days),o=Ex(e._months);n.isValid()&&(r=r??!0,o&&z6(n,cS(n,"Month")+o*t),s&&B6(n,"Date",cS(n,"Date")+s*t),i&&n._d.setTime(n._d.valueOf()+i*t),r&&se.updateOffset(n,s||o))}var lfe=o5(1,"add"),ufe=o5(-1,"subtract");function l5(n){return typeof n=="string"||n instanceof String}function cfe(n){return Xa(n)||tC(n)||l5(n)||cc(n)||dfe(n)||hfe(n)||n===null||n===void 0}function hfe(n){var e=Hf(n)&&!AH(n),t=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=r.length;for(i=0;i<o;i+=1)s=r[i],t=t||Ft(n,s);return e&&t}function dfe(n){var e=Ka(n),t=!1;return e&&(t=n.filter(function(r){return!cc(r)&&l5(n)}).length===0),e&&t}function ffe(n){var e=Hf(n)&&!AH(n),t=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<r.length;i+=1)s=r[i],t=t||Ft(n,s);return e&&t}function gfe(n,e){var t=n.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function mfe(n,e){arguments.length===1&&(arguments[0]?cfe(arguments[0])?(n=arguments[0],e=void 0):ffe(arguments[0])&&(e=arguments[0],n=void 0):(n=void 0,e=void 0));var t=n||mn(),r=jH(t,this).startOf("day"),i=se.calendarFormat(this,r)||"sameElse",s=e&&(ou(e[i])?e[i].call(this,t):e[i]);return this.format(s||this.localeData().calendar(i,this,mn(t)))}function pfe(){return new nC(this)}function vfe(n,e){var t=Xa(n)?n:mn(n);return this.isValid()&&t.isValid()?(e=aa(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function wfe(n,e){var t=Xa(n)?n:mn(n);return this.isValid()&&t.isValid()?(e=aa(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function yfe(n,e,t,r){var i=Xa(n)?n:mn(n),s=Xa(e)?e:mn(e);return this.isValid()&&i.isValid()&&s.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,t):!this.isBefore(i,t))&&(r[1]===")"?this.isBefore(s,t):!this.isAfter(s,t))):!1}function Sfe(n,e){var t=Xa(n)?n:mn(n),r;return this.isValid()&&t.isValid()?(e=aa(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(r=t.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function Cfe(n,e){return this.isSame(n,e)||this.isAfter(n,e)}function Efe(n,e){return this.isSame(n,e)||this.isBefore(n,e)}function Rfe(n,e,t){var r,i,s;if(!this.isValid())return NaN;if(r=jH(n,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=aa(e),e){case"year":s=TT(this,r)/12;break;case"month":s=TT(this,r);break;case"quarter":s=TT(this,r)/3;break;case"second":s=(this-r)/1e3;break;case"minute":s=(this-r)/6e4;break;case"hour":s=(this-r)/36e5;break;case"day":s=(this-r-i)/864e5;break;case"week":s=(this-r-i)/6048e5;break;default:s=this-r}return t?s:Uo(s)}function TT(n,e){if(n.date()<e.date())return-TT(e,n);var t=(e.year()-n.year())*12+(e.month()-n.month()),r=n.clone().add(t,"months"),i,s;return e-r<0?(i=n.clone().add(t-1,"months"),s=(e-r)/(r-i)):(i=n.clone().add(t+1,"months"),s=(e-r)/(i-r)),-(t+s)||0}se.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";se.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Tfe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function bfe(n){if(!this.isValid())return null;var e=n!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?ET(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ou(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",ET(t,"Z")):ET(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Afe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",e="",t,r,i,s;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+n+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(t+r+i+s)}function Nfe(n){n||(n=this.isUtc()?se.defaultFormatUtc:se.defaultFormat);var e=ET(this,n);return this.localeData().postformat(e)}function Mfe(n,e){return this.isValid()&&(Xa(n)&&n.isValid()||mn(n).isValid())?Za({to:this,from:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Ife(n){return this.from(mn(),n)}function Ofe(n,e){return this.isValid()&&(Xa(n)&&n.isValid()||mn(n).isValid())?Za({from:this,to:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function _fe(n){return this.to(mn(),n)}function u5(n){var e;return n===void 0?this._locale._abbr:(e=vc(n),e!=null&&(this._locale=e),this)}var c5=oa("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function h5(){return this._locale}var $b=1e3,hp=60*$b,Ub=60*hp,d5=(365*400+97)*24*Ub;function dp(n,e){return(n%e+e)%e}function f5(n,e,t){return n<100&&n>=0?new Date(n+400,e,t)-d5:new Date(n,e,t).valueOf()}function g5(n,e,t){return n<100&&n>=0?Date.UTC(n+400,e,t)-d5:Date.UTC(n,e,t)}function Pfe(n){var e,t;if(n=aa(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?g5:f5,n){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=dp(e+(this._isUTC?0:this.utcOffset()*hp),Ub);break;case"minute":e=this._d.valueOf(),e-=dp(e,hp);break;case"second":e=this._d.valueOf(),e-=dp(e,$b);break}return this._d.setTime(e),se.updateOffset(this,!0),this}function xfe(n){var e,t;if(n=aa(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?g5:f5,n){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Ub-dp(e+(this._isUTC?0:this.utcOffset()*hp),Ub)-1;break;case"minute":e=this._d.valueOf(),e+=hp-dp(e,hp)-1;break;case"second":e=this._d.valueOf(),e+=$b-dp(e,$b)-1;break}return this._d.setTime(e),se.updateOffset(this,!0),this}function Lfe(){return this._d.valueOf()-(this._offset||0)*6e4}function Hfe(){return Math.floor(this.valueOf()/1e3)}function Dfe(){return new Date(this.valueOf())}function Ffe(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function kfe(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function Vfe(){return this.isValid()?this.toISOString():null}function $fe(){return NH(this)}function Ufe(){return yh({},lt(this))}function Bfe(){return lt(this).overflow}function Wfe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}We("N",0,0,"eraAbbr");We("NN",0,0,"eraAbbr");We("NNN",0,0,"eraAbbr");We("NNNN",0,0,"eraName");We("NNNNN",0,0,"eraNarrow");We("y",["y",1],"yo","eraYear");We("y",["yy",2],0,"eraYear");We("y",["yyy",3],0,"eraYear");We("y",["yyyy",4],0,"eraYear");Ie("N",zH);Ie("NN",zH);Ie("NNN",zH);Ie("NNNN",ege);Ie("NNNNN",tge);nn(["N","NN","NNN","NNNN","NNNNN"],function(n,e,t,r){var i=t._locale.erasParse(n,r,t._strict);i?lt(t).era=i:lt(t).invalidEra=n});Ie("y",sv);Ie("yy",sv);Ie("yyy",sv);Ie("yyyy",sv);Ie("yo",nge);nn(["y","yy","yyy","yyyy"],Mi);nn(["yo"],function(n,e,t,r){var i;t._locale._eraYearOrdinalRegex&&(i=n.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[Mi]=t._locale.eraYearOrdinalParse(n,i):e[Mi]=parseInt(n,10)});function jfe(n,e){var t,r,i,s=this._eras||vc("en")._eras;for(t=0,r=s.length;t<r;++t){switch(typeof s[t].since){case"string":i=se(s[t].since).startOf("day"),s[t].since=i.valueOf();break}switch(typeof s[t].until){case"undefined":s[t].until=1/0;break;case"string":i=se(s[t].until).startOf("day").valueOf(),s[t].until=i.valueOf();break}}return s}function zfe(n,e,t){var r,i,s=this.eras(),o,a,l;for(n=n.toUpperCase(),r=0,i=s.length;r<i;++r)if(o=s[r].name.toUpperCase(),a=s[r].abbr.toUpperCase(),l=s[r].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(a===n)return s[r];break;case"NNNN":if(o===n)return s[r];break;case"NNNNN":if(l===n)return s[r];break}else if([o,a,l].indexOf(n)>=0)return s[r]}function Gfe(n,e){var t=n.since<=n.until?1:-1;return e===void 0?se(n.since).year():se(n.since).year()+(e-n.offset)*t}function Yfe(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].name;return""}function Kfe(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].narrow;return""}function Xfe(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].abbr;return""}function qfe(){var n,e,t,r,i=this.localeData().eras();for(n=0,e=i.length;n<e;++n)if(t=i[n].since<=i[n].until?1:-1,r=this.clone().startOf("day").valueOf(),i[n].since<=r&&r<=i[n].until||i[n].until<=r&&r<=i[n].since)return(this.year()-se(i[n].since).year())*t+i[n].offset;return this.year()}function Qfe(n){return Ft(this,"_erasNameRegex")||GH.call(this),n?this._erasNameRegex:this._erasRegex}function Zfe(n){return Ft(this,"_erasAbbrRegex")||GH.call(this),n?this._erasAbbrRegex:this._erasRegex}function Jfe(n){return Ft(this,"_erasNarrowRegex")||GH.call(this),n?this._erasNarrowRegex:this._erasRegex}function zH(n,e){return e.erasAbbrRegex(n)}function ege(n,e){return e.erasNameRegex(n)}function tge(n,e){return e.erasNarrowRegex(n)}function nge(n,e){return e._eraYearOrdinalRegex||sv}function GH(){var n=[],e=[],t=[],r=[],i,s,o,a,l,u=this.eras();for(i=0,s=u.length;i<s;++i)o=nc(u[i].name),a=nc(u[i].abbr),l=nc(u[i].narrow),e.push(o),n.push(a),t.push(l),r.push(o),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}We(0,["gg",2],0,function(){return this.weekYear()%100});We(0,["GG",2],0,function(){return this.isoWeekYear()%100});function KA(n,e){We(0,[n,n.length],0,e)}KA("gggg","weekYear");KA("ggggg","weekYear");KA("GGGG","isoWeekYear");KA("GGGGG","isoWeekYear");Ie("G",WA);Ie("g",WA);Ie("GG",pn,yo);Ie("gg",pn,yo);Ie("GGGG",xH,PH);Ie("gggg",xH,PH);Ie("GGGGG",BA,$A);Ie("ggggg",BA,$A);iC(["gggg","ggggg","GGGG","GGGGG"],function(n,e,t,r){e[r.substr(0,2)]=Tt(n)});iC(["gg","GG"],function(n,e,t,r){e[r]=se.parseTwoDigitYear(n)});function rge(n){return m5.call(this,n,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function ige(n){return m5.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function sge(){return rc(this.year(),1,4)}function oge(){return rc(this.isoWeekYear(),1,4)}function age(){var n=this.localeData()._week;return rc(this.year(),n.dow,n.doy)}function lge(){var n=this.localeData()._week;return rc(this.weekYear(),n.dow,n.doy)}function m5(n,e,t,r,i){var s;return n==null?dS(this,r,i).year:(s=rc(n,r,i),e>s&&(e=s),uge.call(this,n,e,t,r,i))}function uge(n,e,t,r,i){var s=K6(n,e,t,r,i),o=hS(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}We("Q",0,"Qo","quarter");Ie("Q",F6);nn("Q",function(n,e){e[Yu]=(Tt(n)-1)*3});function cge(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}We("D",["DD",2],"Do","date");Ie("D",pn,ov);Ie("DD",pn,yo);Ie("Do",function(n,e){return n?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});nn(["D","DD"],kl);nn("Do",function(n,e){e[kl]=Tt(n.match(pn)[0])});var p5=av("Date",!0);We("DDD",["DDDD",3],"DDDo","dayOfYear");Ie("DDD",UA);Ie("DDDD",k6);nn(["DDD","DDDD"],function(n,e,t){t._dayOfYear=Tt(n)});function hge(n){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?e:this.add(n-e,"d")}We("m",["mm",2],0,"minute");Ie("m",pn,LH);Ie("mm",pn,yo);nn(["m","mm"],$a);var dge=av("Minutes",!1);We("s",["ss",2],0,"second");Ie("s",pn,LH);Ie("ss",pn,yo);nn(["s","ss"],Ku);var fge=av("Seconds",!1);We("S",0,0,function(){return~~(this.millisecond()/100)});We(0,["SS",2],0,function(){return~~(this.millisecond()/10)});We(0,["SSS",3],0,"millisecond");We(0,["SSSS",4],0,function(){return this.millisecond()*10});We(0,["SSSSS",5],0,function(){return this.millisecond()*100});We(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});We(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});We(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});We(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Ie("S",UA,F6);Ie("SS",UA,yo);Ie("SSS",UA,k6);var Sh,v5;for(Sh="SSSS";Sh.length<=9;Sh+="S")Ie(Sh,sv);function gge(n,e){e[Rf]=Tt(("0."+n)*1e3)}for(Sh="S";Sh.length<=9;Sh+="S")nn(Sh,gge);v5=av("Milliseconds",!1);We("z",0,0,"zoneAbbr");We("zz",0,0,"zoneName");function mge(){return this._isUTC?"UTC":""}function pge(){return this._isUTC?"Coordinated Universal Time":""}var ce=nC.prototype;ce.add=lfe;ce.calendar=mfe;ce.clone=pfe;ce.diff=Rfe;ce.endOf=xfe;ce.format=Nfe;ce.from=Mfe;ce.fromNow=Ife;ce.to=Ofe;ce.toNow=_fe;ce.get=Ahe;ce.invalidAt=Bfe;ce.isAfter=vfe;ce.isBefore=wfe;ce.isBetween=yfe;ce.isSame=Sfe;ce.isSameOrAfter=Cfe;ce.isSameOrBefore=Efe;ce.isValid=$fe;ce.lang=c5;ce.locale=u5;ce.localeData=h5;ce.max=$de;ce.min=Vde;ce.parsingFlags=Ufe;ce.set=Nhe;ce.startOf=Pfe;ce.subtract=ufe;ce.toArray=Ffe;ce.toObject=kfe;ce.toDate=Dfe;ce.toISOString=bfe;ce.inspect=Afe;typeof Symbol<"u"&&Symbol.for!=null&&(ce[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ce.toJSON=Vfe;ce.toString=Tfe;ce.unix=Hfe;ce.valueOf=Lfe;ce.creationData=Wfe;ce.eraName=Yfe;ce.eraNarrow=Kfe;ce.eraAbbr=Xfe;ce.eraYear=qfe;ce.year=U6;ce.isLeapYear=bhe;ce.weekYear=rge;ce.isoWeekYear=ige;ce.quarter=ce.quarters=cge;ce.month=G6;ce.daysInMonth=Dhe;ce.week=ce.weeks=jhe;ce.isoWeek=ce.isoWeeks=zhe;ce.weeksInYear=age;ce.weeksInWeekYear=lge;ce.isoWeeksInYear=sge;ce.isoWeeksInISOWeekYear=oge;ce.date=p5;ce.day=ce.days=ide;ce.weekday=sde;ce.isoWeekday=ode;ce.dayOfYear=hge;ce.hour=ce.hours=fde;ce.minute=ce.minutes=dge;ce.second=ce.seconds=fge;ce.millisecond=ce.milliseconds=v5;ce.utcOffset=Xde;ce.utc=Qde;ce.local=Zde;ce.parseZone=Jde;ce.hasAlignedHourOffset=efe;ce.isDST=tfe;ce.isLocal=rfe;ce.isUtcOffset=ife;ce.isUtc=s5;ce.isUTC=s5;ce.zoneAbbr=mge;ce.zoneName=pge;ce.dates=oa("dates accessor is deprecated. Use date instead.",p5);ce.months=oa("months accessor is deprecated. Use month instead",G6);ce.years=oa("years accessor is deprecated. Use year instead",U6);ce.zone=oa("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",qde);ce.isDSTShifted=oa("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",nfe);function vge(n){return mn(n*1e3)}function wge(){return mn.apply(null,arguments).parseZone()}function w5(n){return n}var kt=IH.prototype;kt.calendar=rhe;kt.longDateFormat=ahe;kt.invalidDate=uhe;kt.ordinal=dhe;kt.preparse=w5;kt.postformat=w5;kt.relativeTime=ghe;kt.pastFuture=mhe;kt.set=the;kt.eras=jfe;kt.erasParse=zfe;kt.erasConvertYear=Gfe;kt.erasAbbrRegex=Zfe;kt.erasNameRegex=Qfe;kt.erasNarrowRegex=Jfe;kt.months=Phe;kt.monthsShort=xhe;kt.monthsParse=Hhe;kt.monthsRegex=khe;kt.monthsShortRegex=Fhe;kt.week=$he;kt.firstDayOfYear=Whe;kt.firstDayOfWeek=Bhe;kt.weekdays=Jhe;kt.weekdaysMin=tde;kt.weekdaysShort=ede;kt.weekdaysParse=rde;kt.weekdaysRegex=ade;kt.weekdaysShortRegex=lde;kt.weekdaysMinRegex=ude;kt.isPM=hde;kt.meridiem=gde;function Bb(n,e,t,r){var i=vc(),s=su().set(r,e);return i[t](s,n)}function y5(n,e,t){if(cc(n)&&(e=n,n=void 0),n=n||"",e!=null)return Bb(n,e,t,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Bb(n,r,t,"month");return i}function YH(n,e,t,r){typeof n=="boolean"?(cc(e)&&(t=e,e=void 0),e=e||""):(e=n,t=e,n=!1,cc(e)&&(t=e,e=void 0),e=e||"");var i=vc(),s=n?i._week.dow:0,o,a=[];if(t!=null)return Bb(e,(t+s)%7,r,"day");for(o=0;o<7;o++)a[o]=Bb(e,(o+s)%7,r,"day");return a}function yge(n,e){return y5(n,e,"months")}function Sge(n,e){return y5(n,e,"monthsShort")}function Cge(n,e,t){return YH(n,e,t,"weekdays")}function Ege(n,e,t){return YH(n,e,t,"weekdaysShort")}function Rge(n,e,t){return YH(n,e,t,"weekdaysMin")}Dh("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var e=n%10,t=Tt(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return n+t}});se.lang=oa("moment.lang is deprecated. Use moment.locale instead.",Dh);se.langData=oa("moment.langData is deprecated. Use moment.localeData instead.",vc);var mu=Math.abs;function Tge(){var n=this._data;return this._milliseconds=mu(this._milliseconds),this._days=mu(this._days),this._months=mu(this._months),n.milliseconds=mu(n.milliseconds),n.seconds=mu(n.seconds),n.minutes=mu(n.minutes),n.hours=mu(n.hours),n.months=mu(n.months),n.years=mu(n.years),this}function S5(n,e,t,r){var i=Za(e,t);return n._milliseconds+=r*i._milliseconds,n._days+=r*i._days,n._months+=r*i._months,n._bubble()}function bge(n,e){return S5(this,n,e,1)}function Age(n,e){return S5(this,n,e,-1)}function XB(n){return n<0?Math.floor(n):Math.ceil(n)}function Nge(){var n=this._milliseconds,e=this._days,t=this._months,r=this._data,i,s,o,a,l;return n>=0&&e>=0&&t>=0||n<=0&&e<=0&&t<=0||(n+=XB(Tx(t)+e)*864e5,e=0,t=0),r.milliseconds=n%1e3,i=Uo(n/1e3),r.seconds=i%60,s=Uo(i/60),r.minutes=s%60,o=Uo(s/60),r.hours=o%24,e+=Uo(o/24),l=Uo(C5(e)),t+=l,e-=XB(Tx(l)),a=Uo(t/12),t%=12,r.days=e,r.months=t,r.years=a,this}function C5(n){return n*4800/146097}function Tx(n){return n*146097/4800}function Mge(n){if(!this.isValid())return NaN;var e,t,r=this._milliseconds;if(n=aa(n),n==="month"||n==="quarter"||n==="year")switch(e=this._days+r/864e5,t=this._months+C5(e),n){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(Tx(this._months)),n){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+n)}}function wc(n){return function(){return this.as(n)}}var E5=wc("ms"),Ige=wc("s"),Oge=wc("m"),_ge=wc("h"),Pge=wc("d"),xge=wc("w"),Lge=wc("M"),Hge=wc("Q"),Dge=wc("y"),Fge=E5;function kge(){return Za(this)}function Vge(n){return n=aa(n),this.isValid()?this[n+"s"]():NaN}function lg(n){return function(){return this.isValid()?this._data[n]:NaN}}var $ge=lg("milliseconds"),Uge=lg("seconds"),Bge=lg("minutes"),Wge=lg("hours"),jge=lg("days"),zge=lg("months"),Gge=lg("years");function Yge(){return Uo(this.days()/7)}var Hu=Math.round,Wm={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Kge(n,e,t,r,i){return i.relativeTime(e||1,!!t,n,r)}function Xge(n,e,t,r){var i=Za(n).abs(),s=Hu(i.as("s")),o=Hu(i.as("m")),a=Hu(i.as("h")),l=Hu(i.as("d")),u=Hu(i.as("M")),c=Hu(i.as("w")),h=Hu(i.as("y")),d=s<=t.ss&&["s",s]||s<t.s&&["ss",s]||o<=1&&["m"]||o<t.m&&["mm",o]||a<=1&&["h"]||a<t.h&&["hh",a]||l<=1&&["d"]||l<t.d&&["dd",l];return t.w!=null&&(d=d||c<=1&&["w"]||c<t.w&&["ww",c]),d=d||u<=1&&["M"]||u<t.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+n>0,d[4]=r,Kge.apply(null,d)}function qge(n){return n===void 0?Hu:typeof n=="function"?(Hu=n,!0):!1}function Qge(n,e){return Wm[n]===void 0?!1:e===void 0?Wm[n]:(Wm[n]=e,n==="s"&&(Wm.ss=e-1),!0)}function Zge(n,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,r=Wm,i,s;return typeof n=="object"&&(e=n,n=!1),typeof n=="boolean"&&(t=n),typeof e=="object"&&(r=Object.assign({},Wm,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),s=Xge(this,!t,r,i),t&&(s=i.pastFuture(+this,s)),i.postformat(s)}var eI=Math.abs;function Eg(n){return(n>0)-(n<0)||+n}function XA(){if(!this.isValid())return this.localeData().invalidDate();var n=eI(this._milliseconds)/1e3,e=eI(this._days),t=eI(this._months),r,i,s,o,a=this.asSeconds(),l,u,c,h;return a?(r=Uo(n/60),i=Uo(r/60),n%=60,r%=60,s=Uo(t/12),t%=12,o=n?n.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Eg(this._months)!==Eg(a)?"-":"",c=Eg(this._days)!==Eg(a)?"-":"",h=Eg(this._milliseconds)!==Eg(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(t?u+t+"M":"")+(e?c+e+"D":"")+(i||r||n?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(n?h+o+"S":"")):"P0D"}var Ot=YA.prototype;Ot.isValid=zde;Ot.abs=Tge;Ot.add=bge;Ot.subtract=Age;Ot.as=Mge;Ot.asMilliseconds=E5;Ot.asSeconds=Ige;Ot.asMinutes=Oge;Ot.asHours=_ge;Ot.asDays=Pge;Ot.asWeeks=xge;Ot.asMonths=Lge;Ot.asQuarters=Hge;Ot.asYears=Dge;Ot.valueOf=Fge;Ot._bubble=Nge;Ot.clone=kge;Ot.get=Vge;Ot.milliseconds=$ge;Ot.seconds=Uge;Ot.minutes=Bge;Ot.hours=Wge;Ot.days=jge;Ot.weeks=Yge;Ot.months=zge;Ot.years=Gge;Ot.humanize=Zge;Ot.toISOString=XA;Ot.toString=XA;Ot.toJSON=XA;Ot.locale=u5;Ot.localeData=h5;Ot.toIsoString=oa("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",XA);Ot.lang=c5;We("X",0,0,"unix");We("x",0,0,"valueOf");Ie("x",WA);Ie("X",yhe);nn("X",function(n,e,t){t._d=new Date(parseFloat(n)*1e3)});nn("x",function(n,e,t){t._d=new Date(Tt(n))});//! moment.js
se.version="2.30.1";Jce(mn);se.fn=ce;se.min=Ude;se.max=Bde;se.now=Wde;se.utc=su;se.unix=vge;se.months=yge;se.isDate=tC;se.locale=Dh;se.invalid=VA;se.duration=Za;se.isMoment=Xa;se.weekdays=Cge;se.parseZone=wge;se.localeData=vc;se.isDuration=RT;se.monthsShort=Sge;se.weekdaysMin=Rge;se.defineLocale=VH;se.updateLocale=wde;se.locales=yde;se.weekdaysShort=Ege;se.normalizeUnits=aa;se.relativeTimeRounding=qge;se.relativeTimeThreshold=Qge;se.calendarFormat=gfe;se.prototype=ce;se.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var Jge=an,eme=yr,tme=iv,nme=Ps,rme=Cr,ime=iu,sme=xs,ome=id,tI=ome("forEach",TypeError);Jge({target:"Iterator",proto:!0,real:!0,forced:tI},{forEach:function(e){rme(this);try{nme(e)}catch(i){sme(this,"throw",i)}if(tI)return eme(tI,this,e);var t=ime(this),r=0;tme(t,function(i){e(i,r++)},{IS_RECORD:!0})}});var nI=cr,aE=Set.prototype,au={Set,add:nI(aE.add),has:nI(aE.has),remove:nI(aE.delete),proto:aE},ame=au.has,ug=function(n){return ame(n),n},lme=yr,cg=function(n,e,t){for(var r=t?n:n.iterator,i=n.next,s,o;!(s=lme(i,r)).done;)if(o=e(s.value),o!==void 0)return o},R5=cr,ume=cg,T5=au,cme=T5.Set,b5=T5.proto,hme=R5(b5.forEach),A5=R5(b5.keys),dme=A5(new cme).next,sC=function(n,e,t){return t?ume({iterator:A5(n),next:dme},e):hme(n,e)},N5=au,fme=sC,gme=N5.Set,mme=N5.add,KH=function(n){var e=new gme;return fme(n,function(t){mme(e,t)}),e},pme=Y4,vme=au,oC=pme(vme.proto,"size","get")||function(n){return n.size},qB=Ps,M5=Cr,QB=yr,wme=ZS,yme=iu,ZB="Invalid size",Sme=RangeError,Cme=TypeError,Eme=Math.max,I5=function(n,e){this.set=n,this.size=Eme(e,0),this.has=qB(n.has),this.keys=qB(n.keys)};I5.prototype={getIterator:function(){return yme(M5(QB(this.keys,this.set)))},includes:function(n){return QB(this.has,this.set,n)}};var hg=function(n){M5(n);var e=+n.size;if(e!==e)throw new Cme(ZB);var t=wme(e);if(t<0)throw new Sme(ZB);return new I5(n,t)},Rme=ug,O5=au,Tme=KH,bme=oC,Ame=hg,Nme=sC,Mme=cg,Ime=O5.has,JB=O5.remove,Ome=function(e){var t=Rme(this),r=Ame(e),i=Tme(t);return bme(t)<=r.size?Nme(t,function(s){r.includes(s)&&JB(i,s)}):Mme(r.getIterator(),function(s){Ime(i,s)&&JB(i,s)}),i},_me=ev,eW=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},tW=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}},dg=function(n,e){var t=_me("Set");try{new t()[n](eW(0));try{return new t()[n](eW(-1)),!1}catch{if(!e)return!0;try{return new t()[n](tW(-1/0)),!1}catch{var r=new t;return r.add(1),r.add(2),e(r[n](tW(1/0)))}}}catch{return!1}},Pme=an,xme=Ome,Lme=wr,Hme=dg,Dme=!Hme("difference",function(n){return n.size===0}),Fme=Dme||Lme(function(){var n={size:1,has:function(){return!0},keys:function(){var t=0;return{next:function(){var r=t++>1;return e.has(1)&&e.clear(),{done:r,value:2}}}}},e=new Set([1,2,3,4]);return e.difference(n).size!==3});Pme({target:"Set",proto:!0,real:!0,forced:Fme},{difference:xme});var kme=ug,XH=au,Vme=oC,$me=hg,Ume=sC,Bme=cg,Wme=XH.Set,nW=XH.add,jme=XH.has,zme=function(e){var t=kme(this),r=$me(e),i=new Wme;return Vme(t)>r.size?Bme(r.getIterator(),function(s){jme(t,s)&&nW(i,s)}):Ume(t,function(s){r.includes(s)&&nW(i,s)}),i},Gme=an,Yme=wr,Kme=zme,Xme=dg,qme=!Xme("intersection",function(n){return n.size===2&&n.has(1)&&n.has(2)})||Yme(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});Gme({target:"Set",proto:!0,real:!0,forced:qme},{intersection:Kme});var Qme=ug,Zme=au.has,Jme=oC,epe=hg,tpe=sC,npe=cg,rpe=xs,ipe=function(e){var t=Qme(this),r=epe(e);if(Jme(t)<=r.size)return tpe(t,function(s){if(r.includes(s))return!1},!0)!==!1;var i=r.getIterator();return npe(i,function(s){if(Zme(t,s))return rpe(i,"normal",!1)})!==!1},spe=an,ope=ipe,ape=dg,lpe=!ape("isDisjointFrom",function(n){return!n});spe({target:"Set",proto:!0,real:!0,forced:lpe},{isDisjointFrom:ope});var upe=ug,cpe=oC,hpe=sC,dpe=hg,fpe=function(e){var t=upe(this),r=dpe(e);return cpe(t)>r.size?!1:hpe(t,function(i){if(!r.includes(i))return!1},!0)!==!1},gpe=an,mpe=fpe,ppe=dg,vpe=!ppe("isSubsetOf",function(n){return n});gpe({target:"Set",proto:!0,real:!0,forced:vpe},{isSubsetOf:mpe});var wpe=ug,ype=au.has,Spe=oC,Cpe=hg,Epe=cg,Rpe=xs,Tpe=function(e){var t=wpe(this),r=Cpe(e);if(Spe(t)<r.size)return!1;var i=r.getIterator();return Epe(i,function(s){if(!ype(t,s))return Rpe(i,"normal",!1)})!==!1},bpe=an,Ape=Tpe,Npe=dg,Mpe=!Npe("isSupersetOf",function(n){return!n});bpe({target:"Set",proto:!0,real:!0,forced:Mpe},{isSupersetOf:Ape});var Ipe=ug,qH=au,Ope=KH,_pe=hg,Ppe=cg,xpe=qH.add,Lpe=qH.has,Hpe=qH.remove,Dpe=function(e){var t=Ipe(this),r=_pe(e).getIterator(),i=Ope(t);return Ppe(r,function(s){Lpe(t,s)?Hpe(i,s):xpe(i,s)}),i},_5=function(n){try{var e=new Set,t={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[n](t);return r.size===1&&r.values().next().value===4}catch{return!1}},Fpe=an,kpe=Dpe,Vpe=_5,$pe=dg,Upe=!$pe("symmetricDifference")||!Vpe("symmetricDifference");Fpe({target:"Set",proto:!0,real:!0,forced:Upe},{symmetricDifference:kpe});var Bpe=ug,Wpe=au.add,jpe=KH,zpe=hg,Gpe=cg,Ype=function(e){var t=Bpe(this),r=zpe(e).getIterator(),i=jpe(t);return Gpe(r,function(s){Wpe(i,s)}),i},Kpe=an,Xpe=Ype,qpe=_5,Qpe=dg,Zpe=!Qpe("union")||!qpe("union");Kpe({target:"Set",proto:!0,real:!0,forced:Zpe},{union:Xpe});function P5(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}function bx(n,e){const t=e.length;let r=0;for(;r<t;)n.push(e[r]),r+=1}function uy(n){const e=[];if(!n||n.length===0||!n[0]||n[0].length===0)return e;const t=n.length,r=n[0].length;for(let i=0;i<t;i++)for(let s=0;s<r;s++)e[s]||(e[s]=[]),e[s][i]=n[i][s];return e}function Er(n,e,t,r){let i=-1,s=n,o=t;Array.isArray(n)||(s=Array.from(n));const a=s.length;for(r&&a&&(i+=1,o=s[i]),i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function Yh(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length,s=[];let o=-1;for(;t<i;){const a=r[t];e(a,t,r)&&(o+=1,s[o]=a),t+=1}return s}function At(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length,s=[];let o=-1;for(;t<i;){const a=r[t];o+=1,s[o]=e(a,t,r),t+=1}return s}function k(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length;for(;t<i&&e(r[t],t,r)!==!1;)t+=1;return n}function x5(n){return Er(n,(e,t)=>e+t,0)}function Jpe(n){return Er(n,(e,t)=>e>t?e:t,Array.isArray(n)?n[0]:void 0)}function eve(n){return Er(n,(e,t)=>e<t?e:t,Array.isArray(n)?n[0]:void 0)}function tve(n){return n.length?x5(n)/n.length:0}function L5(n){return Er(n,(e,t)=>e.concat(Array.isArray(t)?L5(t):t),[])}function H5(n){const e=[];return k(n,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function Ax(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=[...e];let s=r;return k(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function nve(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=[...e];let s=r;return k(i,o=>{s=s.filter(a=>o.includes(a))}),s}function rve(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=[...e],s=new Set(r);return k(i,o=>{k(o,a=>{s.has(a)||s.add(a)})}),Array.from(s)}function Nx(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return n.split(e)}const ive=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:tve,arrayEach:k,arrayFilter:Yh,arrayFlatten:L5,arrayMap:At,arrayMax:Jpe,arrayMin:eve,arrayReduce:Er,arraySum:x5,arrayUnique:H5,extendArray:bx,getDifferenceOfArrays:Ax,getIntersectionOfArrays:nve,getUnionOfArrays:rve,pivot:uy,stringToArray:Nx,to2dArray:P5},Symbol.toStringTag,{value:"Module"}));function Lt(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return Er(n,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=t[a]?t[a]:"";return s+l+u},"").trim()}function D5(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];const i=document.createElement("template");i.innerHTML=n.reduce((a,l,u)=>{var c;return a+l+((c=t[u])!==null&&c!==void 0?c:"")},"");const s=i.content.cloneNode(!0),o={};return s.querySelectorAll("[data-ref]").forEach(a=>{const l=a.getAttribute("data-ref");a.removeAttribute("data-ref"),o[l]=a}),{fragment:s,refs:o}}function on(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=n===null?"":n.toString();break;case"undefined":e="";break;default:e=n.toString();break}return e}function Re(n){return typeof n<"u"}function fn(n){return typeof n>"u"}function Dn(n){return n===null||n===""||fn(n)}function F5(n){return Object.prototype.toString.call(n)==="[object RegExp]"}const kw="length",cy=n=>parseInt(n,16),rW=n=>parseInt(n,10),Wb=(n,e,t)=>n.substr(e,t),hy=n=>n.codePointAt(0)-65,Mx=n=>`${n}`.replace(/\-/g,""),sve=n=>cy(Wb(Mx(n),cy("12"),hy("F")))/(cy(Wb(Mx(n),hy("B"),~~![][kw]))||9),ove=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let iW=!1;const sW={invalid:()=>Lt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Lt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Lt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},oW={invalid:()=>Lt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Lt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Lt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function k5(n,e){const t=!Dn(n),r=typeof n=="string"&&n.toLowerCase()==="non-commercial-and-evaluation",i="16.1.1";let s,o="invalid",a="invalid";n=Mx(n||"");const l=ave(n);if(t||r||l)if(l){const u=se("23/09/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=sve(n);s=se((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(o="expired",a="expired"):(o="valid",a="valid")}else r?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(ove()&&(o="valid",a="valid"),!iW&&o!=="valid"&&(sW[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](sW[o]({keyValidityDate:s,hotVersion:i})),iW=!0),a!=="valid"&&e&&oW[a]({keyValidityDate:s,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=oW[a]({keyValidityDate:s,hotVersion:i}),e.appendChild(c)}}function ave(n){let e=[][kw],t=e;if(n[kw]!==hy("Z"))return!1;for(let r="",i="B<H4P+".split(""),s=hy(i.shift());s;s=hy(i.shift()||"A"))--s<""[kw]?t=t|(rW(`${rW(cy(r)+(cy(Wb(n,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Wb(n,s,s?i[kw]===1?9:8:6);return t===e}function jb(n){const{rowIndexMapper:e,columnIndexMapper:t}=n,{navigableHeaders:r}=n.getSettings();let i=r&&n.countColHeaders()>0?-n.countColHeaders():0,s=r&&n.countRowHeaders()>0?-n.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=t.getVisualFromRenderableIndex(s)),i===null||s===null?null:n._createCellCoords(i,s)}function zb(n){var e,t;const{rowIndexMapper:r,columnIndexMapper:i}=n,{navigableHeaders:s}=n.getSettings();let o=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||n.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||n.countColHeaders()===0)return null;a=-1}return n._createCellCoords((e=r.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(t=i.getVisualFromRenderableIndex(a))!==null&&t!==void 0?t:a)}const lve=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:k5,getMostBottomEndPosition:zb,getMostTopStartPosition:jb,isDefined:Re,isEmpty:Dn,isRegExp:F5,isUndefined:fn,stringify:on},Symbol.toStringTag,{value:"Module"}));var uve=cr,QH=uve([].slice),cve=cr,aW=t6,hve=Sr,lW=og,dve=FA,uW=cve([].push),fve=function(n){if(hve(n))return n;if(aW(n)){for(var e=n.length,t=[],r=0;r<e;r++){var i=n[r];typeof i=="string"?uW(t,i):(typeof i=="number"||lW(i)==="Number"||lW(i)==="String")&&uW(t,dve(i))}var s=t.length,o=!0;return function(a,l){if(o)return o=!1,l;if(aW(this))return l;for(var u=0;u<s;u++)if(t[u]===a)return l}}},gve=an,V5=ev,$5=eC,mve=yr,aC=cr,U5=wr,cW=Sr,hW=hH,B5=QH,pve=fve,vve=cH,wve=String,Fh=V5("JSON","stringify"),lE=aC(/./.exec),dW=aC("".charAt),yve=aC("".charCodeAt),Sve=aC("".replace),Cve=aC(1.1.toString),Eve=/[\uD800-\uDFFF]/g,fW=/^[\uD800-\uDBFF]$/,gW=/^[\uDC00-\uDFFF]$/,mW=!vve||U5(function(){var n=V5("Symbol")("stringify detection");return Fh([n])!=="[null]"||Fh({a:n})!=="{}"||Fh(Object(n))!=="{}"}),pW=U5(function(){return Fh("\uDF06\uD834")!=='"\\udf06\\ud834"'||Fh("\uDEAD")!=='"\\udead"'}),Rve=function(n,e){var t=B5(arguments),r=pve(e);if(!(!cW(r)&&(n===void 0||hW(n))))return t[1]=function(i,s){if(cW(r)&&(s=mve(r,this,wve(i),s)),!hW(s))return s},$5(Fh,null,t)},Tve=function(n,e,t){var r=dW(t,e-1),i=dW(t,e+1);return lE(fW,n)&&!lE(gW,i)||lE(gW,n)&&!lE(fW,r)?"\\u"+Cve(yve(n,0),16):n};Fh&&gve({target:"JSON",stat:!0,arity:3,forced:mW||pW},{stringify:function(e,t,r){var i=B5(arguments),s=$5(mW?Rve:Fh,null,i);return pW&&typeof s=="string"?Sve(s,Eve,Tve):s}});function Hp(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},ct(n,(t,r)=>{r!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[r]=Hp(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[r]=[Hp(t[0])]:e[r]=[]:e[r]=null)})),e}function W5(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function lr(n,e,t){const r=Array.isArray(t);return ct(e,(i,s)=>{(r===!1||t.includes(s))&&(n[s]=i)}),n}function lC(n,e){ct(e,(t,r)=>{e[r]&&typeof e[r]=="object"?(n[r]||(Array.isArray(e[r])?n[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?n[r]=e[r]:n[r]={}),lC(n[r],e[r])):n[r]=e[r]})}function Oi(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function qa(n){const e={};return ct(n,(t,r)=>{e[r]=t}),e}function Vt(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return k(t,i=>{n.MIXINS.push(i.MIXIN_NAME),ct(i,(s,o)=>{if(n.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")n.prototype[o]=s;else{const a=function(c,h){const d=`_${c}`,f=m=>{let g=m;return(Array.isArray(g)||je(g))&&(g=Oi(g)),g};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(n.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),n}function uC(n,e){return JSON.stringify(n)===JSON.stringify(e)}function je(n){return Object.prototype.toString.call(n)==="[object Object]"}function lu(n,e,t,r){r.value=t,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(n,e,r)}function ct(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&e(n[t],t,n)===!1)break;return n}function Gb(n,e){const t=e.split(".");let r=n;return ct(t,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function bT(n,e,t){if(typeof e!="string")return;const r=e.split(".");let i=n;r.forEach((s,o)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(o!==r.length-1?(xn(i,s)||(i[s]={}),i=i[s]):i[s]=t)})}function qA(n){if(!je(n))return 0;const e=function(t){let r=0;return je(t)?ct(t,(i,s)=>{s!=="__children"&&(r+=e(i))}):r+=1,r};return e(n)}function Rs(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,r={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[t]},set(i){this._touched=!0,this[t]=i},enumerable:!0,configurable:!0}),r}function xn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function dy(n,e){if(typeof n!="object"||n===null)return e;if(typeof e!="object"||e===null)return n;const t={};return Object.keys(e).forEach(r=>{typeof e[r]=="object"&&e[r]!==null&&!Array.isArray(e[r])?t[r]=dy(n[r],e[r]):t[r]=xn(n,r)&&n[r]!==void 0?n[r]:e[r]}),Object.keys(n).forEach(r=>{xn(t,r)||(t[r]=n[r])}),t}const bve=Object.freeze(Object.defineProperty({__proto__:null,assignObjectDefaults:dy,clone:qa,createObjectPropListener:Rs,deepClone:Oi,deepExtend:lC,deepObjectSize:qA,defineGetter:lu,duckSchema:Hp,extend:lr,getProperty:Gb,hasOwnProperty:xn,inherit:W5,isObject:je,isObjectEqual:uC,mixin:Vt,objectEach:ct,setProperty:bT},Symbol.toStringTag,{value:"Module"})),Ave="hooksRefRegisterer",j5={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){k(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){ct(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};lu(j5,"MIXIN_NAME",Ave,{writable:!1,enumerable:!1});/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:z5,setPrototypeOf:vW,isFrozen:Nve,getPrototypeOf:Mve,getOwnPropertyDescriptor:Ive}=Object;let{freeze:Ki,seal:Qo,create:Ix}=Object,{apply:Ox,construct:_x}=typeof Reflect<"u"&&Reflect;Ki||(Ki=function(e){return e});Qo||(Qo=function(e){return e});Ox||(Ox=function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return e.apply(t,i)});_x||(_x=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return new e(...r)});const uE=Xi(Array.prototype.forEach),Ove=Xi(Array.prototype.lastIndexOf),wW=Xi(Array.prototype.pop),Ov=Xi(Array.prototype.push),_ve=Xi(Array.prototype.splice),AT=Xi(String.prototype.toLowerCase),rI=Xi(String.prototype.toString),iI=Xi(String.prototype.match),_v=Xi(String.prototype.replace),Pve=Xi(String.prototype.indexOf),xve=Xi(String.prototype.trim),Ea=Xi(Object.prototype.hasOwnProperty),xi=Xi(RegExp.prototype.test),Pv=Lve(TypeError);function Xi(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return Ox(n,e,r)}}function Lve(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _x(n,t)}}function Ct(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:AT;vW&&vW(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=t(i);s!==i&&(Nve(e)||(e[r]=s),i=s)}n[i]=!0}return n}function Hve(n){for(let e=0;e<n.length;e++)Ea(n,e)||(n[e]=null);return n}function Ou(n){const e=Ix(null);for(const[t,r]of z5(n))Ea(n,t)&&(Array.isArray(r)?e[t]=Hve(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=Ou(r):e[t]=r);return e}function xv(n,e){for(;n!==null;){const r=Ive(n,e);if(r){if(r.get)return Xi(r.get);if(typeof r.value=="function")return Xi(r.value)}n=Mve(n)}function t(){return null}return t}const yW=Ki(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sI=Ki(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),oI=Ki(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Dve=Ki(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),aI=Ki(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Fve=Ki(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),SW=Ki(["#text"]),CW=Ki(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),lI=Ki(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),EW=Ki(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),cE=Ki(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),kve=Qo(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Vve=Qo(/<%[\w\W]*|[\w\W]*%>/gm),$ve=Qo(/\$\{[\w\W]*/gm),Uve=Qo(/^data-[\-\w.\u00B7-\uFFFF]+$/),Bve=Qo(/^aria-[\-\w]+$/),G5=Qo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Wve=Qo(/^(?:\w+script|data):/i),jve=Qo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Y5=Qo(/^html$/i),zve=Qo(/^[a-z][.\w]*(-[.\w]+)+$/i);var RW=Object.freeze({__proto__:null,ARIA_ATTR:Bve,ATTR_WHITESPACE:jve,CUSTOM_ELEMENT:zve,DATA_ATTR:Uve,DOCTYPE_NAME:Y5,ERB_EXPR:Vve,IS_ALLOWED_URI:G5,IS_SCRIPT_OR_DATA:Wve,MUSTACHE_EXPR:kve,TMPLIT_EXPR:$ve});const Lv={element:1,text:3,progressingInstruction:7,comment:8,document:9},Gve=function(){return typeof window>"u"?null:window},Yve=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},TW=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function K5(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Gve();const e=Ue=>K5(Ue);if(e.version="3.3.0",e.removed=[],!n||!n.document||n.document.nodeType!==Lv.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=n,m=l.prototype,g=xv(m,"cloneNode"),C=xv(m,"remove"),y=xv(m,"nextSibling"),w=xv(m,"childNodes"),S=xv(m,"parentNode");if(typeof o=="function"){const Ue=t.createElement("template");Ue.content&&Ue.content.ownerDocument&&(t=Ue.content.ownerDocument)}let E,P="";const{implementation:_,createNodeIterator:I,createDocumentFragment:D,getElementsByTagName:Q}=t,{importNode:F}=r;let J=TW();e.isSupported=typeof z5=="function"&&typeof S=="function"&&_&&_.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:q,ERB_EXPR:ie,TMPLIT_EXPR:fe,DATA_ATTR:Ee,ARIA_ATTR:ke,IS_SCRIPT_OR_DATA:be,ATTR_WHITESPACE:re,CUSTOM_ELEMENT:ae}=RW;let{IS_ALLOWED_URI:le}=RW,ye=null;const ze=Ct({},[...yW,...sI,...oI,...aI,...SW]);let et=null;const v=Ct({},[...CW,...lI,...EW,...cE]);let R=Object.seal(Ix(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),A=null,W=null;const z=Object.seal(Ix(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let X=!0,T=!0,N=!1,L=!0,V=!1,x=!0,U=!1,Y=!1,$=!1,j=!1,K=!1,G=!1,ne=!0,de=!1;const Se="user-content-";let Ke=!0,St=!1,_t={},Xe=null;const Ze=Ct({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Nt=null;const Qr=Ct({},["audio","video","img","source","image","track"]);let Ls=null;const Hs=Ct({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Dr="http://www.w3.org/1998/Math/MathML",Ds="http://www.w3.org/2000/svg",ln="http://www.w3.org/1999/xhtml";let Ht=ln,$t=!1,tl=null;const dd=Ct({},[Dr,Ds,ln],rI);let Tc=Ct({},["mi","mo","mn","ms","mtext"]),Pi=Ct({},["annotation-xml"]);const Fs=Ct({},["title","style","font","a","script"]);let bc=null;const LC=["application/xhtml+xml","text/html"],OJ="text/html";let Fr=null,wg=null;const _J=t.createElement("form"),y$=function(B){return B instanceof RegExp||B instanceof Function},qN=function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(wg&&wg===B)){if((!B||typeof B!="object")&&(B={}),B=Ou(B),bc=LC.indexOf(B.PARSER_MEDIA_TYPE)===-1?OJ:B.PARSER_MEDIA_TYPE,Fr=bc==="application/xhtml+xml"?rI:AT,ye=Ea(B,"ALLOWED_TAGS")?Ct({},B.ALLOWED_TAGS,Fr):ze,et=Ea(B,"ALLOWED_ATTR")?Ct({},B.ALLOWED_ATTR,Fr):v,tl=Ea(B,"ALLOWED_NAMESPACES")?Ct({},B.ALLOWED_NAMESPACES,rI):dd,Ls=Ea(B,"ADD_URI_SAFE_ATTR")?Ct(Ou(Hs),B.ADD_URI_SAFE_ATTR,Fr):Hs,Nt=Ea(B,"ADD_DATA_URI_TAGS")?Ct(Ou(Qr),B.ADD_DATA_URI_TAGS,Fr):Qr,Xe=Ea(B,"FORBID_CONTENTS")?Ct({},B.FORBID_CONTENTS,Fr):Ze,A=Ea(B,"FORBID_TAGS")?Ct({},B.FORBID_TAGS,Fr):Ou({}),W=Ea(B,"FORBID_ATTR")?Ct({},B.FORBID_ATTR,Fr):Ou({}),_t=Ea(B,"USE_PROFILES")?B.USE_PROFILES:!1,X=B.ALLOW_ARIA_ATTR!==!1,T=B.ALLOW_DATA_ATTR!==!1,N=B.ALLOW_UNKNOWN_PROTOCOLS||!1,L=B.ALLOW_SELF_CLOSE_IN_ATTR!==!1,V=B.SAFE_FOR_TEMPLATES||!1,x=B.SAFE_FOR_XML!==!1,U=B.WHOLE_DOCUMENT||!1,j=B.RETURN_DOM||!1,K=B.RETURN_DOM_FRAGMENT||!1,G=B.RETURN_TRUSTED_TYPE||!1,$=B.FORCE_BODY||!1,ne=B.SANITIZE_DOM!==!1,de=B.SANITIZE_NAMED_PROPS||!1,Ke=B.KEEP_CONTENT!==!1,St=B.IN_PLACE||!1,le=B.ALLOWED_URI_REGEXP||G5,Ht=B.NAMESPACE||ln,Tc=B.MATHML_TEXT_INTEGRATION_POINTS||Tc,Pi=B.HTML_INTEGRATION_POINTS||Pi,R=B.CUSTOM_ELEMENT_HANDLING||{},B.CUSTOM_ELEMENT_HANDLING&&y$(B.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(R.tagNameCheck=B.CUSTOM_ELEMENT_HANDLING.tagNameCheck),B.CUSTOM_ELEMENT_HANDLING&&y$(B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(R.attributeNameCheck=B.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),B.CUSTOM_ELEMENT_HANDLING&&typeof B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(R.allowCustomizedBuiltInElements=B.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),V&&(T=!1),K&&(j=!0),_t&&(ye=Ct({},SW),et=[],_t.html===!0&&(Ct(ye,yW),Ct(et,CW)),_t.svg===!0&&(Ct(ye,sI),Ct(et,lI),Ct(et,cE)),_t.svgFilters===!0&&(Ct(ye,oI),Ct(et,lI),Ct(et,cE)),_t.mathMl===!0&&(Ct(ye,aI),Ct(et,EW),Ct(et,cE))),B.ADD_TAGS&&(typeof B.ADD_TAGS=="function"?z.tagCheck=B.ADD_TAGS:(ye===ze&&(ye=Ou(ye)),Ct(ye,B.ADD_TAGS,Fr))),B.ADD_ATTR&&(typeof B.ADD_ATTR=="function"?z.attributeCheck=B.ADD_ATTR:(et===v&&(et=Ou(et)),Ct(et,B.ADD_ATTR,Fr))),B.ADD_URI_SAFE_ATTR&&Ct(Ls,B.ADD_URI_SAFE_ATTR,Fr),B.FORBID_CONTENTS&&(Xe===Ze&&(Xe=Ou(Xe)),Ct(Xe,B.FORBID_CONTENTS,Fr)),Ke&&(ye["#text"]=!0),U&&Ct(ye,["html","head","body"]),ye.table&&(Ct(ye,["tbody"]),delete A.tbody),B.TRUSTED_TYPES_POLICY){if(typeof B.TRUSTED_TYPES_POLICY.createHTML!="function")throw Pv('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof B.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Pv('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');E=B.TRUSTED_TYPES_POLICY,P=E.createHTML("")}else E===void 0&&(E=Yve(f,i)),E!==null&&typeof P=="string"&&(P=E.createHTML(""));Ki&&Ki(B),wg=B}},S$=Ct({},[...sI,...oI,...Dve]),C$=Ct({},[...aI,...Fve]),PJ=function(B){let he=S(B);(!he||!he.tagName)&&(he={namespaceURI:Ht,tagName:"template"});const He=AT(B.tagName),vn=AT(he.tagName);return tl[B.namespaceURI]?B.namespaceURI===Ds?he.namespaceURI===ln?He==="svg":he.namespaceURI===Dr?He==="svg"&&(vn==="annotation-xml"||Tc[vn]):!!S$[He]:B.namespaceURI===Dr?he.namespaceURI===ln?He==="math":he.namespaceURI===Ds?He==="math"&&Pi[vn]:!!C$[He]:B.namespaceURI===ln?he.namespaceURI===Ds&&!Pi[vn]||he.namespaceURI===Dr&&!Tc[vn]?!1:!C$[He]&&(Fs[He]||!S$[He]):!!(bc==="application/xhtml+xml"&&tl[B.namespaceURI]):!1},nl=function(B){Ov(e.removed,{element:B});try{S(B).removeChild(B)}catch{C(B)}},fd=function(B,he){try{Ov(e.removed,{attribute:he.getAttributeNode(B),from:he})}catch{Ov(e.removed,{attribute:null,from:he})}if(he.removeAttribute(B),B==="is")if(j||K)try{nl(he)}catch{}else try{he.setAttribute(B,"")}catch{}},E$=function(B){let he=null,He=null;if($)B="<remove></remove>"+B;else{const dr=iI(B,/^[\r\n\t ]+/);He=dr&&dr[0]}bc==="application/xhtml+xml"&&Ht===ln&&(B='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+B+"</body></html>");const vn=E?E.createHTML(B):B;if(Ht===ln)try{he=new d().parseFromString(vn,bc)}catch{}if(!he||!he.documentElement){he=_.createDocument(Ht,"template",null);try{he.documentElement.innerHTML=$t?P:vn}catch{}}const hi=he.body||he.documentElement;return B&&He&&hi.insertBefore(t.createTextNode(He),hi.childNodes[0]||null),Ht===ln?Q.call(he,U?"html":"body")[0]:U?he.documentElement:hi},R$=function(B){return I.call(B.ownerDocument||B,B,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},QN=function(B){return B instanceof h&&(typeof B.nodeName!="string"||typeof B.textContent!="string"||typeof B.removeChild!="function"||!(B.attributes instanceof c)||typeof B.removeAttribute!="function"||typeof B.setAttribute!="function"||typeof B.namespaceURI!="string"||typeof B.insertBefore!="function"||typeof B.hasChildNodes!="function")},T$=function(B){return typeof a=="function"&&B instanceof a};function fu(Ue,B,he){uE(Ue,He=>{He.call(e,B,he,wg)})}const b$=function(B){let he=null;if(fu(J.beforeSanitizeElements,B,null),QN(B))return nl(B),!0;const He=Fr(B.nodeName);if(fu(J.uponSanitizeElement,B,{tagName:He,allowedTags:ye}),x&&B.hasChildNodes()&&!T$(B.firstElementChild)&&xi(/<[/\w!]/g,B.innerHTML)&&xi(/<[/\w!]/g,B.textContent)||B.nodeType===Lv.progressingInstruction||x&&B.nodeType===Lv.comment&&xi(/<[/\w]/g,B.data))return nl(B),!0;if(!(z.tagCheck instanceof Function&&z.tagCheck(He))&&(!ye[He]||A[He])){if(!A[He]&&N$(He)&&(R.tagNameCheck instanceof RegExp&&xi(R.tagNameCheck,He)||R.tagNameCheck instanceof Function&&R.tagNameCheck(He)))return!1;if(Ke&&!Xe[He]){const vn=S(B)||B.parentNode,hi=w(B)||B.childNodes;if(hi&&vn){const dr=hi.length;for(let Ji=dr-1;Ji>=0;--Ji){const gu=g(hi[Ji],!0);gu.__removalCount=(B.__removalCount||0)+1,vn.insertBefore(gu,y(B))}}}return nl(B),!0}return B instanceof l&&!PJ(B)||(He==="noscript"||He==="noembed"||He==="noframes")&&xi(/<\/no(script|embed|frames)/i,B.innerHTML)?(nl(B),!0):(V&&B.nodeType===Lv.text&&(he=B.textContent,uE([q,ie,fe],vn=>{he=_v(he,vn," ")}),B.textContent!==he&&(Ov(e.removed,{element:B.cloneNode()}),B.textContent=he)),fu(J.afterSanitizeElements,B,null),!1)},A$=function(B,he,He){if(ne&&(he==="id"||he==="name")&&(He in t||He in _J))return!1;if(!(T&&!W[he]&&xi(Ee,he))){if(!(X&&xi(ke,he))){if(!(z.attributeCheck instanceof Function&&z.attributeCheck(he,B))){if(!et[he]||W[he]){if(!(N$(B)&&(R.tagNameCheck instanceof RegExp&&xi(R.tagNameCheck,B)||R.tagNameCheck instanceof Function&&R.tagNameCheck(B))&&(R.attributeNameCheck instanceof RegExp&&xi(R.attributeNameCheck,he)||R.attributeNameCheck instanceof Function&&R.attributeNameCheck(he,B))||he==="is"&&R.allowCustomizedBuiltInElements&&(R.tagNameCheck instanceof RegExp&&xi(R.tagNameCheck,He)||R.tagNameCheck instanceof Function&&R.tagNameCheck(He))))return!1}else if(!Ls[he]){if(!xi(le,_v(He,re,""))){if(!((he==="src"||he==="xlink:href"||he==="href")&&B!=="script"&&Pve(He,"data:")===0&&Nt[B])){if(!(N&&!xi(be,_v(He,re,"")))){if(He)return!1}}}}}}}return!0},N$=function(B){return B!=="annotation-xml"&&iI(B,ae)},M$=function(B){fu(J.beforeSanitizeAttributes,B,null);const{attributes:he}=B;if(!he||QN(B))return;const He={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:et,forceKeepAttr:void 0};let vn=he.length;for(;vn--;){const hi=he[vn],{name:dr,namespaceURI:Ji,value:gu}=hi,yg=Fr(dr),ZN=gu;let Zr=dr==="value"?ZN:xve(ZN);if(He.attrName=yg,He.attrValue=Zr,He.keepAttr=!0,He.forceKeepAttr=void 0,fu(J.uponSanitizeAttribute,B,He),Zr=He.attrValue,de&&(yg==="id"||yg==="name")&&(fd(dr,B),Zr=Se+Zr),x&&xi(/((--!?|])>)|<\/(style|title|textarea)/i,Zr)){fd(dr,B);continue}if(yg==="attributename"&&iI(Zr,"href")){fd(dr,B);continue}if(He.forceKeepAttr)continue;if(!He.keepAttr){fd(dr,B);continue}if(!L&&xi(/\/>/i,Zr)){fd(dr,B);continue}V&&uE([q,ie,fe],O$=>{Zr=_v(Zr,O$," ")});const I$=Fr(B.nodeName);if(!A$(I$,yg,Zr)){fd(dr,B);continue}if(E&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Ji)switch(f.getAttributeType(I$,yg)){case"TrustedHTML":{Zr=E.createHTML(Zr);break}case"TrustedScriptURL":{Zr=E.createScriptURL(Zr);break}}if(Zr!==ZN)try{Ji?B.setAttributeNS(Ji,dr,Zr):B.setAttribute(dr,Zr),QN(B)?nl(B):wW(e.removed)}catch{fd(dr,B)}}fu(J.afterSanitizeAttributes,B,null)},xJ=function Ue(B){let he=null;const He=R$(B);for(fu(J.beforeSanitizeShadowDOM,B,null);he=He.nextNode();)fu(J.uponSanitizeShadowNode,he,null),b$(he),M$(he),he.content instanceof s&&Ue(he.content);fu(J.afterSanitizeShadowDOM,B,null)};return e.sanitize=function(Ue){let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},he=null,He=null,vn=null,hi=null;if($t=!Ue,$t&&(Ue="<!-->"),typeof Ue!="string"&&!T$(Ue))if(typeof Ue.toString=="function"){if(Ue=Ue.toString(),typeof Ue!="string")throw Pv("dirty is not a string, aborting")}else throw Pv("toString is not a function");if(!e.isSupported)return Ue;if(Y||qN(B),e.removed=[],typeof Ue=="string"&&(St=!1),St){if(Ue.nodeName){const gu=Fr(Ue.nodeName);if(!ye[gu]||A[gu])throw Pv("root node is forbidden and cannot be sanitized in-place")}}else if(Ue instanceof a)he=E$("<!---->"),He=he.ownerDocument.importNode(Ue,!0),He.nodeType===Lv.element&&He.nodeName==="BODY"||He.nodeName==="HTML"?he=He:he.appendChild(He);else{if(!j&&!V&&!U&&Ue.indexOf("<")===-1)return E&&G?E.createHTML(Ue):Ue;if(he=E$(Ue),!he)return j?null:G?P:""}he&&$&&nl(he.firstChild);const dr=R$(St?Ue:he);for(;vn=dr.nextNode();)b$(vn),M$(vn),vn.content instanceof s&&xJ(vn.content);if(St)return Ue;if(j){if(K)for(hi=D.call(he.ownerDocument);he.firstChild;)hi.appendChild(he.firstChild);else hi=he;return(et.shadowroot||et.shadowrootmode)&&(hi=F.call(r,hi,!0)),hi}let Ji=U?he.outerHTML:he.innerHTML;return U&&ye["!doctype"]&&he.ownerDocument&&he.ownerDocument.doctype&&he.ownerDocument.doctype.name&&xi(Y5,he.ownerDocument.doctype.name)&&(Ji="<!DOCTYPE "+he.ownerDocument.doctype.name+`>
`+Ji),V&&uE([q,ie,fe],gu=>{Ji=_v(Ji,gu," ")}),E&&G?E.createHTML(Ji):Ji},e.setConfig=function(){let Ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};qN(Ue),Y=!0},e.clearConfig=function(){wg=null,Y=!1},e.isValidAttribute=function(Ue,B,he){wg||qN({});const He=Fr(Ue),vn=Fr(B);return A$(He,vn,he)},e.addHook=function(Ue,B){typeof B=="function"&&Ov(J[Ue],B)},e.removeHook=function(Ue,B){if(B!==void 0){const he=Ove(J[Ue],B);return he===-1?void 0:_ve(J[Ue],he,1)[0]}return wW(J[Ue])},e.removeHooks=function(Ue){J[Ue]=[]},e.removeAllHooks=function(){J=TW()},e}var Kve=K5();function _i(n){return n[0].toUpperCase()+n.substr(1)}function Xve(){const n=[];for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=t.length;for(;i;){i-=1;const s=on(t[i]).toLowerCase();n.indexOf(s)===-1&&n.push(s)}return n.length===1}function ZH(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function X5(n){if(typeof n!="string")return!1;try{const e=JSON.parse(n);return typeof e=="object"&&e!==null}catch{return!1}}function JH(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function QA(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,r)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[r]===void 0?"":e[r])}function NT(n){return ZA(`${n}`,{ALLOWED_TAGS:[]})}function ZA(n,e){return Kve.sanitize(n,e)}const qve=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Xve,isJSON:X5,isPercentValue:JH,randomString:ZH,sanitize:ZA,stripTags:NT,substitute:QA,toUpperCaseFirst:_i},Symbol.toStringTag,{value:"Module"})),ys=n=>["tabindex",n],Qve=()=>["role","treegrid"],Xu=()=>["role","presentation"],Zve=()=>["role","gridcell"],Jve=()=>["role","gridcell button"],ewe=()=>["role","rowheader"],q5=()=>["role","rowgroup"],twe=()=>["role","columnheader"],Q5=()=>["role","row"],nwe=()=>["role","menu"],rwe=()=>["role","menuitem"],iwe=()=>["role","menuitemcheckbox"],swe=()=>["role","combobox"],Z5=()=>["role","listbox"],owe=()=>["role","option"],awe=()=>["role","checkbox"],lwe=()=>["role","dialog"],uwe=()=>["role","alertdialog"],cwe=()=>["scope","col"],hwe=()=>["scope","row"],dwe=()=>["type","text"],io=n=>["aria-label",n],fwe=n=>["aria-labelledby",n],gwe=n=>["aria-describedby",n],fg=()=>["aria-hidden","true"],Vw=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},mwe=()=>["aria-multiselectable","true"],J5=n=>["aria-haspopup",n],e9=n=>["aria-rowcount",n],JA=n=>["aria-colcount",n],t9=n=>["aria-rowindex",n],eD=n=>["aria-colindex",n],Yo=n=>["aria-expanded",n],pwe=n=>["aria-sort",n],bW=()=>["aria-readonly","true"],AW=()=>["aria-invalid","true"],n9=n=>["aria-checked",n],tD=()=>["aria-selected","true"],vwe=()=>["aria-autocomplete","list"],wwe=n=>["aria-controls",n],ywe=n=>["aria-activedescendant",n],Swe=n=>["aria-live",n],Cwe=n=>["aria-relevant",n],Ewe=n=>["aria-setsize",n],Rwe=n=>["aria-posinset",n],Twe=()=>["aria-modal","true"];function gS(n){return window.requestAnimationFrame(n)}function mS(n){window.cancelAnimationFrame(n)}function nD(){return"ontouchstart"in window}function r9(){return typeof window<"u"}let Rg;function i9(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Rg||(typeof Intl=="object"?Rg=new Intl.Collator(n,e).compare:typeof String.prototype.localeCompare=="function"?Rg=(t,r)=>`${t}`.localeCompare(r):Rg=(t,r)=>t===r?0:t>r?-1:1,Rg)}const bwe=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:mS,getComparisonFunction:i9,isCSR:r9,isTouchSupported:nD,requestAnimationFrame:gS},Symbol.toStringTag,{value:"Module"})),Po=n=>{const e={value:!1};return e.test=(t,r)=>{e.value=n(t,r)},e},yc={chrome:Po((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:Po(n=>/CriOS/.test(n)),edge:Po(n=>/Edge/.test(n)),edgeWebKit:Po(n=>/EdgiOS/.test(n)),firefox:Po(n=>/Firefox/.test(n)),firefoxWebKit:Po(n=>/FxiOS/.test(n)),mobile:Po(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:Po((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},lv={mac:Po(n=>/^Mac/.test(n)),win:Po(n=>/^Win/.test(n)),linux:Po(n=>/^Linux/.test(n)),ios:Po(n=>/iPhone|iPad|iPod/i.test(n))};function s9(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ct(yc,t=>{let{test:r}=t;return void r(n,e)})}function o9(){let{platform:n=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ct(lv,e=>{let{test:t}=e;return void t(n)})}r9()&&(s9(),o9());function rD(){return yc.chrome.value}function a9(){return yc.chromeWebKit.value}function MT(){return yc.firefox.value}function l9(){return yc.firefoxWebKit.value}function cC(){return yc.safari.value}function u9(){return yc.edge.value}function Awe(){return yc.edgeWebKit.value}function Ua(){return yc.mobile.value}function iD(){return lv.ios.value}function sD(){let{maxTouchPoints:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return n>2&&lv.mac.value}function Yb(){return lv.win.value}function Kb(){return lv.mac.value}function Nwe(){return lv.linux.value}const Mwe=Object.freeze(Object.defineProperty({__proto__:null,isChrome:rD,isChromeWebKit:a9,isEdge:u9,isEdgeWebKit:Awe,isFirefox:MT,isFirefoxWebKit:l9,isIOS:iD,isIpadOS:sD,isLinuxOS:Nwe,isMacOS:Kb,isMobileBrowser:Ua,isSafari:cC,isWindowsOS:Yb,setBrowserMeta:s9,setPlatformMeta:o9},Symbol.toStringTag,{value:"Module"}));function c9(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,r=null,i=n;for(;i!==null;){if(t===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(t+=1,i=i.parentNode)}return r}function fy(n,e){const t=n.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function h9(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}function Gf(n){return h9(n)&&n.parent}function Iwe(n){return!!Object.getPrototypeOf(n.parent)}function Kh(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=n;for(;s!=null&&s!==t;){const{nodeType:o,nodeName:a}=s;if(o===r&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function $w(n,e,t){const r=[];let i=n;for(;i&&(i=Kh(i,e,t),!(!i||t&&!t.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=r.length;return s?r[s-1]:null}function d9(n,e){const t={element:void 0,classNames:[]};let r=n;for(;r!==null&&r!==n.ownerDocument.documentElement&&!t.element;){if(typeof e=="string"&&r.classList.contains(e))t.element=r,t.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(s=>e.test(s));i.length&&(t.element=r,t.classNames.push(...i))}r=r.parentElement}return t}function kh(n,e){let t=n.parentNode,r=[];for(typeof e=="string"?n.defaultView?r=Array.prototype.slice.call(n.querySelectorAll(e),0):r=Array.prototype.slice.call(n.ownerDocument.querySelectorAll(e),0):r.push(e);t!==null;){if(r.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function f9(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function Xc(n,e,t){const r=t.parentElement.querySelector(`.ht_clone_${n}`);return r?r.contains(e):null}function g9(n){return!n||!n.length?[]:n.filter(e=>!!e)}function m9(n,e){if(!n||!n.length)return{regexFree:[],regexes:[]};const t=[],r=[];return r.push(...n.filter(i=>{const s=i instanceof RegExp;return s&&e&&t.push(i),!s})),{regexFree:r,regexes:t}}function Be(n,e){return n.classList===void 0||typeof e!="string"||e===""?!1:n.classList.contains(e)}function ee(n,e){typeof e=="string"&&(e=e.split(" ")),e=g9(e),e.length>0&&n.classList.add(...e)}function Me(n,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:r}=m9(e,!0);t=g9(t),t.length>0&&n.classList.remove(...t),r.forEach(i=>{n.classList.forEach(s=>{i.test(s)&&n.classList.remove(s)})})}function Pe(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&n.setAttribute(...r)})}function Kl(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:r}=m9(e,!0);t.forEach(i=>{i!==""&&n.removeAttribute(i)}),r.forEach(i=>{n.getAttributeNames().forEach(s=>{i.test(s)&&n.removeAttribute(s)})})}function oD(n){if(n.nodeType===3)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)oD(e[t])}}function Jl(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const p9=/(<(.*)>|&(.*);)/;function sd(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p9.test(e)?n.innerHTML=t?ZA(e):e:Xh(n,e)}function Xh(n,e){const t=n.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(Jl(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function Yf(n){const e=n.ownerDocument.documentElement,t=n.ownerDocument.defaultView;let r=n;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return Yf(r.host.impl);if(r.host)return Yf(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(t.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function v9(n){const t=n.ownerDocument.defaultView;let r=n;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return t.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function si(n){const e=n.ownerDocument,t=e.defaultView,r=e.documentElement;let i=n,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=t.pageXOffset||r.scrollLeft,o+=t.pageYOffset||r.scrollTop),{left:s,top:o}}function aD(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function eN(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function tN(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?aD(e):n.scrollTop}function lD(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?eN(e):n.scrollLeft}function pS(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const r=["auto","scroll"];let i=n.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=t.getComputedStyle(i),r.includes(s)||r.includes(o)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(s))||i.clientWidth<=i.scrollWidth+1&&(r.includes(o)||r.includes(s)))return i;i=i.parentNode}return t}function w9(n){return n.scrollHeight-n.clientHeight}function y9(n){return n.scrollWidth-n.clientWidth}function Dp(n){const e=n.ownerDocument,t=e.defaultView;let r=n.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=t.getComputedStyle(r),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return r;r=r.parentNode}return t}function vS(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(n){if(n===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const r=n.style[e];if(r!==""&&r!==void 0)return r;const i=t.getComputedStyle(n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Owe(n,e){const{selectorText:t}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&t&&(n.msMatchesSelector?r=n.msMatchesSelector(t):n.matches&&(r=n.matches(t))),r}function Xn(n){return n.offsetWidth}function or(n){return n.getBoundingClientRect().height}function fp(n){return n.clientHeight||n.innerHeight}function uD(n){return n.clientWidth||n.innerWidth}function _we(n,e,t){n.addEventListener(e,t,!1)}function Pwe(n,e,t){n.removeEventListener(e,t,!1)}function cD(n){return n.selectionStart?n.selectionStart:0}function S9(n){return n.selectionEnd?n.selectionEnd:0}function xwe(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=n.document;let t="";return n.getSelection?t=n.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(t=e.selection.createRange().text),t}function Px(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function hC(n,e,t){if(t===void 0&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const i=n.parentNode,s=i.style.display;i.style.display="block",n.setSelectionRange(e,t),i.style.display=s}}}let uI;function C9(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Yb()?Number.isInteger(n.defaultView.devicePixelRatio||1)?0:2:0}function Lwe(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");cC()&&!Ua()&&t.classList.add("htScrollbarSafariTest"),t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const r=e.getBoundingClientRect().width;t.style.overflow="scroll";let i=e.getBoundingClientRect().width;return r===i&&(i=t.clientWidth),(n.body||n.documentElement).removeChild(t),parseFloat((r-i).toFixed(3))}function ar(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return uI===void 0&&(uI=Lwe(n)),uI}function hD(n){return n instanceof Window?n.document.body.scrollHeight>n.innerHeight:n.offsetWidth!==n.clientWidth}function dD(n){return n instanceof Window?n.document.body.scrollWidth>n.innerWidth:n.offsetHeight!==n.clientHeight}function nN(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function Hwe(n){let e;return n.style.transform&&(e=n.style.transform)!==""?["transform",e]:-1}function dC(n){n.style.transform&&n.style.transform!==""&&(n.style.transform="")}function gy(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function rN(n){return gy(n)&&n.hasAttribute("data-hot-input")===!1}function Dwe(n){const e=n.ownerDocument.activeElement;rN(e)||n.select()}function fD(n){return!n.parentNode}function E9(n,e){new IntersectionObserver((r,i)=>{r.forEach(s=>{s.isIntersecting&&n.offsetParent!==null&&(e(),i.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}function gD(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=n.ownerDocument,i=r.createRange(),s=r.defaultView.getSelection();Pe(n,"contenteditable",!0),t&&Pe(n,...fg()),e&&ee(n,"invisibleSelection"),i.selectNodeContents(n),s.removeAllRanges(),s.addRange(i)}function mD(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const t=n.ownerDocument.defaultView.getSelection();n.hasAttribute("aria-hidden")&&n.removeAttribute("aria-hidden"),t.removeAllRanges(),e&&Me(n,"invisibleSelection"),n.removeAttribute("contenteditable")}function R9(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;gD(n,t),e(),mD(n,t)}function Xl(n){var e;const t=n==null||(e=n.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(t&&t!==null&&n instanceof t)}const Fwe=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:p9,addClass:ee,addEvent:_we,clearTextSelection:Px,closest:Kh,closestDown:$w,empty:Jl,fastInnerHTML:sd,fastInnerText:Xh,findFirstParentWithClass:d9,getCaretPosition:cD,getCssTransform:Hwe,getFractionalScalingCompensation:C9,getFrameElement:h9,getMaximumScrollLeft:y9,getMaximumScrollTop:w9,getParent:c9,getParentWindow:Gf,getScrollLeft:lD,getScrollTop:tN,getScrollableElement:pS,getScrollbarWidth:ar,getSelectionEndPosition:S9,getSelectionText:xwe,getStyle:vS,getTrimmingContainer:Dp,getWindowScrollLeft:eN,getWindowScrollTop:aD,hasAccessToParentWindow:Iwe,hasClass:Be,hasHorizontalScrollbar:dD,hasVerticalScrollbar:hD,hasZeroHeight:v9,index:f9,innerHeight:fp,innerWidth:uD,isChildOf:kh,isDetached:fD,isHTMLElement:Xl,isInput:gy,isInternalElement:fy,isOutsideInput:rN,isVisible:Yf,makeElementContentEditableAndSelectItsContent:gD,matchesCSSRules:Owe,observeVisibilityChangeOnce:E9,offset:si,outerHeight:or,outerWidth:Xn,overlayContainsElement:Xc,removeAttribute:Kl,removeClass:Me,removeContentEditableFromElementAndDeselect:mD,removeEvent:Pwe,removeTextNodes:oD,resetCssTransform:dC,runWithSelectedContendEditableElement:R9,selectElementIfAllowed:Dwe,setAttribute:Pe,setCaretPosition:hC,setOverlayPosition:nN},Symbol.toStringTag,{value:"Module"}));function fa(n,e,t){return(e=kwe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kwe(n){var e=Vwe(n,"string");return typeof e=="symbol"?e:e+""}function Vwe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const $we="base",zn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class uv{static get EDITOR_TYPE(){return $we}constructor(e){fa(this,"hot",void 0),fa(this,"state",zn.VIRGIN),fa(this,"_opened",!1),fa(this,"_fullEditMode",!1),fa(this,"_closeCallback",null),fa(this,"TD",null),fa(this,"row",null),fa(this,"col",null),fa(this,"prop",null),fa(this,"originalValue",null),fa(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,i,s,o){this.TD=i,this.row=e,this.col=t,this.prop=r,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:zn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,i,s,o;if(t){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();r=u.row,i=u.col,s=c.row,o=c.col}else[r,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,s,o,"edit")}beginEditing(e,t){if(this.state!==zn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=zn.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:on(l);this.setValue(u)}this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),r.view.scrollViewport(r._createCellCoords(i,s))||(this.hot.removeHook("afterScroll",o),o()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,t,r){let i;if(r){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),r(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===zn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===zn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=zn.WAITING,this.saveValue(i,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=zn.FINISHED,this.discardEditor(o)}):(this.state=zn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=zn.FINISHED,this.discardEditor()}discardEditor(e){this.state===zn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=zn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=zn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===zn.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=si(t),a=Xn(t),l=si(this.hot.rootElement),u=Xn(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==s?c.scrollTop:0,f=h!==s?h.scrollLeft:0,m=s.innerWidth-l.left-u,{wtTable:g}=(e=r.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,C=g.name,y=["master","inline_start"].includes(C)?d:0,w=["master","top","bottom"].includes(C)?f:0,S=o.top===l.top?0:1;let E=o.top-l.top-S-y,P=0;this.hot.isRtl()?P=s.innerWidth-o.left-a-m-1+w:P=o.left-l.left-1-w,["top","top_inline_start_corner"].includes(C)&&(E+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(P+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const _=this.hot.hasColHeaders(),I=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),D=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),F=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(_&&I<=0||I===F)&&(E+=1),D<=0&&(P+=1);const J=i.rowsRenderCalculator.startPosition,q=i.columnsRenderCalculator.startPosition,ie=Math.abs(r.inlineStartOverlay.getScrollPosition()),fe=r.topOverlay.getScrollPosition(),Ee=ar(this.hot.rootDocument);let ke=t.offsetTop;if(["inline_start","master"].includes(C)&&(ke+=J-fe),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:z,wtTable:X}=r.bottomOverlay.clone;ke+=z.getWorkspaceHeight()-X.getHeight()-Ee}let be=t.offsetLeft;this.hot.isRtl()?(be>=0?be=g.getWidth()-t.offsetLeft:be=Math.abs(be),be+=q-ie-a):["top","master","bottom"].includes(C)&&(be+=q-ie);const re=s.getComputedStyle(this.TD),ae=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",le=parseInt(re[ae],10)>0?0:1,ye=parseInt(re.borderTopWidth,10)>0?0:1,ze=Xn(t)+le,et=or(t)+ye,v=hD(c)?Ee:0,R=dD(h)?Ee:0,A=this.hot.view.maximumVisibleElementWidth(be)-v+le,W=Math.max(this.hot.view.maximumVisibleElementHeight(ke)-R+ye,this.hot.stylesHandler.getDefaultRowHeight());return{top:E,start:P,height:et,maxHeight:W,width:ze,maxWidth:A}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}Vt(uv,j5);function la(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function hh(n){return n.isImmediatePropagationEnabled===!1}function qh(n){return n.button===2}function iN(n){return n.button===0}function T9(n){return n instanceof TouchEvent}function b9(n,e){const t={x:n.offsetX,y:n.offsetY};let r=n.target;if(!Xl(e)||r!==e&&r.contains(e))return t;for(;r!==e;)t.x+=r.offsetLeft,t.y+=r.offsetTop,r=r.offsetParent;return t}const Uwe=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:hh,isLeftClick:iN,isRightClick:qh,isTouchEvent:T9,offsetRelativeTo:b9,stopImmediatePropagation:la},Symbol.toStringTag,{value:"Module"}));function Bwe(n,e,t){return(e=Wwe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wwe(n){var e=jwe(n,"string");return typeof e=="symbol"?e:e+""}function jwe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let IT=0;class Zo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Bwe(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){r.call(this,zwe(o))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(t,s,i),IT+=1,()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===t&&o.element===e){if(r&&r!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),IT-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const r=this.context.eventListeners[t];e&&r.eventManager!==this||(this.context.eventListeners.splice(t,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),IT-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const s={bubbles:!0,cancelable:t!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;r.createEvent?(o=r.createEvent("MouseEvents"),o.initMouseEvent(t,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,r.body.parentNode)):o=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${t}`,o)}}function zwe(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),la(this)},n}function Gwe(){return IT}function bi(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof n;if(t==="number")return!isNaN(n)&&isFinite(n);if(t==="string"){if(n.length===0)return!1;if(n.length===1)return/\d/.test(n);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}else if(t==="object")return!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date);return!1}function A9(n){return bi(n,[","])}function Le(n,e,t){let r=-1;for(typeof e=="function"?(t=e,e=n):r=n-1;++r<=e&&t(r)!==!1;);}function xx(n,e,t){let r=n+1;for(typeof e=="function"&&(t=e,e=0);--r>=e&&t(r)!==!1;);}function pD(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}function ft(n,e,t){return Math.min(n,e)===n?e:Math.max(n,t)===n?t:n}function N9(n){const e=n.replace(",",".");return isNaN(parseFloat(e))===!1?parseFloat(e):null}function Df(n){return Number.isInteger(n)&&n>=0}const Ywe=Object.freeze(Object.defineProperty({__proto__:null,clamp:ft,getParsedNumber:N9,isNumeric:bi,isNumericLike:A9,isUnsignedNumber:Df,rangeEach:Le,rangeEachReverse:xx,valueAccordingPercent:pD},Symbol.toStringTag,{value:"Module"}));function NW(n,e,t){n.addEventListener(e,t,!1)}function MW(n,e,t){n.removeEventListener(e,t,!1)}function hE(n){return n.ownerDocument.defaultView.getComputedStyle(n)}function M9(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=n.body,i=n.createTextNode(""),s=n.createElement("span");let o;function a(){var h,d;i.textContent=t.textContent(o),s.style.position="absolute",s.style.fontSize=hE(o).fontSize,s.style.fontFamily=hE(o).fontFamily,s.style.whiteSpace="pre",r.appendChild(s);const f=parseInt(((h=hE(o))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),m=parseInt(((d=hE(o))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),g=s.clientWidth+f+m+1;r.removeChild(s);const C=o.style;C.height=`${t.minHeight}px`,t.minWidth>g?C.width=`${t.minWidth}px`:g>t.maxWidth?C.width=`${t.maxWidth}px`:C.width=`${g}px`;const y=o.scrollHeight?o.scrollHeight-1:0;t.minHeight>y?C.height=`${t.minHeight}px`:t.maxHeight<y?(C.height=`${t.maxHeight}px`,C.overflowY="visible"):C.height=`${y}px`}function l(){n.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")t.minHeight=o.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(t.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")t.maxHeight=o.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(t.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")t.minWidth=o.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(t.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")t.maxWidth=o.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(t.maxWidth=d)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=h,u(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${t.minHeight}px`,o.style.minWidth=`${t.minWidth}px`,o.style.maxWidth=`${t.maxWidth}px`,o.style.overflowY="hidden"),f&&(NW(o,"input",a),NW(o,"keydown",l)),a()}return{init:c,resize:a,unObserve(){MW(o,"input",a),MW(o,"keydown",l)}}}function IW(n,e){const t=cD(e),r=e.value.split(`
`);let i=t,s=0;for(let o=0;o<r.length;o++){const a=r[o];o!==0&&(s+=r[o-1].length+1);const l=s+a.length;if(n==="home"?i=s:n==="end"&&(i=l),t<=l)break}hC(e,i)}function md(n,e,t){return(e=Kwe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kwe(n){var e=Xwe(n,"string");return typeof e=="symbol"?e:e+""}function Xwe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const qwe="ht_editor_visible",dE="ht_editor_hidden",OW="textEditor",Qwe="text";class gg extends uv{static get EDITOR_TYPE(){return Qwe}constructor(e){super(e),md(this,"eventManager",new Zo(this)),md(this,"autoResize",M9(this.hot.rootDocument)),md(this,"TEXTAREA",void 0),md(this,"textareaStyle",void 0),md(this,"TEXTAREA_PARENT",void 0),md(this,"textareaParentStyle",void 0),md(this,"layerClass",void 0),this.eventManager=new Zo(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),fy(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,r,i,s,o){const a=this.state;if(super.prepare(e,t,r,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==zn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===zn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),hC(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Pe(this.TEXTAREA,[["data-hot-input",""],ys(-1)]),ee(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ee(this.TEXTAREA_PARENT,"handsontableInputHolder"),Be(this.TEXTAREA_PARENT,this.layerClass)&&Me(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,dE),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){u9()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Me(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,dE)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;Le(e.length-1,r=>{const i=e[r];if(Be(i,"handsontableEditor"))return t=!0,!1}),Be(this.TEXTAREA_PARENT,dE)&&Me(this.TEXTAREA_PARENT,dE),t?(this.layerClass=qwe,ee(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ee(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==zn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:r,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){iD()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===zn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===zn.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>Re(this.hot.getSelected()),group:OW},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;IW(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;IW(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(OW)}}const I9="gridDefault",od="editorManager.handlingEditor",Zwe={name:"editorCloseAndSave",callback(n){n._getEditorManager().closeEditorAndSaveChanges()}},Jwe={name:"editorCloseAndSaveByArrowKeys",callback(n,e,t){const r=n._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===zn.EDITING||(r.closeEditorAndSaveChanges(),n.getSelected()&&(t.includes("arrowdown")?n.selection.transformStart(1,0):t.includes("arrowup")?n.selection.transformStart(-1,0):t.includes("arrowleft")?n.selection.transformStart(0,-1*n.getDirectionFactor()):t.includes("arrowright")&&n.selection.transformStart(0,n.getDirectionFactor())),e.preventDefault())}},eye={name:"editorCloseAndSaveByEnter",callback(n,e){const t=n._getEditorManager();t.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),t.moveSelectionAfterEnter(e)}},tye={name:"editorCloseWithoutSaving",callback(n){const e=n._getEditorManager();e.closeEditorAndRestoreOriginalValue(n.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},nye={name:"editorFastOpen",callback(n,e){const{highlight:t}=n.getSelectedRangeActive();t.isHeader()||n._getEditorManager().openEditor(null,e,!0)}};var rye=an,iye=yr,sye=iv,oye=Ps,aye=Cr,lye=iu,uye=xs,cye=id,cI=cye("some",TypeError);rye({target:"Iterator",proto:!0,real:!0,forced:cI},{some:function(e){aye(this);try{oye(e)}catch(i){uye(this,"throw",i)}if(cI)return iye(cI,this,e);var t=lye(this),r=0;return sye(t,function(i,s){if(e(i,r++))return s()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const hye={name:"editorOpen",callback(n,e,t){const{selection:r}=n,i=n._getEditorManager(),s=n.getSelectedRange(),o=n.getSelectedRangeActive(),{highlight:a}=o;if((s.some(l=>r.isMultiple(l))||s.length>1)&&!o.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0){const l=n.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;t.includes("shift")?r.transformFocus(-u.row,-u.col):r.transformFocus(u.row,u.col);return}a.isHeader()||(n.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),la(e))}};function dye(){return[Zwe,Jwe,eye,tye,nye,hye]}const fye={name:"extendCellsSelectionDown",callback(n){const{selection:e}=n,{highlight:t}=n.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},gye={name:"extendCellsSelectionDownByViewportHeight",callback(n){const{selection:e,rowIndexMapper:t}=n,{to:r}=n.getSelectedRangeActive(),i=Math.min(r.row+n.countVisibleRows(),n.countRows()-1),s=t.getNearestNotHiddenIndex(i,-1);if(s!==null){const o=n._createCellCoords(s,r.col),a=r.row-n.getFirstFullyVisibleRow(),l=Math.min(o.row-a,n.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(o,n.getActiveSelectionLayerIndex()),e.markEndSource(),n.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},mye={name:"extendCellsSelectionLeft",callback(n){const{selection:e}=n,{highlight:t}=n.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*n.getDirectionFactor()),e.markEndSource())}},pye={name:"extendCellsSelectionRight",callback(n){const{selection:e}=n,{highlight:t}=n.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,n.getDirectionFactor()),e.markEndSource())}},vye={name:"extendCellsSelectionToColumns",callback(n){const{selection:e}=n,{highlight:t,from:r,to:i}=n.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):n.selectColumns(r.col,i.col,t),e.markEndSource()}},wye={name:"extendCellsSelectionToMostBottom",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeActive(),o=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(n.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,s.col)),e.markEndSource()}}},yye={name:"extendCellsSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const o=t.getNearestNotHiddenIndex(n.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(n._createCellCoords(s.row,o)),e.markEndSource()}}},Sye={name:"extendCellsSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const o=parseInt(n.getSettings().fixedColumnsStart,10),a=t.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(n._createCellCoords(s.row,a)),e.markEndSource()}}},Cye={name:"extendCellsSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeActive(),o=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(s.row,a)),e.markEndSource()}}},Eye={name:"extendCellsSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeActive(),o=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(s.row,a)),e.markEndSource()}}},Rye={name:"extendCellsSelectionToMostTop",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeActive(),o=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,s.col)),e.markEndSource()}}},Tye={name:"extendCellsSelectionToRows",callback(n){const{selection:e}=n,{highlight:t,from:r,to:i}=n.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):n.selectRows(r.row,i.row,t),e.markEndSource()}},bye={name:"extendCellsSelectionUp",callback(n){const{selection:e}=n,{highlight:t}=n.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},Aye={name:"extendCellsSelectionUpByViewportHeight",callback(n){const{selection:e,rowIndexMapper:t}=n,{to:r}=n.getSelectedRangeActive(),i=Math.max(r.row-n.countVisibleRows(),0),s=t.getNearestNotHiddenIndex(i,1);if(s!==null){const o=n._createCellCoords(s,r.col),a=r.row-n.getFirstFullyVisibleRow(),l=Math.max(o.row-a,0);e.markSource("keyboard"),e.setRangeEnd(o,n.getActiveSelectionLayerIndex()),e.markEndSource(),n.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function Nye(){return[fye,gye,mye,pye,vye,wye,yye,Sye,Cye,Eye,Rye,Tye,bye,Aye]}const Mye={name:"moveCellSelectionDown",callback(n){let{selection:e}=n;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},Iye={name:"moveCellSelectionDownByViewportHeight",callback(n){const{selection:e}=n,{navigableHeaders:t}=n.getSettings(),r=t?n.countColHeaders():0,{row:i}=n.getSelectedRangeActive().highlight;let s=n.countVisibleRows()+r;s=s===0?1:s,i===n.countRows()-1?s=1:i+s>n.countRows()&&(s=n.countRows()-i-1),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),n.getSelectedRangeActive().highlight.row<0&&n.scrollViewportTo({row:0})}},Oye={name:"moveCellSelectionInlineEnd",callback(n,e){const{selection:t}=n,r=n.getSettings(),i=n.getSelectedRange(),s=n.getSelectedRangeActive(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.markSource("keyboard"),(i.some(a=>t.isMultiple(a))||i.length>1)&&!s.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?t.transformFocus(-o.row,-o.col):t.transformStart(-o.row,-o.col),t.markEndSource()}},_ye={name:"moveCellSelectionInlineStart",callback(n,e){const{selection:t}=n,r=n.getSettings(),i=n.getSelectedRange(),s=n.getSelectedRangeActive(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.markSource("keyboard"),(i.some(a=>t.isMultiple(a))||i.length>1)&&!s.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?t.transformFocus(o.row,o.col):t.transformStart(o.row,o.col),t.markEndSource()}},Pye={name:"moveCellSelectionLeft",callback(n){const{selection:e}=n;e.markSource("keyboard"),e.transformStart(0,-1*n.getDirectionFactor()),e.markEndSource()}},xye={name:"moveCellSelectionRight",callback(n){const{selection:e}=n;e.markSource("keyboard"),e.transformStart(0,n.getDirectionFactor()),e.markEndSource()}},Lye={name:"moveCellSelectionToMostBottom",callback(n){const{selection:e}=n,{col:t}=n.getSelectedRangeActive().highlight;let r=n.rowIndexMapper.getNearestNotHiddenIndex(n.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(n._createCellCoords(r,t))}},Hye={name:"moveCellSelectionToMostBottomInlineEnd",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:r}=n,i=parseInt(n.getSettings().fixedRowsBottom,10),s=t.getNearestNotHiddenIndex(n.countRows()-i-1,-1),o=r.getNearestNotHiddenIndex(n.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(n._createCellCoords(s,o)),e.markEndSource()}},Dye={name:"moveCellSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n;e.markSource("keyboard"),e.setRangeStart(n._createCellCoords(n.getSelectedRangeActive().highlight.row,t.getNearestNotHiddenIndex(n.countCols()-1,-1))),e.markEndSource()}},Fye={name:"moveCellSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,r=parseInt(n.getSettings().fixedColumnsStart,10),i=n.getSelectedRangeActive().highlight.row,s=t.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(n._createCellCoords(i,s)),e.markEndSource()}},kye={name:"moveCellSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,r=n.getSelectedRangeActive().highlight.row;let i=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]);i===null&&(i=n.isRtl()?-1:-n.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(n._createCellCoords(r,i)),e.markEndSource()}},Vye={name:"moveCellSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{row:r}=n.getSelectedRangeActive().highlight;let i=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]);i===null&&(i=n.isRtl()?-n.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(n._createCellCoords(r,i)),e.markEndSource()}},$ye={name:"moveCellSelectionToMostTop",callback(n){const{selection:e}=n,{col:t}=n.getSelectedRangeActive().highlight;let r=n.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-n.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(n._createCellCoords(r,t)),e.markEndSource()}},Uye={name:"moveCellSelectionToMostTopInlineStart",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:r}=n,i=parseInt(n.getSettings().fixedRowsTop,10),s=parseInt(n.getSettings().fixedColumnsStart,10),o=t.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(s,1);e.markSource("keyboard"),e.setRangeStart(n._createCellCoords(o,a)),e.markEndSource()}},Bye={name:"moveCellSelectionUp",callback(n){let{selection:e}=n;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Wye={name:"moveCellSelectionUpByViewportHight",callback(n){const{selection:e}=n,{navigableHeaders:t}=n.getSettings(),r=t?n.countColHeaders():0,{row:i}=n.getSelectedRangeActive().highlight;let s=n.countVisibleRows()+r;s=s===0?-1:-s,i===-r?s=-1:i+s<r&&(s=-(i+r)),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),n.getSelectedRangeActive().highlight.row<0&&n.scrollViewportTo({row:0})}};function jye(){return[Mye,Iye,Oye,_ye,Pye,xye,Lye,Hye,Dye,Fye,kye,Vye,$ye,Uye,Bye,Wye]}const zye={name:"emptySelectedCells",callback(n){n.emptySelectedCells(),n._getEditorManager().prepareEditor()}},Gye={name:"scrollToFocusedCell",callback(n){const{highlight:e}=n.getSelectedRangeActive(),t=n.getFirstFullyVisibleRow()-1,r=n.getFirstFullyVisibleColumn()-1,i=n.getLastFullyVisibleRow()+1,s=n.getLastFullyVisibleColumn()+1,o=n._createCellCoords(t,r),a=n._createCellCoords(i,s);if(!n._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(n.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(n.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}n.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Yye={name:"selectAllCells",callback(n){let{selection:e}=n;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Kye={name:"selectAllCellsAndHeaders",callback(n){let{selection:e}=n;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Xye={name:"populateSelectedCellsData",callback(n){const e=n.getSelectedRange(),{row:t,col:r}=e[e.length-1].highlight.normalize(),i=n.getDataAtCell(t,r),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==t||l!==r)){const{readOnly:u}=n.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,i])}});n.setDataAtCell(Array.from(s.values()))}},qye=[...dye(),...Nye(),...jye(),zye,Gye,Yye,Kye,Xye];function O9(n){const e={};return qye.forEach(t=>{let{name:r,callback:i}=t;e[r]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(n,...o)}}),e}function Qye(n){const e=n.getShortcutManager().addContext("editor"),t=O9(n),r={group:od};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>t.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>t.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:n.getShortcutManager().getContext("grid"),callback:(i,s)=>t.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>t.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],r)}function Zye(n){const e=n.getShortcutManager().addContext("grid"),t=O9(n),r={runOnlyIf:()=>{const{navigableHeaders:i}=n.getSettings();return Re(n.getSelected())&&(i||!i&&n.countRenderedRows()>0&&n.countRenderedCols()>0)},group:I9};e.addShortcuts([{keys:[["F2"]],callback:i=>t.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>t.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:od,runOnlyIf:()=>Re(n.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells(),runOnlyIf:()=>{var i;return!((i=n.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=n.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=n.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=n.getSelectedRangeActive())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>t.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>t.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],r)}function Jye(n){[Zye,Qye].forEach(e=>e(n))}function _W(n,e,t){return(e=eSe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eSe(n){var e=tSe(n,"string");return typeof e=="symbol"?e:e+""}function tSe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const PW="handsontableEditor",nSe="handsontable";class vD extends gg{constructor(){super(...arguments),_W(this,"isFlippedVertically",!1),_W(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return nSe}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),hC(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&lr(l,o.handsontable),this.htOptions=l}beginEditing(e,t){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedActive()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,t,r)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,t=this.getEditedCellRect();let r=t.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getDropdownHeight(),s=e.getWorkspaceHeight()-r-t.height,o=i>s&&r>s+t.height;return o?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:o,spaceAbove:r,spaceBelow:s}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,t=this.getEditedCellRect();let r=t.start+t.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;r=Math.max(r+a,0)}const i=this.getDropdownWidth(),s=e.getWorkspaceWidth()-r+t.width,o=i>s&&r>s;return o?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:o,spaceInlineStart:r,spaceInlineEnd:s}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:t}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-t)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||this.close()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:PW,relativeToGroup:od,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||this.isFlippedVertically&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),la(o),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedActive()&&this.isFlippedVertically?a=o.countRows()-1:o.getSelectedActive()&&(this.isFlippedVertically?(l=o.getSelectedActive()[0],a=Math.max(0,l-1)):(l=o.getSelectedActive()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedActive()&&!this.isFlippedVertically)a=0;else if(o.getSelectedActive()){if(this.isFlippedVertically)a=o.getSelectedActive()[0]+1;else if(!this.isFlippedVertically){const u=o.countRows()-1;l=o.getSelectedActive()[0],a=Math.min(u,l+1)}}return i(a,s)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(PW)}}const Fe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:MT()?182:174,AUDIO_MUTE:MT()?181:173,AUDIO_UP:MT()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},rSe=[Fe.ALT,Fe.ARROW_DOWN,Fe.ARROW_LEFT,Fe.ARROW_RIGHT,Fe.ARROW_UP,Fe.AUDIO_DOWN,Fe.AUDIO_MUTE,Fe.AUDIO_UP,Fe.BACKSPACE,Fe.CAPS_LOCK,Fe.DELETE,Fe.END,Fe.ENTER,Fe.ESCAPE,Fe.F1,Fe.F2,Fe.F3,Fe.F4,Fe.F5,Fe.F6,Fe.F7,Fe.F8,Fe.F9,Fe.F10,Fe.F11,Fe.F12,Fe.F13,Fe.F14,Fe.F15,Fe.F16,Fe.F17,Fe.F18,Fe.F19,Fe.HOME,Fe.INSERT,Fe.MEDIA_NEXT,Fe.MEDIA_PLAY_PAUSE,Fe.MEDIA_PREV,Fe.MEDIA_STOP,Fe.NULL,Fe.NUM_LOCK,Fe.PAGE_DOWN,Fe.PAGE_UP,Fe.PAUSE,Fe.SCROLL_LOCK,Fe.SHIFT,Fe.TAB];function _9(n){return n===32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function wD(n){return rSe.includes(n)}function iSe(n){const e=[];return Kb()?e.push(Fe.COMMAND_LEFT,Fe.COMMAND_RIGHT,Fe.COMMAND_FIREFOX):e.push(Fe.CONTROL),e.includes(n)}function P9(n){return[Fe.CONTROL,Fe.COMMAND_LEFT,Fe.COMMAND_RIGHT,Fe.COMMAND_FIREFOX].includes(n)}function cv(n,e){const t=e.split("|");let r=!1;return k(t,i=>{if(n===Fe[i])return r=!0,!1}),r}const sSe=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:Fe,isCtrlKey:iSe,isCtrlMetaKey:P9,isFunctionKey:wD,isKey:cv,isPrintableChar:_9},Symbol.toStringTag,{value:"Module"})),oSe="base",aSe="htTextEllipsis";function fC(n,e,t,r,i,s,o){const a=o.ariaTags,l=[],u=[],c=[],h=[];o.className&&ee(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push(bW())):a&&c.push(bW()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(AW())):(u.push(o.invalidCellClassName),a&&c.push(AW()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),o.textEllipsis&&l.push(aSe),Me(e,u),ee(e,l),Kl(e,c),Pe(e,h)}fC.RENDERER_TYPE=oSe;const lSe="text";function Sc(n,e,t,r,i,s,o){fC.apply(this,[n,e,t,r,i,s,o]);let a=s;!a&&o.placeholder&&(a=o.placeholder),a=on(a),o.trimWhitespace&&(a=a.trim()),Xh(e,a)}Sc.RENDERER_TYPE=lSe;function Pt(n){return typeof n=="function"}function x9(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=0;const r={lastCallThrottled:!0};let i=null;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,t||(t=u,c=!0);const h=e-(u-t);return c?(r.lastCallThrottled=!1,n.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,n.apply(this,a),t=0,i=void 0},h)),r}return s}function uSe(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=x9(n,e);let i=t;function s(){i=t}function o(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,n.apply(this,l)):r.apply(this,l)}return o.clearHits=s,o}function gC(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,r;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{r=n.apply(this,o)},e),r}return i}function cSe(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=e;return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return Er(i,(u,c)=>c(u),r.apply(this,a))}}function yD(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.apply(this,t.concat(o))}}function L9(n){const e=n.length;function t(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o);let u;return l.length>=e?u=n.apply(this,l):u=t(l),u}}return t([])}function hSe(n){const e=n.length;function t(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o.reverse());let u;return l.length>=e?u=n.apply(this,l):u=t(l),u}}return t([])}function Xb(n,e,t,r,i,s,o,a){return Re(a)?n.call(e,t,r,i,s,o,a):Re(o)?n.call(e,t,r,i,s,o):Re(s)?n.call(e,t,r,i,s):Re(i)?n.call(e,t,r,i):Re(r)?n.call(e,t,r):Re(t)?n.call(e,t):n.call(e)}const dSe=Object.freeze(Object.defineProperty({__proto__:null,curry:L9,curryRight:hSe,debounce:gC,fastCall:Xb,isFunction:Pt,partial:yD,pipe:cSe,throttle:x9,throttleAfterHits:uSe},Symbol.toStringTag,{value:"Module"}));function fSe(n,e){H9(n,e),e.add(n)}function xW(n,e,t){H9(n,e),e.set(n,t)}function H9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hI(n,e,t){return(e=gSe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gSe(n){var e=mSe(n,"string");return typeof e=="symbol"?e:e+""}function mSe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function dI(n,e){return n.get(qc(n,e))}function qc(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const pSe="autocomplete";var fI=new WeakMap,LW=new WeakMap,Nc=new WeakSet;class SD extends vD{constructor(){super(...arguments),fSe(this,Nc),hI(this,"query",null),hI(this,"strippedChoices",[]),hI(this,"rawChoices",[]),xW(this,fI,this.hot.guid.slice(0,9)),xW(this,LW,gC(()=>{this.focus()},100))}static get EDITOR_TYPE(){return pSe}getValue(){const e=this.rawChoices.find(t=>{const r=this.stripValueIfNeeded(t);return(qc(Nc,this,Hv).call(this,r)?r.value:r)===this.TEXTAREA.value});return Re(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ee(this.htContainer,"autocompleteEditor"),ee(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[dwe(),swe(),J5("listbox"),vwe()])}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[Yo("false"),wwe(`${dI(fI,this)}-listbox-${e}-${t}`)]),this.htOptions={...this.htOptions,valueGetter:a=>qc(Nc,this,Hv).call(this,a)?a.value:a}}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:s,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",dI(LW,this)),this.htEditor.updateSettings({colWidths:e?[Xn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Sc(a,l,u,c,h,d,f);const{filteringCaseSensitive:m,allowHtml:g,locale:C}=this.cellProperties,y=this.query;let w=on(d),S,E;w&&!g&&(S=m===!0?w.indexOf(y):w.toLocaleLowerCase(C).indexOf(y.toLocaleLowerCase(C)),S!==-1&&(E=w.substr(S,y.length),w=w.replace(E,`<strong>${E}</strong>`))),t&&Pe(l,[owe(),...r?[Ewe(i)]:[],...r?[Rwe(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=w},afterSelectionEnd:(a,l)=>{if(t){const u=h=>{Pe(h,[tD()]),Pe(this.TEXTAREA,...ywe(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),t&&(Pe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Xu()),Pe(this.htEditor.rootElement,[Z5(),Swe("polite"),Cwe("text"),["id",`${dI(fI,this)}-listbox-${s}-${o}`]]),Pe(this.TEXTAREA,...Yo("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[Yo("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=cD(this.TEXTAREA),r=S9(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,o=this.stripValueIfNeeded(this.getValue()),a=qc(Nc,this,Hv).call(this,o)?o.value:o;let l=null,u=e;i||(u=u.toSorted());const c=[],h=this.cellProperties.locale,d=this.cellProperties.filteringCaseSensitive,f=d?a:a.toLocaleLowerCase(h);for(let m=0;m<u.length;m++){const g=qc(Nc,this,Hv).call(this,u[m])?NT(on(u[m].value)):NT(on(u[m]));if((d?g:g.toLocaleLowerCase(h)).indexOf(f)!==-1&&(c.push(m),s===!1))break}s===!1?l=c[0]:(u=c.map(m=>u[m]),l=u.indexOf(f)>-1?u.indexOf(f):0),this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(uy([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),hC(this.TEXTAREA,t,t===r?void 0:r)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:t,spaceAbove:r,spaceBelow:i}=e;return this.limitDropdownIfNeeded(t?r:i),e}limitDropdownIfNeeded(e){const t=this.getDropdownHeight();if(t>e){let r=0,i=0,s=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),r+=i;while(r<e);s=r-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-s}px`),this.setDropdownHeight(r-i)}}updateDropdownDimensions(){const e=C9(),t=this.getTargetEditorWidth()+e,r=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:t,height:r}),qc(Nc,this,HW).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),qc(Nc,this,HW).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const t=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:t},(i,s)=>s).reduce((i,s)=>{const o=this.hot.stylesHandler.getDefaultRowHeight()+(s===0?1:0);return i+o},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const t=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(t.borderInlineStartWidth,10)+parseInt(t.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,r=i=>on(t?i:NT(i));return e.every(i=>qc(Nc,this,Hv).call(this,i))?e.map(i=>({key:r(i.key),value:r(i.value)})):e.map(i=>r(i))}onBeforeKeyDown(e){if(_9(e.keyCode)||e.keyCode===Fe.BACKSPACE||e.keyCode===Fe.DELETE||e.keyCode===Fe.INSERT){let t=10;if(e.keyCode===Fe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}function HW(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+ar(this.hot.rootDocument)})}function Hv(n){return je(n)&&Re(n.key)&&Re(n.value)}const vSe="checkbox";class D9 extends uv{static get EDITOR_TYPE(){return vSe}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');Be(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ch=()=>window,Fo=()=>window.document,Lx=(n,e)=>window.setTimeout(n,e),Al=function(n,e,t,r){n.addEventListener(e,t,!!r)},pu=function(n,e,t,r){n.removeEventListener(e,t,!!r)},wSe=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},zs=function(n,e){return(" "+n.className+" ").indexOf(" "+e+" ")!==-1},gI=function(n,e){zs(n,e)||(n.className=n.className===""?e:n.className+" "+e)},mI=function(n,e){n.className=wSe((" "+n.className+" ").replace(" "+e+" "," "))},CD=function(n){return/Array/.test(Object.prototype.toString.call(n))},qs=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},ySe=function(n){let e=n.getDay();return e===0||e===6},SSe=function(n){return n%4===0&&n%100!==0||n%400===0},DW=function(n,e){return[31,SSe(n)?29:28,31,30,31,30,31,31,30,31,30,31][e]},fE=function(n){qs(n)&&n.setHours(0,0,0,0)},gE=function(n,e){return n.getTime()===e.getTime()},qb=function(n,e,t){let r,i;for(r in e)i=n[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?qs(e[r])?t&&(n[r]=new Date(e[r].getTime())):CD(e[r])?t&&(n[r]=e[r].slice(0)):n[r]=qb({},e[r],t):(t||!i)&&(n[r]=e[r]);return n},FW=function(n,e,t){let r=Fo().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=qb(r,t),n.dispatchEvent(r)},kW=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},sl={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},VW=function(n,e,t){for(e+=n.firstDay;e>=7;)e-=7;return t?n.i18n.weekdaysShort[e]:n.i18n.weekdays[e]},CSe=function(n){let e=[],t="false";if(n.isEmpty)if(n.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),n.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return n.isDisabled&&e.push("is-disabled"),n.isToday&&e.push("is-today"),n.isSelected&&(e.push("is-selected"),t="true"),n.hasEvent&&e.push("has-event"),n.isInRange&&e.push("is-inrange"),n.isStartRange&&e.push("is-startrange"),n.isEndRange&&e.push("is-endrange"),'<td data-day="'+n.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"</button></td>"},ESe=function(n,e){n.setHours(0,0,0,0);let t=n.getDate(),r=n.getDay(),i=e,s=i-1,o=7,a=function(d){return(d+o-1)%o};n.setDate(t+s-a(r));let l=new Date(n.getFullYear(),0,i),u=24*60*60*1e3,c=(n.getTime()-l.getTime())/u;return 1+Math.round((c-s+a(l.getDay()))/o)},RSe=function(n,e,t,r,i){let s=new Date(r,t,e);return'<td class="pika-week">'+(n.hasMoment?n.moment(s).isoWeek():ESe(s,i))+"</td>"},TSe=function(n,e,t,r){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?n.reverse():n).join("")+"</tr>"},bSe=function(n){return"<tbody>"+n.join("")+"</tbody>"},ASe=function(n){let e,t=[];for(n.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+VW(n,e)+'">'+VW(n,e,!0)+"</abbr></th>");return"<thead><tr>"+(n.isRTL?t.reverse():t).join("")+"</tr></thead>"},NSe=function(n,e,t,r,i,s){let o,a,l,u=n._o,c=t===u.minYear,h=t===u.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,m,g=!0,C=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(t===i?o-e:12+o-e)+'"'+(o===r?' selected="selected"':"")+(c&&o<u.minMonth||h&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",CD(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=t-u.yearRange,a=1+t+u.yearRange),l=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&l.push('<option value="'+o+'"'+(o===t?' selected="selected"':"")+">"+o+"</option>");return m='<div class="pika-label">'+t+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(r===0||u.minMonth>=r)&&(g=!1),h&&(r===11||u.maxMonth<=r)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===n._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},MSe=function(n,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+ASe(n)+bSe(e)+"</table>"};function Hx(n){let e=this,t=e.config(n);e._onMouseDown=function(i){if(!e._v)return;i=i||Ch().event;let s=i.target||i.srcElement;if(s)if(zs(s,"is-disabled")||(zs(s,"pika-button")&&!zs(s,"is-empty")&&!zs(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),t.bound&&Lx(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100)):zs(s,"pika-prev")?e.prevMonth():zs(s,"pika-next")&&e.nextMonth()),zs(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Ch().event;let s=i.target||i.srcElement;s&&(zs(s,"pika-select-month")?e.gotoMonth(s.value):zs(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||Ch().event,e.isVisible())switch(i.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let i=this.moment(t.field.value,t.format,t.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(t.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),qs(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Fo().activeElement;do if(zs(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=Lx(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Ch().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&zs(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),Al(s,"change",e._onChange)));do if(zs(o,"pika-single")||o===t.trigger)return;while(o=o.parentNode);e._v&&s!==t.trigger&&o!==t.trigger&&e.hide()}},e.el=Fo().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),Al(e.el,"mousedown",e._onMouseDown,!0),Al(e.el,"touchend",e._onMouseDown,!0),Al(e.el,"change",e._onChange),t.keyboardInput&&Al(Fo(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?Fo().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),Al(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let r=t.defaultDate;qs(r)?t.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",Al(t.trigger,"click",e._onInputClick),Al(t.trigger,"focus",e._onInputFocus),Al(t.trigger,"blur",e._onInputBlur)):this.show()}Hx.prototype={config:function(n){this._o||(this._o=qb({},sl,!0));let e=qb(this._o,n,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,qs(e.minDate)||(e.minDate=!1),qs(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),CD(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||sl.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,qs(this._d)?this._o.toString?this._o.toString(this._d,n):this.hasMoment?this.moment(this._d).format(n):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(n,e){this.hasMoment&&this.moment.isMoment(n)&&this.setDate(n.toDate(),e)},useMoment:function(n){this.hasMoment=!0,this.moment=n},getDate:function(){return qs(this._d)?new Date(this._d.getTime()):null},setDate:function(n,e){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",FW(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),!qs(n))return;let t=this._o.minDate,r=this._o.maxDate;qs(t)&&n<t?n=t:qs(r)&&n>r&&(n=r),this._d=new Date(n.getTime()),fE(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),FW(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(n){let e=!0;if(qs(n)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=n.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<t.getTime()||r.getTime()<i}e&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,e){let t=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;n==="add"?i=new Date(t.valueOf()+r):n==="subtract"&&(i=new Date(t.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=kW(this.calendars[0]);for(let n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=kW({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(fE(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=sl.minDate,this._o.minYear=sl.minYear,this._o.minMonth=sl.minMonth,this._o.startRange=sl.startRange),this.draw()},setMaxDate:function(n){n instanceof Date?(fE(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=sl.maxDate,this._o.maxYear=sl.maxYear,this._o.maxMonth=sl.maxMonth,this._o.endRange=sl.endRange),this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){if(!this._v&&!n)return;let e=this._o,t=e.minYear,r=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=t&&(this._y=t,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+NSe(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&Lx(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let n,e,t,r,i,s,o,a,l,u,c;this._o.container||(this.el.style.position="absolute",n=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,r=Ch().innerWidth||Fo().documentElement.clientWidth,i=Ch().innerHeight||Fo().documentElement.clientHeight,s=Fo().body.scrollTop||Fo().documentElement.scrollTop,u=!0,c=!0,l=n.getBoundingClientRect(),o=l.left+Ch().pageXOffset,a=l.bottom+Ch().pageYOffset,(this._o.reposition&&o+e>r||this._o.position.indexOf("right")>-1&&o-e+n.offsetWidth>0)&&(o=o-e+n.offsetWidth,u=!1),(this._o.reposition&&a+t>i+s||this._o.position.indexOf("top")>-1&&a-t-n.offsetHeight>0)&&(a=a-t-n.offsetHeight,c=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",gI(this.el,u?"left-aligned":"right-aligned"),gI(this.el,c?"bottom-aligned":"top-aligned"),mI(this.el,u?"right-aligned":"left-aligned"),mI(this.el,c?"top-aligned":"bottom-aligned"))},render:function(n,e,t){let r=this._o,i=new Date,s=DW(n,e),o=new Date(n,e,1).getDay(),a=[],l=[];fE(i),r.firstDay>0&&(o-=r.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?n-1:n,d=e===11?n+1:n,f=DW(h,u),m=s+o,g=m;for(;g>7;)g-=7;m+=7-g;let C=!1;for(let y=0,w=0;y<m;y++){let S=new Date(n,e,1+(y-o)),E=qs(this._d)?gE(S,this._d):!1,P=gE(S,i),_=r.events.indexOf(S.toDateString())!==-1,I=y<o||y>=s+o,D=1+(y-o),Q=e,F=n,J=r.startRange&&gE(r.startRange,S),q=r.endRange&&gE(r.endRange,S),ie=r.startRange&&r.endRange&&r.startRange<S&&S<r.endRange,fe=r.minDate&&S<r.minDate||r.maxDate&&S>r.maxDate||r.disableWeekends&&ySe(S)||r.disableDayFn&&r.disableDayFn(S);I&&(y<o?(D=f+D,Q=u,F=h):(D=D-s,Q=c,F=d));let Ee={day:D,month:Q,year:F,hasEvent:_,isSelected:E,isToday:P,isDisabled:fe,isEmpty:I,isStartRange:J,isEndRange:q,isInRange:ie,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&E&&(C=!0),l.push(CSe(Ee)),++w===7&&(r.showWeekNumber&&l.unshift(RSe(this,y-o,e,n,r.firstWeekOfYearMinDays)),a.push(TSe(l,r.isRTL,r.pickWholeWeek,C)),l=[],w=0,C=!1)}return MSe(r,a,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),mI(this.el,"is-hidden"),this._o.bound&&(Al(Fo(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let n=this._v;n!==!1&&(this._o.bound&&pu(Fo(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),gI(this.el,"is-hidden"),this._v=!1,n!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let n=this._o;this.hide(),pu(this.el,"mousedown",this._onMouseDown,!0),pu(this.el,"touchend",this._onMouseDown,!0),pu(this.el,"change",this._onChange),n.keyboardInput&&pu(Fo(),"keydown",this._onKeyChange),n.field&&(pu(n.field,"change",this._onInputChange),n.bound&&(pu(n.trigger,"click",this._onInputClick),pu(n.trigger,"focus",this._onInputFocus),pu(n.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function ISe(n,e){OSe(n,e),e.add(n)}function OSe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $W(n,e,t){return(e=_Se(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _Se(n){var e=PSe(n,"string");return typeof e=="symbol"?e:e+""}function PSe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function pI(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const F9="date",UW="dateEditor",xSe="DD/MM/YYYY";var mE=new WeakSet;class k9 extends gg{constructor(){super(...arguments),ISe(this,mE),$W(this,"parentDestroyed",!1),$W(this,"$datePicker",null)}static get EDITOR_TYPE(){return F9}init(){if(typeof se!="function")throw new Error("You need to include moment.js to your project.");if(typeof Hx!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ee(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Be(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:UW})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(UW),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=pI(mE,this,vI).call(this),r=this.hot.view.isMouseDown(),i=e?wD(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new Hx(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(se),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,se(s,t,!0).isValid()&&this.$datePicker.setMoment(se(s,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,se(s,t,!0).isValid()&&this.$datePicker.setMoment(se(s,t),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const t=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&lC(r,this.cellProperties.datePickerConfig);const i=r.onSelect,s=r.onClose;return r.field=t,r.trigger=t,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:pI(mE,this,vI).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=se(a).format(pI(mE,this,vI).call(this))),this.setValue(a),i&&i(),Ua()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},r}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==zn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(t=s.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,a=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+or(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Xn(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function vI(){var n;return(n=this.cellProperties.dateFormat)!==null&&n!==void 0?n:xSe}const LSe="dropdown";class V9 extends SD{static get EDITOR_TYPE(){return LSe}prepare(e,t,r,i,s,o){o.filter=!1,o.strict=!0,super.prepare(e,t,r,i,s,o)}}const HSe="numeric";class $9 extends gg{static get EDITOR_TYPE(){return HSe}}function DSe(n,e,t){return(e=FSe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FSe(n){var e=kSe(n,"string");return typeof e=="symbol"?e:e+""}function kSe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const VSe="password";class U9 extends gg{constructor(){super(...arguments),DSe(this,"autoResize",M9(this.hot.rootDocument,{textContent:e=>"".repeat(e.value.length)}))}static get EDITOR_TYPE(){return VSe}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Jl(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...ys(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const wI="ht_editor_visible",BW="selectEditor",$Se="select";class B9 extends uv{static get EDITOR_TYPE(){return $Se}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),t=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",t&&e.setAttribute(...fg()),e.appendChild(this.hot.rootDocument.createTextNode("")),ee(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Be(this.selectWrapper,wI)&&Me(this.selectWrapper,wI),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Jl(this.select),ct(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,sd(h,u),this.select.appendChild(h)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)t[e[r]]=e[r];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==zn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:r,height:i}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${i}px`,s.width=`${r}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${t}px`,s.margin="0px",ee(this.selectWrapper,wI)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={group:BW};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(BW)}}const USe="time";class W9 extends gg{static get EDITOR_TYPE(){return USe}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.TEXTAREA.dir="ltr"}}function wt(){Re(console)&&console.warn(...arguments)}function j9(n){Re(console)&&console.warn(`Deprecated: ${n}`)}function ED(){Re(console)&&console.error(...arguments)}const ff=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],yI=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),SI=new Map([[]]);function BSe(n,e){z9(n,e),e.add(n)}function CI(n,e,t){z9(n,e),e.set(n,t)}function z9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WW(n,e,t){return n.set(Qb(n,e),t),t}function ei(n,e){return n.get(Qb(n,e))}function Qb(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const WSe=100;var Gs=new WeakMap,mm=new WeakMap,EI=new WeakMap,RI=new WeakSet;class jW{constructor(){BSe(this,RI),CI(this,Gs,new Map),CI(this,mm,new Map),CI(this,EI,new Set),ff.forEach(e=>Qb(RI,this,zW).call(this,e))}getHooks(e){var t;return(t=ei(Gs,this).get(e))!==null&&t!==void 0?t:[]}add(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ei(Gs,this).has(e)||(Qb(RI,this,zW).call(this,e),ff.push(e));const i=ei(Gs,this).get(e);if(i.find(u=>u.callback===t))return;const s=Number.isInteger(r.orderIndex)?r.orderIndex:0,o=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=t,l=!0)}if(!l){i.push({callback:t,orderIndex:s,runOnce:o,initialHook:a,skip:!1});let u=ei(EI,this).has(e);!u&&s!==0&&(u=!0,ei(EI,this).add(e)),u&&i.length>1&&ei(Gs,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return ei(Gs,this).has(e)&&ei(Gs,this).get(e).length>0}remove(e,t){if(!ei(Gs,this).has(e))return!1;const r=ei(Gs,this).get(e),i=r.find(s=>s.callback===t);if(i){let s=ei(mm,this).get(e);return i.skip=!0,s+=1,s>WSe&&(ei(Gs,this).set(e,r.filter(o=>!o.skip)),s=0),ei(mm,this).set(e,s),!0}return!1}destroy(){ei(Gs,this).clear(),ei(mm,this).clear(),WW(Gs,this,null),WW(mm,this,null)}}function zW(n){ei(Gs,this).set(n,[]),ei(mm,this).set(n,0)}function jSe(n,e,t){return(e=zSe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zSe(n){var e=GSe(n,"string");return typeof e=="symbol"?e:e+""}function GSe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const YSe=Lt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class we{constructor(){jSe(this,"globalBucket",new jW)}static getSingleton(){return XSe()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new jW),e.pluginHookBucket):this.globalBucket}add(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?k(t,s=>this.add(e,s,r)):(yI.has(e)&&wt(QA(YSe,{hookName:e,removedInVersion:yI.get(e)})),SI.has(e)&&wt(SI.get(e)),this.getBucket(r).add(e,t,{orderIndex:i,runOnce:!1})),this}once(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?k(t,s=>this.once(e,s,r)):this.getBucket(r).add(e,t,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(t)?k(t,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,t,{initialHook:!0}),this}remove(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,t)}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(t).has(e)}run(e,t,r,i,s,o,a,l){{const u=this.getBucket().getHooks(t),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Xb(u[h].callback,e,r,i,s,o,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(t,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(t),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Xb(u[h].callback,e,r,i,s,o,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(t,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||ff.push(e)}deregister(e){this.isRegistered(e)&&ff.splice(ff.indexOf(e),1)}isDeprecated(e){return SI.has(e)||yI.has(e)}isRegistered(e){return ff.indexOf(e)>=0}getRegistered(){return ff}}const KSe=new we;function XSe(){return KSe}const Tf=new Map;function ua(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Tf.has(n)||Tf.set(n,new Map);const e=Tf.get(n);function t(l,u){e.set(l,u)}function r(l){return e.get(l)}function i(l){return e.has(l)}function s(){return[...e.keys()]}function o(){return[...e.values()]}function a(){Tf.delete(n),e.clear()}return{register:t,getItem:r,hasItem:i,getNames:s,getValues:o,clear:a}}function qSe(n,e){var t;return Tf==null||(t=Tf.get(n.guid))===null||t===void 0?void 0:t.get(e)}const Dx=new WeakMap,{register:QSe,getItem:G9,hasItem:Y9,getNames:ZSe,getValues:EKe}=ua("editors");function JSe(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new t(r)),e[r.guid]},we.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function K9(n,e){let t;if(typeof n=="function")Dx.get(n)||cs(null,n),t=Dx.get(n);else if(typeof n=="string")t=G9(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function Zb(n){if(typeof n=="function")return n;if(!Y9(n))throw Error(`No registered editor found under "${n}" name`);return G9(n).getConstructor()}function cs(n,e){n&&typeof n!="string"&&(e=n,n=e.EDITOR_TYPE);const t=new JSe(e);typeof n=="string"&&QSe(n,t),Dx.set(e,t)}function eCe(){cs(uv),cs(SD),cs(D9),cs(k9),cs(V9),cs(vD),cs($9),cs(U9),cs(B9),cs(gg),cs(W9)}const tCe="html";function RD(n,e,t,r,i,s,o){fC.apply(this,[n,e,t,r,i,s,o]),sd(e,s??"",!1)}RD.RENDERER_TYPE=tCe;const nCe="autocomplete";function hv(n,e,t,r,i,s,o){const{rootDocument:a}=n,l=o.allowHtml?RD:Sc,u=a.createElement("DIV"),c=n.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...fg()),u.appendChild(a.createTextNode("")),l.apply(this,[n,e,t,r,i,s,o]),e.firstChild||e.appendChild(a.createTextNode("")),e.insertBefore(u,e.firstChild),ee(e,"htAutocomplete"),!n.acArrowListener){const h=new Zo(n);n.acArrowListener=function(d){Be(d.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,r),e)},h.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{h.destroy()})}}hv.RENDERER_TYPE=nCe;const rCe="dropdown";function TD(n,e,t,r,i,s,o){hv.apply(this,[n,e,t,r,i,s,o])}TD.RENDERER_TYPE=rCe;const X9="ContextMenu:items",Je=X9,bD=`${Je}.noItems`,AD=`${Je}.insertRowAbove`,ND=`${Je}.insertRowBelow`,MD=`${Je}.insertColumnOnTheLeft`,ID=`${Je}.insertColumnOnTheRight`,OD=`${Je}.removeRow`,_D=`${Je}.removeColumn`,PD=`${Je}.undo`,xD=`${Je}.redo`,Jb=`${Je}.readOnly`,LD=`${Je}.clearColumn`,HD=`${Je}.copy`,DD=`${Je}.copyWithHeaders`,FD=`${Je}.copyWithGroupHeaders`,kD=`${Je}.copyHeadersOnly`,VD=`${Je}.cut`,$D=`${Je}.freezeColumn`,UD=`${Je}.unfreezeColumn`,BD=`${Je}.mergeCells`,WD=`${Je}.unmergeCells`,jD=`${Je}.addComment`,zD=`${Je}.editComment`,GD=`${Je}.removeComment`,YD=`${Je}.readOnlyComment`,KD=`${Je}.align`,XD=`${Je}.align.left`,qD=`${Je}.align.center`,QD=`${Je}.align.right`,ZD=`${Je}.align.justify`,JD=`${Je}.align.top`,eF=`${Je}.align.middle`,tF=`${Je}.align.bottom`,nF=`${Je}.borders`,rF=`${Je}.borders.top`,iF=`${Je}.borders.right`,sF=`${Je}.borders.bottom`,oF=`${Je}.borders.left`,aF=`${Je}.borders.remove`,lF=`${Je}.nestedHeaders.insertChildRow`,uF=`${Je}.nestedHeaders.detachFromParent`,cF=`${Je}.hideColumn`,hF=`${Je}.showColumn`,dF=`${Je}.hideRow`,fF=`${Je}.showRow`,Zi="Filters:",Vn=`${Zi}conditions`,sN=`${Vn}.none`,gF=`${Vn}.isEmpty`,mF=`${Vn}.isNotEmpty`,pF=`${Vn}.isEqualTo`,vF=`${Vn}.isNotEqualTo`,wF=`${Vn}.beginsWith`,yF=`${Vn}.endsWith`,SF=`${Vn}.contains`,CF=`${Vn}.doesNotContain`,iCe=`${Vn}.byValue`,EF=`${Vn}.greaterThan`,RF=`${Vn}.greaterThanOrEqualTo`,TF=`${Vn}.lessThan`,bF=`${Vn}.lessThanOrEqualTo`,AF=`${Vn}.isBetween`,NF=`${Vn}.isNotBetween`,MF=`${Vn}.after`,IF=`${Vn}.before`,OF=`${Vn}.today`,_F=`${Vn}.tomorrow`,PF=`${Vn}.yesterday`,xF=`${Zi}labels.filterByCondition`,LF=`${Zi}labels.filterByValue`,HF=`${Zi}labels.conjunction`,oN=`${Zi}labels.disjunction`,e0=`${Zi}values.blankCells`,DF=`${Zi}buttons.selectAll`,FF=`${Zi}buttons.clear`,kF=`${Zi}buttons.ok`,VF=`${Zi}buttons.cancel`,$F=`${Zi}buttons.placeholder.search`,UF=`${Zi}buttons.placeholder.value`,BF=`${Zi}buttons.placeholder.secondValue`,uu="Pagination:",WF=`${uu}section.pagination`,jF=`${uu}.pageSize.auto`,t0=`${uu}section.pageSize`,zF=`${uu}section.counter`,GF=`${uu}section.navigation`,YF=`${uu}firstPage`,KF=`${uu}prevPage`,XF=`${uu}nextPage`,qF=`${uu}lastPage`,QF="CheckboxRenderer:",ZF=`${QF}checked`,JF=`${QF}unchecked`,q9="Loading:",ek=`${q9}title`,sCe=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:ZF,CHECKBOX_RENDERER_NAMESPACE:QF,CHECKBOX_UNCHECKED:JF,CONTEXTMENU_ITEMS_ADD_COMMENT:jD,CONTEXTMENU_ITEMS_ALIGNMENT:KD,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:tF,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:qD,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:ZD,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:XD,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:eF,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:QD,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:JD,CONTEXTMENU_ITEMS_BORDERS:nF,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:sF,CONTEXTMENU_ITEMS_BORDERS_LEFT:oF,CONTEXTMENU_ITEMS_BORDERS_RIGHT:iF,CONTEXTMENU_ITEMS_BORDERS_TOP:rF,CONTEXTMENU_ITEMS_CLEAR_COLUMN:LD,CONTEXTMENU_ITEMS_COPY:HD,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:kD,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:FD,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:DD,CONTEXTMENU_ITEMS_CUT:VD,CONTEXTMENU_ITEMS_EDIT_COMMENT:zD,CONTEXTMENU_ITEMS_FREEZE_COLUMN:$D,CONTEXTMENU_ITEMS_HIDE_COLUMN:cF,CONTEXTMENU_ITEMS_HIDE_ROW:dF,CONTEXTMENU_ITEMS_INSERT_LEFT:MD,CONTEXTMENU_ITEMS_INSERT_RIGHT:ID,CONTEXTMENU_ITEMS_MERGE_CELLS:BD,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:uF,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:lF,CONTEXTMENU_ITEMS_NO_ITEMS:bD,CONTEXTMENU_ITEMS_READ_ONLY:Jb,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:YD,CONTEXTMENU_ITEMS_REDO:xD,CONTEXTMENU_ITEMS_REMOVE_BORDERS:aF,CONTEXTMENU_ITEMS_REMOVE_COLUMN:_D,CONTEXTMENU_ITEMS_REMOVE_COMMENT:GD,CONTEXTMENU_ITEMS_REMOVE_ROW:OD,CONTEXTMENU_ITEMS_ROW_ABOVE:AD,CONTEXTMENU_ITEMS_ROW_BELOW:ND,CONTEXTMENU_ITEMS_SHOW_COLUMN:hF,CONTEXTMENU_ITEMS_SHOW_ROW:fF,CONTEXTMENU_ITEMS_UNDO:PD,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:UD,CONTEXTMENU_ITEMS_UNMERGE_CELLS:WD,CONTEXT_MENU_ITEMS_NAMESPACE:X9,FILTERS_BUTTONS_CANCEL:VF,FILTERS_BUTTONS_CLEAR:FF,FILTERS_BUTTONS_OK:kF,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:$F,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:BF,FILTERS_BUTTONS_PLACEHOLDER_VALUE:UF,FILTERS_BUTTONS_SELECT_ALL:DF,FILTERS_CONDITIONS_AFTER:MF,FILTERS_CONDITIONS_BEFORE:IF,FILTERS_CONDITIONS_BEGINS_WITH:wF,FILTERS_CONDITIONS_BETWEEN:AF,FILTERS_CONDITIONS_BY_VALUE:iCe,FILTERS_CONDITIONS_CONTAINS:SF,FILTERS_CONDITIONS_EMPTY:gF,FILTERS_CONDITIONS_ENDS_WITH:yF,FILTERS_CONDITIONS_EQUAL:pF,FILTERS_CONDITIONS_GREATER_THAN:EF,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:RF,FILTERS_CONDITIONS_LESS_THAN:TF,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:bF,FILTERS_CONDITIONS_NAMESPACE:Vn,FILTERS_CONDITIONS_NONE:sN,FILTERS_CONDITIONS_NOT_BETWEEN:NF,FILTERS_CONDITIONS_NOT_CONTAIN:CF,FILTERS_CONDITIONS_NOT_EMPTY:mF,FILTERS_CONDITIONS_NOT_EQUAL:vF,FILTERS_CONDITIONS_TODAY:OF,FILTERS_CONDITIONS_TOMORROW:_F,FILTERS_CONDITIONS_YESTERDAY:PF,FILTERS_DIVS_FILTER_BY_CONDITION:xF,FILTERS_DIVS_FILTER_BY_VALUE:LF,FILTERS_LABELS_CONJUNCTION:HF,FILTERS_LABELS_DISJUNCTION:oN,FILTERS_NAMESPACE:Zi,FILTERS_VALUES_BLANK_CELLS:e0,LOADING_NAMESPACE:q9,LOADING_TITLE:ek,PAGINATION_COUNTER_SECTION:zF,PAGINATION_FIRST_PAGE:YF,PAGINATION_LAST_PAGE:qF,PAGINATION_NAMESPACE:uu,PAGINATION_NAV_SECTION:GF,PAGINATION_NEXT_PAGE:XF,PAGINATION_PAGE_SIZE_AUTO:jF,PAGINATION_PAGE_SIZE_SECTION:t0,PAGINATION_PREV_PAGE:KF,PAGINATION_SECTION:WF},Symbol.toStringTag,{value:"Module"})),GW=new WeakMap,YW=new WeakMap,oCe="htBadValue",Fp="data-row",kp="data-col",aCe="checkboxRenderer",Q9="checkbox";we.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:r,type:i,row:s,column:o,prop:a}=e;if(i===Q9){if(r){const{value:l,property:u}=r;let c=t;if(l)c=typeof l=="function"?l(s,o,a,t):l;else if(u){const h=this.getDataAtRowProp(s,u);c=h!==null?h:t}n=c}return n}});function tk(n,e,t,r,i,s,o){const{rootDocument:a}=n,l=n.getSettings().ariaTags;fC.apply(this,[n,e,t,r,i,s,o]),lCe(n);let u=uCe(a);const c=o.label;let h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Jl(e),s===o.checkedTemplate||on(s).toLocaleLowerCase(o.locale)===on(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||on(s).toLocaleLowerCase(o.locale)===on(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:Dn(s)?ee(u,"noValue"):(u.style.display="none",ee(u,oCe),h=!0),Pe(u,[[Fp,t],[kp,r]]),l&&Pe(u,[io(u.checked?n.getTranslatedPhrase(ZF):n.getTranslatedPhrase(JF)),n9(u.checked),awe()]),!h&&c){let g="";if(c.value)g=typeof c.value=="function"?c.value.call(this,t,r,i,s):c.value;else if(c.property){const y=n.getDataAtRowProp(t,c.property);g=y!==null?y:""}const C=cCe(a,g,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),GW.has(n)||(GW.set(n,!0),d());function d(){const C=n.getShortcutManager().getContext("grid"),y={group:aCe,relativeToGroup:od,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var w;return(w=n.getSelectedRangeActive())===null||w===void 0?void 0:w.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const w=n.getSelectedRangeActive();return n.getSettings().enterBeginsEditing&&(w==null?void 0:w.highlight.isCell())&&!n.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var w;return(w=n.getSelectedRangeActive())===null||w===void 0?void 0:w.highlight.isCell()}}],y)}function f(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=n.getSelectedRange(),y=[],w=new Map;let S=[],E=0;if(C){for(let P=0;P<C.length;P++){const{row:_,col:I}=C[P].getTopStartCorner(),{row:D,col:Q}=C[P].getBottomEndCorner();for(let F=_;F<=D;F+=1)for(let J=I;J<=Q;J+=1){const q=n.getCellMeta(F,J);if(q.hidden)continue;const ie={checkedTemplate:q.checkedTemplate,uncheckedTemplate:q.uncheckedTemplate};if(q.type!=="checkbox"){g===!0&&!q.readOnly&&(w.has(y.length)?w.set(y.length,[...w.get(y.length),[F,J,null]]):w.set(y.length,[[F,J,null]]));continue}if(q.readOnly===!0)continue;typeof q.checkedTemplate>"u"&&(q.checkedTemplate=!0),typeof q.uncheckedTemplate>"u"&&(q.uncheckedTemplate=!1);const fe=n.getDataAtCell(F,J);g===!1?[q.checkedTemplate,q.checkedTemplate.toString()].includes(fe)?S.push([F,J,q.uncheckedTemplate,ie]):[q.uncheckedTemplate,q.uncheckedTemplate.toString(),null,void 0].includes(fe)&&S.push([F,J,q.checkedTemplate,ie]):S.push([F,J,q.uncheckedTemplate,ie]),E+=1}y.push(E),E=0}S.every(P=>{let[,,_]=P;return _===S[0][2]})?S=S.map(P=>{let[_,I,D]=P;return[_,I,D]}):S=S.map(P=>{let[_,I,,D]=P;return[_,I,D.checkedTemplate]}),S.length>0&&y.forEach((P,_)=>{let I=S.splice(0,P);w.size&&w.has(_)&&(I=[...I,...w.get(_)]),n.setDataAtCell(I)})}}function m(){const g=n.getSelectedRange();if(g){for(let C=0;C<g.length;C++){const y=g[C].getTopStartCorner(),w=g[C].getBottomEndCorner();for(let S=y.row;S<=w.row;S++)for(let E=y.col;E<=w.col;E++){if(n.getCellMeta(S,E).readOnly)continue;const _=n.getCell(S,E);if(Xl(_)&&_.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}tk.RENDERER_TYPE=Q9;function lCe(n){let e=YW.get(n);if(!e){const{rootElement:t}=n;e=new Zo(n),e.addEventListener(t,"click",r=>dCe(r,n)),e.addEventListener(t,"mouseup",r=>hCe(r,n)),e.addEventListener(t,"change",r=>fCe(r,n)),YW.set(n,e)}return e}function uCe(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function cCe(n,e,t){const r=n.createElement("label");r.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`;const i=n.createTextNode(e);if(t){const s=n.createElement("span");s.appendChild(i),r.appendChild(s)}else r.appendChild(i);return r.cloneNode(!0)}function hCe(n,e){const{target:t}=n;nk(t)&&(!t.hasAttribute(Fp)||!t.hasAttribute(kp)||setTimeout(e.listen,10))}function dCe(n,e){const{target:t}=n;if(!nk(t)||!t.hasAttribute(Fp)||!t.hasAttribute(kp))return;const r=parseInt(t.getAttribute(Fp),10),i=parseInt(t.getAttribute(kp),10);e.getCellMeta(r,i).readOnly&&n.preventDefault()}function fCe(n,e){const{target:t}=n;if(!nk(t)||!t.hasAttribute(Fp)||!t.hasAttribute(kp))return;const r=parseInt(t.getAttribute(Fp),10),i=parseInt(t.getAttribute(kp),10),s=e.getCellMeta(r,i);if(!s.readOnly){let o=null;n.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(r,i,o)}}function nk(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}const gCe="handsontable";function rk(n,e,t,r,i,s,o){hv.apply(this,[n,e,t,r,i,s,o])}rk.RENDERER_TYPE=gCe;var mCe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pCe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var TI,KW;function vCe(){return KW||(KW=1,TI={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(n){let e=n%10;return~~(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),TI}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var bI,XW;function Z9(){if(XW)return bI;XW=1;const n=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function t(l,u,c,h,d,f,m){if(!isNaN(+l))return+l;let g="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*t(C,u,c,h,d,f);for(let _=0;_<n.length;_++){let I=n[_];if(g=l.replace(RegExp(`([0-9 ])(${I.key})$`),"$1"),g!==l)return t(g,u,c,h,d,f)*I.factor}if(g=l.replace("%",""),g!==l)return t(g,u,c,h,d,f)/100;let y=parseFloat(l);if(isNaN(y))return;let w=h(y);if(w&&w!=="."&&(g=l.replace(new RegExp(`${e(w)}$`),""),g!==l))return t(g,u,c,h,d,f);let S={};Object.keys(f).forEach(_=>{S[f[_]]=_});let E=Object.keys(S).sort().reverse(),P=E.length;for(let _=0;_<P;_++){let I=E[_],D=S[I];if(g=l.replace(I,""),g!==l){let Q;switch(D){case"thousand":Q=Math.pow(10,3);break;case"million":Q=Math.pow(10,6);break;case"billion":Q=Math.pow(10,9);break;case"trillion":Q=Math.pow(10,12);break}return t(g,u,c,h,d,f)*Q}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,m){if(l==="")return;if(l===d)return 0;let g=r(l,u,c);return t(g,u,c,h,d,f)}function s(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],m=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(m)}function o(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=ok();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),m=c.getZeroFormat(),g=c.currentAbbreviations(),C;if(typeof l=="string")s(l,h)?C=o(l):C=i(l,h,d,f,m,g);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return bI={unformat:a},bI}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var AI,qW;function ik(){if(qW)return AI;qW=1;let n=Z9();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,t=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],s=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:t},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,y)=>y.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,y)=>y.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,y)=>!y.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,y)=>y.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(C,y){let w=d(C),S=m(y);return w&&S}function d(C){return n.unformat(C)!==void 0}function f(C,y,w,S=!1){let E=Object.keys(C).map(P=>{if(!y[P])return console.error(`${w} Invalid key: ${P}`),!1;let _=C[P],I=y[P];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!f(_,u,`[Validate ${P}]`,!0))return!1}else if(typeof _!==I.type)return console.error(`${w} ${P} type mismatched: "${I.type}" expected, "${typeof _}" provided`),!1;if(I.restrictions&&I.restrictions.length){let D=I.restrictions.length;for(let Q=0;Q<D;Q++){let{restriction:F,message:J}=I.restrictions[Q];if(!F(_,C))return console.error(`${w} ${P} invalid value: ${J}`),!1}}return I.restriction&&!I.restriction(_,C)?(console.error(`${w} ${P} invalid value: ${I.message}`),!1):I.validValues&&I.validValues.indexOf(_)===-1?(console.error(`${w} ${P} invalid value: must be among ${JSON.stringify(I.validValues)}, "${_}" provided`),!1):!(I.children&&!f(_,I.children,`[Validate ${P}]`))});return S||E.push(...Object.keys(y).map(P=>{let _=y[P];if(typeof _=="string"&&(_={type:_}),_.mandatory){let I=_.mandatory;if(typeof I=="function"&&(I=I(C)),I&&C[P]===void 0)return console.error(`${w} Missing mandatory key "${P}"`),!1}return!0})),E.reduce((P,_)=>P&&_,!0)}function m(C){return f(C,u,"[Validate format]")}function g(C){return f(C,c,"[Validate language]")}return AI={validate:h,validateFormat:m,validateInput:d,validateLanguage:g},AI}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function wCe(n,e){let t=n.match(/^{([^}]*)}/);return t?(e.prefix=t[1],n.slice(t[0].length)):n}function yCe(n,e){let t=n.match(/{([^}]*)}$/);return t?(e.postfix=t[1],n.slice(0,-t[0].length)):n}function SCe(n,e){if(n.indexOf("$")!==-1){e.output="currency";return}if(n.indexOf("%")!==-1){e.output="percent";return}if(n.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(n.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(n.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(n.indexOf(":")!==-1){e.output="time";return}n.indexOf("o")!==-1&&(e.output="ordinal")}function CCe(n,e){n.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function ECe(n,e){n.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function RCe(n,e){let t=n.match(/[1-9]+[0-9]*/);t&&(e.totalLength=+t[0])}function TCe(n,e){let r=n.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function bCe(n,e){let t=n.split(".")[1];if(t){let r=t.match(/0+/);r&&(e.mantissa=r[0].length)}}function ACe(n,e){const t=n.split(".")[1];t&&(e.trimMantissa=t.indexOf("[")!==-1)}function NCe(n,e){n.indexOf("a")!==-1&&(e.average=!0)}function MCe(n,e){n.indexOf("K")!==-1?e.forceAverage="thousand":n.indexOf("M")!==-1?e.forceAverage="million":n.indexOf("B")!==-1?e.forceAverage="billion":n.indexOf("T")!==-1&&(e.forceAverage="trillion")}function ICe(n,e){n.match(/\[\.]/)?e.optionalMantissa=!0:n.match(/\./)&&(e.optionalMantissa=!1)}function OCe(n,e){if(n.indexOf(".")!==-1){let t=n.split(".")[0];e.optionalCharacteristic=t.indexOf("0")===-1}}function _Ce(n,e){n.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),n.match(/^\+?-/)&&(e.negative="sign")}function PCe(n,e){n.match(/^\+/)&&(e.forceSign=!0)}function xCe(n,e={}){return typeof n!="string"?n:(n=wCe(n,e),n=yCe(n,e),SCe(n,e),RCe(n,e),TCe(n,e),OCe(n,e),NCe(n,e),MCe(n,e),bCe(n,e),ICe(n,e),ACe(n,e),CCe(n,e),ECe(n,e),_Ce(n,e),PCe(n,e),e)}var sk={parseFormat:xCe};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var NI,QW;function ok(){if(QW)return NI;QW=1;const n=vCe(),e=ik(),t=sk;let r={},i,s={},o=null,a={};function l(c){i=c}function u(){return s[i]}return r.languages=()=>Object.assign({},s),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=t.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>o,r.setZeroFormat=c=>o=typeof c=="string"?c:null,r.hasZeroFormat=()=>o!==null,r.languageData=c=>{if(c){if(s[c])return s[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");s[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=n.languageTag)=>{if(!s[c]){let d=c.split("-")[0],f=Object.keys(s).find(m=>m.split("-")[0]===d);if(!s[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(n),i=n.languageTag,NI=r,NI}function LCe(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function HCe(n,e){n.forEach(t=>{let r;try{r=LCe(`../languages/${t}`)}catch{console.error(`Unable to load "${t}". No matching language file found.`)}r&&e.registerLanguage(r)})}var DCe=n=>({loadLanguagesInNode:e=>HCe(e,n)}),J9={exports:{}};(function(n){(function(e){var t,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function m(_){var I,D,Q,F=v.prototype={constructor:v,toString:null,valueOf:null},J=new v(1),q=20,ie=4,fe=-7,Ee=21,ke=-1e7,be=1e7,re=!1,ae=1,le=0,ye={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},ze="0123456789abcdefghijklmnopqrstuvwxyz",et=!0;function v(T,N){var L,V,x,U,Y,$,j,K,G=this;if(!(G instanceof v))return new v(T,N);if(N==null){if(T&&T._isBigNumber===!0){G.s=T.s,!T.c||T.e>be?G.c=G.e=null:T.e<ke?G.c=[G.e=0]:(G.e=T.e,G.c=T.c.slice());return}if(($=typeof T=="number")&&T*0==0){if(G.s=1/T<0?(T=-T,-1):1,T===~~T){for(U=0,Y=T;Y>=10;Y/=10,U++);U>be?G.c=G.e=null:(G.e=U,G.c=[T]);return}K=String(T)}else{if(!r.test(K=String(T)))return Q(G,K,$);G.s=K.charCodeAt(0)==45?(K=K.slice(1),-1):1}(U=K.indexOf("."))>-1&&(K=K.replace(".","")),(Y=K.search(/e/i))>0?(U<0&&(U=Y),U+=+K.slice(Y+1),K=K.substring(0,Y)):U<0&&(U=K.length)}else{if(w(N,2,ze.length,"Base"),N==10&&et)return G=new v(T),z(G,q+G.e+1,ie);if(K=String(T),$=typeof T=="number"){if(T*0!=0)return Q(G,K,$,N);if(G.s=1/T<0?(K=K.slice(1),-1):1,v.DEBUG&&K.replace(/^0\.0*|\./,"").length>15)throw Error(a+T)}else G.s=K.charCodeAt(0)===45?(K=K.slice(1),-1):1;for(L=ze.slice(0,N),U=Y=0,j=K.length;Y<j;Y++)if(L.indexOf(V=K.charAt(Y))<0){if(V=="."){if(Y>U){U=j;continue}}else if(!x&&(K==K.toUpperCase()&&(K=K.toLowerCase())||K==K.toLowerCase()&&(K=K.toUpperCase()))){x=!0,Y=-1,U=0;continue}return Q(G,String(T),$,N)}$=!1,K=D(K,N,10,G.s),(U=K.indexOf("."))>-1?K=K.replace(".",""):U=K.length}for(Y=0;K.charCodeAt(Y)===48;Y++);for(j=K.length;K.charCodeAt(--j)===48;);if(K=K.slice(Y,++j)){if(j-=Y,$&&v.DEBUG&&j>15&&(T>c||T!==s(T)))throw Error(a+G.s*T);if((U=U-Y-1)>be)G.c=G.e=null;else if(U<ke)G.c=[G.e=0];else{if(G.e=U,G.c=[],Y=(U+1)%u,U<0&&(Y+=u),Y<j){for(Y&&G.c.push(+K.slice(0,Y)),j-=u;Y<j;)G.c.push(+K.slice(Y,Y+=u));Y=u-(K=K.slice(Y)).length}else Y-=j;for(;Y--;K+="0");G.c.push(+K)}}else G.c=[G.e=0]}v.clone=m,v.ROUND_UP=0,v.ROUND_DOWN=1,v.ROUND_CEIL=2,v.ROUND_FLOOR=3,v.ROUND_HALF_UP=4,v.ROUND_HALF_DOWN=5,v.ROUND_HALF_EVEN=6,v.ROUND_HALF_CEIL=7,v.ROUND_HALF_FLOOR=8,v.EUCLID=9,v.config=v.set=function(T){var N,L;if(T!=null)if(typeof T=="object"){if(T.hasOwnProperty(N="DECIMAL_PLACES")&&(L=T[N],w(L,0,f,N),q=L),T.hasOwnProperty(N="ROUNDING_MODE")&&(L=T[N],w(L,0,8,N),ie=L),T.hasOwnProperty(N="EXPONENTIAL_AT")&&(L=T[N],L&&L.pop?(w(L[0],-f,0,N),w(L[1],0,f,N),fe=L[0],Ee=L[1]):(w(L,-f,f,N),fe=-(Ee=L<0?-L:L))),T.hasOwnProperty(N="RANGE"))if(L=T[N],L&&L.pop)w(L[0],-f,-1,N),w(L[1],1,f,N),ke=L[0],be=L[1];else if(w(L,-f,f,N),L)ke=-(be=L<0?-L:L);else throw Error(o+N+" cannot be zero: "+L);if(T.hasOwnProperty(N="CRYPTO"))if(L=T[N],L===!!L)if(L)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))re=L;else throw re=!L,Error(o+"crypto unavailable");else re=L;else throw Error(o+N+" not true or false: "+L);if(T.hasOwnProperty(N="MODULO_MODE")&&(L=T[N],w(L,0,9,N),ae=L),T.hasOwnProperty(N="POW_PRECISION")&&(L=T[N],w(L,0,f,N),le=L),T.hasOwnProperty(N="FORMAT"))if(L=T[N],typeof L=="object")ye=L;else throw Error(o+N+" not an object: "+L);if(T.hasOwnProperty(N="ALPHABET"))if(L=T[N],typeof L=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(L))et=L.slice(0,10)=="0123456789",ze=L;else throw Error(o+N+" invalid: "+L)}else throw Error(o+"Object expected: "+T);return{DECIMAL_PLACES:q,ROUNDING_MODE:ie,EXPONENTIAL_AT:[fe,Ee],RANGE:[ke,be],CRYPTO:re,MODULO_MODE:ae,POW_PRECISION:le,FORMAT:ye,ALPHABET:ze}},v.isBigNumber=function(T){if(!T||T._isBigNumber!==!0)return!1;if(!v.DEBUG)return!0;var N,L,V=T.c,x=T.e,U=T.s;e:if({}.toString.call(V)=="[object Array]"){if((U===1||U===-1)&&x>=-f&&x<=f&&x===s(x)){if(V[0]===0){if(x===0&&V.length===1)return!0;break e}if(N=(x+1)%u,N<1&&(N+=u),String(V[0]).length==N){for(N=0;N<V.length;N++)if(L=V[N],L<0||L>=l||L!==s(L))break e;if(L!==0)return!0}}}else if(V===null&&x===null&&(U===null||U===1||U===-1))return!0;throw Error(o+"Invalid BigNumber: "+T)},v.maximum=v.max=function(){return A(arguments,-1)},v.minimum=v.min=function(){return A(arguments,1)},v.random=function(){var T=9007199254740992,N=Math.random()*T&2097151?function(){return s(Math.random()*T)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(L){var V,x,U,Y,$,j=0,K=[],G=new v(J);if(L==null?L=q:w(L,0,f),Y=i(L/u),re)if(crypto.getRandomValues){for(V=crypto.getRandomValues(new Uint32Array(Y*=2));j<Y;)$=V[j]*131072+(V[j+1]>>>11),$>=9e15?(x=crypto.getRandomValues(new Uint32Array(2)),V[j]=x[0],V[j+1]=x[1]):(K.push($%1e14),j+=2);j=Y/2}else if(crypto.randomBytes){for(V=crypto.randomBytes(Y*=7);j<Y;)$=(V[j]&31)*281474976710656+V[j+1]*1099511627776+V[j+2]*4294967296+V[j+3]*16777216+(V[j+4]<<16)+(V[j+5]<<8)+V[j+6],$>=9e15?crypto.randomBytes(7).copy(V,j):(K.push($%1e14),j+=7);j=Y/7}else throw re=!1,Error(o+"crypto unavailable");if(!re)for(;j<Y;)$=N(),$<9e15&&(K[j++]=$%1e14);for(Y=K[--j],L%=u,Y&&L&&($=h[u-L],K[j]=s(Y/$)*$);K[j]===0;K.pop(),j--);if(j<0)K=[U=0];else{for(U=-1;K[0]===0;K.splice(0,1),U-=u);for(j=1,$=K[0];$>=10;$/=10,j++);j<u&&(U-=u-j)}return G.e=U,G.c=K,G}}(),v.sum=function(){for(var T=1,N=arguments,L=new v(N[0]);T<N.length;)L=L.plus(N[T++]);return L},D=function(){var T="0123456789";function N(L,V,x,U){for(var Y,$=[0],j,K=0,G=L.length;K<G;){for(j=$.length;j--;$[j]*=V);for($[0]+=U.indexOf(L.charAt(K++)),Y=0;Y<$.length;Y++)$[Y]>x-1&&($[Y+1]==null&&($[Y+1]=0),$[Y+1]+=$[Y]/x|0,$[Y]%=x)}return $.reverse()}return function(L,V,x,U,Y){var $,j,K,G,ne,de,Se,Ke,St=L.indexOf("."),_t=q,Xe=ie;for(St>=0&&(G=le,le=0,L=L.replace(".",""),Ke=new v(V),de=Ke.pow(L.length-St),le=G,Ke.c=N(P(C(de.c),de.e,"0"),10,x,T),Ke.e=Ke.c.length),Se=N(L,V,x,Y?($=ze,T):($=T,ze)),K=G=Se.length;Se[--G]==0;Se.pop());if(!Se[0])return $.charAt(0);if(St<0?--K:(de.c=Se,de.e=K,de.s=U,de=I(de,Ke,_t,Xe,x),Se=de.c,ne=de.r,K=de.e),j=K+_t+1,St=Se[j],G=x/2,ne=ne||j<0||Se[j+1]!=null,ne=Xe<4?(St!=null||ne)&&(Xe==0||Xe==(de.s<0?3:2)):St>G||St==G&&(Xe==4||ne||Xe==6&&Se[j-1]&1||Xe==(de.s<0?8:7)),j<1||!Se[0])L=ne?P($.charAt(1),-_t,$.charAt(0)):$.charAt(0);else{if(Se.length=j,ne)for(--x;++Se[--j]>x;)Se[j]=0,j||(++K,Se=[1].concat(Se));for(G=Se.length;!Se[--G];);for(St=0,L="";St<=G;L+=$.charAt(Se[St++]));L=P(L,K,$.charAt(0))}return L}}(),I=function(){function T(V,x,U){var Y,$,j,K,G=0,ne=V.length,de=x%d,Se=x/d|0;for(V=V.slice();ne--;)j=V[ne]%d,K=V[ne]/d|0,Y=Se*j+K*de,$=de*j+Y%d*d+G,G=($/U|0)+(Y/d|0)+Se*K,V[ne]=$%U;return G&&(V=[G].concat(V)),V}function N(V,x,U,Y){var $,j;if(U!=Y)j=U>Y?1:-1;else for($=j=0;$<U;$++)if(V[$]!=x[$]){j=V[$]>x[$]?1:-1;break}return j}function L(V,x,U,Y){for(var $=0;U--;)V[U]-=$,$=V[U]<x[U]?1:0,V[U]=$*Y+V[U]-x[U];for(;!V[0]&&V.length>1;V.splice(0,1));}return function(V,x,U,Y,$){var j,K,G,ne,de,Se,Ke,St,_t,Xe,Ze,Nt,Qr,Ls,Hs,Dr,Ds,ln=V.s==x.s?1:-1,Ht=V.c,$t=x.c;if(!Ht||!Ht[0]||!$t||!$t[0])return new v(!V.s||!x.s||(Ht?$t&&Ht[0]==$t[0]:!$t)?NaN:Ht&&Ht[0]==0||!$t?ln*0:ln/0);for(St=new v(ln),_t=St.c=[],K=V.e-x.e,ln=U+K+1,$||($=l,K=g(V.e/u)-g(x.e/u),ln=ln/u|0),G=0;$t[G]==(Ht[G]||0);G++);if($t[G]>(Ht[G]||0)&&K--,ln<0)_t.push(1),ne=!0;else{for(Ls=Ht.length,Dr=$t.length,G=0,ln+=2,de=s($/($t[0]+1)),de>1&&($t=T($t,de,$),Ht=T(Ht,de,$),Dr=$t.length,Ls=Ht.length),Qr=Dr,Xe=Ht.slice(0,Dr),Ze=Xe.length;Ze<Dr;Xe[Ze++]=0);Ds=$t.slice(),Ds=[0].concat(Ds),Hs=$t[0],$t[1]>=$/2&&Hs++;do{if(de=0,j=N($t,Xe,Dr,Ze),j<0){if(Nt=Xe[0],Dr!=Ze&&(Nt=Nt*$+(Xe[1]||0)),de=s(Nt/Hs),de>1)for(de>=$&&(de=$-1),Se=T($t,de,$),Ke=Se.length,Ze=Xe.length;N(Se,Xe,Ke,Ze)==1;)de--,L(Se,Dr<Ke?Ds:$t,Ke,$),Ke=Se.length,j=1;else de==0&&(j=de=1),Se=$t.slice(),Ke=Se.length;if(Ke<Ze&&(Se=[0].concat(Se)),L(Xe,Se,Ze,$),Ze=Xe.length,j==-1)for(;N($t,Xe,Dr,Ze)<1;)de++,L(Xe,Dr<Ze?Ds:$t,Ze,$),Ze=Xe.length}else j===0&&(de++,Xe=[0]);_t[G++]=de,Xe[0]?Xe[Ze++]=Ht[Qr]||0:(Xe=[Ht[Qr]],Ze=1)}while((Qr++<Ls||Xe[0]!=null)&&ln--);ne=Xe[0]!=null,_t[0]||_t.splice(0,1)}if($==l){for(G=1,ln=_t[0];ln>=10;ln/=10,G++);z(St,U+(St.e=G+K*u-1)+1,Y,ne)}else St.e=K,St.r=+ne;return St}}();function R(T,N,L,V){var x,U,Y,$,j;if(L==null?L=ie:w(L,0,8),!T.c)return T.toString();if(x=T.c[0],Y=T.e,N==null)j=C(T.c),j=V==1||V==2&&(Y<=fe||Y>=Ee)?E(j,Y):P(j,Y,"0");else if(T=z(new v(T),N,L),U=T.e,j=C(T.c),$=j.length,V==1||V==2&&(N<=U||U<=fe)){for(;$<N;j+="0",$++);j=E(j,U)}else if(N-=Y,j=P(j,U,"0"),U+1>$){if(--N>0)for(j+=".";N--;j+="0");}else if(N+=U-$,N>0)for(U+1==$&&(j+=".");N--;j+="0");return T.s<0&&x?"-"+j:j}function A(T,N){for(var L,V,x=1,U=new v(T[0]);x<T.length;x++)V=new v(T[x]),(!V.s||(L=y(U,V))===N||L===0&&U.s===N)&&(U=V);return U}function W(T,N,L){for(var V=1,x=N.length;!N[--x];N.pop());for(x=N[0];x>=10;x/=10,V++);return(L=V+L*u-1)>be?T.c=T.e=null:L<ke?T.c=[T.e=0]:(T.e=L,T.c=N),T}Q=function(){var T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,N=/^([^.]+)\.$/,L=/^\.([^.]+)$/,V=/^-?(Infinity|NaN)$/,x=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(U,Y,$,j){var K,G=$?Y:Y.replace(x,"");if(V.test(G))U.s=isNaN(G)?null:G<0?-1:1;else{if(!$&&(G=G.replace(T,function(ne,de,Se){return K=(Se=Se.toLowerCase())=="x"?16:Se=="b"?2:8,!j||j==K?de:ne}),j&&(K=j,G=G.replace(N,"$1").replace(L,"0.$1")),Y!=G))return new v(G,K);if(v.DEBUG)throw Error(o+"Not a"+(j?" base "+j:"")+" number: "+Y);U.s=null}U.c=U.e=null}}();function z(T,N,L,V){var x,U,Y,$,j,K,G,ne=T.c,de=h;if(ne){e:{for(x=1,$=ne[0];$>=10;$/=10,x++);if(U=N-x,U<0)U+=u,Y=N,j=ne[K=0],G=s(j/de[x-Y-1]%10);else if(K=i((U+1)/u),K>=ne.length)if(V){for(;ne.length<=K;ne.push(0));j=G=0,x=1,U%=u,Y=U-u+1}else break e;else{for(j=$=ne[K],x=1;$>=10;$/=10,x++);U%=u,Y=U-u+x,G=Y<0?0:s(j/de[x-Y-1]%10)}if(V=V||N<0||ne[K+1]!=null||(Y<0?j:j%de[x-Y-1]),V=L<4?(G||V)&&(L==0||L==(T.s<0?3:2)):G>5||G==5&&(L==4||V||L==6&&(U>0?Y>0?j/de[x-Y]:0:ne[K-1])%10&1||L==(T.s<0?8:7)),N<1||!ne[0])return ne.length=0,V?(N-=T.e+1,ne[0]=de[(u-N%u)%u],T.e=-N||0):ne[0]=T.e=0,T;if(U==0?(ne.length=K,$=1,K--):(ne.length=K+1,$=de[u-U],ne[K]=Y>0?s(j/de[x-Y]%de[Y])*$:0),V)for(;;)if(K==0){for(U=1,Y=ne[0];Y>=10;Y/=10,U++);for(Y=ne[0]+=$,$=1;Y>=10;Y/=10,$++);U!=$&&(T.e++,ne[0]==l&&(ne[0]=1));break}else{if(ne[K]+=$,ne[K]!=l)break;ne[K--]=0,$=1}for(U=ne.length;ne[--U]===0;ne.pop());}T.e>be?T.c=T.e=null:T.e<ke&&(T.c=[T.e=0])}return T}function X(T){var N,L=T.e;return L===null?T.toString():(N=C(T.c),N=L<=fe||L>=Ee?E(N,L):P(N,L,"0"),T.s<0?"-"+N:N)}return F.absoluteValue=F.abs=function(){var T=new v(this);return T.s<0&&(T.s=1),T},F.comparedTo=function(T,N){return y(this,new v(T,N))},F.decimalPlaces=F.dp=function(T,N){var L,V,x,U=this;if(T!=null)return w(T,0,f),N==null?N=ie:w(N,0,8),z(new v(U),T+U.e+1,N);if(!(L=U.c))return null;if(V=((x=L.length-1)-g(this.e/u))*u,x=L[x])for(;x%10==0;x/=10,V--);return V<0&&(V=0),V},F.dividedBy=F.div=function(T,N){return I(this,new v(T,N),q,ie)},F.dividedToIntegerBy=F.idiv=function(T,N){return I(this,new v(T,N),0,1)},F.exponentiatedBy=F.pow=function(T,N){var L,V,x,U,Y,$,j,K,G,ne=this;if(T=new v(T),T.c&&!T.isInteger())throw Error(o+"Exponent not an integer: "+X(T));if(N!=null&&(N=new v(N)),$=T.e>14,!ne.c||!ne.c[0]||ne.c[0]==1&&!ne.e&&ne.c.length==1||!T.c||!T.c[0])return G=new v(Math.pow(+X(ne),$?T.s*(2-S(T)):+X(T))),N?G.mod(N):G;if(j=T.s<0,N){if(N.c?!N.c[0]:!N.s)return new v(NaN);V=!j&&ne.isInteger()&&N.isInteger(),V&&(ne=ne.mod(N))}else{if(T.e>9&&(ne.e>0||ne.e<-1||(ne.e==0?ne.c[0]>1||$&&ne.c[1]>=24e7:ne.c[0]<8e13||$&&ne.c[0]<=9999975e7)))return U=ne.s<0&&S(T)?-0:0,ne.e>-1&&(U=1/U),new v(j?1/U:U);le&&(U=i(le/u+2))}for($?(L=new v(.5),j&&(T.s=1),K=S(T)):(x=Math.abs(+X(T)),K=x%2),G=new v(J);;){if(K){if(G=G.times(ne),!G.c)break;U?G.c.length>U&&(G.c.length=U):V&&(G=G.mod(N))}if(x){if(x=s(x/2),x===0)break;K=x%2}else if(T=T.times(L),z(T,T.e+1,1),T.e>14)K=S(T);else{if(x=+X(T),x===0)break;K=x%2}ne=ne.times(ne),U?ne.c&&ne.c.length>U&&(ne.c.length=U):V&&(ne=ne.mod(N))}return V?G:(j&&(G=J.div(G)),N?G.mod(N):U?z(G,le,ie,Y):G)},F.integerValue=function(T){var N=new v(this);return T==null?T=ie:w(T,0,8),z(N,N.e+1,T)},F.isEqualTo=F.eq=function(T,N){return y(this,new v(T,N))===0},F.isFinite=function(){return!!this.c},F.isGreaterThan=F.gt=function(T,N){return y(this,new v(T,N))>0},F.isGreaterThanOrEqualTo=F.gte=function(T,N){return(N=y(this,new v(T,N)))===1||N===0},F.isInteger=function(){return!!this.c&&g(this.e/u)>this.c.length-2},F.isLessThan=F.lt=function(T,N){return y(this,new v(T,N))<0},F.isLessThanOrEqualTo=F.lte=function(T,N){return(N=y(this,new v(T,N)))===-1||N===0},F.isNaN=function(){return!this.s},F.isNegative=function(){return this.s<0},F.isPositive=function(){return this.s>0},F.isZero=function(){return!!this.c&&this.c[0]==0},F.minus=function(T,N){var L,V,x,U,Y=this,$=Y.s;if(T=new v(T,N),N=T.s,!$||!N)return new v(NaN);if($!=N)return T.s=-N,Y.plus(T);var j=Y.e/u,K=T.e/u,G=Y.c,ne=T.c;if(!j||!K){if(!G||!ne)return G?(T.s=-N,T):new v(ne?Y:NaN);if(!G[0]||!ne[0])return ne[0]?(T.s=-N,T):new v(G[0]?Y:ie==3?-0:0)}if(j=g(j),K=g(K),G=G.slice(),$=j-K){for((U=$<0)?($=-$,x=G):(K=j,x=ne),x.reverse(),N=$;N--;x.push(0));x.reverse()}else for(V=(U=($=G.length)<(N=ne.length))?$:N,$=N=0;N<V;N++)if(G[N]!=ne[N]){U=G[N]<ne[N];break}if(U&&(x=G,G=ne,ne=x,T.s=-T.s),N=(V=ne.length)-(L=G.length),N>0)for(;N--;G[L++]=0);for(N=l-1;V>$;){if(G[--V]<ne[V]){for(L=V;L&&!G[--L];G[L]=N);--G[L],G[V]+=l}G[V]-=ne[V]}for(;G[0]==0;G.splice(0,1),--K);return G[0]?W(T,G,K):(T.s=ie==3?-1:1,T.c=[T.e=0],T)},F.modulo=F.mod=function(T,N){var L,V,x=this;return T=new v(T,N),!x.c||!T.s||T.c&&!T.c[0]?new v(NaN):!T.c||x.c&&!x.c[0]?new v(x):(ae==9?(V=T.s,T.s=1,L=I(x,T,0,3),T.s=V,L.s*=V):L=I(x,T,0,ae),T=x.minus(L.times(T)),!T.c[0]&&ae==1&&(T.s=x.s),T)},F.multipliedBy=F.times=function(T,N){var L,V,x,U,Y,$,j,K,G,ne,de,Se,Ke,St,_t,Xe=this,Ze=Xe.c,Nt=(T=new v(T,N)).c;if(!Ze||!Nt||!Ze[0]||!Nt[0])return!Xe.s||!T.s||Ze&&!Ze[0]&&!Nt||Nt&&!Nt[0]&&!Ze?T.c=T.e=T.s=null:(T.s*=Xe.s,!Ze||!Nt?T.c=T.e=null:(T.c=[0],T.e=0)),T;for(V=g(Xe.e/u)+g(T.e/u),T.s*=Xe.s,j=Ze.length,ne=Nt.length,j<ne&&(Ke=Ze,Ze=Nt,Nt=Ke,x=j,j=ne,ne=x),x=j+ne,Ke=[];x--;Ke.push(0));for(St=l,_t=d,x=ne;--x>=0;){for(L=0,de=Nt[x]%_t,Se=Nt[x]/_t|0,Y=j,U=x+Y;U>x;)K=Ze[--Y]%_t,G=Ze[Y]/_t|0,$=Se*K+G*de,K=de*K+$%_t*_t+Ke[U]+L,L=(K/St|0)+($/_t|0)+Se*G,Ke[U--]=K%St;Ke[U]=L}return L?++V:Ke.splice(0,1),W(T,Ke,V)},F.negated=function(){var T=new v(this);return T.s=-T.s||null,T},F.plus=function(T,N){var L,V=this,x=V.s;if(T=new v(T,N),N=T.s,!x||!N)return new v(NaN);if(x!=N)return T.s=-N,V.minus(T);var U=V.e/u,Y=T.e/u,$=V.c,j=T.c;if(!U||!Y){if(!$||!j)return new v(x/0);if(!$[0]||!j[0])return j[0]?T:new v($[0]?V:x*0)}if(U=g(U),Y=g(Y),$=$.slice(),x=U-Y){for(x>0?(Y=U,L=j):(x=-x,L=$),L.reverse();x--;L.push(0));L.reverse()}for(x=$.length,N=j.length,x-N<0&&(L=j,j=$,$=L,N=x),x=0;N;)x=($[--N]=$[N]+j[N]+x)/l|0,$[N]=l===$[N]?0:$[N]%l;return x&&($=[x].concat($),++Y),W(T,$,Y)},F.precision=F.sd=function(T,N){var L,V,x,U=this;if(T!=null&&T!==!!T)return w(T,1,f),N==null?N=ie:w(N,0,8),z(new v(U),T,N);if(!(L=U.c))return null;if(x=L.length-1,V=x*u+1,x=L[x]){for(;x%10==0;x/=10,V--);for(x=L[0];x>=10;x/=10,V++);}return T&&U.e+1>V&&(V=U.e+1),V},F.shiftedBy=function(T){return w(T,-c,c),this.times("1e"+T)},F.squareRoot=F.sqrt=function(){var T,N,L,V,x,U=this,Y=U.c,$=U.s,j=U.e,K=q+4,G=new v("0.5");if($!==1||!Y||!Y[0])return new v(!$||$<0&&(!Y||Y[0])?NaN:Y?U:1/0);if($=Math.sqrt(+X(U)),$==0||$==1/0?(N=C(Y),(N.length+j)%2==0&&(N+="0"),$=Math.sqrt(+N),j=g((j+1)/2)-(j<0||j%2),$==1/0?N="5e"+j:(N=$.toExponential(),N=N.slice(0,N.indexOf("e")+1)+j),L=new v(N)):L=new v($+""),L.c[0]){for(j=L.e,$=j+K,$<3&&($=0);;)if(x=L,L=G.times(x.plus(I(U,x,K,1))),C(x.c).slice(0,$)===(N=C(L.c)).slice(0,$))if(L.e<j&&--$,N=N.slice($-3,$+1),N=="9999"||!V&&N=="4999"){if(!V&&(z(x,x.e+q+2,0),x.times(x).eq(U))){L=x;break}K+=4,$+=4,V=1}else{(!+N||!+N.slice(1)&&N.charAt(0)=="5")&&(z(L,L.e+q+2,1),T=!L.times(L).eq(U));break}}return z(L,L.e+q+1,ie,T)},F.toExponential=function(T,N){return T!=null&&(w(T,0,f),T++),R(this,T,N,1)},F.toFixed=function(T,N){return T!=null&&(w(T,0,f),T=T+this.e+1),R(this,T,N)},F.toFormat=function(T,N,L){var V,x=this;if(L==null)T!=null&&N&&typeof N=="object"?(L=N,N=null):T&&typeof T=="object"?(L=T,T=N=null):L=ye;else if(typeof L!="object")throw Error(o+"Argument not an object: "+L);if(V=x.toFixed(T,N),x.c){var U,Y=V.split("."),$=+L.groupSize,j=+L.secondaryGroupSize,K=L.groupSeparator||"",G=Y[0],ne=Y[1],de=x.s<0,Se=de?G.slice(1):G,Ke=Se.length;if(j&&(U=$,$=j,j=U,Ke-=U),$>0&&Ke>0){for(U=Ke%$||$,G=Se.substr(0,U);U<Ke;U+=$)G+=K+Se.substr(U,$);j>0&&(G+=K+Se.slice(U)),de&&(G="-"+G)}V=ne?G+(L.decimalSeparator||"")+((j=+L.fractionGroupSize)?ne.replace(new RegExp("\\d{"+j+"}\\B","g"),"$&"+(L.fractionGroupSeparator||"")):ne):G}return(L.prefix||"")+V+(L.suffix||"")},F.toFraction=function(T){var N,L,V,x,U,Y,$,j,K,G,ne,de,Se=this,Ke=Se.c;if(T!=null&&($=new v(T),!$.isInteger()&&($.c||$.s!==1)||$.lt(J)))throw Error(o+"Argument "+($.isInteger()?"out of range: ":"not an integer: ")+X($));if(!Ke)return new v(Se);for(N=new v(J),K=L=new v(J),V=j=new v(J),de=C(Ke),U=N.e=de.length-Se.e-1,N.c[0]=h[(Y=U%u)<0?u+Y:Y],T=!T||$.comparedTo(N)>0?U>0?N:K:$,Y=be,be=1/0,$=new v(de),j.c[0]=0;G=I($,N,0,1),x=L.plus(G.times(V)),x.comparedTo(T)!=1;)L=V,V=x,K=j.plus(G.times(x=K)),j=x,N=$.minus(G.times(x=N)),$=x;return x=I(T.minus(L),V,0,1),j=j.plus(x.times(K)),L=L.plus(x.times(V)),j.s=K.s=Se.s,U=U*2,ne=I(K,V,U,ie).minus(Se).abs().comparedTo(I(j,L,U,ie).minus(Se).abs())<1?[K,V]:[j,L],be=Y,ne},F.toNumber=function(){return+X(this)},F.toPrecision=function(T,N){return T!=null&&w(T,1,f),R(this,T,N,2)},F.toString=function(T){var N,L=this,V=L.s,x=L.e;return x===null?V?(N="Infinity",V<0&&(N="-"+N)):N="NaN":(T==null?N=x<=fe||x>=Ee?E(C(L.c),x):P(C(L.c),x,"0"):T===10&&et?(L=z(new v(L),q+x+1,ie),N=P(C(L.c),L.e,"0")):(w(T,2,ze.length,"Base"),N=D(P(C(L.c),x,"0"),10,T,V,!0)),V<0&&L.c[0]&&(N="-"+N)),N},F.valueOf=F.toJSON=function(){return X(this)},F._isBigNumber=!0,_!=null&&v.set(_),v}function g(_){var I=_|0;return _>0||_===I?I:I-1}function C(_){for(var I,D,Q=1,F=_.length,J=_[0]+"";Q<F;){for(I=_[Q++]+"",D=u-I.length;D--;I="0"+I);J+=I}for(F=J.length;J.charCodeAt(--F)===48;);return J.slice(0,F+1||1)}function y(_,I){var D,Q,F=_.c,J=I.c,q=_.s,ie=I.s,fe=_.e,Ee=I.e;if(!q||!ie)return null;if(D=F&&!F[0],Q=J&&!J[0],D||Q)return D?Q?0:-ie:q;if(q!=ie)return q;if(D=q<0,Q=fe==Ee,!F||!J)return Q?0:!F^D?1:-1;if(!Q)return fe>Ee^D?1:-1;for(ie=(fe=F.length)<(Ee=J.length)?fe:Ee,q=0;q<ie;q++)if(F[q]!=J[q])return F[q]>J[q]^D?1:-1;return fe==Ee?0:fe>Ee^D?1:-1}function w(_,I,D,Q){if(_<I||_>D||_!==s(_))throw Error(o+(Q||"Argument")+(typeof _=="number"?_<I||_>D?" out of range: ":" not an integer: ":" not a primitive number: ")+String(_))}function S(_){var I=_.c.length-1;return g(_.e/u)==I&&_.c[I]%2!=0}function E(_,I){return(_.length>1?_.charAt(0)+"."+_.slice(1):_)+(I<0?"e":"e+")+I}function P(_,I,D){var Q,F;if(I<0){for(F=D+".";++I;F+=D);_=F+_}else if(Q=_.length,++I>Q){for(F=D,I-=Q;--I;F+=D);_+=F}else I<Q&&(_=_.slice(0,I)+"."+_.slice(I));return _}t=m(),t.default=t.BigNumber=t,n.exports?n.exports=t:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=t)})(mCe)})(J9);var e8=J9.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ra=ok(),FCe=ik(),kCe=sk,VCe=e8,Jr={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},mC={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:t8,decimalSuffixes:n0}=Ra.currentBytes(),ak={general:{scale:1024,suffixes:n0},binary:{scale:1024,suffixes:t8},decimal:{scale:1e3,suffixes:n0}};function $Ce(n,e={},t){if(typeof e=="string"&&(e=kCe.parseFormat(e)),!FCe.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",s=e.postfix||"",o=UCe(n,e,t);return o=oEe(o,i),o=aEe(o,s),o}function UCe(n,e,t){switch(e.output){case"currency":return e=pm(e,Ra.currentCurrencyDefaultFormat()),XCe(n,e,Ra);case"percent":return e=pm(e,Ra.currentPercentageDefaultFormat()),KCe(n,e,Ra,t);case"byte":return e=pm(e,Ra.currentByteDefaultFormat()),zCe(n,e,Ra,t);case"time":return e=pm(e,Ra.currentTimeDefaultFormat()),YCe(n);case"ordinal":return e=pm(e,Ra.currentOrdinalDefaultFormat()),GCe(n,e,Ra);case"number":default:return pC({instance:n,providedFormat:e})}}function BCe(n){let e=ak.decimal;return aN(n._value,e.suffixes,e.scale).suffix}function WCe(n){let e=ak.binary;return aN(n._value,e.suffixes,e.scale).suffix}function jCe(n){let e=ak.general;return aN(n._value,e.suffixes,e.scale).suffix}function aN(n,e,t){let r=e[0],i=Math.abs(n);if(i>=t){for(let s=1;s<e.length;++s){let o=Math.pow(t,s),a=Math.pow(t,s+1);if(i>=o&&i<a){r=e[s],n=n/o;break}}r===e[0]&&(n=n/Math.pow(t,e.length-1),r=e[e.length-1])}return{value:n,suffix:r}}function zCe(n,e,t,r){let i=e.base||"binary",s=Object.assign({},mC,e);const{binarySuffixes:o,decimalSuffixes:a}=t.currentBytes();let u={general:{scale:1024,suffixes:a||n0,marker:"bd"},binary:{scale:1024,suffixes:o||t8,marker:"b"},decimal:{scale:1e3,suffixes:a||n0,marker:"d"}}[i],{value:c,suffix:h}=aN(n._value,u.suffixes,u.scale);return`${pC({instance:r(c),providedFormat:e,state:t,defaults:t.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${h}`}function GCe(n,e,t){let r=t.currentOrdinal(),i=Object.assign({},mC,e),s=pC({instance:n,providedFormat:e,state:t}),o=r(n._value);return`${s}${i.spaceSeparated?" ":""}${o}`}function YCe(n){let e=Math.floor(n._value/60/60),t=Math.floor((n._value-e*60*60)/60),r=Math.round(n._value-e*60*60-t*60);return`${e}:${t<10?"0":""}${t}:${r<10?"0":""}${r}`}function KCe(n,e,t,r){let i=e.prefixSymbol,s=pC({instance:r(n._value*100),providedFormat:e,state:t}),o=Object.assign({},mC,e);return i?`%${o.spaceSeparated?" ":""}${s}`:`${s}${o.spaceSeparated?" ":""}%`}function XCe(n,e,t){const r=t.currentCurrency();let i=Object.assign({},e),s=Object.assign({},mC,i),o,a="",l=!!s.totalLength||!!s.forceAverage||s.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(o=a+c+a);let d=pC({instance:n,providedFormat:i,state:t,decimalSeparator:o});return u==="prefix"&&(n._value<0&&s.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:n._value>0&&s.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!s.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function qCe({value:n,forceAverage:e,lowPrecision:t=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:s=0,roundingFunction:o=Math.round}){let a="",l=Math.abs(n),u=-1;if(e&&r[e]&&Jr[e]?(a=r[e],n=n/Jr[e]):l>=Jr.trillion||t&&o(l/Jr.trillion)===1?(a=r.trillion,n=n/Jr.trillion):l<Jr.trillion&&l>=Jr.billion||t&&o(l/Jr.billion)===1?(a=r.billion,n=n/Jr.billion):l<Jr.billion&&l>=Jr.million||t&&o(l/Jr.million)===1?(a=r.million,n=n/Jr.million):(l<Jr.million&&l>=Jr.thousand||t&&o(l/Jr.thousand)===1)&&(a=r.thousand,n=n/Jr.thousand),a&&(a=(i?" ":"")+a),s){let h=n<0,d=n.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(s-f,0)}return{value:n,abbreviation:a,mantissaPrecision:u}}function QCe({value:n,characteristicPrecision:e}){let[t,r]=n.toExponential().split("e"),i=+t;if(!e)return{value:i,abbreviation:`e${r}`};let s=1;return s<e&&(i=i*Math.pow(10,e-s),r=+r-(e-s),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function pE(n){let e="";for(let t=0;t<n;t++)e+="0";return e}function ZCe(n,e){let t=n.toString(),[r,i]=t.split("e"),[s,o=""]=r.split(".");if(+i>0)t=s+o+pE(i-o.length);else{let a=".";+s<0?a=`-0${a}`:a=`0${a}`;let l=(pE(-i-1)+Math.abs(s)+o).substr(0,e);l.length<e&&(l+=pE(e-l.length)),t=a+l}return+i>0&&e>0&&(t+=`.${pE(e)}`),t}function JCe(n,e,t=Math.round){return n.toString().indexOf("e")!==-1?ZCe(n,e):new VCe(t(+`${n}e+${e}`)/Math.pow(10,e)).toFixed(e)}function eEe(n,e,t,r,i,s){if(r===-1)return n;let o=JCe(e,r,s),[a,l=""]=o.toString().split(".");if(l.match(/^0+$/)&&(t||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:o.toString()}function tEe(n,e,t,r){let i=n,[s,o]=i.toString().split(".");if(s.match(/^-?0$/)&&t)return o?`${s.replace("0","")}.${o}`:s.replace("0","");const a=e<0&&s.indexOf("-")===0;if(a&&(s=s.slice(1),i=i.slice(1)),s.length<r){let l=r-s.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function nEe(n,e){let t=[],r=0;for(let i=n;i>0;i--)r===e&&(t.unshift(i),r=0),r++;return t}function rEe(n,e,t,r,i){let s=r.currentDelimiters(),o=s.thousands;i=i||s.decimal;let a=s.thousandsSize||3,l=n.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return t&&(h&&(u=u.slice(1)),nEe(u.length,a).forEach((f,m)=>{u=u.slice(0,f+m)+o+u.slice(f+m)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function iEe(n,e){return n+e}function sEe(n,e,t){return e===0?n:+n==0?n.replace("-",""):e>0?`+${n}`:t==="sign"?n:`(${n.replace("-","")})`}function oEe(n,e){return e+n}function aEe(n,e){return n+e}function pC({instance:n,providedFormat:e,state:t=Ra,decimalSeparator:r,defaults:i=t.currentDefaults()}){let s=n._value;if(s===0&&t.hasZeroFormat())return t.getZeroFormat();if(!isFinite(s))return s.toString();let o=Object.assign({},mC,i,e),a=o.totalLength,l=a?0:o.characteristic,u=o.optionalCharacteristic,c=o.forceAverage,h=o.lowPrecision,d=!!a||!!c||o.average,f=a?-1:d&&e.mantissa===void 0?0:o.mantissa,m=a?!1:e.optionalMantissa===void 0?f===-1:o.optionalMantissa,g=o.trimMantissa,C=o.thousandSeparated,y=o.spaceSeparated,w=o.negative,S=o.forceSign,E=o.exponential,P=o.roundingFunction,_="";if(d){let D=qCe({value:s,forceAverage:c,lowPrecision:h,abbreviations:t.currentAbbreviations(),spaceSeparated:y,roundingFunction:P,totalLength:a});s=D.value,_+=D.abbreviation,a&&(f=D.mantissaPrecision)}if(E){let D=QCe({value:s,characteristicPrecision:l});s=D.value,_=D.abbreviation+_}let I=eEe(s.toString(),s,m,f,g,P);return I=tEe(I,s,u,l),I=rEe(I,s,C,t,r),(d||E)&&(I=iEe(I,_)),(S||s<0)&&(I=sEe(I,s,w)),I}function pm(n,e){if(!n)return e;let t=Object.keys(n);return t.length===1&&t[0]==="output"?e:n}var lEe=n=>({format:(...e)=>$Ce(...e,n),getByteUnit:(...e)=>jCe(...e,n),getBinaryByteUnit:(...e)=>WCe(...e,n),getDecimalByteUnit:(...e)=>BCe(...e,n),formatOrDefault:pm});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const hc=e8;function uEe(n,e,t){let r=new hc(n._value),i=e;return t.isNumbro(e)&&(i=e._value),i=new hc(i),n._value=r.plus(i).toNumber(),n}function n8(n,e,t){let r=new hc(n._value),i=e;return t.isNumbro(e)&&(i=e._value),i=new hc(i),n._value=r.minus(i).toNumber(),n}function cEe(n,e,t){let r=new hc(n._value),i=e;return t.isNumbro(e)&&(i=e._value),i=new hc(i),n._value=r.times(i).toNumber(),n}function hEe(n,e,t){let r=new hc(n._value),i=e;return t.isNumbro(e)&&(i=e._value),i=new hc(i),n._value=r.dividedBy(i).toNumber(),n}function dEe(n,e,t){let r=e;return t.isNumbro(e)&&(r=e._value),n._value=r,n}function fEe(n,e,t){let r=t(n._value);return n8(r,e,t),Math.abs(r._value)}var gEe=n=>({add:(e,t)=>uEe(e,t,n),subtract:(e,t)=>n8(e,t,n),multiply:(e,t)=>cEe(e,t,n),divide:(e,t)=>hEe(e,t,n),set:(e,t)=>dEe(e,t,n),difference:(e,t)=>fEe(e,t,n),BigNumber:hc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const mEe="2.5.0",cu=ok(),pEe=ik(),vEe=DCe(qn),wEe=Z9();let pd=lEe(qn),af=gEe(qn);const yEe=sk;class r8{constructor(e){this._value=e}clone(){return qn(this._value)}format(e={}){return pd.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=yEe.parseFormat(e)),e=pd.formatOrDefault(e,cu.currentCurrencyDefaultFormat()),e.output="currency",pd.format(this,e)}formatTime(e={}){return e.output="time",pd.format(this,e)}binaryByteUnits(){return pd.getBinaryByteUnit(this)}decimalByteUnits(){return pd.getDecimalByteUnit(this)}byteUnits(){return pd.getByteUnit(this)}difference(e){return af.difference(this,e)}add(e){return af.add(this,e)}subtract(e){return af.subtract(this,e)}multiply(e){return af.multiply(this,e)}divide(e){return af.divide(this,e)}set(e){return af.set(this,i8(e))}value(){return this._value}valueOf(){return this._value}}function i8(n){let e=n;return qn.isNumbro(n)?e=n._value:typeof n=="string"?e=qn.unformat(n):isNaN(n)&&(e=NaN),e}function qn(n){return new r8(i8(n))}qn.version=mEe;qn.isNumbro=function(n){return n instanceof r8};qn.language=cu.currentLanguage;qn.registerLanguage=cu.registerLanguage;qn.setLanguage=cu.setLanguage;qn.languages=cu.languages;qn.languageData=cu.languageData;qn.zeroFormat=cu.setZeroFormat;qn.defaultFormat=cu.currentDefaults;qn.setDefaults=cu.setDefaults;qn.defaultCurrencyFormat=cu.currentCurrencyDefaultFormat;qn.validate=pEe.validate;qn.loadLanguagesInNode=vEe.loadLanguagesInNode;qn.unformat=wEe.unformat;qn.BigNumber=af.BigNumber;var SEe=qn,vd=pCe(SEe);const CEe="numeric";function s8(n,e){if(bi(n)){const t=e.numericFormat,r=t&&t.culture||"-",i=t&&t.pattern;if(typeof r<"u"&&!vd.languages()[r]){const s=r.replace("-",""),o=vd.allLanguages?vd.allLanguages[r]:vd[s];o&&vd.registerLanguage(o)}vd.setLanguage(r),n=vd(n).format(i||"0")}return n}function lk(n,e,t,r,i,s,o){let a=s;if(bi(a)){let u=[];if(Array.isArray(o.className))u=o.className;else{var l;const c=(l=o.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=s8(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}Sc(n,e,t,r,i,a,o)}lk.RENDERER_TYPE=CEe;const EEe="password";function uk(n,e,t,r,i,s,o){Sc.apply(this,[n,e,t,r,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";Le(a-1,()=>{u+=l}),sd(e,u)}uk.RENDERER_TYPE=EEe;const REe="select";function ck(n,e,t,r,i,s,o){Sc.apply(this,[n,e,t,r,i,s,o])}ck.RENDERER_TYPE=REe;const TEe="time";function hk(n,e,t,r,i,s,o){Sc.apply(this,[n,e,t,r,i,s,o]),e.dir="ltr"}hk.RENDERER_TYPE=TEe;const{register:bEe,getItem:AEe,hasItem:o8,getNames:NEe,getValues:RKe}=ua("renderers");function r0(n){if(typeof n=="function")return n;if(!o8(n))throw Error(`No registered renderer found under "${n}" name`);return AEe(n)}function Ks(n,e){typeof n!="string"&&(e=n,n=e.RENDERER_TYPE),bEe(n,e)}function MEe(){Ks(hv),Ks(fC),Ks(tk),Ks(TD),Ks(rk),Ks(RD),Ks(lk),Ks(uk),Ks(ck),Ks(Sc),Ks(hk)}const IEe="autocomplete";function lN(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,ZW(t,e)):ZW(t,e)(this.source):e(!0)}lN.VALIDATOR_TYPE=IEe;function ZW(n,e){const t=n;return function(r){let i=!1;for(let s=0,o=r.length;s<o;s++)if(uC(t,r[s])){i=!0;break}e(i)}}function a8(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const OEe=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:a8},Symbol.toStringTag,{value:"Module"})),_Ee="date";function dk(n,e){const t=K9(F9,this.instance);let r=n,i=!0;r==null&&(r="");let s=se(r,this.dateFormat||t.defaultDateFormat,!0).isValid(),o=se(new Date(r)).isValid()||s;if(this.allowEmpty&&r===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=PEe(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}dk.VALIDATOR_TYPE=_Ee;function PEe(n,e){const t=se(a8(n)),r=se(n,e),i=n.search(/[A-Za-z]/g)>-1;let s;return t.isValid()&&t.format("x")===r.format("x")||!r.isValid()||i?s=t:s=r,s.format(e)}const xEe="dropdown";function fk(n,e){lN.apply(this,[n,e])}fk.VALIDATOR_TYPE=xEe;const LEe="numeric";function gk(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:bi(n))}gk.VALIDATOR_TYPE=LEe;const HEe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],DEe="time";function mk(n,e){const t=this.timeFormat||"h:mm:ss a";let r=!0,i=n;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=se(i,HEe,!0).isValid()?se(i):se(i,t);let a=o.isValid(),l=se(i,t,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(t);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}mk.VALIDATOR_TYPE=DEe;const{register:FEe,getItem:kEe,hasItem:l8,getNames:VEe,getValues:TKe}=ua("validators");function pk(n){if(typeof n=="function")return n;if(!l8(n))throw Error(`No registered validator found under "${n}" name`);return kEe(n)}function gf(n,e){typeof n!="string"&&(e=n,n=e.VALIDATOR_TYPE),FEe(n,e)}function $Ee(){gf(lN),gf(fk),gf(dk),gf(gk),gf(mk)}function u8(n){return je(n)&&n.value!==void 0?n.value:n}function c8(n,e,t){const r=this.getSourceDataAtCell(this.toPhysicalRow(e),this.toPhysicalColumn(t)),i=s=>je(s)&&Re(s.key)&&Re(s.value);return i(r)?i(n)?n:{key:n,value:n}:n}const UEe="autocomplete",BEe={CELL_TYPE:UEe,editor:SD,renderer:hv,validator:lN,valueGetter:u8,valueSetter:c8};function WEe(n,e,t){const{checkedTemplate:r,uncheckedTemplate:i}=this.getCellMeta(e,t),s=on(n),o=s===on(r),a=s===on(i);return o||a?o?r:i:n}const jEe="checkbox",zEe={CELL_TYPE:jEe,editor:D9,renderer:tk,valueSetter:WEe},GEe="date";function h8(n,e,t,r,i,s,o){hv.apply(this,[n,e,t,r,i,s,o])}h8.RENDERER_TYPE=GEe;const YEe="date",KEe={CELL_TYPE:YEe,editor:k9,renderer:h8,validator:dk};function XEe(n){return u8.call(this,n)}function qEe(n,e,t,r){return c8.call(this,n,e,t,r)}const QEe="dropdown",ZEe={CELL_TYPE:QEe,editor:V9,renderer:TD,validator:fk,filter:!1,strict:!0,valueGetter:XEe,valueSetter:qEe},JEe="handsontable",eRe={CELL_TYPE:JEe,editor:vD,renderer:rk},{register:tRe,getItem:nRe,hasItem:d8,getNames:rRe,getValues:bKe}=ua("cellTypes");function vk(n){if(!d8(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return nRe(n)}function No(n,e){typeof n!="string"&&(e=n,n=e.CELL_TYPE);const{editor:t,renderer:r,validator:i}=e;t&&cs(n,t),r&&Ks(n,r),i&&gf(n,i),tRe(n,e)}function iRe(n,e){var t;return n==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(n))||!xn(e,n)}function uN(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=typeof e.type=="string"?vk(e.type):e.type;if(n._automaticallyAssignedMetaProps&&ct(e,(s,o)=>void n._automaticallyAssignedMetaProps.delete(o)),!je(r))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const i={};ct(r,(s,o)=>{if(iRe(o,t)){var a;i[o]=s,(a=n._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),lr(n,i)}function sRe(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}W5(t,n);for(let r=0;r<e.length;r++)t.prototype[e[r]]=void 0;return t}function OT(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function Uw(n){return n==null}function oRe(n){if(typeof n=="string"&&A9(n)){const e=N9(n);return Uw(e)?n:e}return n}const aRe="numeric",lRe={CELL_TYPE:aRe,editor:$9,renderer:lk,validator:gk,dataType:"number",valueSetter:oRe},uRe="password",cRe={CELL_TYPE:uRe,editor:U9,renderer:uk,copyable:!1},hRe="select",dRe={CELL_TYPE:hRe,editor:B9,renderer:ck},fRe="text",f8={CELL_TYPE:fRe,editor:gg,renderer:Sc},gRe="time",mRe={CELL_TYPE:gRe,editor:W9,renderer:hk,validator:mk};function pRe(){No(BEe),No(zEe),No(KEe),No(ZEe),No(eRe),No(lRe),No(cRe),No(dRe),No(f8),No(mRe)}const Fx="asc",vRe="desc",JW=new Map([[Fx,[-1,1]],[vRe,[1,-1]]]),wRe=n=>`The priority '${n}' is already declared in a map.`,yRe=n=>`The priority '${n}' is not a number.`;function SRe(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;n=Pt(n)?n:wRe,e=Pt(e)?e:yRe;function r(s,o){if(!bi(s))throw new Error(e(s));if(t.has(s))throw new Error(n(s));t.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fx;const[o,a]=JW.get(s)||JW.get(Fx);return[...t].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:r,getItems:i}}const CRe=n=>`The id '${n}' is already declared in a map.`;function cN(){let{errorIdExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;n=Pt(n)?n:CRe;function t(u,c){if(l(u))throw new Error(n(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function s(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:t,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:r}}const ERe=n=>`'${n}' value is already declared in a unique set.`;function RRe(){let{errorItemExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;n=Pt(n)?n:ERe;function t(s){if(e.has(s))throw new Error(n(s));e.add(s)}function r(){return[...e]}function i(){e.clear()}return{addItem:t,clear:i,getItems:r}}const wk=n=>`There is already registered "${n}" plugin.`,TRe=n=>`There is already registered plugin on priority "${n}".`,bRe=n=>`The priority "${n}" is not a number.`,g8=SRe({errorPriorityExists:TRe,errorPriorityNaN:bRe}),m8=RRe({errorItemExists:wk}),kx=cN({errorIdExists:wk});function yk(){return[...g8.getItems(),...m8.getItems()]}function vC(n){const e=_i(n);return kx.getItem(e)}function ARe(n){return!!vC(n)}function pt(n,e,t){[n,e,t]=MRe(n,e,t),vC(n)===void 0&&NRe(n,e,t)}function NRe(n,e,t){const r=_i(n);if(kx.hasItem(r))throw new Error(wk(r));t===void 0?m8.addItem(r):g8.addItem(t,r),kx.addItem(r,e)}function MRe(n,e,t){return typeof n=="function"&&(e=n,n=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}function IRe(n,e){p8(n,e),e.add(n)}function Tg(n,e,t){return(e=ORe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ORe(n){var e=_Re(n,"string");return typeof e=="symbol"?e:e+""}function _Re(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function e2(n,e,t){p8(n,e),e.set(n,t)}function p8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vE(n,e,t){return n.set(Sk(n,e),t),t}function $n(n,e){return n.get(Sk(n,e))}function Sk(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const t2=new Map([["plugin",ARe],["cell-type",d8],["editor",Y9],["renderer",o8],["validator",l8]]),v8=Symbol("mainSetting"),PRe="base",wE=[];let wd=null;var Qn=new WeakMap,yd=new WeakMap,n2=new WeakSet;class yt{static get PLUGIN_KEY(){return PRe}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){IRe(this,n2),e2(this,Qn,null),Tg(this,"eventManager",new Zo(this)),Tg(this,"pluginName",null),Tg(this,"pluginsInitializedCallbacks",[]),Tg(this,"isPluginsReady",!1),Tg(this,"enabled",!1),Tg(this,"initialized",!1),e2(this,yd,{}),lu(this,"hot",e,{writable:!1}),wd=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const i=[];if(t.forEach(s=>{const[o,a]=s.split(":");if(!t2.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);t2.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");wE.push(s)}}if(wd||(wd=yk()),wd.indexOf(this.pluginName)>=0&&wd.splice(wd.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),wd.length===0){if(wE.length>0){const i=[`${wE.join(`
`)}
`,"You have to import and register them manually."].join("");throw wE.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const t=this.constructor.DEFAULT_SETTINGS;if(e===void 0)return je($n(Qn,this))?dy($n(Qn,this),t):$n(Qn,this);if((Array.isArray($n(Qn,this))||je($n(Qn,this)))&&t[v8]===e){var r;return Array.isArray($n(Qn,this))?$n(Qn,this):(r=$n(Qn,this)[e])!==null&&r!==void 0?r:t[e]}if(e.includes(".")){const i=Gb($n(Qn,this),e),s=Gb(t,e);return je(i)?dy(i,s):i!==void 0?i:s}return je($n(Qn,this))?dy($n(Qn,this),t)[e]:t[e]}updatePluginSettings(e){const t=this.constructor.SETTINGS_VALIDATORS;if(t&&typeof t=="function"&&typeof e!="object"){if(t(e)===!1){wt(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return vE(Qn,this,e),$n(Qn,this)}return t&&typeof t=="object"&&typeof e=="object"?(($n(Qn,this)===null||typeof $n(Qn,this)!="object")&&vE(Qn,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(t).forEach(r=>{if(!(r in e))return;const i=t[r];if((i?i(e[r]):!0)===!1){wt(`${this.pluginName} Plugin: "${r}" option is not valid and it will be ignored.`);return}$n(Qn,this)[r]=e[r]}),$n(Qn,this)):(vE(Qn,this,e),e)}addHook(e,t,r){$n(yd,this)[e]=$n(yd,this)[e]||[];const i=$n(yd,this)[e];this.hot.addHook(e,t,r),i.push(t),$n(yd,this)[e]=i}removeHooks(e){k($n(yd,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=$n(yd,this);ct(e,(t,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){k(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=Sk(n2,this,xRe).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;vE(Qn,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),ct(this,(t,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function xRe(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}function Sd(n,e,t){return(e=LRe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function LRe(n){var e=HRe(n,"string");return typeof e=="symbol"?e:e+""}function HRe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let Ck=class{constructor(e){Sd(this,"hot",null),Sd(this,"container",null),Sd(this,"injected",!1),Sd(this,"rows",[]),Sd(this,"columns",[]),Sd(this,"samples",null),Sd(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&ee(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),k(this.rows,t=>{const{height:r}=t.table.getBoundingClientRect();e(t.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),k(this.columns,t=>{const{width:r}=t.table.getBoundingClientRect();e(t.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{k(r.strings,i=>{t.appendChild(this.createColElement(i.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(s=>{k(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=t.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),o.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),t.appendChild(i)}this.samples.forEach(i=>{k(i.strings,s=>{const o=s.col,a=e.createElement("th");r.push([o,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),k(r,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment();return this.samples.forEach(i=>{k(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),u=t.createElement("td"),c=t.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const r=this.hot.rootDocument.createElement("col");let i=0;t>=0&&e>=0&&(i=this.hot.getCellMeta(t,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return r.style.width=`${s}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("table"),s=t.createElement("thead"),o=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),ee(i,e),r.appendChild(i),{fragment:r,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return ee(i,s),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Dv(n,e,t){return(e=DRe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function DRe(n){var e=FRe(n,"string");return typeof e=="symbol"?e:e+""}function FRe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class hN{static get SAMPLE_COUNT(){return 3}constructor(e){Dv(this,"samples",null),Dv(this,"dataFactory",null),Dv(this,"customSampleCount",null),Dv(this,"allowDuplicates",!1),Dv(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:hN.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,r){const i=new Map,{from:s,to:o}=typeof r=="number"?{from:r,to:r}:r;return Le(s,o,a=>{const l=this.generateSample(e,t,a);i.set(a,l)}),i}generateSample(e,t,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return Le(t.from,t.to,a=>{const l=e==="row"?this.dataFactory(r,a,this):this.dataFactory(a,r,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:je(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${on(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[s]:a}),o.push(u),f.needed-=1)}),i}}var kRe=an,VRe=tv,$Re=rv,URe=ZS,BRe=kA;kRe({target:"Array",proto:!0},{at:function(e){var t=VRe(this),r=$Re(t),i=URe(e),s=i>=0?i:r+i;return s<0||s>=r?void 0:t[s]}});BRe("at");var WRe=an,jRe=cr,zRe=KS,GRe=ZS,YRe=FA,KRe=wr,XRe=jRe("".charAt),qRe=KRe(function(){return"".at(-2)!=="\uD842"});WRe({target:"String",proto:!0,forced:qRe},{at:function(e){var t=YRe(zRe(this)),r=t.length,i=GRe(e),s=i>=0?i:r+i;return s<0||s>=r?void 0:XRe(t,s)}});function Fv(n,e,t){return(e=QRe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QRe(n){var e=ZRe(n,"string");return typeof e=="symbol"?e:e+""}function ZRe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class JRe{constructor(){Fv(this,"count",0),Fv(this,"startColumn",null),Fv(this,"endColumn",null),Fv(this,"startPosition",null),Fv(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=t,a=i>0?s+1:s;r>=i&&r+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=i&&(this.startColumn-=1),m>=i)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const h=o>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function kv(n,e,t){return(e=eTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eTe(n){var e=tTe(n,"string");return typeof e=="symbol"?e:e+""}function tTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class nTe{constructor(){kv(this,"count",0),kv(this,"startRow",null),kv(this,"endRow",null),kv(this,"startPosition",null),kv(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=t;r>=i&&r+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-s&&(this.startRow-=1),d>=i-s)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null;const c=r+i-s,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Vv(n,e,t){return(e=rTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rTe(n){var e=iTe(n,"string");return typeof e=="symbol"?e:e+""}function iTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class w8{constructor(){Vv(this,"count",0),Vv(this,"startColumn",null),Vv(this,"endColumn",null),Vv(this,"startPosition",null),Vv(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s}=t;r<=i&&(this.startColumn=e);const o=i>0?s+1:s;r>=i&&r<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const h=o>0?i+1:i;r+i-h<-1*s||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function $v(n,e,t){return(e=sTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sTe(n){var e=oTe(n,"string");return typeof e=="symbol"?e:e+""}function oTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class y8{constructor(){$v(this,"count",0),$v(this,"startRow",null),$v(this,"endRow",null),$v(this,"startPosition",null),$v(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s}=t;r<=i&&(this.startRow=e),r>=i&&r<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-s)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null,r+i-s<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Uv(n,e,t){return(e=aTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aTe(n){var e=lTe(n,"string");return typeof e=="symbol"?e:e+""}function lTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class uTe{constructor(){Uv(this,"count",0),Uv(this,"startColumn",0),Uv(this,"endColumn",0),Uv(this,"startPosition",0),Uv(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function Bv(n,e,t){return(e=cTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cTe(n){var e=hTe(n,"string");return typeof e=="symbol"?e:e+""}function hTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class dTe{constructor(){Bv(this,"count",0),Bv(this,"startRow",0),Bv(this,"endRow",0),Bv(this,"startPosition",0),Bv(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function r2(n,e,t){return(e=fTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fTe(n){var e=gTe(n,"string");return typeof e=="symbol"?e:e+""}function gTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class mTe extends w8{constructor(){super(...arguments),r2(this,"columnStartOffset",0),r2(this,"columnEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:s}=e;if(this.startColumn!==null&&typeof r=="function"){const o=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=s[this.startColumn])!==null&&t!==void 0?t:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function i2(n,e,t){return(e=pTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pTe(n){var e=vTe(n,"string");return typeof e=="symbol"?e:e+""}function vTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wTe extends y8{constructor(){super(...arguments),i2(this,"rowStartOffset",0),i2(this,"rowEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:s}=e;if(this.startRow!==null&&typeof r=="function"){const o=this.startRow,a=this.endRow;r(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(t=s[this.startRow])!==null&&t!==void 0?t:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function s2(n,e,t){return(e=yTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yTe(n){var e=STe(n,"string");return typeof e=="symbol"?e:e+""}function STe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class S8{constructor(e){s2(this,"calculationTypes",[]),s2(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[r,i]=t;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,t){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,r]=t;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function ga(n,e,t){return(e=CTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function CTe(n){var e=ETe(n,"string");return typeof e=="symbol"?e:e+""}function ETe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Vp=50;class RTe extends S8{constructor(e){let{calculationTypes:t,viewportWidth:r,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(t),ga(this,"viewportWidth",0),ga(this,"scrollOffset",0),ga(this,"zeroBasedScrollOffset",0),ga(this,"totalColumns",0),ga(this,"columnWidthFn",null),ga(this,"columnWidth",0),ga(this,"overrideFn",null),ga(this,"inlineStartOffset",0),ga(this,"totalCalculatedWidth",0),ga(this,"startPositions",[]),ga(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?Vp:t}}function So(n,e,t){return(e=TTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TTe(n){var e=bTe(n,"string");return typeof e=="symbol"?e:e+""}function bTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ATe extends S8{constructor(e){let{calculationTypes:t,viewportHeight:r,scrollOffset:i,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(t),So(this,"viewportHeight",0),So(this,"scrollOffset",0),So(this,"zeroBasedScrollOffset",0),So(this,"totalRows",0),So(this,"rowHeightFn",null),So(this,"rowHeight",0),So(this,"overrideFn",null),So(this,"horizontalScrollbarHeight",0),So(this,"innerViewportHeight",0),So(this,"totalCalculatedHeight",0),So(this,"startPositions",[]),So(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?this.defaultHeight:t}}function NTe(n,e,t){MTe(n,e),e.set(n,t)}function MTe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o2(n,e,t){return(e=ITe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ITe(n){var e=OTe(n,"string");return typeof e=="symbol"?e:e+""}function OTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function bg(n,e){return n.get(C8(n,e))}function a2(n,e,t){return n.set(C8(n,e),t),t}function C8(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var vu=new WeakMap;class Kf{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o2(this,"row",null),o2(this,"col",null),NTe(this,vu,!1),a2(vu,this,r),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:r,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=t||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return bg(vu,this)}isSouthEastOf(e){return this.row>=e.row&&(bg(vu,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(bg(vu,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(bg(vu,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(bg(vu,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Kf&&a2(vu,this,e.isRtl()),this}clone(){return new Kf(this.row,this.col,bg(vu,this))}toObject(){return{row:this.row,col:this.col}}}function _Te(n,e,t){PTe(n,e),e.set(n,t)}function PTe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MI(n,e,t){return(e=xTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xTe(n){var e=LTe(n,"string");return typeof e=="symbol"?e:e+""}function LTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Co(n,e){return n.get(E8(n,e))}function HTe(n,e,t){return n.set(E8(n,e),t),t}function E8(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var es=new WeakMap;class dv{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;MI(this,"highlight",null),MI(this,"from",null),MI(this,"to",null),_Te(this,es,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=r.clone(),HTe(es,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:r}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=t&&s.row>=t&&i.col<=r&&s.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,o.row),u=Math.min(r.col,o.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(s),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Co(es,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Co(es,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Co(es,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Co(es,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Co(es,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Co(es,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Co(es,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Co(es,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Kf))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return t.top===r.top&&i.push("top"),t.right===r.right&&i.push(Co(es,this)?"left":"right"),t.bottom===r.bottom&&i.push("bottom"),t.left===r.left&&i.push(Co(es,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=t.row;i++)for(let s=e.col;s<=t.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&r.push(this._createCellCoords(i,s));return r}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=t.row;i++)for(let s=e.col;s<=t.col;s++)e.row===i&&e.col===s?r.push(e):t.row===i&&t.col===s?r.push(t):r.push(this._createCellCoords(i,s));return r}forAll(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=t.row;i<=r.row;i++)for(let s=t.col;s<=r.col;s++)if(e(i,s)===!1)return}clone(){return new dv(this.highlight,this.from,this.to,Co(es,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new Kf(e,t,Co(es,this))}}function ol(n,e,t){DTe(n,e),e.set(n,t)}function DTe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function De(n,e){return n.get(R8(n,e))}function Mc(n,e,t){return n.set(R8(n,e),t),t}function R8(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Eo=new WeakMap,II=new WeakMap,kr=new WeakMap,Ag=new WeakMap,yE=new WeakMap,ma=new WeakMap,OI=new WeakMap,Wv=new WeakMap,Cd=new WeakMap,al=new WeakMap;let T8=class{constructor(e,t,r,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ol(this,Eo,void 0),ol(this,II,void 0),ol(this,kr,void 0),ol(this,Ag,void 0),ol(this,yE,void 0),ol(this,ma,void 0),ol(this,OI,void 0),ol(this,Wv,void 0),ol(this,Cd,[null,null]),ol(this,al,[null,null]),Mc(Eo,this,r),Mc(II,this,t),Mc(kr,this,s),Mc(Ag,this,o),Mc(yE,this,a),Mc(ma,this,i),Mc(OI,this,e),this.registerEvents()}registerEvents(){De(ma,this).addEventListener(De(kr,this).holder,"contextmenu",r=>this.onContextMenu(r)),De(ma,this).addEventListener(De(kr,this).TABLE,"mouseover",r=>this.onMouseOver(r)),De(ma,this).addEventListener(De(kr,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{De(ma,this).addEventListener(De(kr,this).holder,"touchstart",r=>this.onTouchStart(r)),De(ma,this).addEventListener(De(kr,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),De(ma,this).addEventListener(De(kr,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||De(Eo,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,De(Eo,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{De(ma,this).addEventListener(De(kr,this).holder,"mouseup",r=>this.onMouseUp(r)),De(ma,this).addEventListener(De(kr,this).holder,"mousedown",r=>this.onMouseDown(r))};Ua()?e():(nD()&&e(),t())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(De(Wv,this)&&r){const[i,s]=[r.row,De(Wv,this).from.row],[o,a]=[r.col,De(Wv,this).from.col];return i===s&&o===a}return!1}parentCell(e){const t={},r=De(kr,this).TABLE,i=$w(e,["TD","TH"],r);return i?(t.coords=De(kr,this).getCoords(i),t.TD=i):Be(e,"wtBorder")&&Be(e,"current")?(t.coords=De(Ag,this).getFocusSelection().cellRange.highlight,t.TD=De(kr,this).getCell(t.coords)):Be(e,"wtBorder")&&Be(e,"area")&&De(Ag,this).getAreaSelection().cellRange&&(t.coords=De(Ag,this).getAreaSelection().cellRange.to,t.TD=De(kr,this).getCell(t.coords)),t}onMouseDown(e){const t=De(II,this).rootDocument.activeElement,r=yD(c9,e.target),i=e.target;if(!["TD","TH"].includes(t.nodeName)&&(i===t||r(0)===t||r(1)===t))return;const s=this.parentCell(i);Be(i,"corner")?De(Eo,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&De(Eo,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(De(al,this)[0]=s.TD,clearTimeout(De(Cd,this)[0]),De(Cd,this)[0]=setTimeout(()=>{De(al,this)[0]=null},1e3))}onContextMenu(e){if(De(Eo,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!De(Eo,this).has("onCellMouseOver"))return;const t=De(kr,this).TABLE,r=$w(e.target,["TD","TH"],t),i=De(yE,this)||this;r&&r!==i.lastMouseOver&&kh(r,t)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,De(kr,this).getCoords(r),r))}onMouseOut(e){if(!De(Eo,this).has("onCellMouseOut"))return;const t=De(kr,this).TABLE,r=$w(e.target,["TD","TH"],t),i=$w(e.relatedTarget,["TD","TH"],t),s=De(yE,this)||this;r&&r!==i&&kh(r,t)&&(this.callListener("onCellMouseOut",e,De(kr,this).getCoords(r),r),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&De(Eo,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===De(al,this)[0]&&t.TD===De(al,this)[1]?(Be(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),De(al,this)[0]=null,De(al,this)[1]=null):t.TD===De(al,this)[0]&&(De(al,this)[1]=t.TD,clearTimeout(De(Cd,this)[1]),De(Cd,this)[1]=setTimeout(()=>{De(al,this)[1]=null},500)))}onTouchStart(e){Mc(Wv,this,De(Ag,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const r=e.target,i=(t=this.parentCell(r))===null||t===void 0?void 0:t.coords,s=Re(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&De(Eo,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];iD()&&(a9()||l9())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,i){const s=De(Eo,this).getSettingPure(e);s&&s(t,r,i,De(OI,this).call(this))}destroy(){clearTimeout(De(Cd,this)[0]),clearTimeout(De(Cd,this)[1]),De(ma,this).destroy()}};function _I(n,e,t){return(e=FTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FTe(n){var e=kTe(n,"string");return typeof e=="symbol"?e:e+""}function kTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class VTe{constructor(e,t,r){_I(this,"offset",void 0),_I(this,"total",void 0),_I(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function PI(n,e,t){return(e=$Te(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $Te(n){var e=UTe(n,"string");return typeof e=="symbol"?e:e+""}function UTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class BTe{constructor(e,t,r){PI(this,"offset",void 0),PI(this,"total",void 0),PI(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function SE(n,e,t){return(e=WTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function WTe(n){var e=jTe(n,"string");return typeof e=="symbol"?e:e+""}function jTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class zTe{constructor(){SE(this,"currentSize",0),SE(this,"nextSize",0),SE(this,"currentOffset",0),SE(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const GTe=0,l2=1,Vx=2;function xI(n,e,t){return(e=YTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YTe(n){var e=KTe(n,"string");return typeof e=="symbol"?e:e+""}function KTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class XTe{constructor(){xI(this,"size",new zTe),xI(this,"workingSpace",GTe),xI(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=l2,e.workingSpace=Vx,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Vx,e.workingSpace=l2,this.sharedSize=e.getViewSize()}}var u2=DA,qTe=TypeError,QTe=function(n,e){if(!delete n[e])throw new qTe("Cannot delete property "+u2(e)+" of "+u2(n))},ZTe=an,JTe=tv,ebe=rv,tbe=n6,nbe=QTe,rbe=r6,ibe=[].unshift(0)!==1,sbe=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(n){return n instanceof TypeError}},obe=ibe||!sbe();ZTe({target:"Array",proto:!0,arity:1,forced:obe},{unshift:function(e){var t=JTe(this),r=ebe(t),i=arguments.length;if(i){rbe(r+i);for(var s=r;s--;){var o=s+i;s in t?t[o]=t[s]:nbe(t,o)}for(var a=0;a<i;a++)t[a]=arguments[a]}return tbe(t,r+i)}});function abe(n,e,t){return(e=lbe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lbe(n){var e=ube(n,"string");return typeof e=="symbol"?e:e+""}function ube(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class c2{constructor(e,t){abe(this,"order",[]),this.order=[...Array(t).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function cbe(n,e,t){return(e=hbe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hbe(n){var e=dbe(n,"string");return typeof e=="symbol"?e:e+""}function dbe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class fbe{constructor(e){cbe(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:t,nextSize:r}=e.getViewSize();let i=Math.max(r,t);if(i===0)return[];const{currentOffset:s,nextOffset:o}=e.getViewSize(),a=new c2(s,t),l=new c2(o,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(Vx)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Ng(n,e,t){return(e=gbe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gbe(n){var e=mbe(n,"string");return typeof e=="symbol"?e:e+""}function mbe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class b8{constructor(e,t){Ng(this,"rootNode",void 0),Ng(this,"nodesPool",void 0),Ng(this,"sizeSet",new XTe),Ng(this,"collectedNodes",[]),Ng(this,"viewDiffer",new fbe(this.sizeSet)),Ng(this,"leads",[]),this.rootNode=e,this.nodesPool=t}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:t}=this,[r,i,s,o]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":t.insertBefore(a,t.firstChild);break;case"append":t.appendChild(a);break;case"insert_before":t.insertBefore(a,this.nodesPool(s)),t.removeChild(this.nodesPool(o));break;case"replace":t.replaceChild(a,this.nodesPool(s));break;case"remove":t.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class A8 extends b8{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function h2(n,e,t){return(e=pbe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pbe(n){var e=vbe(n,"string");return typeof e=="symbol"?e:e+""}function vbe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wbe{constructor(e){h2(this,"nodeType",void 0),h2(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,t){const i=typeof t=="number"?`${e}x${t}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const s=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,s),s}}function jv(n,e,t){return(e=ybe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ybe(n){var e=Sbe(n,"string");return typeof e=="symbol"?e:e+""}function Sbe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wC{constructor(e,t){jv(this,"nodesPool",null),jv(this,"nodeType",void 0),jv(this,"rootNode",void 0),jv(this,"table",null),jv(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new wbe(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function d2(n,e,t){return(e=Cbe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Cbe(n){var e=Ebe(n,"string");return typeof e=="symbol"?e:e+""}function Ebe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Rbe extends wC{constructor(){super("TH"),d2(this,"orderViews",new WeakMap),d2(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new A8(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:r,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=s.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Kl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Pe(d,[ewe(),hwe(),eD(h+1),ys(-1)]),t[h](a,d,h)}u.end()}}}class Tbe extends wC{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+t;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<s;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)r.removeChild(r.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Jl(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Pe(this.rootNode,[q5()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Pe(o,[Q5(),t9(t+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),Kl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Pe(u,[eD(a+1+this.table.rowHeadersCount),ys(-1),twe(),...a>=0?[cwe()]:[Jve(),io("Select whole grid")]]),r[t](l,u,t)}}}}let f2=!1;class bbe extends wC{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!f2&&e>1e3&&(f2=!0,wt(Lt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<t;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[i+t].style.width=`${o}px`}const r=this.rootNode.firstChild;r&&ee(r,"rowHeader")}}function Abe(n,e,t){return(e=Nbe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Nbe(n){var e=Mbe(n,"string");return typeof e=="symbol"?e:e+""}function Mbe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Mg={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let g2=!1;class Ibe extends wC{constructor(e){super("TR",e),Abe(this,"orderView",void 0),this.orderView=new b8(e,t=>this.nodesPool.obtain(t))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!g2&&e>1e3&&(g2=!0,wt(Lt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Pe(this.rootNode,[q5()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var t,r;Pe(s,[Q5(),t9(o+((t=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}(o+1)%2===0?Be(s,Mg.rowEven)||(Me(s,Mg.rowOdd),ee(s,Mg.rowEven)):Be(s,Mg.rowOdd)||(Me(s,Mg.rowEven),ee(s,Mg.rowOdd))}this.orderView.end()}}function m2(n,e,t){return(e=Obe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Obe(n){var e=_be(n,"string");return typeof e=="symbol"?e:e+""}function _be(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Pbe extends wC{constructor(){super("TD"),m2(this,"orderViews",new WeakMap),m2(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new A8(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(t).setOffset(0).start();for(let d=0;d<t;d++){c.render();const f=this.table.renderedColumnToSource(d),m=c.getCurrentNode();if(Be(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),Kl(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,m),this.table.isAriaEnabled()){var s,o;Pe(m,[...m.hasAttribute("role")?[]:[Zve()],ys(-1),eD(f+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}c.end()}}}function fr(n,e,t){return(e=xbe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xbe(n){var e=Lbe(n,"string");return typeof e=="symbol"?e:e+""}function Lbe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Hbe{constructor(e){let{cellRenderer:t,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};fr(this,"rootNode",void 0),fr(this,"rootDocument",void 0),fr(this,"rowHeaders",null),fr(this,"columnHeaders",null),fr(this,"colGroup",null),fr(this,"rows",null),fr(this,"cells",null),fr(this,"rowFilter",null),fr(this,"columnFilter",null),fr(this,"rowUtils",null),fr(this,"columnUtils",null),fr(this,"rowsToRender",0),fr(this,"columnsToRender",0),fr(this,"rowHeaderFunctions",[]),fr(this,"rowHeadersCount",0),fr(this,"columnHeaderFunctions",[]),fr(this,"columnHeadersCount",0),fr(this,"cellRenderer",void 0),fr(this,"activeOverlayName",void 0),fr(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:r,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let r=0;r<e;r++){const i=t.getRenderedNode(r),s=this.rowUtils;if(i.firstChild){const o=this.renderedRowToSource(r),a=s.getHeightByOverlayName(o,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class Dbe{constructor(){let{TABLE:e,THEAD:t,COLGROUP:r,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Hbe(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new Rbe,columnHeaders:new Tbe(t),colGroup:new bbe(r),rows:new Ibe(i),cells:new Pbe}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function LI(n,e,t){return(e=Fbe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fbe(n){var e=kbe(n,"string");return typeof e=="symbol"?e:e+""}function kbe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Vbe{constructor(e,t){LI(this,"dataAccessObject",void 0),LI(this,"wtSettings",void 0),LI(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let t=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(t=t?Math.max(t,r):r),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<r;s++){let o=Array.isArray(t)?t[s]:t;o=o??i,this.headerWidths.set(s,o)}}}}function p2(n,e,t){return(e=$be(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $be(n){var e=Ube(n,"string");return typeof e=="symbol"?e:e+""}function Ube(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Bbe{constructor(e,t){p2(this,"dataAccessObject",void 0),p2(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(t=t===void 0?r:Math.max(t,r)),t}getHeightByOverlayName(e,t){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function ll(n,e,t){return(e=Wbe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wbe(n){var e=jbe(n,"string");return typeof e=="symbol"?e:e+""}function jbe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class fv{constructor(e,t,r,i,s){ll(this,"wtSettings",null),ll(this,"domBindings",void 0),ll(this,"TBODY",null),ll(this,"THEAD",null),ll(this,"COLGROUP",null),ll(this,"hasTableHeight",!0),ll(this,"hasTableWidth",!0),ll(this,"isTableVisible",!1),ll(this,"tableOffset",0),ll(this,"holderOffset",0),this.domBindings=r,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,oD(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new Bbe(this.dataAccessObject,this.wtSettings),this.columnUtils=new Vbe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Dbe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Be(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Pe(r,[Xu()]),r}createHider(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Be(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Pe(r,[Xu()]),r}createHolder(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Be(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",this.isMaster&&Pe(r,[ys(-1)]),t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Pe(r.parentNode,[Xu()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Pe(r,[Xu()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,s=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,u=t.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=si(this.holder),h=i.createCalculators(h),l&&!t.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=si(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),m=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new BTe(f,s,c),this.columnFilter=new VTe(m,o,l);let g=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),g=C.skipRender!==!0}g&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Vl)||this.is(Vh))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Vl))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Vl)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,s=this.getColumnHeaderHeight(r),o=this.getColumnHeader(t,r),o&&(a=fp(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(r[s]){if(!t[s]||t[s].childNodes.length===0)return;t[s].childNodes[0].style.height=`${r[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Vl))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const s=this.rowFilter.renderedToSource(i);t.oversizedRows&&t.oversizedRows[s]&&(t.oversizedRows[s]=void 0)}}}getCell(e){let t=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",t,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([t,r]=i),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const s=this.getRow(t);if(!s&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!o&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,r=null;if(e<0){var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),r=this.TBODY}return t!==void 0&&r!==void 0?r.childNodes.length<t+1?!1:r.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[t];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[r];s&&t.push(s)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(t>=r)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a==null?void 0:a.childNodes[t]}getRowHeaders(e){const t=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&t.push(o)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=Kh(t,["TD","TH"])),t===null)return null;const r=t.parentNode;if(!r)return null;const i=r.parentNode;let s=f9(r),o=t.cellIndex;Xc(Qf,t,this.wtRootElement)||Xc(Xf,t,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):Xc(Vh,t,this.wtRootElement)||Xc(Vl,t,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter&&(s=this.rowFilter.renderedToSource(s)),Xc(Qf,t,this.wtRootElement)||Xc(qf,t,this.wtRootElement)||Xc(Vh,t,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=this.wtSettings.getSetting("stylesHandler"),r=e*t.getDefaultRowHeight(),i=fp(this.TBODY)-1,s=t.areCellsBorderBox(),o=s?or:fp,a=s?0:1,l=s?1:0;let u,c,h,d,f;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const m=h===0?l:0;f?c=o(f):c=o(d)-a,(!u&&t.getDefaultRowHeight()<c-m||u<c)&&(s||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Xn(this.TABLE)}getHeight(){return or(this.TABLE)}getTotalWidth(){const e=Xn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=or(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Yf(this.TABLE)}_modifyRowHeaderWidth(e){let t=Pt(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const zbe="stickyRowsBottom",Ek={getFirstRenderedRow(){const n=this.getRenderedRowsCount();return n===0?-1:this.wtSettings.getSetting("totalRows")-n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};lu(Ek,"MIXIN_NAME",zbe,{writable:!1,enumerable:!1});const Gbe="stickyColumnsStart",dN={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};lu(dN,"MIXIN_NAME",Gbe,{writable:!1,enumerable:!1});class Rk extends fv{constructor(e,t,r,i){super(e,t,r,i,Vh)}}Vt(Rk,Ek);Vt(Rk,dN);const Xf="top",Vl="bottom",qf="inline_start",Qf="top_inline_start_corner",Vh="bottom_inline_start_corner",N8=[Xf,Vl,qf,Qf,Vh],Ybe=new Map([[Xf,`ht_clone_${Xf}`],[Vl,`ht_clone_${Vl}`],[qf,`ht_clone_${qf} ht_clone_left`],[Qf,`ht_clone_${Qf} ht_clone_top_left_corner`],[Vh,`ht_clone_${Vh} ht_clone_bottom_left_corner`]]);function Kbe(n,e){Xbe(n,e),e.add(n)}function Xbe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qbe(n,e,t){return(e=Qbe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qbe(n){var e=Zbe(n,"string");return typeof e=="symbol"?e:e+""}function Zbe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function CE(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var zv=new WeakSet;class Jbe{constructor(e){Kbe(this,zv),qbe(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,t),s=this.scrollViewportVertically(e.row,r);return i||s}scrollViewportHorizontally(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const s=Rs(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>i)return!1;t=s.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,l=t==="auto";if(l&&e<o)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():t==="end")),h}scrollViewportVertically(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const s=Rs(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>i)return!1;t=s.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=t==="auto";if(u&&(e<a||e>i-o-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():t==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return CE(zv,this,w2).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return CE(zv,this,w2).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return CE(zv,this,v2).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return CE(zv,this,v2).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function v2(n){const{wtSettings:e,inlineStartOverlay:t,wtTable:r,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(t.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=si(r.wtRootElement).left;const u=Math.abs(lD(o,o));if(l>u){const c=uD(o);let h=i.getRowHeaderWidth();for(let d=1;d<=s;d++)if(h+=t.sumCellSizes(d-1,d),l+h-u>=c){n=d-2;break}}}return n}function w2(n){const{topOverlay:e,wtTable:t,wtViewport:r,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=si(t.wtRootElement),a=tN(s,s);if(o.top>a){const l=fp(s);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),o.top+u-a>=l){n=c-2;break}}}return n}function Ro(n,e,t){return(e=e0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function e0e(n){var e=t0e(n,"string");return typeof e=="symbol"?e:e+""}function t0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Tk{get eventManager(){return new Zo(this)}constructor(e,t){Ro(this,"wtTable",void 0),Ro(this,"wtScroll",void 0),Ro(this,"wtViewport",void 0),Ro(this,"wtOverlays",void 0),Ro(this,"selectionManager",void 0),Ro(this,"wtEvent",void 0),Ro(this,"guid",`wt_${ZH()}`),Ro(this,"drawInterrupted",!1),Ro(this,"drawn",!1),Ro(this,"activeOverlayName","master"),Ro(this,"domBindings",void 0),Ro(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new Jbe(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,r){Xh(r,e[t])}])}}createCellCoords(e,t){return new Kf(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new dv(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||v9(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=r-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,r){return this.wtScroll.scrollViewport(e,t,r)}scrollViewportHorizontally(e,t){return this.wtScroll.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this.wtScroll.scrollViewportVertically(e,t)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function y2(n,e,t){return(e=n0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function n0e(n){var e=r0e(n,"string");return typeof e=="symbol"?e:e+""}function r0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class i0e extends Tk{constructor(e,t,r){super(e,t),y2(this,"cloneSource",void 0),y2(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new T8(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function s0e(n,e,t){return(e=o0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o0e(n){var e=a0e(n,"string");return typeof e=="symbol"?e:e+""}function a0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class yC{constructor(e,t,r,i,s){s0e(this,"wtSettings",null),lu(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=t,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Dp(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Dp(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=pS(e.TABLE)}getRelativeCellPosition(e,t,r){if(this.clone.wtTable.holder.contains(e)===!1){wt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=r<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(o,s,c,u):h=this.getRelativeCellPositionWithinHolder(o,a,s,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!t)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+ar())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:r.start+o,top:r.top+a}}getRelativeCellPositionWithinHolder(e,t,r,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=o.horizontal-s.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(N8.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=r.createElement("div"),o=r.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${Ybe.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,t.getSetting("ariaTags")&&Pe(s,[Xu()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Xf||u==="vertical"&&this.type===qf?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=pS(e.TABLE),new i0e(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const t=this.clone.cloneSource;t.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),t.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,r=e.style,i=t.style,s=e.parentNode.style;[r,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class l0e extends yC{constructor(e,t,r,i,s,o){super(e,t,Vh,r,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Rk(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${s}px`,t.style.bottom=`${o}px`}else dC(t),this.repositionOverlay();let r=or(this.clone.wtTable.TABLE);const i=Xn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height=`${r}px`,t.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=ar(r)),i.style.bottom=`${s}px`}}const u0e="calculatedColumns",fN={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return n===null?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return n===null?-1:n},getFirstPartiallyVisibleColumn(){const n=this.dataAccessObject.startColumnPartiallyVisible;return n===null?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return n===null?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return n===null?-1:n},getLastPartiallyVisibleColumn(){const n=this.dataAccessObject.endColumnPartiallyVisible;return n===null?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};lu(fN,"MIXIN_NAME",u0e,{writable:!1,enumerable:!1});class bk extends fv{constructor(e,t,r,i){super(e,t,r,i,Vl)}}Vt(bk,Ek);Vt(bk,fN);function c0e(n,e,t){return(e=h0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function h0e(n){var e=d0e(n,"string");return typeof e=="symbol"?e:e+""}function d0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class f0e extends yC{constructor(e,t,r,i){super(e,t,Vl,r,i),c0e(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new bk(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),t.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=ar(r)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===t&&e!==t.scrollY){const s=t.scrollY;t.scrollTo(eN(t),top),i=s!==t.scrollY}else if(e!==r.scrollTop){const s=r.scrollTop;r.scrollTop=e,i=s!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:r,wtSettings:i}=this.wot,s=i.getSetting("stylesHandler").getDefaultRowHeight();let o=e,a=0;for(;o<t;){const l=r.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=t.getWorkspaceWidth();t.hasVerticalScroll()&&(u-=ar(r)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=or(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;t&&s.offsetHeight!==s.clientHeight&&(o=ar(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=o,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return tN(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((r||t===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=Be(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ee(o,"innerBorderBottom"),s=!a):(Me(o,"innerBorderBottom"),s=a)}return s}}const g0e="calculatedRows",Ak={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return n===null?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return n===null?-1:n},getFirstPartiallyVisibleRow(){const n=this.dataAccessObject.startRowPartiallyVisible;return n===null?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return n===null?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return n===null?-1:n},getLastPartiallyVisibleRow(){const n=this.dataAccessObject.endRowPartiallyVisible;return n===null?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};lu(Ak,"MIXIN_NAME",g0e,{writable:!1,enumerable:!1});class Nk extends fv{constructor(e,t,r,i){super(e,t,r,i,qf)}}Vt(Nk,Ak);Vt(Nk,dN);const m0e="localHooks",Hr={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},removeLocalHook(n,e){if(this._localHooks[n]){const t=this._localHooks[n].indexOf(e);t>-1&&this._localHooks[n].splice(t,1)}return this},runLocalHooks(n,e,t,r,i,s,o){if(this._localHooks[n]){const a=this._localHooks[n].length;for(let l=0;l<a;l++)Xb(this._localHooks[n][l],this,e,t,r,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};lu(Hr,"MIXIN_NAME",m0e,{writable:!1,enumerable:!1});let M8=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};Vt(M8,Hr);const I8="active-header",Mk="header",Ik="area",i0="focus",p0e="fill",v0e="row",w0e="column",y0e="custom-selection",Ok=n=>{const e=n.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const t=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:t,height:t,borderWidth:r,borderStyle:"solid",borderColor:i})};var S0e=kA;S0e("flat");function C0e(n,e){O8(n,e),e.add(n)}function S2(n,e,t){O8(n,e),e.set(n,t)}function O8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nn(n,e){return n.get(my(n,e))}function C2(n,e,t){return n.set(my(n,e),t),t}function my(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Sa=new WeakMap,wi=new WeakMap,EE=new WeakSet;class E0e{constructor(){C0e(this,EE),S2(this,Sa,void 0),S2(this,wi,void 0)}setActiveOverlay(e){return C2(wi,this,e),this}setActiveSelection(e){return C2(Sa,this,e),this}scan(){const e=Nn(Sa,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r))):e==="area"?this.scanCellsRange(r=>t.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r)),this.scanCellsRange(r=>t.add(r))):e==="fill"?this.scanCellsRange(r=>t.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>t.add(r)),this.scanRowsInCellsRange(r=>t.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanColumnsInCellsRange(r=>t.add(r))),t}scanColumnsInHeadersRange(e){const[t,r,i,s]=Nn(Sa,this).getCorners(),{wtTable:o}=Nn(wi,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let c=-o.getRowHeadersCount();c<a;c++){const h=o.columnFilter.renderedToSource(c);if(!(h<r||h>s)){for(let d=-l;d<0;d++){if(d<t||d>i)continue;const f=d+l;let m=o.getColumnHeader(h,f);const g=Nn(wi,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Nn(Sa,this).settings.selectionType,columnCursor:u,selectionWidth:s-r+1});g!==null&&(g!==h&&(m=o.getColumnHeader(g,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[t,r,i,s]=Nn(Sa,this).getCorners(),{wtTable:o}=Nn(wi,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let c=-o.getColumnHeadersCount();c<a;c++){const h=o.rowFilter.renderedToSource(c);if(!(h<t||h>i)){for(let d=-l;d<0;d++){if(d<r||d>s)continue;const f=d+l;let m=o.getRowHeader(h,f);const g=Nn(wi,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Nn(Sa,this).settings.selectionType,rowCursor:u,selectionHeight:i-t+1});g!==null&&(g!==h&&(m=o.getRowHeader(g,f)),e(m))}u+=1}}}scanCellsRange(e){const{wtTable:t}=Nn(wi,this);my(EE,this,R0e).call(this,(r,i)=>{const s=t.getCell(Nn(wi,this).createCellCoords(r,i)),o=Nn(wi,this).getSetting("onAfterDrawSelection",r,i,Nn(Sa,this).settings.layerLevel);typeof o=="string"&&ee(s,o),e(s)})}scanRowsInCellsRange(e){const[t,,r]=Nn(Sa,this).getCorners(),{wtTable:i}=Nn(wi,this);my(EE,this,E2).call(this,(s,o)=>{if(s>=t&&s<=r){const a=i.getCell(Nn(wi,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,t,,r]=Nn(Sa,this).getCorners(),{wtTable:i}=Nn(wi,this);my(EE,this,E2).call(this,(s,o)=>{if(o>=t&&o<=r){const a=i.getCell(Nn(wi,this).createCellCoords(s,o));e(a)}})}}function R0e(n){let[e,t,r,i]=Nn(Sa,this).getCorners();if(e<0&&r<0||t<0&&i<0)return;const{wtTable:s}=Nn(wi,this),o=e!==r||t!==i;if(t=Math.max(t,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),o){if(t=Math.max(t,s.getFirstRenderedColumn()),i=Math.min(i,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),r=Math.min(r,s.getLastRenderedRow()),i<t||r<e)return}else{const a=s.getCell(Nn(wi,this).createCellCoords(e,t));if(!Xl(a))return}for(let a=e;a<=r;a+=1)for(let l=t;l<=i;l+=1)n(a,l)}function E2(n){const{wtTable:e}=Nn(wi,this),t=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<t;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<r;o+=1)n(s,e.columnFilter.renderedToSource(o))}}class R2{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Ok(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,r=this.main.childNodes.length;t<r;t++){const i=this.main.childNodes[t];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),la(e);const r=this,i=this.wot.rootDocument.body,s=t.getBoundingClientRect();t.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ua()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:t}=this.wot,r=t.getSetting("stylesHandler"),i=r.getCSSVariableValue("cell-mobile-handle-size"),s=r.getCSSVariableValue("cell-mobile-handle-border-radius"),o=r.getCSSVariableValue("cell-mobile-handle-background-color"),a=r.getCSSVariableValue("cell-mobile-handle-border-width"),l=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};ct(h,(f,m)=>{this.selectionHandles.styles.bottomHitArea[m]=f,this.selectionHandles.styles.topHitArea[m]=f});const d=r.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${s}px`,background:`${o}`,border:`${a}px solid ${l}`};ct(d,(f,m)=>{this.selectionHandles.styles.bottom[m]=f,this.selectionHandles.styles.top[m]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||t!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,r,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),g=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,c.top=`${parseInt(r-g/4*3,10)}px`,c[l]=`${parseInt(i-g/4*3,10)}px`;const w=Math.min(parseInt(i+s,10),C-m-f*2),S=Math.min(parseInt(i+s-g/4,10),C-g-f*2);h[l]=`${w}px`,d[l]=`${S}px`;const E=Math.min(parseInt(r+o,10),y-m-f*2),P=Math.min(parseInt(r+o-g/4,10),y-g-f*2);h.top=`${E}px`,d.top=`${P}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,t)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[t,r,i,s]=e;if(t<0&&i<0||r<0&&s<0){this.disappear();return}const{wtTable:o,rootDocument:a,rootWindow:l}=this.wot,u=t!==i||r!==s,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=o.getFirstRenderedRow(),d=o.getLastRenderedRow(),f=o.getFirstRenderedColumn(),m=o.getLastRenderedColumn();if(f<0&&m<0||h<0&&d<0){this.disappear();return}let g;if(u){if(r=Math.max(r,f),s=Math.min(s,m),t=Math.max(t,h),i=Math.min(i,d),s<r||i<t){this.disappear();return}g=o.getCell(this.wot.createCellCoords(t,r))}else if(g=o.getCell(this.wot.createCellCoords(t,r)),!Xl(g)){this.disappear();return}const C=u?o.getCell(this.wot.createCellCoords(i,s)):g,y=si(g),w=u?si(C):y,S=si(o.TABLE),E=y.top,P=y.left,_=this.wot.wtSettings.getSetting("rtlMode");let I=0,D=0;if(_){const re=Xn(o.TABLE),ae=Xn(g),le=l.innerWidth-S.left-re;D=P+ae-w.left,I=l.innerWidth-P-ae-le-1}else D=w.left+Xn(C)-P,I=P-S.left-1;if(this.isEntireColumnSelected(t,i)){const re=t,ae=this.getDimensionsFromHeader("columns",r,s,re,S);let le=null;ae&&([le,I,D]=ae),le&&(g=le)}let Q=E-S.top-1,F=w.top+or(C)-E;if(this.isEntireRowSelected(r,s)){const re=r,ae=this.getDimensionsFromHeader("rows",t,i,re,S);let le=null;ae&&([le,Q,F]=ae),le&&(g=le)}const J=l.getComputedStyle(g);parseInt(J.borderTopWidth,10)>0&&(Q+=1,F=F>0?F-1:0),parseInt(J[_?"borderRightWidth":"borderLeftWidth"],10)>0&&(I+=1,D=D>0?D-1:0);const q=_?"right":"left",ie=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${Q}px`,this.topStyle[q]=`${I}px`,this.topStyle.width=`${D+ie}px`,this.topStyle.display="block",this.startStyle.top=`${Q}px`,this.startStyle[q]=`${I}px`,this.startStyle.height=`${F+ie}px`,this.startStyle.display="block",this.bottomStyle.top=`${Q+F-parseInt(this.bottomStyle.height,10)+ie}px`,this.bottomStyle[q]=`${I}px`,this.bottomStyle.width=`${D+ie}px`,this.bottomStyle.display="block",this.endStyle.top=`${Q}px`,this.endStyle[q]=`${I+D-parseInt(this.endStyle.width,10)+ie}px`,this.endStyle.height=`${F+ie}px`,this.endStyle.display="block";let fe=this.settings.border.cornerVisible;fe=typeof fe=="function"?fe(this.settings.layerLevel):fe;const Ee=this.wot.getSetting("onModifyGetCellCoords",i,s,!1,"render");let[ke,be]=[i,s];if(Ee&&Array.isArray(Ee)&&([,,ke,be]=Ee),Ua()||!fe||this.isPartRange(ke,be))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Q+F+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[q]=`${I+D+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let re=Dp(o.TABLE);const ae=re===l;ae&&(re=a.documentElement);const le=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,ye=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),ze=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const et=ae?C.getBoundingClientRect().left:C.offsetLeft;let v=!1,R=0;if(_?(R=et-parseInt(this.cornerDefaultStyle.width,10)/2,v=R<0):(R=et+Xn(C)+parseInt(this.cornerDefaultStyle.width,10)/2,v=R>=uD(re)),v){const A=Math.floor(I+D+this.cornerCenterPointOffset-ye-le);c?(this.cornerStyle[q]=`${A}px`,this.cornerStyle[_?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[q]=`${A-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(ae?C.getBoundingClientRect().top:C.offsetTop)+or(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=fp(re)){const A=Math.floor(Q+F+this.cornerCenterPointOffset-ze-le);c?(this.cornerStyle.top=`${A}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${A-1}px`}this.cornerStyle.display="block"}Ua()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,s,Q,I,D,F)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,g=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return or(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return Xn(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(m=l(t,C-i),g=l(r,C-i),!m||!g)return!1;const y=si(m),w=si(g);return m&&g&&(h=y[f]-s[f]-1,d=w[f]+u(g)-y[f]),[m,h,d]}return!1}changeBorderStyle(e,t){const r=this[e].style,i=t[e];!i||i.hide?ee(this[e],"hidden"):(Be(this[e],"hidden")&&Me(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},r=this[e].style;r.backgroundColor=t.color,r.width=`${t.width}px`,r.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?ee(this[e],"hidden"):Me(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ua()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function T0e(n,e){_8(n,e),e.add(n)}function Ig(n,e,t){_8(n,e),e.set(n,t)}function _8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dt(n,e){return n.get(_k(n,e))}function T2(n,e,t){return n.set(_k(n,e),t),t}function _k(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var yi=new WeakMap,hs=new WeakMap,HI=new WeakMap,Bw=new WeakMap,DI=new WeakMap,Ed=new WeakMap,b2=new WeakSet;class b0e{constructor(e){T0e(this,b2),Ig(this,yi,void 0),Ig(this,hs,void 0),Ig(this,HI,new E0e),Ig(this,Bw,new WeakMap),Ig(this,DI,new WeakSet),Ig(this,Ed,new Map),T2(hs,this,e)}setActiveOverlay(e){return T2(yi,this,e),dt(HI,this).setActiveOverlay(dt(yi,this)),dt(Bw,this).has(dt(yi,this))||dt(Bw,this).set(dt(yi,this),new Set),this}getFocusSelection(){return dt(hs,this)!==null?dt(hs,this).getFocus():null}getAreaSelection(){return dt(hs,this)!==null?dt(hs,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(dt(Ed,this).has(e)){const r=dt(Ed,this).get(e);if(r.has(dt(yi,this)))return r.get(dt(yi,this));const i=new R2(dt(yi,this),e.settings);return r.set(dt(yi,this),i),i}const t=new R2(dt(yi,this),e.settings);return dt(Ed,this).set(e,new Map([[dt(yi,this),t]])),t}getBorderInstances(e){var t,r;return Array.from((t=(r=dt(Ed,this).get(e))===null||r===void 0?void 0:r.values())!==null&&t!==void 0?t:[])}destroyBorders(e){dt(Ed,this).get(e).forEach(t=>t.destroy()),dt(Ed,this).delete(e)}render(e){if(dt(hs,this)===null)return;e&&_k(b2,this,A0e).call(this);const t=Array.from(dt(hs,this)),r=new Map,i=new Map;for(let s=0;s<t.length;s++){const o=t[s],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=o.settings;dt(DI,this).has(o)||(dt(DI,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h==null||h.disappear();continue}a&&dt(HI,this).setActiveSelection(o).scan().forEach(m=>{if(r.has(m)){const g=r.get(m);g.has(a)&&u===!0?g.set(a,g.get(a)+1):g.set(a,1)}else r.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=o.getCorners();dt(yi,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>dt(Bw,this).get(dt(yi,this)).add(u)),ee(o,l),o.nodeName==="TD"&&Array.isArray((a=dt(hs,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Pe(o,dt(hs,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{Pe(s,[...i.get(s)])})}}function A0e(){const n=dt(Bw,this).get(dt(yi,this)),e=dt(yi,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)n.add(e[t]);n.forEach(t=>{var r,i;const s=dt(yi,this).wtTable.TABLE.querySelectorAll(`.${t}`);let o=[];Array.isArray((r=dt(hs,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(o=dt(hs,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=dt(hs,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...dt(hs,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)Me(s[a],t),Kl(s[a],o)}),n.clear()}class N0e extends yC{constructor(e,t,r,i){super(e,t,qf,r,i)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Nk(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===t&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),nN(r,`${s}px`,"0px")):(s=this.getScrollPosition(),dC(r));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===t&&e!==t.scrollX){const s=t.scrollX;t.scrollTo(e,aD(t)),r=s!==t.scrollX}else if(e!==i.scrollLeft){const s=i.scrollLeft;i.scrollLeft=e,r=s!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<t;)s+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=t.getWorkspaceHeight();t.hasHorizontalScroll()&&(u-=ar(r)),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=Xn(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=Ok(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(t.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!Be(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(t){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(t=!1)}return t&&a.offsetWidth!==a.clientWidth&&(c=ar(this.domBindings.rootDocument)),t?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,y9(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(lD(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,r=this.wot.wtTable.holder.parentNode,i=t.getSetting("rowHeaders"),s=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),a=t.getSetting("preventOverflow")==="vertical";o?Me(r,"emptyRows"):ee(r,"emptyRows");let l=!1;if(!a){if(s&&!i.length)ee(r,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const u=Be(r,"innerBorderInlineStart");e?(ee(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(Me(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const M0e="stickyRowsTop",Pk={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};lu(Pk,"MIXIN_NAME",M0e,{writable:!1,enumerable:!1});class xk extends fv{constructor(e,t,r,i){super(e,t,r,i,Qf)}}Vt(xk,Pk);Vt(xk,dN);function A2(n,e,t){return(e=I0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function I0e(n){var e=O0e(n,"string");return typeof e=="symbol"?e:e+""}function O0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _0e extends yC{constructor(e,t,r,i,s,o){super(e,t,Qf,r,i),A2(this,"topOverlay",void 0),A2(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new xk(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();nN(e,`${i}px`,`${s}px`)}else dC(e);let t=or(this.clone.wtTable.TABLE);const r=Xn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${r}px`,!1}}class Lk extends fv{constructor(e,t,r,i){super(e,t,r,i,Xf)}}Vt(Lk,Pk);Vt(Lk,fN);function P0e(n,e,t){return(e=x0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function x0e(n){var e=L0e(n,"string");return typeof e=="symbol"?e:e+""}function L0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class H0e extends yC{constructor(e,t,r,i){super(e,t,Xf,r,i),P0e(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Lk(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===t&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;s=u===c,i=this.getOverlayOffset(),nN(e,"0px",`${i}px`)}else i=this.getScrollPosition(),dC(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===t&&e!==t.scrollY){const s=t.scrollY;t.scrollTo(eN(t),e),i=s!==t.scrollY}else if(e!==r.scrollTop){const s=r.scrollTop;r.scrollTop=e,i=s!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,s=0;for(;i<t;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?r:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=t.getWorkspaceWidth();t.hasVerticalScroll()&&(u-=ar(r)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=or(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=Ok(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(t.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:r,wtSettings:i}=this,o=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Be(o.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(t){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(t=!1)}if(t&&o.offsetHeight!==o.clientHeight&&(h=ar(this.domBindings.rootDocument)),t){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,w9(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return tN(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,s=r.getSetting("totalColumns"),o=r.getSetting("preventOverflow")==="horizontal";s?Me(i,"emptyColumns"):ee(i,"emptyColumns");let a=!1;if(!t&&!o){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=Be(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(ee(i,"innerBorderTop"),a=!h):(Me(i,"innerBorderTop"),a=h)}}return a}}function RE(n,e,t){D0e(n,e),e.set(n,t)}function D0e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wu(n,e,t){return(e=F0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function F0e(n){var e=k0e(n,"string");return typeof e=="symbol"?e:e+""}function k0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Rd(n,e,t){return n.set(P8(n,e),t),t}function yu(n,e){return n.get(P8(n,e))}function P8(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Og=new WeakMap,TE=new WeakMap,_g=new WeakMap,bE=new WeakMap;class V0e{constructor(e,t,r,i,s,o){wu(this,"wot",null),RE(this,Og,[]),wu(this,"topOverlay",null),wu(this,"bottomOverlay",null),wu(this,"inlineStartOverlay",null),wu(this,"topInlineStartCornerOverlay",null),wu(this,"bottomInlineStartCornerOverlay",null),wu(this,"browserLineHeight",void 0),wu(this,"wtSettings",null),RE(this,TE,!1),RE(this,_g,0),RE(this,bE,null),wu(this,"resizeObserver",new ResizeObserver(c=>{gS(()=>{!Array.isArray(c)||!c.length||(Rd(_g,this,yu(_g,this)+1),yu(_g,this)===300&&(wt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),yu(bE,this)!==null&&clearTimeout(yu(bE,this)),Rd(bE,this,setTimeout(()=>{Rd(_g,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=t,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=ar(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:pS(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[...yu(Og,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,r=e.getComputedStyle(t.body),i=parseInt(r.lineHeight,10),s=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new H0e(...e),this.bottomOverlay=new f0e(...e),this.inlineStartOverlay=new N0e(...e),this.topInlineStartCornerOverlay=new _0e(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new l0e(...e,this.bottomOverlay,this.inlineStartOverlay),Rd(Og,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Rd(TE,this,yu(Og,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),yu(Og,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),yu(Og,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!rD())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(t,"resize",()=>{gS(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Rd(_g,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==t&&s!==t&&!e.target.contains(i)||r!==t&&s!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){if(e.ctrlKey)return;const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==r&&o!==r&&!o.contains(s),l=i!==r&&o!==r&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=cv(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);const i=this.scrollVertically(t),s=this.scrollHorizontally(r);return i||s}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,t=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=r)}this.verticalScrolling&&(t.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!yu(TE,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),Rd(TE,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=pS(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,r=e.clientHeight,i=t!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,o)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,s),f=t.hider.style,m=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-t.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-t.holder.clientWidth),C=m()?1:0,y=g()?1:0;f.width=`${h+y}px`,f.height=`${c+C}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return k(t,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];k(t,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function N2(n,e,t){return(e=$0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $0e(n){var e=U0e(n,"string");return typeof e=="symbol"?e:e+""}function U0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class B0e{constructor(e){N2(this,"settings",{}),N2(this,"defaults",Object.freeze(this.getDefaults())),ct(this.defaults,(t,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(t===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{const i=this.getSetting("data",e,t);Xh(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,t){return t===void 0?ct(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=t,this}getSetting(e,t,r,i,s){return typeof this.settings[e]=="function"?this.settings[e](t,r,i,s):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Hk extends fv{constructor(e,t,r,i){super(e,t,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Dp(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=vS(e,"height",t),s=vS(e,"overflow",t),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(t.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),o.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Yf(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,r="master",s=e.getSetting("columnHeaders").length;if(s&&!t.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);t.hasOversizedColumnHeadersMarked[r]=!0}}}Vt(Hk,Ak);Vt(Hk,fN);class W0e{constructor(e,t,r,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new dTe:new wTe],["fullyVisible",()=>new nTe],["partiallyVisible",()=>new y8]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new uTe:new mTe],["fullyVisible",()=>new JRe],["partiallyVisible",()=>new w8]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return t===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=or(t)>0&&t.clientHeight>0?t.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:t}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===t){const s=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollHeight>s.clientHeight}const{holder:e,hider:t}=this.wtTable,r=e.clientHeight,i=t.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}const{hider:e}=this.wtTable,t=e.offsetWidth,r=this.hasVerticalScroll()?ar():0;return t>this.getWorkspaceWidth()-r}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,t){let r=0,i=e;for(;i<t;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return si(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=or(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=t.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=t.length;i<s;i++)r?(this.rowHeaderWidth+=Xn(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=o),r.holder.clientHeight===r.holder.offsetHeight?s=0:s=ar(this.domBindings.rootDocument),new ATe({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:t.getSetting("totalRows"),defaultRowHeight:t.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=ar(this.domBindings.rootDocument)),new RTe({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:t.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const s=r.getResultsFor("fullyVisible"),o=r.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s,o)}if(e&&!t.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible"),o=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s,o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,t){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:i}=e;const{startRow:s,endRow:o}=t;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(s)&&!this.wtTable.isRowAfterRenderedRows(o))return!0;r=s,i=o}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(r=Math.max(0,r-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(r=Math.max(0,r-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),r<a||r===a&&r>0?!1:!(i>l||i===l&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e,t){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:i}=e;const{startColumn:s,endColumn:o}=t;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(s)&&!this.wtTable.isColumnAfterRenderedColumns(o))return!0;r=s,i=o}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(r=Math.max(0,r-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(r=Math.max(0,r-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),r<a||r===a&&r>0?!1:!(i>l||i===l&&i<h)}resetHasOversizedColumnHeadersMarked(){ct(this.hasOversizedColumnHeadersMarked,(e,t,r)=>{r[t]=void 0})}}class j0e extends Tk{constructor(e,t){super(e,new B0e(t));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new Hk(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new W0e(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new b0e(this.wtSettings.getSetting("selections")),this.wtEvent=new T8(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new V0e(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],r=[];ct(e,(i,s)=>{this.wtSettings.getSetting(s).length&&r.push(i),t.push(i)}),Me(this.wtTable.wtRootElement.parentNode,t),ee(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var t;if(!N8.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(t=this.wtOverlays[`${r}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Dk{constructor(e){e instanceof Tk?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const r=new Dk(t);return()=>r},this._wot=new j0e(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,r){return this._wot.createCellRange(e,t,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,r){return this._wot.scrollViewport(e,t,r)}scrollViewportHorizontally(e,t){return this._wot.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wot.scrollViewportVertically(e,t)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,r,i,s){return this._wot.wtSettings.getSetting(e,t,r,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function M2(n,e,t){return(e=z0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function z0e(n){var e=G0e(n,"string");return typeof e=="symbol"?e:e+""}function G0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class mg{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;M2(this,"indexedValues",[]),M2(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Pt(this.initValueOrFn)?Le(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):Le(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Vt(mg,Hr);function Fk(n,e,t,r){const i=t.length?t[0]:void 0;return[...n.slice(0,i),...t.map((s,o)=>Pt(r)?r(s,o):r),...i===void 0?[]:n.slice(i)]}function kk(n,e){return Yh(n,(t,r)=>e.includes(r)===!1)}class ad extends mg{insert(e,t){this.indexedValues=Fk(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=kk(this.indexedValues,e),super.remove(e)}}class gN extends ad{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Er(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}function Vk(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function wS(n,e){return Yh(n,t=>e.includes(t)===!1)}function $k(n,e){return At(n,t=>t-e.filter(r=>r<t).length)}function Uk(n,e){const t=e[0],r=e.length;return At(n,i=>i>=t?i+r:i)}function Y0e(n,e,t){return(e=K0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function K0e(n){var e=X0e(n,"string");return typeof e=="symbol"?e:e+""}function X0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class mN extends mg{constructor(){super(...arguments),Y0e(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=wS(this.orderOfIndexes,[e]),Pt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=Fk(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=Uk(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=kk(this.indexedValues,e),this.orderOfIndexes=wS(this.orderOfIndexes,e),this.orderOfIndexes=$k(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class SC extends ad{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Er(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}const I2=new Map([["indexesSequence",{getListWithInsertedItems:Vk,getListWithRemovedItems:wS}],["physicallyIndexed",{getListWithInsertedItems:Fk,getListWithRemovedItems:kk}]]),x8=n=>{if(I2.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return I2.get(n)};class L8 extends mg{constructor(){super(e=>e)}insert(e,t){const r=Uk(this.indexedValues,t);this.indexedValues=Vk(r,e,t),super.insert(e,t)}remove(e){const t=wS(this.indexedValues,e);this.indexedValues=$k(t,e),super.remove(e)}}const O2=new Map([["hiding",gN],["index",mg],["linkedPhysicalIndexToValue",mN],["physicalIndexToValue",ad],["trimming",SC]]);function q0e(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!O2.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(O2.get(n))(e)}function Q0e(n,e,t){return(e=Z0e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Z0e(n){var e=J0e(n,"string");return typeof e=="symbol"?e:e+""}function J0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let $x=0;class Bk{constructor(){Q0e(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),$x+=1)}unregister(e){const t=this.collection.get(e);Re(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),$x-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return fn(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(r=>{r.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}Vt(Bk,Hr);function eAe(){return $x}function FI(n,e,t){return(e=tAe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tAe(n){var e=nAe(n,"string");return typeof e=="symbol"?e:e+""}function nAe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _2 extends Bk{constructor(e,t){super(),FI(this,"mergedValuesCache",[]),FI(this,"aggregationFunction",void 0),FI(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=At(this.get(),s=>s.getValues()),r=[],i=Re(t[0])&&t[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(t[a][s]);r.push(o)}return At(r,this.aggregationFunction)}getMergedValueAtIndex(e,t){const r=this.getMergedValues(t)[e];return Re(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function rAe(n,e,t){iAe(n,e),e.set(n,t)}function iAe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sAe(n,e,t){return n.set(H8(n,e),t),t}function oAe(n,e){return n.get(H8(n,e))}function H8(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var kI=new WeakMap;class D8{constructor(){rAe(this,kI,[])}subscribe(e){return this.addLocalHook("change",e),this._write(oAe(kI,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){sAe(kI,this,e)}}Vt(D8,Hr);function P2(n,e){const t=[];let r=0,i=0;for(;r<n.length&&i<e.length;r++,i++)n[r]!==e[i]&&t.push({op:"replace",index:i,oldValue:n[r],newValue:e[i]});for(;r<e.length;r++)t.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<n.length;i++)t.push({op:"remove",index:i,oldValue:n[i],newValue:void 0});return t}function Gv(n,e,t){aAe(n,e),e.set(n,t)}function aAe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function To(n,e){return n.get(F8(n,e))}function AE(n,e,t){return n.set(F8(n,e),t),t}function F8(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var NE=new WeakMap,Yv=new WeakMap,ME=new WeakMap,IE=new WeakMap,OE=new WeakMap;class lAe{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Gv(this,NE,new Set),Gv(this,Yv,[]),Gv(this,ME,[]),Gv(this,IE,!1),Gv(this,OE,!1),AE(OE,this,e??!1)}createObserver(){const e=new D8;return To(NE,this).add(e),e.addLocalHook("unsubscribe",()=>{To(NE,this).delete(e)}),e._writeInitialChanges(P2(To(Yv,this),To(ME,this))),e}emit(e){let t=To(ME,this);(!To(IE,this)||To(Yv,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(To(OE,this)):AE(Yv,this,new Array(e.length).fill(To(OE,this))),To(IE,this)||(AE(IE,this,!0),t=To(Yv,this)));const r=P2(t,e);To(NE,this).forEach(i=>i._write(r)),AE(ME,this,e)}}function Li(n,e,t){return(e=uAe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function uAe(n){var e=cAe(n,"string");return typeof e=="symbol"?e:e+""}function cAe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ux{constructor(){Li(this,"indexesSequence",new L8),Li(this,"trimmingMapsCollection",new _2(e=>e.some(t=>t===!0),!1)),Li(this,"hidingMapsCollection",new _2(e=>e.some(t=>t===!0),!1)),Li(this,"variousMapsCollection",new Bk),Li(this,"hidingChangesObservable",new lAe({initialIndexValue:!1})),Li(this,"notTrimmedIndexesCache",[]),Li(this,"notHiddenIndexesCache",[]),Li(this,"isBatched",!1),Li(this,"indexesSequenceChanged",!1),Li(this,"indexesChangeSource",void 0),Li(this,"trimmedIndexesChanged",!1),Li(this,"hiddenIndexesChanged",!1),Li(this,"renderablePhysicalIndexesCache",[]),Li(this,"fromPhysicalToVisualIndexesCache",new Map),Li(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,q0e(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof SC?this.trimmingMapsCollection.register(e,t):t instanceof gN?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const r=this.getNumberOfIndexes();return r>0&&t.init(r),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return Re(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return Re(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return Re(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return Re(t)?t:null}getNearestNotHiddenIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return t>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?r?this.getNearestNotHiddenIndex(e,-t,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const r=At(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=wS(this.getIndexesSequence(),r),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(t+s<i){const u=a[t];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(Vk(o,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],s=Re(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=At(new Array(t).fill(s),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0;const l=r==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(o,l),this.hidingMapsCollection.insertToEvery(o,l),this.variousMapsCollection.insertToEvery(o,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(r,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromRenderableIndex(t),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,t)}}}Vt(Ux,Hr);function hAe(n,e){k8(n,e),e.add(n)}function VI(n,e,t){k8(n,e),e.set(n,t)}function k8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kv(n,e,t){return(e=dAe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dAe(n){var e=fAe(n,"string");return typeof e=="symbol"?e:e+""}function fAe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Eh(n,e){return n.get(fs(n,e))}function s0(n,e,t){return n.set(fs(n,e),t),t}function fs(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("modifyAutoColumnSizeSeed");const $I="autoColumnSize",gAe=10,mAe="autoColumnSize";var Wk=new WeakMap,vm=new WeakMap,$p=new WeakMap,Xs=new WeakSet;class py extends yt{static get PLUGIN_KEY(){return $I}static get PLUGIN_PRIORITY(){return gAe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),hAe(this,Xs),Kv(this,"ghostTable",new Ck(this.hot)),Kv(this,"samplesGenerator",new hN((t,r)=>{const i=this.hot.toPhysicalRow(t),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(t,r);let a="";o.spanned||(a=this.hot.getDataAtCell(t,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),Kv(this,"inProgress",!1),Kv(this,"measuredColumns",0),Kv(this,"columnWidthsMap",new ad),VI(this,Wk,!1),VI(this,vm,[]),VI(this,$p,[]),this.hot.columnIndexMapper.registerMap(mAe,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,r,i)=>fs(Xs,this,x2).call(this,t,r,i))}isEnabled(){return this.hot.getSettings()[$I]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return fs(Xs,e,wAe).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return fs(Xs,e,yAe).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return fs(Xs,e,CAe).call(e,...i)}),this.addHook("beforeRender",()=>fs(Xs,this,vAe).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>fs(Xs,this,SAe).call(this)),super.enablePlugin()}updatePlugin(){s0($p,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,r)=>fs(Xs,this,x2).call(this,e,t,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(e===-1||t===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:t},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;Le(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&fs(Xs,this,V8).call(this,o,s)}),this.ghostTable.columns.length&&(fs(Xs,this,$8).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){mS(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+py.CALCULATION_STEP,i)},e,t),r=r+py.CALCULATION_STEP+1,r<i?s=gS(o):(mS(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,t),r=a+1),r<i?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[$I];let t=py.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return je(e)&&(t=e.syncLimit,JH(t)?t=pD(r,t):t>>=0),Math.min(t,r)}getColumnWidth(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=t;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Vp))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,s)=>{const o=Eh(vm,this).length;return(o-1<s||Eh(vm,this)[s]!==i)&&r.push(this.hot.toVisualColumn(s)),o-1<s?Eh(vm,this).push(i):Eh(vm,this)[s]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function pAe(n){const e={from:0,to:this.hot.countRows()-1};n.forEach(t=>{const r=this.hot.toPhysicalColumn(t);r!==null&&(this.hot._getColWidthFromSettings(r)||fs(Xs,this,V8).call(this,t,e))}),this.ghostTable.columns.length&&(fs(Xs,this,$8).call(this),this.ghostTable.clean())}function V8(n,e){this.samplesGenerator.generateColumnSamples(n,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function $8(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((n,e)=>{const t=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(t,e)})},!0)}function vAe(){this.calculateVisibleColumnsWidth(),this.inProgress||(fs(Xs,this,pAe).call(this,Eh($p,this)),s0($p,this,[]))}function wAe(n,e){e||this.recalculateAllColumnsWidth()}function yAe(n){const e=n.reduce((t,r)=>{let[,i]=r;const s=this.hot.propToCol(i);return Number.isInteger(s)&&t.indexOf(s)===-1&&t.push(s),t},[]);Eh($p,this).push(...e)}function x2(n,e,t){let r=n;return t&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function SAe(){s0(vm,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),s0(Wk,this,!0)}function CAe(n){if(!Eh(Wk,this))return;const e=n.reduce((t,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);t.indexOf(o)===-1&&t.push(o)}return t},[]);Eh($p,this).push(...e)}const bf={horizontal:"horizontal",vertical:"vertical"};function EAe(n,e,t){let r,i,s;return e[0]===n[0]&&e[1]<n[1]?(s="left",r=t(e[0],e[1]),i=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(s="right",r=t(e[0],n[3]+1),i=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(s="up",r=t(e[0],e[1]),i=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(s="down",r=t(n[2]+1,e[1]),i=t(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:r,endOfDragCoords:i}}function RAe(n){const e={};return n===!0?(e.directions=Object.keys(bf),e.autoInsertRow=!0):je(n)?(Re(n.autoInsertRow)?n.direction===bf.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,Re(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(bf)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function TAe(n,e){bAe(n,e),e.add(n)}function bAe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pg(n,e,t){return(e=AAe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AAe(n){var e=NAe(n,"string");return typeof e=="symbol"?e:e+""}function NAe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function xg(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("modifyAutofillRange");we.getSingleton().register("beforeAutofill");we.getSingleton().register("afterAutofill");const L2="autofill",MAe=20,IAe=["fillHandle"],OAe="insert_row_below",_Ae=200;var Td=new WeakSet;class PAe extends yt{constructor(){super(...arguments),TAe(this,Td),Pg(this,"addingStarted",!1),Pg(this,"mouseDownOnCellCorner",!1),Pg(this,"mouseDragOutside",!1),Pg(this,"handleDraggedCells",0),Pg(this,"directions",[]),Pg(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return L2}static get PLUGIN_PRIORITY(){return MAe}static get SETTING_KEYS(){return[L2,...IAe]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>xg(Td,this,HAe).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>xg(Td,this,LAe).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>xg(Td,this,DAe).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.hot.getSelectedRangeLast(),{row:r,col:i}=t.getTopStartCorner(),{row:s,col:o}=t.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:i,endRow:s,endCol:o}]),l=[],u=[],c=[];return k(a,h=>{for(let d=h.startRow;d<=h.endRow;d+=1)l.indexOf(d)===-1&&l.push(d);for(let d=h.startCol;d<=h.endCol;d+=1)u.indexOf(d)===-1&&u.push(d)}),k(l,h=>{const d=[];k(u,f=>{const m=e?this.hot.getSourceDataAtCell(h,f):null;e&&je(m)?d.push(this.hot.getCopyableSourceData(h,f)):d.push(this.hot.getCopyableData(h,f))}),c.push(d)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,t),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=EAe(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=this.getSelectionData(!0),g=s.clone(),C=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,g,C,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let w=y;const S=y;if(["up","left"].indexOf(c)>-1&&!(S.length===1&&S[0].length===0))if(w=[],c==="up"){const E=d.row-h.row+1,P=E%S.length;for(let _=0;_<E;_++)w.push(S[(_+(S.length-P))%S.length])}else{const E=d.col-h.col+1,P=E%S[0].length;for(let _=0;_<S.length;_++){w.push([]);for(let I=0;I<E;I++)w[_].push(S[_][(I+(S[_].length-P))%S[_].length])}}if(m.some(E=>E.some(P=>je(P)))){const E=xg(Td,this,xAe).call(this,w,m,h,d,c);E.length&&(w=E)}this.hot.populateFromArray(h.row,h.col,w,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",w,g,C,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),r=t.getBottomEndCorner();let i=e;if(this.directions.includes(bf.vertical)&&this.directions.includes(bf.horizontal)){const s=t.getTopStartCorner();(r.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(bf.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(bf.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(OAe,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},_Ae)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),r=this.hot.countRows();let i;for(let s=e[2]+1;s<r;s++){for(let l=e[1];l<=e[3];l++){const u=t[s][l];if(!Dn(u))return-1}const o=t[s][e[1]-1],a=t[s][e[3]+1];(!Dn(o)||!Dn(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...At(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,r=si(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+or(this.hot.table),i=si(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+Xn(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>xg(Td,this,FAe).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>xg(Td,this,kAe).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=RAe(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function xAe(n,e,t,r){const i=[];for(let s=Math.min(t.row,r.row);s<=Math.max(t.row,r.row);s+=1){i.push([]);for(let o=Math.min(t.col,r.col);o<=Math.max(t.col,r.col);o+=1){const a=this.hot.getSourceDataAtCell(s,o),l=s-Math.min(t.row,r.row),u=o-Math.min(t.col,r.col),c=l%e.length,h=u%e[0].length;je(a)?i[l][u]=e[c][h]:i[l][u]=n[c][h]}}return i}function LAe(){this.selectAdjacent()&&this.fillIn()}function HAe(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function DAe(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}function FAe(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function kAe(n){const e=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function VAe(n,e){U8(n,e),e.add(n)}function H2(n,e,t){U8(n,e),e.set(n,t)}function U8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lg(n,e,t){return(e=$Ae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $Ae(n){var e=UAe(n,"string");return typeof e=="symbol"?e:e+""}function UAe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function B8(n,e,t){return n.set(Qs(n,e),t),t}function o0(n,e){return n.get(Qs(n,e))}function Qs(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const UI="autoRowSize",BAe=40,WAe="autoRowSize",D2="htFirstDatasetColumnNotRendered";var yS=new WeakMap,jk=new WeakMap,Mo=new WeakSet;class vy extends yt{static get PLUGIN_KEY(){return UI}static get PLUGIN_PRIORITY(){return BAe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),VAe(this,Mo),Lg(this,"headerHeight",null),Lg(this,"ghostTable",new Ck(this.hot)),Lg(this,"samplesGenerator",new hN((t,r)=>{const i=this.hot.toPhysicalColumn(r);if(this.hot.columnIndexMapper.isHidden(i)||t>=0&&r>=0&&this.hot.getCellMeta(t,r).hidden)return!1;let s;return t>=0?s=this.hot.getDataAtCell(t,r):t===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Lg(this,"inProgress",!1),Lg(this,"measuredRows",0),Lg(this,"rowHeightsMap",new ad),H2(this,yS,[]),H2(this,jk,!1),this.hot.rowIndexMapper.registerMap(WAe,this.rowHeightsMap),this.addHook("beforeRowResize",(t,r,i)=>Qs(Mo,this,F2).call(this,t,r,i))}isEnabled(){const e=this.hot.getSettings()[UI];return e===!0||je(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Qs(Mo,e,YAe).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Qs(Mo,e,KAe).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Qs(Mo,e,qAe).call(e,...i)}),this.addHook("beforeViewRender",()=>Qs(Mo,this,zAe).call(this)),this.addHook("beforeRender",()=>Qs(Mo,this,GAe).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>Qs(Mo,this,XAe).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),Qs(Mo,this,W8).call(this,!1),this.addHook("beforeRowResize",(e,t,r)=>Qs(Mo,this,F2).call(this,e,t,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(e===-1||t===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:t},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}Le(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){mS(s),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+vy.CALCULATION_STEP,i)},e,t),r=r+vy.CALCULATION_STEP+1,r<i?s=gS(o):(mS(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,t),r=a+1),r<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[UI];let t=vy.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return je(e)&&(t=e.syncLimit,JH(t)?t=pD(r,t):t>>=0),Math.min(t,r)}getRowHeight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.stylesHandler.getDefaultRowHeight();if(e<0){var r;return(r=this.headerHeight)!==null&&r!==void 0?r:t}const i=this.hot.toPhysicalRow(e);if(this.hot.rowIndexMapper.isHidden(i))return t;const s=this.rowHeightsMap.getValueAtIndex(i);let o=t;return s!==null&&s>t&&(o=s),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Le(Math.min(t,r),Math.max(t,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function jAe(n){const e={from:0,to:this.hot.countCols()-1};n.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,r)=>{const i=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function W8(n){const e=this.hot.getFirstRenderedVisibleColumn(),t=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(e);n===!1||t===this.hot.columnIndexMapper.getPhysicalFromRenderableIndex(0)?Me(this.hot.rootElement,D2):ee(this.hot.rootElement,D2)}function zAe(){Qs(Mo,this,W8).call(this)}function GAe(){this.calculateVisibleRowsHeight(),this.inProgress||(Qs(Mo,this,jAe).call(this,o0(yS,this)),B8(yS,this,[]))}function F2(n,e,t){let r=n;return t&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function YAe(n,e){e||this.recalculateAllRowsHeight()}function KAe(n){const e=n.reduce((t,r)=>{let[i]=r;return t.indexOf(i)===-1&&t.push(i),t},[]);o0(yS,this).push(...e)}function XAe(){this.recalculateAllRowsHeight(),B8(jk,this,!0)}function qAe(n){if(!o0(jk,this))return;const e=n.reduce((t,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);t.indexOf(o)===-1&&t.push(o)}return t},[]);o0(yS,this).push(...e)}const{getListWithInsertedItems:QAe,getListWithRemovedItems:ZAe}=x8("physicallyIndexed");class JAe extends mg{constructor(){super(e=>e)}insert(e,t){const r=Uk(this.indexedValues,t);this.indexedValues=QAe(r,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=ZAe(this.indexedValues,e);this.indexedValues=$k(t,e),super.remove(e)}}const{getListWithInsertedItems:eNe,getListWithRemovedItems:tNe}=x8("physicallyIndexed");class nNe extends mg{constructor(){super(e=>e)}insert(e,t){this.indexedValues=eNe(this.indexedValues,e,t,(r,i)=>this.getNextValue(i)),super.insert(e,t)}remove(e){this.indexedValues=tNe(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function rNe(n,e){iNe(n,e),e.add(n)}function iNe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sNe(n,e,t){return(e=oNe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oNe(n){var e=aNe(n,"string");return typeof e=="symbol"?e:e+""}function aNe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function lNe(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const k2="bindRowsWithHeaders",uNe=210,cNe="loose",V2=new Map([["loose",JAe],["strict",nNe]]);var $2=new WeakSet;class hNe extends yt{constructor(){super(...arguments),rNe(this,$2),sNe(this,"headerIndexes",null)}static get PLUGIN_KEY(){return k2}static get PLUGIN_PRIORITY(){return uNe}isEnabled(){return!!this.hot.getSettings()[k2]}enablePlugin(){var e;if(this.enabled)return;const t=(e=V2.get(this.getSetting()))!==null&&e!==void 0?e:V2.get(cNe);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",r=>lNe($2,this,dNe).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function dNe(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}function fNe(n,e){j8(n,e),e.add(n)}function gNe(n,e,t){j8(n,e),e.set(n,t)}function j8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U2(n,e,t){return(e=mNe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mNe(n){var e=pNe(n,"string");return typeof e=="symbol"?e:e+""}function pNe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function B2(n,e){return n.get(jm(n,e))}function BI(n,e,t){return n.set(jm(n,e),t),t}function jm(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const _T="collapsibleColumns",vNe=290,wNe=["nestedHeaders"],gp="collapsibleIndicator",W2=_T,j2=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Hg=new WeakMap,Xv=new WeakSet;class yNe extends yt{constructor(){super(...arguments),fNe(this,Xv),U2(this,"nestedHeadersPlugin",null),U2(this,"headerStateManager",null),gNe(this,Hg,null)}static get PLUGIN_KEY(){return _T}static get PLUGIN_PRIORITY(){return vNe}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[_T,...wNe]}isEnabled(){return!!this.hot.getSettings()[_T]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||wt("You need to configure the Nested Headers plugin in order to use collapsible headers."),BI(Hg,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>jm(Xv,this,ENe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return jm(Xv,e,RNe).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return jm(Xv,e,SNe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,s)=>jm(Xv,this,CNe).call(this,r,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),BI(Hg,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:r}=this.hot.getSelectedRangeActive().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(t,r))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:t,col:o}):this.collapseSection({row:t,col:o}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeActive())===null||t===void 0?void 0:t.highlight.isHeader())},group:W2,relativeToGroup:od,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(W2)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};Le(0,e-1,o=>{const a=t.childNodes[o],l=r.childNodes[o],u=i?i.childNodes[o]:null;Le(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${gp}`);s(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${gp}`),s(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${gp}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=r;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!j2.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const r=Yh(e,f=>{let{row:m}=f;return m<0});let i=r.length>0;k(r,f=>{var m;let{row:g,col:C}=f;const{collapsible:y,isCollapsed:w}=(m=this.headerStateManager.getHeaderSettings(g,C))!==null&&m!==void 0?m:{};if(!y||w&&t==="collapse"||!w&&t==="expand")return i=!1,!1});const s=[],o=[];i&&k(r,f=>{let{row:m,col:g}=f;const{colspanCompensation:C,affectedColumns:y,rollbackModification:w}=this.headerStateManager.triggerNodeModification(t,m,g);C>0&&(o.push(...y),s.push(w))});const a=this.getCollapsedColumns();let l=[];t==="collapse"?l=H5([...a,...o]):t==="expand"&&(l=Yh(a,f=>!o.includes(f)));const u=j2.get(t);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){k(s,f=>{f()});return}this.hot.batchExecution(()=>{k(o,f=>{B2(Hg,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeActive();if(t==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&o.includes(m)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,y=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;C!==null&&y!==null&&this.hot.selectCell(C,y)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.view.adjustElementsSize(),this.hot.render()}getCollapsedColumns(){return B2(Hg,this).getHiddenIndexes()}destroy(){BI(Hg,this,null),super.destroy()}}function SNe(n,e,t){var r;const{collapsible:i,origColspan:s,isCollapsed:o}=(r=this.headerStateManager.getHeaderSettings(t,n))!==null&&r!==void 0?r:{},a=i&&s>1&&n>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${gp}`);if(Kl(e,[Yo("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ee(u,gp),e.querySelector("div:first-child").appendChild(u)),Me(u,["collapsed","expanded"]),o?(ee(u,"collapsed"),Xh(u,"+"),l&&Pe(e,...Yo(!1))):(ee(u,"expanded"),Xh(u,"-"),l&&Pe(e,...Yo(!0))),l&&Pe(u,...fg());else{var c;(c=u)===null||c===void 0||c.remove()}}function CNe(n,e){Be(n.target,gp)&&(Be(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Be(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),la(n))}function ENe(){this.updatePlugin()}function RNe(n,e){e||this.updatePlugin()}function bd(n,e,t){return(e=TNe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TNe(n){var e=bNe(n,"string");return typeof e=="symbol"?e:e+""}function bNe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const ANe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],NNe=!1,MNe=!0,INe=!0;class ONe{constructor(e,t){bd(this,"hot",void 0),bd(this,"sortingStates",new mN),bd(this,"sortEmptyCells",NNe),bd(this,"indicator",MNe),bd(this,"headerAction",INe),bd(this,"compareFunctionFactory",void 0),bd(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){je(e)&&ct(e,(t,r)=>{ANe.includes(r)&&(this[r]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[r]=t;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return je(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[r,i]=t;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(Re(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function z8(n,e,t){const r=e.locale;return function(i,s){const{sortEmptyCells:o}=t;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof s=="string"&&(s=s.toLocaleLowerCase(r)),i===s?ql:Dn(i)?Dn(s)?ql:o&&n==="asc"?_n:Pn:Dn(s)?o&&n==="asc"?Pn:_n:isNaN(i)&&!isNaN(s)?n==="asc"?Pn:_n:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?n==="asc"?_n:Pn:i>s?n==="asc"?Pn:_n:ql}}const G8="default";function _Ne(n,e,t){return function(r,i){const s=parseFloat(r),o=parseFloat(i),{sortEmptyCells:a}=t;if(s===o||isNaN(s)&&isNaN(o))return ql;if(a){if(Dn(r))return n==="asc"?_n:Pn;if(Dn(i))return n==="asc"?Pn:_n}return isNaN(s)?Pn:isNaN(o)?_n:s<o?n==="asc"?_n:Pn:s>o?n==="asc"?Pn:_n:ql}}const PNe="numeric";function xNe(n,e,t){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=t;return function(o,a){const l=Dn(o),u=Dn(a),c=l?i:o,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(s===!1){if(l&&u===!1)return Pn;if(l===!1&&u)return _n}return d===!1&&f?n==="asc"?_n:Pn:d&&f===!1?n==="asc"?Pn:_n:d===!1&&f===!1?z8(n,e,t)(o,a):c===i&&h===r?n==="asc"?_n:Pn:c===r&&h===i?n==="asc"?Pn:_n:ql}}const LNe="checkbox";function HNe(n,e,t){return Z8(n,e.dateFormat,t)}const DNe="date";function FNe(n,e,t){return Z8(n,e.timeFormat,t)}const kNe="time",{register:CC,getItem:z2,hasItem:VNe}=ua("sorting.compareFunctionFactory"),{register:Y8,getItem:$Ne}=ua("sorting.mainSortComparator");function K8(n){return VNe(n)?z2(n):z2(G8)}CC(LNe,xNe);CC(DNe,HNe);CC(G8,z8);CC(PNe,_Ne);CC(kNe,FNe);const ql=0,_n=-1,Pn=1;function UNe(n,e){const t=$Ne(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];n.sort(t(...i))}const a0="asc",l0="desc",X8="colHeader";function BNe(n){if(je(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[a0,l0].includes(t)}function WNe(n){if(n.some(t=>BNe(t)===!1))return!1;const e=n.map(t=>{let{column:r}=t;return r});return new Set(e).size===e.length}function G2(n){if(n!==l0)return n===a0?l0:a0}function q8(n){return n.querySelector(`.${X8}`)}function Q8(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function zk(n,e,t){return n===-1&&e>=0&&qh(t)===!1}function Z8(n,e,t){return function(r,i){const{sortEmptyCells:s}=t;if(r===i)return ql;if(Dn(r))return Dn(i)?ql:s&&n==="asc"?_n:Pn;if(Dn(i))return s&&n==="asc"?Pn:_n;const o=se(r,e),a=se(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?n==="asc"?_n:Pn:a.isBefore(o)?n==="asc"?Pn:_n:ql:_n:Pn}}function jNe(n,e){wt(Lt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${n}\` will work. The \`${e}\` plugin will remain disabled.`)}const zNe="ascending",GNe="descending",J8="indicatorDisabled",eX="columnSorting",tX="sortAction",nX=new Map([[a0,zNe],[l0,GNe]]);function YNe(n,e,t,r){const i=[eX];if(r&&i.push(tX),t===!1)return i.push(J8),i;const s=n.getSortOrderOfColumn(e);return Re(s)&&i.push(nX.get(s)),i}function KNe(){return Array.from(nX.values()).concat(tX,J8,eX)}function XNe(n,e){return function(t,r){const[,...i]=t,[,...s]=r;return function(a){const l=n[a],u=e[a],c=i[a],h=s[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:K8(u.type))(l,u,d)(c,h)}(0)}}function qNe(n,e){QNe(n,e),e.add(n)}function QNe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _E(n,e,t){return(e=ZNe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ZNe(n){var e=JNe(n,"string");return typeof e=="symbol"?e:e+""}function JNe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function wm(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const u0="columnSorting",eMe=50,c0="append",tMe="replace",Y2=u0;Y8(u0,XNe);we.getSingleton().register("beforeColumnSort");we.getSingleton().register("afterColumnSort");const qv=new WeakMap;var lf=new WeakSet;class rX extends yt{constructor(){super(...arguments),qNe(this,lf),_E(this,"columnStatesManager",null),_E(this,"columnMetaCache",null),_E(this,"pluginKey",u0),_E(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return u0}static get PLUGIN_PRIORITY(){return eMe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(qv.has(this.hot)&&qv.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),jNe(qv.get(this.hot),this.pluginKey);return}this.enabled||(qv.set(this.hot,this.pluginKey),this.columnStatesManager=new ONe(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ad(t=>{let r=this.hot.toVisualColumn(t);return r===null&&(r=t),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,r)=>wm(lf,this,nMe).call(this,t,r)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return wm(lf,e,iMe).call(e,...r)}),this.addHook("afterOnCellMouseDown",(t,r)=>this.onAfterOnCellMouseDown(t,r)),this.addHook("afterInit",()=>wm(lf,this,Bx).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return wm(lf,e,rMe).call(e,...r)}),this.hot.view&&wm(lf,this,Bx).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,r)=>{const i=q8(r);Q8(t,r)===!1||i===null||this.updateHeaderClasses(i)};qv.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeActive())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:od,position:"before",group:Y2})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Y2)}sort(e){const t=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",t,r,i)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new L8),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",t,i?r:t,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Re(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return WNe(e)&&e.every(r=>{let{column:i}=r;return i<=t&&i>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};t.initialConfig=At(e,r),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,r=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return Re(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=At(t.initialConfig,r)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(Re(t)){const i=G2(t);return Re(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:G2()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c0;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(fn(o))return[...s.slice(0,r),...s.slice(r+1)];if(t===c0)return[...s.slice(0,r),...s.slice(r+1),o];if(t===tMe)return[...s.slice(0,r),o,...s.slice(r+1)]}return Re(o)?s.concat(o):s}getPluginColumnConfig(e){if(je(e)){const t=e[this.pluginKey];if(je(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(r,t,this.getPluginColumnConfig(s.columns[e])):Pt(s.columns)?Object.assign(r,t,this.getPluginColumnConfig(s.columns(e))):Object.assign(r,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),r=Object.create(t);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],r=this.hot.countRows(),i=u=>At(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)t.push([this.hot.toPhysicalRow(u)].concat(i(u)));const s=At(t,u=>u[0]);UNe(t,this.pluginKey,At(e,u=>u.sortOrder),At(e,u=>this.getFirstCellSettings(u.column)));for(let u=t.length;u<r;u+=1)t.push([u].concat(i(u)));const o=At(t,u=>u[0]),a=new Map(At(s,(u,c)=>[u,o[c]])),l=At(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(je(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||je(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(Me(e,KNe()),this.enabled!==!1){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];ee(e,YNe(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Re(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&Be(e.target,X8)}onAfterOnCellMouseDown(e,t){if(zk(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(t.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function Bx(){const n=this.getAllSavedSortSettings();if(je(n))this.sortBySettings(n);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function nMe(n,e){const t=q8(e);if(Q8(n,e)===!1||t===null)return;const r=this.getFirstCellSettings(n)[this.pluginKey],i=r.indicator,s=r.headerAction;if(this.updateHeaderClasses(t,this.columnStatesManager,n,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(n);Pe(e,...pwe(o?`${o}ending`:"none"))}}function rMe(n){n===!0&&this.hot.view&&wm(lf,this,Bx).call(this)}function iMe(n,e,t,r){zk(e.row,e.col,n)!==!1&&this.wasClickableHeaderClicked(n,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function WI(n){return n==null||isNaN(n)}function sMe(n,e){if(typeof n!="number")return n;const t=r=>r.toString();switch(typeof e){case"number":return t(n.toFixed(Math.min(Math.max(0,e),100)));case"boolean":return e?t(Math.round(n)):n;case"string":if(e==="auto"){const r=Math.round(n).toString().length;return t(n.toFixed(8-r))}return n;default:return n}}function Ad(n,e,t){return(e=oMe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oMe(n){var e=aMe(n,"string");return typeof e=="symbol"?e:e+""}function aMe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class lMe{constructor(e,t){Ad(this,"plugin",void 0),Ad(this,"hot",void 0),Ad(this,"endpoints",[]),Ad(this,"settings",void 0),Ad(this,"settingsType","array"),Ad(this,"currentEndpoint",null),Ad(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),k(r,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),t.push(s)}),t}assignSetting(e,t,r,i){if(r==="ranges"&&e[r]===void 0){t[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;t[r]=i}else r==="destinationRow"&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}resetSetupBeforeStructureAlteration(e,t,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();k(s,o=>{i==="row"&&o.destinationRow>=t&&(e==="insert_row"?o.alterRowOffset=r:e==="remove_row"&&(o.alterRowOffset=-1*r)),i==="col"&&o.destinationColumn>=t&&(e==="insert_col"?o.alterColumnOffset=r:e==="remove_col"&&(o.alterColumnOffset=-1*r))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,t,r,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=t;k(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?k(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):k(u,d=>{this.shiftEndpointCoordinates(d,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,r,i){k(e.ranges,s=>{s[1]&&(t>=s[0]&&t<=s[1]?r>s[1]?s[1]+=i:r<s[0]&&(s[0]-=i):r>=s[0]&&r<=s[1]&&(s[1]-=i,t<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,r=[],i=[];k(t,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),k(i,s=>{let o=[];k(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),r.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),r.push(o))})}),e.ranges=r}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,k(e.ranges,r=>{k(r,(i,s)=>{i>=t&&(r[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],k(e,i=>{this.resetEndpointValue(i,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],k(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],k(e,(r,i,s)=>{`${r[2]||""}`!=`${r[3]}`&&k(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&t.indexOf(a)===-1&&t.push(a)})}),k(t,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const r=this.hot.getCellMeta(t,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?i:0)),""])}setEndpointValue(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(t==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}e.result=sMe(e.result,e.roundFloat),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){wt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function uMe(n,e){cMe(n,e),e.add(n)}function cMe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hMe(n,e,t){return(e=dMe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dMe(n){var e=fMe(n,"string");return typeof e=="symbol"?e:e+""}function fMe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Dg(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const jI="columnSummary",gMe=220;var Nd=new WeakSet;class mMe extends yt{constructor(){super(...arguments),uMe(this,Nd),hMe(this,"endpoints",null)}static get PLUGIN_KEY(){return jI}static get PLUGIN_PRIORITY(){return gMe}isEnabled(){return!!this.hot.getSettings()[jI]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[jI],this.endpoints=new lMe(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Dg(Nd,e,pMe).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Dg(Nd,e,wMe).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Dg(Nd,e,vMe).call(e,...r)}),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Dg(Nd,e,yMe).call(e,...r)}),this.addHook("afterUpdateData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Dg(Nd,e,SMe).call(e,...r)}),this.addHook("beforeCreateRow",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,r,null,i)),this.addHook("beforeCreateCol",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,r,null,i)),this.addHook("afterCreateCol",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,r,null,i)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Dg(Nd,e,CMe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return ct(e.ranges,r=>{t+=this.getPartialSum(r,e.sourceColumn)}),t}getPartialSum(e,t){let r=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,t),s=WI(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}r+=s||0,i-=1}while(i>=e[0]);return Math.round(r*10**o)/10**o}calculateMinMax(e,t){let r=null;return ct(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,t);if(r===null&&s!==null&&(r=s),s!==null)switch(t){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}}),r===null?"Not enough data":r}getPartialMinMax(e,t,r){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,t),o=WI(o)?null:o,i===null)i=o;else if(o!==null)switch(r){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,t){let r,i=0,s=e[1]||e[0];do r=this.getCellValue(s,t),r=WI(r)?null:r,r===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let t=0;const r=e.ranges;return ct(r,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);t+=s,t-=o}),t}calculateAverage(e){const t=this.calculateSum(e),r=this.countEntries(e);return t/r}getCellValue(e,t){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(t);let s=this.hot.getSourceDataAtCell(e,t),o="";if(r!==null&&i!==null&&(o=this.hot.getCellMeta(r,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Lt`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function pMe(){this.endpoints.initEndpoints()}function vMe(n){n.columns!==void 0&&this.endpoints.refreshCellMetas()}function wMe(n,e){n&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}function yMe(n,e){e||this.endpoints.refreshAllEndpoints()}function SMe(n,e){e||this.endpoints.refreshAllEndpoints()}function CMe(n,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,n.length,n,this.pluginName)}function EMe(n,e){iX(n,e),e.add(n)}function zI(n,e,t){iX(n,e),e.set(n,t)}function iX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ym(n,e){return n.get(Gk(n,e))}function Wx(n,e,t){return n.set(Gk(n,e),t),t}function Gk(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var h0=new WeakMap,PE=new WeakMap,xE=new WeakMap,K2=new WeakSet;class sX{constructor(){EMe(this,K2),zI(this,h0,!0),zI(this,PE,null),zI(this,xE,new ResizeObserver(e=>Gk(K2,this,RMe).call(this,e)))}setObservedElement(e){Wx(PE,this,e)}unobserve(){ym(xE,this).unobserve(ym(PE,this))}observe(){Wx(h0,this,!0),ym(xE,this).observe(ym(PE,this))}destroy(){ym(xE,this).disconnect()}}function RMe(n){if(ym(h0,this)||!Array.isArray(n)||!n.length){Wx(h0,this,!1);return}n.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:r,blockSize:i}=t[0];this.runLocalHooks("resize",r,i)})}Vt(sX,Hr);function Ic(n,e,t){TMe(n,e),e.set(n,t)}function TMe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xt(n,e){return n.get(oX(n,e))}function ul(n,e,t){return n.set(oX(n,e),t),t}function oX(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Fg=new WeakMap,GI=new WeakMap,YI=new WeakMap,Su=new WeakMap,Oc=new WeakMap,_c=new WeakMap,LE=new WeakMap,kg=new WeakMap;class Af{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t,r){var i=this;Ic(this,Fg,void 0),Ic(this,GI,void 0),Ic(this,YI,!1),Ic(this,Su,null),Ic(this,Oc,void 0),Ic(this,_c,void 0),Ic(this,LE,!0),Ic(this,kg,new sX),ul(Fg,this,e),ul(GI,this,r),ul(YI,this,t),ul(Oc,this,this.createEditor()),ul(_c,this,Xt(Oc,this).style),Xt(kg,this).setObservedElement(this.getInputElement()),Xt(kg,this).addLocalHook("resize",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,t){Xt(_c,this).left=`${e}px`,Xt(_c,this).top=`${t}px`}setSize(e,t){if(e&&t){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${t}px`}}getSize(){return{width:Xn(this.getInputElement()),height:or(this.getInputElement())}}observeSize(){Xt(kg,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){Xt(_c,this).display="block",ul(LE,this,!1)}hide(){Xt(kg,this).unobserve(),Xt(LE,this)||(Xt(_c,this).display="none"),ul(LE,this,!0)}isVisible(){return Xt(_c,this).display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return Xt(Fg,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Xt(Fg,this).createElement("div"),t=Xt(Fg,this).createElement("textarea");return e.style.display="none",ul(Su,this,Xt(Fg,this).createElement("div")),Xt(Su,this).setAttribute("dir",Xt(YI,this)?"rtl":"ltr"),ee(Xt(Su,this),Af.CLASS_EDITOR_CONTAINER),Xt(GI,this).appendChild(Xt(Su,this)),ee(e,Af.CLASS_EDITOR),ee(t,Af.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),Xt(Su,this).appendChild(e),e}getInputElement(){return Xt(Oc,this).querySelector(`.${Af.CLASS_INPUT}`)}getEditorElement(){return Xt(Oc,this)}destroy(){const e=Xt(Su,this)?Xt(Su,this).parentNode:null;Xt(Oc,this).parentNode.removeChild(Xt(Oc,this)),ul(Oc,this,null),ul(_c,this,null),Xt(kg,this).destroy(),e&&e.removeChild(Xt(Su,this))}}Vt(Af,Hr);function KI(n,e,t){return(e=bMe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bMe(n){var e=AMe(n,"string");return typeof e=="symbol"?e:e+""}function AMe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const NMe=250,MMe=250;class aX{constructor(e){KI(this,"wasLastActionShow",!0),KI(this,"showDebounced",null),KI(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},MMe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NMe;this.showDebounced=gC(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}Vt(aX,Hr);function IMe(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function OMe(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Md(n,e){const t={};return k(n,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&(t[i]||(t[i]=[]),t[i][s]=e(i,s))})}),t}function Qc(n,e,t,r,i){k(n,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&_Me(o,a,e,t,r,i)})})}function _Me(n,e,t,r,i,s){const o=i(n,e);let a=r;o.className&&(t==="vertical"?a=IMe(o.className,r):a=OMe(o.className,r)),s(n,e,"className",a)}function lX(n){return`<span class="selected"></span>${n}`}function PT(n,e){let t=!1;return Array.isArray(n)&&k(n,r=>(r.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return t=!0,!1}),t)),t}function pN(n,e){const t={top:0,left:0};if(e!==n.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:s}=r.getBoundingClientRect();t.top=i,t.left=s}return t}const mt="---------";function PMe(){return{name:mt}}const xo="alignment";function xMe(){return{key:xo,name(){return this.getTranslatedPhrase(KD)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const n=this.getSelectedRangeActive();return!n||n.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${xo}:left`,name(){return this.getTranslatedPhrase(XD)},callback(){const n=this.getSelectedRange(),e=Md(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,n,t,r),Qc(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${xo}:center`,name(){return this.getTranslatedPhrase(qD)},callback(){const n=this.getSelectedRange(),e=Md(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,n,t,r),Qc(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${xo}:right`,name(){return this.getTranslatedPhrase(QD)},callback(){const n=this.getSelectedRange(),e=Md(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,n,t,r),Qc(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${xo}:justify`,name(){return this.getTranslatedPhrase(ZD)},callback(){const n=this.getSelectedRange(),e=Md(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,n,t,r),Qc(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:mt},{key:`${xo}:top`,name(){return this.getTranslatedPhrase(JD)},callback(){const n=this.getSelectedRange(),e=Md(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,n,t,r),Qc(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${xo}:middle`,name(){return this.getTranslatedPhrase(eF)},callback(){const n=this.getSelectedRange(),e=Md(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,r),Qc(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${xo}:bottom`,name(){return this.getTranslatedPhrase(tF)},callback(){const n=this.getSelectedRange(),e=Md(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,n,t,r),Qc(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const vN="clear_column";function LMe(){return{key:vN,name(){return this.getTranslatedPhrase(LD)},callback(n,e){const t=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const n=this.getSelectedRangeActive();if(!n||n.isSingleHeader()&&n.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return n.forAll((t,r)=>{if(t<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(t,r);return i?!0:(e=!0,!1)}),!e}}}const EC="col_left";function HMe(){return{key:EC,name(){return this.getTranslatedPhrase(MD)},callback(){const n=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeActive();return!n||this.selection.isSelectedByRowHeader()||n.isSingleHeader()&&n.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const RC="col_right";function DMe(){return{key:RC,name(){return this.getTranslatedPhrase(ID)},callback(){const n=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeActive();return!!(!n||this.selection.isSelectedByRowHeader()||n.isSingleHeader()&&n.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const TC="make_read_only";function FMe(){return{key:TC,checkable:!0,ariaChecked(){return PT(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Jb)},name(){let n=this.getTranslatedPhrase(Jb);return PT(this.getSelectedRange(),(t,r)=>this.getCellMeta(t,r).readOnly)&&(n=lX(n)),n},callback(){const n=this.getSelectedRange(),e=PT(n,(t,r)=>this.getCellMeta(t,r).readOnly);k(n,t=>{t.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const n=this.getSelectedRangeActive();return!!(!n||n.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const wN="redo";function kMe(){return{key:wN,name(){return this.getTranslatedPhrase(xD)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const yN=0,SN=1,uX=2,Yk=3,VMe=[Yk,uX],$Me=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],XI=Symbol("root"),X2=Symbol("child");function Up(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:XI;if(e!==XI&&e!==X2)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),r=e===XI;let i=yN;if(t){const s=n[0];n.length===0?i=SN:r&&s instanceof dv?i=Yk:r&&Array.isArray(s)?i=Up(s,X2):n.length>=2&&n.length<=4&&!n.some((a,l)=>!$Me[l].includes(typeof a))&&(i=uX)}return i}function SS(n){let{createCellCoords:e,createCellRange:t,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!VMe.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=n===Yk;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],c=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),fn(u)&&(u=a),fn(c)&&(c=l),!r){const m=a,g=l,C=u,y=c;a=Math.min(m,C),l=Math.min(g,y),u=Math.max(m,C),c=Math.max(g,y)}const h=o?s.highlight.clone():e(a,l),d=e(a,l),f=e(u,c);return t(h,d,f)}}function UMe(n){const e=Up(n.getSelected());if(e===yN||e===SN)return[];const t=SS(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),r=new Set;k(n.getSelected(),o=>{const{from:a,to:l}=t(o),u=Math.max(a.col,0),c=l.col-u+1;k(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((o,a)=>o-a);return Er(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function BMe(n){const e=Up(n.getSelected());if(e===yN||e===SN)return[];const t=SS(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),r=new Set;k(n.getSelected(),o=>{const{from:a,to:l}=t(o),u=Math.max(a.row,0),c=l.row-u+1;k(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((o,a)=>o-a);return Er(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}const bC="remove_col";function WMe(){return{key:bC,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(_D,e)},callback(){this.alter("remove_col",UMe(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeActive();if(!n||n.isSingleHeader()&&n.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const CN="remove_row";function jMe(){return{key:CN,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(OD,e)},callback(){this.alter("remove_row",BMe(this),1,"ContextMenu.removeRow")},disabled(){const n=this.getSelectedRangeActive();if(!n||n.isSingleHeader()&&n.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const EN="row_above";function zMe(){return{key:EN,name(){return this.getTranslatedPhrase(AD)},callback(){const n=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){const n=this.getSelectedRangeActive();return!n||this.selection.isSelectedByColumnHeader()||n.isSingleHeader()&&n.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const RN="row_below";function GMe(){return{key:RN,name(){return this.getTranslatedPhrase(ND)},callback(){const n=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){const n=this.getSelectedRangeActive();return!!(!n||this.selection.isSelectedByColumnHeader()||n.isSingleHeader()&&n.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const CS="no_items";function YMe(){return{key:CS,name(){return this.getTranslatedPhrase(bD)},disabled:!0,isCommand:!1}}const TN="undo";function KMe(){return{key:TN,name(){return this.getTranslatedPhrase(PD)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const XMe=[EN,RN,EC,RC,vN,CN,bC,TN,wN,TC,xo,mt,CS],qMe={[mt]:PMe,[CS]:YMe,[EN]:zMe,[RN]:GMe,[EC]:HMe,[RC]:DMe,[vN]:LMe,[CN]:jMe,[bC]:WMe,[TN]:KMe,[wN]:kMe,[TC]:FMe,[xo]:xMe};function cX(){const n={};return ct(qMe,(e,t)=>{n[t]=e()}),n}function QMe(n){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&n.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(zD):this.getTranslatedPhrase(jD)},callback(){const e=this.getSelectedRangeActive();n.setRange(e),n.show(),n.focusEditor()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ZMe(n){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(GD)},callback(){this.getSelectedRangeActive().forAll((t,r)=>{t>=0&&r>=0&&n.removeCommentAtCell(t,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function JMe(n){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(YD);return PT(this.getSelectedRange(),(r,i)=>n.getCommentMeta(r,i,xT))?lX(e):e},callback(){this.getSelectedRangeActive().forAll((t,r)=>{if(t>=0&&r>=0){const i=!!n.getCommentMeta(t,r,xT);n.updateCommentMeta(t,r,{[xT]:!i})}})},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function eIe(n,e){hX(n,e),e.add(n)}function Id(n,e,t){hX(n,e),e.set(n,t)}function hX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tIe(n,e,t){return(e=nIe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nIe(n){var e=rIe(n,"string");return typeof e=="symbol"?e:e+""}function rIe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $l(n,e,t){return n.set(Nr(n,e),t),t}function at(n,e){return n.get(Nr(n,e))}function Nr(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const d0="comments",iIe=60,Du="comment",Ww="value",dX="style",xT="readOnly",Qv=d0,jx=`plugin:${d0}`;var Qt=new WeakMap,Il=new WeakMap,bN=new WeakMap,LT=new WeakMap,f0=new WeakMap,zx=new WeakMap,g0=new WeakMap,Ur=new WeakSet;class sIe extends yt{constructor(){super(...arguments),eIe(this,Ur),tIe(this,"range",{}),Id(this,Qt,null),Id(this,Il,null),Id(this,bN,!1),Id(this,LT,!1),Id(this,f0,!1),Id(this,zx,null),Id(this,g0,"")}static get PLUGIN_KEY(){return d0}static get PLUGIN_PRIORITY(){return iIe}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[d0]}enablePlugin(){var e=this;this.enabled||(at(Qt,this)||($l(Qt,this,new Af(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),at(Qt,this).addLocalHook("resize",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Nr(Ur,e,fIe).call(e,...r)}),this.hot.addHook("afterSetTheme",(t,r)=>{r||this.hide()})),at(Il,this)||$l(Il,this,new aX(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,r,i,s,o,a)=>Nr(Ur,this,cIe).call(this,t,a)),this.addHook("afterScroll",()=>Nr(Ur,this,gIe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>Nr(Ur,this,q2).call(this,t)),this.addHook("beforeCompositionStart",t=>Nr(Ur,this,q2).call(this,t)),at(Il,this).addLocalHook("hide",()=>this.hide()),at(Il,this).addLocalHook("show",(t,r)=>this.showAtCell(t,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){at(Il,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),r=e.addContext(jx);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeActive();$l(LT,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(jx),this.hot._registerTimeout(()=>{$l(LT,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isCell()},group:Qv}),r.addShortcut({keys:[["Escape"]],callback:()=>{at(Qt,this).setValue(at(g0,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>at(Qt,this).isVisible()&&at(Qt,this).isFocused(),group:Qv}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>at(Qt,this).isVisible()&&at(Qt,this).isFocused(),group:Qv}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{$l(f0,this,!0),at(Qt,this).setValue(at(Qt,this).getValue()),this.setComment(),this.hide(),e.setActiveContextName("grid")},group:Qv})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Qv)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Nr(Ur,this,lIe).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Nr(Ur,this,oIe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Nr(Ur,this,uIe).call(this)),this.eventManager.addEventListener(t,"focus",()=>Nr(Ur,this,dIe).call(this)),this.eventManager.addEventListener(t,"blur",()=>Nr(Ur,this,hIe).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Nr(Ur,this,aIe).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=Kh(e.target,"TD","TBODY");return!!(t&&Be(t,"htCommentCell")&&Kh(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=at(Qt,this).getValue();let r="";e!=null?r=e:t!=null&&(r=t);const{row:i,col:s}=Nr(Ur,this,Sm).call(this);this.updateCommentMeta(i,s,{[Ww]:r}),this.hot.render()}setCommentAtCell(e,t,r){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:t,col:r}=Nr(Ur,this,Sm).call(this);this.hot.setCellMeta(t,r,Du),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(r)}getComment(){const{row:e,col:t}=Nr(Ur,this,Sm).call(this);return this.getCommentMeta(e,t,Ww)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,Ww)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:t,col:r}=Nr(Ur,this,Sm).call(this);if(t<0||t>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(t,r);return at(Il,this).cancelHiding(),at(Qt,this).setValue((e=i[Du]?i[Du][Ww]:null)!==null&&e!==void 0?e:""),at(Qt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){at(Qt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!at(Qt,this).isVisible()))return;const{rowIndexMapper:t,columnIndexMapper:r}=this.hot,{row:i,col:s}=Nr(Ur,this,Sm).call(this);let o=t.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(s);const l=o===null;at(Qt,this).setPosition(0,0),o===null&&(o=t.getRenderableFromVisualIndex(t.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,-1)));const u=o===null,c=a===null;o=o??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,m=d.getCell({row:o,col:a},!0),g=this.getCommentMeta(i,s,dX);g?at(Qt,this).setSize(g.width,g.height):at(Qt,this).resetSize();const C=c?0:f.getColumnWidth(a),y=l&&!u?or(m):0,{left:w,top:S,width:E,height:P}=m.getBoundingClientRect(),{width:_,height:I}=at(Qt,this).getSize(),{innerWidth:D,innerHeight:Q}=this.hot.rootWindow,F=this.hot.rootDocument.documentElement,J=ar(this.hot.rootDocument),q=hD(this.hot.rootWindow)?J:0,ie=dD(this.hot.rootWindow)?J:0;let fe=w+h.scrollX+C,Ee=S+h.scrollY+y;this.hot.isRtl()&&(fe-=_+C),this.hot.isLtr()&&w+E+_>D-q?fe=w+h.scrollX-_-1:this.hot.isRtl()&&fe<-(F.scrollWidth-F.clientWidth)&&(fe=w+h.scrollX+C+1),S+I>Q-ie&&(Ee-=I-P+1),at(Qt,this).setPosition(fe,Ee),at(Qt,this).setReadOnlyState(this.getCommentMeta(i,s,xT)),at(Qt,this).observeSize()}focusEditor(){at(Qt,this).focus()}updateCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t)[Du];let s;i?(s=Oi(i),lC(s,r)):s=r,this.hot.setCellMeta(e,t,Du,s)}getCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t);if(i[Du])return i[Du][r]}addToContextMenu(e){e.items.push({name:mt},QMe(this),ZMe(this),JMe(this))}getEditorInputElement(){return at(Qt,this).getInputElement()}destroy(){var e,t;(e=at(Qt,this))===null||e===void 0||e.destroy(),(t=at(Il,this))===null||t===void 0||t.destroy(),super.destroy()}}function oIe(n){if(!(!this.hot.view||!this.hot.view._wt)&&!at(bN,this)&&!this.targetIsCommentTextArea(n)){const e=Kh(n.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function aIe(n){n.stopPropagation()}function lIe(n){const{rootDocument:e}=this.hot;if(!(at(bN,this)||at(Qt,this).isFocused()||Be(n.target,"wtBorder")||at(zx,this)===n.target||!at(Qt,this)))if($l(zx,this,e.elementFromPoint(n.clientX,n.clientY)),this.targetIsCellWithComment(n)){const t=this.hot._createCellRange(this.hot.getCoords(n.target));at(Il,this).show(t)}else kh(n.target,e)&&!this.targetIsCommentTextArea(n)&&at(Il,this).hide()}function uIe(){$l(bN,this,!1)}function cIe(n,e){e[Du]&&e[Du][Ww]&&ee(n,e.commentedCellClassName)}function hIe(){if(at(f0,this)){$l(f0,this,!1);return}$l(g0,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function dIe(){$l(g0,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(jx)}function fIe(n,e){const{row:t,col:r}=Nr(Ur,this,Sm).call(this);this.updateCommentMeta(t,r,{[dX]:{width:n,height:e}})}function q2(n){at(Qt,this).isFocused()&&la(n)}function gIe(){at(LT,this)||this.hide()}function Sm(){return this.range instanceof dv?this.range.highlight:this.hot._createCellCoords(this.range.from.row,this.range.from.col)}function qI(n,e,t){return(e=mIe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mIe(n){var e=pIe(n,"string");return typeof e=="symbol"?e:e+""}function pIe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class fX{constructor(e){qI(this,"hot",void 0),qI(this,"commands",{}),qI(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=vIe(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||xn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(s.join(":")),k(u,c=>c.apply(this.hot,r))}}function vIe(n,e){let t;return k(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===n)return t=r,!1}),t}function QI(n,e,t){return(e=wIe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wIe(n){var e=yIe(n,"string");return typeof e=="symbol"?e:e+""}function yIe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class gX{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;QI(this,"hot",void 0),QI(this,"predefinedItems",cX()),QI(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,ct(e,(r,i)=>{let s="";r.name===mt?(t[mt]=r,s=mt):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,t[i]=r,s=r.key):(t[r.key]=r,s=r.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return SIe(e,this.defaultOrderPattern,this.predefinedItems)}}function SIe(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=n;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),je(i)?ct(i,(s,o)=>{let a=t[typeof s=="string"?s:o];a||(a=s),je(s)?lr(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),r.push(a)}):k(i,(s,o)=>{let a=t[s];!a&&XMe.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),je(s)&&lr(a,s),a.key===void 0&&(a.key=o),r.push(a))}),r}function Pc(n,e,t){return(e=CIe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function CIe(n){var e=EIe(n,"string");return typeof e=="symbol"?e:e+""}function EIe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class RIe{constructor(e,t){Pc(this,"top",void 0),Pc(this,"topRelative",void 0),Pc(this,"left",void 0),Pc(this,"leftRelative",void 0),Pc(this,"scrollTop",void 0),Pc(this,"scrollLeft",void 0),Pc(this,"cellHeight",void 0),Pc(this,"cellWidth",void 0);const r=t.scrollY,i=t.scrollX;let s,o,a,l,u,c;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,o=s,l=a,s+=r,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,o=s-r,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Zv(n,e,t){TIe(n,e),e.set(n,t)}function TIe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tt(n,e){return n.get(mX(n,e))}function HE(n,e,t){return n.set(mX(n,e),t),t}function mX(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Hi=new WeakMap,ts=new WeakMap,ns=new WeakMap,ZI=new WeakMap,Vg=new WeakMap;class bIe{constructor(e){Zv(this,Hi,void 0),Zv(this,ts,void 0),Zv(this,ns,void 0),Zv(this,ZI,!1),Zv(this,Vg,{above:0,below:0,left:0,right:0}),HE(ZI,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return tt(Vg,this)[e]=t,this}setElement(e){return HE(Hi,this,e),this}setParentElement(e){return HE(ts,this,e),this}updatePosition(e){HE(ns,this,new RIe(e,tt(Hi,this).ownerDocument.defaultView)),tt(ZI,this)?(tt(ns,this).fitsBelow(tt(Hi,this))?this.setPositionBelowCursor():tt(ns,this).fitsAbove(tt(Hi,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){tt(Hi,this).dir==="rtl"?tt(ns,this).fitsOnLeft(tt(Hi,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():tt(ns,this).fitsOnRight(tt(Hi,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=tt(Vg,this).above+tt(ns,this).top-tt(Hi,this).offsetHeight;if(tt(ts,this)){const r=tt(ts,this).ownerDocument.defaultView.getComputedStyle(tt(ts,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),s=Number.parseInt(r.borderTop,10);e=tt(ns,this).top+tt(ns,this).cellHeight-tt(Hi,this).scrollHeight+i+s}tt(Hi,this).style.top=`${e}px`}setPositionBelowCursor(){let e=tt(Vg,this).below+tt(ns,this).top+1;if(tt(ts,this)){const r=tt(ts,this).ownerDocument.defaultView.getComputedStyle(tt(ts,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),s=Number.parseInt(r.borderTop,10);e=tt(ns,this).top-i-s}tt(Hi,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=tt(ns,this).left;if(tt(ts,this)){const t=tt(ts,this).ownerDocument.defaultView,r=Number.parseInt(t.getComputedStyle(tt(ts,this).querySelector(".htCore")).borderRightWidth,10);e+=tt(ns,this).cellWidth+r}else e+=tt(Vg,this).right;tt(Hi,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=tt(Vg,this).left+tt(ns,this).left-tt(Hi,this).offsetWidth;if(tt(ts,this)){const t=tt(ts,this).ownerDocument.defaultView,r=Number.parseInt(t.getComputedStyle(tt(ts,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}tt(Hi,this).style.left=`${e}px`}}function Kk(n){let{initialPage:e=-1,size:t=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=n;const s=new Set;let o=ft(e,-1,g()-1);function a(y,w){const S=g()-1;return y<0&&(y=S),y>S&&(y=0),s.has(y)?-1:(s.add(y),r(y,!1)===!1&&(y=a(w===1?++y:--y,w)),y)}function l(y){y>-1&&y<g()&&r(y,!0)!==!1&&(o=y)}function u(y){y>-1&&y<g()&&(o=y)}function c(){return o}function h(){g()>0&&(s.clear(),o=a(0,1))}function d(){g()>0&&(s.clear(),o=a(g()-1,-1))}function f(){g()>0&&(s.clear(),o=a(++o,1))}function m(){g()>0&&(s.clear(),o=a(--o,-1))}function g(){return Math.max(t(),0)}function C(){s.clear(),o=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:m,getSize:g,clear:C}}function AIe(n){return At(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Gx(n){return xn(n,"submenu")}function Yx(n){return new RegExp(mt,"i").test(n.name)}function HT(n,e){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(e)===!0}function Q2(n){return xn(n,"disableSelection")}function NIe(n){return Be(n,"htSeparator")}function MIe(n){return Be(n,"htSubmenu")}function IIe(n){return Be(n,"htDisabled")}function OIe(n){return Be(n,"htSelectionDisabled")}function _Ie(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function pX(n,e){const t=n.slice(0);for(let r=0;r<t.length&&t[r].name===e;)t.shift();return t}function PIe(n,e){let t=n.slice(0);return t.reverse(),t=pX(t,e),t.reverse(),t}function xIe(n){const e=[];return k(n,(t,r)=>{r>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function LIe(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mt,t=n.slice(0);return t=pX(t,e),t=PIe(t,e),t=xIe(t),t}function HIe(n){return n.checkable===!0}function DIe(n){return Kk({size:()=>n.countRows(),onItemSelect(e,t){const r=n.getCell(e,0);if(!r||NIe(r)||IIe(r)||OIe(r))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})}function FIe(n){const{hot:e,hotMenu:t}=n;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(r):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),n.close(!0)}},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=t.getSelectedActive();if(r){const i=n.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{t.getSelectedActive()&&n.isSubMenu()&&(n.close(),n.isSubMenu()&&n.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=t.getSelectedActive();i&&(t.getSourceDataAtRow(i[0]).submenu?n.openSubMenu(i[0]).getNavigator().toFirstItem():(n.executeCommand(r),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.getSelectedActive()?t.selection.transformStart(-t.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.getSelectedActive()?t.selection.transformStart(t.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}const vX="menu",Z2=vX;function kIe(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];r(FIe(n)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:vX})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),t.push({shortcuts:u,contextName:c}),r(u,c)}function s(){return[...t]}function o(u){return u?`${Z2}:${u}`:Z2}function a(u){var c;const h=n.hotMenu.getShortcutManager(),d=o(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){n.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:l}}function VIe(n){return(e,t,r,i,s,o)=>{const a=e.getSourceDataAtRow(r),l=n.rootDocument.createElement("div"),u=typeof o=="function"?o.call(n):o,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(n):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(n):a.ariaChecked;if(Jl(t),ee(l,"htItemWrapper"),n.getSettings().ariaTags){const d=!HT(a,n)&&!Q2(a)&&!Yx(a);Pe(t,[...HIe(a)?[iwe(),io(c),n9(h)]:[rwe(),io(u)],...d?[ys(-1)]:[],...HT(a,n)?[Vw()]:[],...Gx(a)?[Yo(!1)]:[]])}t.className="",t.appendChild(l),Yx(a)?ee(t,"htSeparator"):typeof a.renderer=="function"?(ee(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,r,i,s,u))):sd(l,u),HT(a,n)?ee(t,"htDisabled"):Q2(a)?ee(t,"htSelectionDisabled"):Gx(a)&&ee(t,"htSubmenu")}}function JI(n,e,t){$Ie(n,e),e.set(n,t)}function $Ie(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cl(n,e,t){return(e=UIe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function UIe(n){var e=BIe(n,"string");return typeof e=="symbol"?e:e+""}function BIe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function eO(n,e,t){return n.set(wX(n,e),t),t}function xc(n,e){return n.get(wX(n,e))}function wX(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const J2=215;var $g=new WeakMap,DE=new WeakMap,FE=new WeakMap;class gv{get tableBorderWidth(){return xc(FE,this)===void 0&&this.hotMenu&&eO(FE,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),xc(FE,this)}constructor(e,t){var r=this;cl(this,"hot",void 0),cl(this,"options",void 0),cl(this,"eventManager",new Zo(this)),cl(this,"container",void 0),cl(this,"positioner",void 0),cl(this,"hotMenu",null),cl(this,"hotSubMenus",{}),cl(this,"parentMenu",void 0),cl(this,"menuItems",null),cl(this,"origOutsideClickDeselects",null),JI(this,$g,void 0),JI(this,DE,void 0),JI(this,FE,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:J2,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new bIe(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(i,s)=>{this.options.container!==this.hot.rootPortalElement&&(Me(this.options.container,/ht-theme-.*/g),ee(this.options.container,i)),s||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=Gf(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return xc($g,this)}getKeyboardShortcutsCtrl(){return xc(DE,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=gC(a=>this.openSubMenu(a),300),t=this.options.minWidth||J2;let r=!1,i=Yh(this.menuItems,a=>(a.key===CS&&(r=!0),_Ie(a,this.hot)));if(i.length<1&&!r)i.push(cX()[CS]);else if(i.length===0)return;i=LIe(i,mt);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return Re(a)&&a<t?t:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:VIe(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?xc($g,this).setCurrentPage(l.row):xc($g,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),Yb()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Yb()||!qh(a))&&s&&this.hasSelectedItem()&&(Ua()||sD()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),eO($g,this,DIe(this.hotMenu)),eO(DE,this,kIe(this)),xc(DE,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(xc($g,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedActive();if(t){const r=this.parentMenu.hotMenu.getCell(t[0],0);Pe(r,[Yo(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!MIe(t))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new gv(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(t.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Pe(t,[Yo(!0)]),i}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[t.key];if(r){r.destroy(),delete this.hotSubMenus[t.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Pe(i,[Yo(!1)])}}closeAllSubMenus(){k(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const r=this.hot.getSelectedRange(),i=r?AIe(r):[];this.runLocalHooks("executeCommand",t.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,i,e)}isCommandPassive(e){return e.isCommand===!1||Yx(e)||HT(e,this.hot)||Gx(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,s=parseInt(r.width,10),o=Er(t,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?or(this.hotMenu.getCell(u,0)):0;return a+(l.name===mt?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${s+3}px`,i.height=`${o+3}px`):(i.width=`${s}px`,i.height=`${o}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let r=e,i;return r&&(Pt(r)&&(r=r.call(this.hot),r===null||fn(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=t.querySelector(`.${this.options.className}.${r}`)),i||(i=t.createElement("div"),ee(i,`htMenu handsontable ${this.options.className}`),r&&ee(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Pe(this.hotMenu.rootElement,[nwe(),ys(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!kh(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!kh(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Be(e.target,"htCore")&&kh(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Vt(gv,Hr);function WIe(n,e){jIe(n,e),e.add(n)}function jIe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tO(n,e,t){return(e=zIe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zIe(n){var e=GIe(n,"string");return typeof e=="symbol"?e:e+""}function GIe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function kE(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const jw="contextMenu",YIe=70,ej=jw;we.getSingleton().register("afterContextMenuDefaultOptions");we.getSingleton().register("beforeContextMenuShow");we.getSingleton().register("afterContextMenuShow");we.getSingleton().register("afterContextMenuHide");we.getSingleton().register("afterContextMenuExecute");var Jv=new WeakSet;class AN extends yt{constructor(){super(...arguments),WIe(this,Jv),tO(this,"commandExecutor",new fX(this.hot)),tO(this,"itemsFactory",null),tO(this,"menu",null)}static get PLUGIN_KEY(){return jw}static get PLUGIN_PRIORITY(){return YIe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[EN,RN,mt,EC,RC,mt,CN,bC,mt,TN,wN,mt,TC,mt,xo]}isEnabled(){return!!this.hot.getSettings()[jw]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[jw];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new gv(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>kE(Jv,this,XIe).call(this)),this.menu.addLocalHook("afterOpen",()=>kE(Jv,this,qIe).call(this)),this.menu.addLocalHook("afterClose",()=>kE(Jv,this,QIe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>kE(Jv,this,KIe).call(this,r)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=pN(this.menu.container,this.hot.rootDocument);this.open({left:t.left+r.left,top:t.top+r.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:ej})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ej)}open(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.prepareMenuItems(),this.menu.open(),ct(r,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new gX(this.hot,AN.DEFAULT_ITEMS);const e=this.hot.getSettings()[jw],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),k(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function KIe(n){const e=this.hot.getSettings(),t=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=n.target;if(this.close(),Be(s,"handsontableInput")||(n.preventDefault(),n.stopPropagation(),!(t||r)&&!i(s)&&!(Be(s,"current")&&Be(s,"wtBorder"))))return;const o=pN(this.menu.container,this.hot.rootDocument);this.open({top:n.clientY+o.top,left:n.clientX+o.left})}function XIe(){this.hot.runHooks("beforeContextMenuShow",this)}function qIe(){this.hot.runHooks("afterContextMenuShow",this)}function QIe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}AN.SEPARATOR={name:mt};const tj=/^(\r\n|\n\r|\r|\n)/,ZIe=/^[^\t\r\n]+/,nj=/^\t/;function JIe(n){const e=[[""]];if(n.length===0)return e;let t=0,r=0,i;for(;n.length>0&&i!==n.length;)if(i=n.length,n.match(nj))n=n.replace(nj,""),t+=1,e[r][t]="";else if(n.match(tj))n=n.replace(tj,""),t=0,r+=1,e[r]=[""];else{let s="";if(n.startsWith('"')){let o=0,a=!0;for(;a;){const l=n.slice(0,1);l==='"'&&(o+=1),s+=l,n=n.slice(1),(n.length===0||n.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=n.match(ZIe);s=o?o[0]:"",n=n.slice(s.length)}e[r][t]=s}return e}function m0(n){let e,t,r,i,s="",o;for(e=0,t=n.length;e<t;e+=1){for(i=n[e].length,r=0;r<i;r+=1)r>0&&(s+="	"),o=n[e][r],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==t-1&&(s+=`
`)}return s}function eOe(n){return{key:"copy",name(){return this.getTranslatedPhrase(HD)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function tOe(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),t=e?ft(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(kD,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function nOe(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),t=e?ft(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(FD,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function rOe(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),t=e?ft(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(DD,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function iOe(n){return{key:"cut",name(){return this.getTranslatedPhrase(VD)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}class sOe{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class oOe{constructor(){this.clipboardData=new sOe}preventDefault(){}composedPath(){return[]}}function aOe(n,e){yX(n,e),e.add(n)}function Ug(n,e,t){yX(n,e),e.set(n,t)}function yX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ki(n,e){return n.get(zm(n,e))}function Bg(n,e,t){return n.set(zm(n,e),t),t}function zm(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Lc=new WeakMap,nO=new WeakMap,ew=new WeakMap,Kx=new WeakMap,Xx=new WeakMap,tw=new WeakMap,nw=new WeakSet;class lOe{constructor(e){let{countRows:t,countColumns:r,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;aOe(this,nw),Ug(this,Lc,void 0),Ug(this,nO,void 0),Ug(this,ew,void 0),Ug(this,Kx,void 0),Ug(this,Xx,void 0),Ug(this,tw,void 0),Bg(nO,this,t),Bg(ew,this,r),Bg(Kx,this,i),Bg(Xx,this,s),Bg(tw,this,o)}setSelectedRange(e){Bg(Lc,this,e)}getCellsRange(){if(ki(nO,this).call(this)===0||ki(ew,this).call(this)===0)return null;const{row:e,col:t}=ki(Lc,this).getTopStartCorner(),{row:r,col:i}=ki(Lc,this).getBottomEndCorner(),s=zm(nw,this,uOe).call(this,e,r),o=zm(nw,this,rO).call(this,t,i);return{isRangeTrimmed:r!==s||i!==o,startRow:e,startCol:t,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(ki(ew,this).call(this)===0||ki(tw,this).call(this)===0)return null;const{col:e}=ki(Lc,this).getTopStartCorner(),{col:t}=ki(Lc,this).getBottomEndCorner(),r=zm(nw,this,rO).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(ki(ew,this).call(this)===0||ki(tw,this).call(this)===0)return null;const{col:e}=ki(Lc,this).getTopStartCorner(),{col:t}=ki(Lc,this).getBottomEndCorner(),r=zm(nw,this,rO).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-ki(tw,this).call(this),startCol:e,endRow:-1,endCol:r}}}function rO(n,e){return Math.min(e,Math.max(n+ki(Xx,this).call(this)-1,n))}function uOe(n,e){return Math.min(e,Math.max(n+ki(Kx,this).call(this)-1,n))}function SX(n){const e=[],t=[];return k(n,r=>{const i=Math.min(r.startRow,r.endRow),s=Math.max(r.startRow,r.endRow);Le(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);Le(o,a,l=>{t.indexOf(l)===-1&&t.push(l)})}),{rows:e,columns:t}}var cOe=ia,hOe=og,dOe=Qa,fOe=dOe("match"),gOe=function(n){var e;return cOe(n)&&((e=n[fOe])!==void 0?!!e:hOe(n)==="RegExp")},mOe=ur,pOe=wr,rj=mOe.RegExp,vOe=!pOe(function(){var n=!0;try{rj(".","d")}catch{n=!1}var e={},t="",r=n?"dgimsy":"gimsy",i=function(l,u){Object.defineProperty(e,l,{get:function(){return t+=u,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};n&&(s.hasIndices="d");for(var o in s)i(o,s[o]);var a=Object.getOwnPropertyDescriptor(rj.prototype,"flags").get.call(e);return a!==r||t!==r}),wOe={correct:vOe},yOe=Cr,SOe=function(){var n=yOe(this),e="";return n.hasIndices&&(e+="d"),n.global&&(e+="g"),n.ignoreCase&&(e+="i"),n.multiline&&(e+="m"),n.dotAll&&(e+="s"),n.unicode&&(e+="u"),n.unicodeSets&&(e+="v"),n.sticky&&(e+="y"),e},COe=yr,EOe=sa,ROe=qS,ij=wOe,TOe=SOe,bOe=RegExp.prototype,AOe=ij.correct?function(n){return n.flags}:function(n){return!ij.correct&&ROe(bOe,n)&&!EOe(n,"flags")?COe(TOe,n):n.flags},Xk=cr,NOe=tv,MOe=Math.floor,iO=Xk("".charAt),IOe=Xk("".replace),sO=Xk("".slice),OOe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,_Oe=/\$([$&'`]|\d{1,2})/g,POe=function(n,e,t,r,i,s){var o=t+n.length,a=r.length,l=_Oe;return i!==void 0&&(i=NOe(i),l=OOe),IOe(s,l,function(u,c){var h;switch(iO(c,0)){case"$":return"$";case"&":return n;case"`":return sO(e,0,t);case"'":return sO(e,o);case"<":h=i[sO(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=MOe(d/10);return f===0?u:f<=a?r[f-1]===void 0?iO(c,1):r[f-1]+iO(c,1):u}h=r[d-1]}return h===void 0?"":h})},xOe=an,LOe=yr,qk=cr,sj=KS,HOe=Sr,DOe=ia,FOe=gOe,rw=FA,kOe=QS,VOe=AOe,$Oe=POe,UOe=Qa,BOe=UOe("replace"),WOe=TypeError,oO=qk("".indexOf);qk("".replace);var oj=qk("".slice),jOe=Math.max;xOe({target:"String",proto:!0},{replaceAll:function(e,t){var r=sj(this),i,s,o,a,l,u,c,h,d,f,m=0,g="";if(DOe(e)){if(i=FOe(e),i&&(s=rw(sj(VOe(e))),!~oO(s,"g")))throw new WOe("`.replaceAll` does not allow non-global regexes");if(o=kOe(e,BOe),o)return LOe(o,e,r,t)}for(a=rw(r),l=rw(e),u=HOe(t),u||(t=rw(t)),c=l.length,h=jOe(1,c),d=oO(a,l);d!==-1;)f=u?rw(t(l,d,a)):$Oe(l,a,d,[],void 0,t),g+=oj(a,m,d)+f,m=d+c,d=d+h>a.length?-1:oO(a,l,d+h);return m<a.length&&(g+=oj(a,m)),g}});const CX={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},zOe=new RegExp(Object.keys(CX).map(n=>`(${n})`).join("|"),"gi");function GOe(n){return(n&&n.nodeName||"")==="TABLE"}function qx(n){const e=n.hasColHeaders(),t=n.hasRowHeaders(),r=[e?-1:0,t?-1:0,n.countRows()-1,n.countCols()-1],i=n.getData(...r),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=t?1:0,h=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,m=[];for(let C=0;C<o;C+=1){const y=!f&&t&&C===0;let w="";if(f)w=`<th>${n.getColHeader(C-c)}</th>`;else if(y)w=`<th>${n.getRowHeader(d-h)}</th>`;else{const S=i[d][C],{hidden:E,rowspan:P,colspan:_}=n.getCellMeta(d-h,C-c);if(!E){const I=[];if(P&&I.push(`rowspan="${P}"`),_&&I.push(`colspan="${_}"`),Dn(S))w=`<td ${I.join(" ")}></td>`;else{const D=S.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w=`<td ${I.join(" ")}>${D}</td>`}}}m.push(w)}const g=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,g):u.splice(-1,0,g)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Qx(n){const e=n.length,t=["<table>"];for(let r=0;r<e;r+=1){const i=n[r],s=i.length,o=[];r===0&&t.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],u=Dn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}t.push("<tr>",...o,"</tr>"),r+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function Zx(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let s=n;if(typeof s=="string"){const S=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,E=>{const P=E.match(/<td\b[^>]*?>/g)[0],_=/<p.*?>/g,I=E.substring(P.length,E.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(_,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${P}${I}</td>`});i.insertAdjacentHTML("afterbegin",`${S}`),s=i.querySelector("table")}if(!s||!GOe(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((S,E)=>S+E.colSpan,0)-(a?1:0):0,c=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(s.tHead){const S=Array.from(s.tHead.rows).filter(E=>{const P=E.querySelector("td")!==null;return P&&h.push(E),!P});f=S.length,d=f>0,f>1?t.nestedHeaders=Array.from(S).reduce((E,P)=>{const _=Array.from(P.cells).reduce((I,D,Q)=>{if(a&&Q===0)return I;const{colSpan:F,innerHTML:J}=D,q=F>1?{label:J,colspan:F}:J;return I.push(q),I},[]);return E.push(_),E},[]):d&&(t.colHeaders=Array.from(S[0].children).reduce((E,P,_)=>(a&&_===0||E.push(P.innerHTML),E),[]))}h.length&&(t.fixedRowsTop=h.length),c.length&&(t.fixedRowsBottom=c.length);const g=[...h,...Array.from(s.tBodies).reduce((S,E)=>(S.push(...Array.from(E.rows)),S),[]),...c];m=g.length;const C=new Array(m);for(let S=0;S<m;S++)C[S]=new Array(u);const y=[],w=[];for(let S=0;S<m;S++){const E=g[S],P=Array.from(E.cells),_=P.length;for(let I=0;I<_;I++){const D=P[I],{nodeName:Q,innerHTML:F,rowSpan:J,colSpan:q}=D,ie=C[S].findIndex(fe=>fe===void 0);if(Q==="TD"){if(J>1||q>1){for(let be=S;be<S+J;be++)if(be<m)for(let re=ie;re<ie+q;re++)C[be][re]=null;const Ee=D.getAttribute("style");Ee&&Ee.includes("mso-ignore:colspan")||y.push({col:ie,row:S,rowspan:J,colspan:q})}let fe="";o&&/excel/gi.test(o.content)?fe=F.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):fe=F.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[S][ie]=fe.replace(zOe,Ee=>CX[Ee])}else w.push(F)}}return y.length&&(t.mergeCells=y),w.length&&(t.rowHeaders=w),C.length&&(t.data=C),t}const YOe=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:Qx,htmlToGridSettings:Zx,instanceToHTML:qx},Symbol.toStringTag,{value:"Module"}));function KOe(n,e){EX(n,e),e.add(n)}function Hc(n,e,t){EX(n,e),e.set(n,t)}function EX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iw(n,e,t){return(e=XOe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XOe(n){var e=qOe(n,"string");return typeof e=="symbol"?e:e+""}function qOe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ds(n,e){return n.get(Si(n,e))}function Ca(n,e,t){return n.set(Si(n,e),t),t}function Si(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("afterCopyLimit");we.getSingleton().register("modifyCopyableRange");we.getSingleton().register("beforeCut");we.getSingleton().register("afterCut");we.getSingleton().register("beforePaste");we.getSingleton().register("afterPaste");we.getSingleton().register("beforeCopy");we.getSingleton().register("afterCopy");const aO="copyPaste",QOe=80,ZOe=["fragmentSelection"],RX="application/ht-source-data-json-html",aj=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Jx=new WeakMap,e1=new WeakMap,t1=new WeakMap,Wg=new WeakMap,VE=new WeakMap,$E=new WeakMap,jg=new WeakMap,p0=new WeakMap,Vi=new WeakSet;class JOe extends yt{constructor(){super(...arguments),KOe(this,Vi),iw(this,"columnsLimit",1/0),iw(this,"rowsLimit",1/0),iw(this,"pasteMode","overwrite"),iw(this,"uiContainer",this.hot.rootDocument.body),Hc(this,Jx,!1),Hc(this,e1,!1),Hc(this,t1,!1),Hc(this,Wg,"cells-only"),Hc(this,VE,!1),Hc(this,$E,!1),Hc(this,jg,new lOe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Hc(this,p0,!1),iw(this,"copyableRanges",[])}static get PLUGIN_KEY(){return aO}static get SETTING_KEYS(){return[aO,...ZOe]}static get PLUGIN_PRIORITY(){return QOe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[aO]}enablePlugin(){var e,t,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Ca(Jx,this,this.getSetting("copyColumnHeaders")),Ca(e1,this,this.getSetting("copyColumnGroupHeaders")),Ca(t1,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(t=this.getSetting("uiContainer"))!==null&&t!==void 0?t:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Si(Vi,this,n_e).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Si(Vi,r,r_e).call(r,...s)}),this.addHook("afterSelectionEnd",()=>Si(Vi,this,i_e).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),cC()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Si(Vi,r,s_e).call(r,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Si(Vi,r,o_e).call(r,...s)}),this.addHook("afterSelection",()=>Si(Vi,this,a_e).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Ca(Wg,this,e),Ca(VE,this,!0),Si(Vi,this,lj).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Ca($E,this,!0),Si(Vi,this,lj).call(this,"cut")}getRangedCopyableData(e){return m0(this.getRangedData(e))}getRangedData(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=[],{rows:i,columns:s}=SX(e);return k(i,o=>{const a=[];k(s,l=>{if(o<0)a.push(this.hot.getColHeader(l,o));else{let u=t?this.hot.getCopyableSourceData(o,l):this.hot.getCopyableData(o,l);t&&je(u)&&(u=JSON.stringify(u)),a.push(u)}}),r.push(a)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const r=new oOe;e&&r.clipboardData.setData("text/plain",e),t&&r.clipboardData.setData("text/html",t),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}ds(jg,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);ds(Wg,this)==="column-headers-only"?t.set("headers",ds(jg,this).getMostBottomColumnHeadersRange()):(ds(Wg,this)==="with-column-headers"?t.set("headers",ds(jg,this).getMostBottomColumnHeadersRange()):ds(Wg,this)==="with-column-group-headers"&&t.set("headers",ds(jg,this).getAllColumnHeadersRange()),t.set("cells",ds(jg,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=t.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=r;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const i=e.length,s=e[0].length,o=[],{row:a,col:l}=r.getTopStartCorner(),{row:u,col:c}=r.getBottomEndCorner();let h=a,d=l,f=a,m=l;for(;o.length<i||h<=u;){const{skipRowOnPaste:C,visualRow:y}=this.hot.getCellMeta(h,l);if(h=y+1,C===!0)continue;f=y,d=l;const w=[],S=o.length%i;for(;w.length<s||d<=c;){var g;const{skipColumnOnPaste:E,visualCol:P}=this.hot.getCellMeta(y,d),_=this.hot.getSourceDataAtCell(y,d),I=w.length%s;if(d=P+1,E===!0)continue;m=P;const D=t==null||(g=t[S])===null||g===void 0?void 0:g[I];let Q=e[S][I];if(t&&X5(D)){const F=JSON.parse(D);(je(_)||_===null)&&(Q=F)}w.push(Q)}o.push(w)}return Ca(p0,this,!0),this.hot.populateFromArray(a,l,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,f,m]}onCopy(e){const t=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=t==null?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ds(VE,this)||this.isEditorOpened()||Xl(t)&&(i&&t!==r||!i&&t!==this.hot.rootDocument.body&&!fy(t,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ca(VE,this,!1);const s=this.getRangedData(this.copyableRanges),o=this.getRangedData(this.copyableRanges,!0),a=Si(Vi,this,e_e).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,a)&&(Si(Vi,this,uj).call(this,e,s,o),this.hot.runHooks("afterCopy",s,this.copyableRanges,a)),Ca(Wg,this,"cells-only")}onCut(e){const t=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=t==null?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ds($E,this)||this.isEditorOpened()||Xl(t)&&(i&&t!==r||!i&&t!==this.hot.rootDocument.body&&!fy(t,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ca($E,this,!1);const s=this.getRangedData(this.copyableRanges),o=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",s,this.copyableRanges)&&(Si(Vi,this,uj).call(this,e,s,o),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges))}onPaste(e){const t=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=t==null?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Xl(t)&&(i&&t!==r||!i&&t!==this.hot.rootDocument.body&&!fy(t,this.hot.rootElement)))return;e.preventDefault();let s,o;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(RX);h&&(o=Zx(h,this.hot.rootDocument).data);const d=ZA(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?s=Zx(d,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=JIe(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(s,o);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function lj(n){if(cC()){const e=this.hot.getSelectedRangeActive();if(e){const{row:t,col:r}=e.highlight,i=this.hot.getCell(t,r,!0);i&&R9(i,()=>{this.hot.rootDocument.execCommand(n)})}}else this.hot.rootDocument.execCommand(n)}function e_e(n){const{rows:e}=SX(n);let t=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)t+=1;return{columnHeadersCount:t}}function t_e(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeActive();if(n){const{row:e,col:t}=n.highlight,r=this.hot.getCell(e,t,!0);r&&gD(r)}}}function TX(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeActive();if(n){const{row:e,col:t}=n.highlight,r=this.hot.getCell(e,t,!0);r!=null&&r.hasAttribute("contenteditable")&&mD(r)}}}function uj(n,e,t){const r=m0(e);if(n&&n.clipboardData){const i=Qx(e),s=Qx(t);n.clipboardData.setData("text/plain",r),n.clipboardData.setData("text/html",[aj,i].join("")),n.clipboardData.setData(RX,[aj,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",r)}function n_e(n){n.items.push({name:"---------"},eOe(this)),ds(Jx,this)&&n.items.push(rOe(this)),ds(e1,this)&&n.items.push(nOe(this)),ds(t1,this)&&n.items.push(tOe(this)),n.items.push(iOe(this))}function r_e(n,e,t,r,i){ds(p0,this)&&(i.value=!0),Ca(p0,this,!1)}function i_e(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function s_e(){Si(Vi,this,TX).call(this)}function o_e(){Si(Vi,this,t_e).call(this)}function a_e(){Si(Vi,this,TX).call(this)}function bX(n,e){return`border_row${n}col${e}`}function zw(){return{width:1,color:"#000"}}function qu(){return{hide:!0}}function l_e(){return{width:1,color:"#000",cornerVisible:!1}}function lO(n){if(Re(n.start)||Re(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(Re(n.end)||Re(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function sw(n){return Re(n.start)&&(n.left=n.start),Re(n.end)&&(n.right=n.end),n}function uO(n,e){return{id:bX(n,e),border:l_e(),row:n,col:e,top:qu(),bottom:qu(),start:qu(),end:qu()}}function u_e(n,e){return xn(e,"border")&&e.border&&(n.border=e.border),xn(e,"top")&&Re(e.top)&&(e.top?(je(e.top)||(e.top=zw()),n.top=e.top):(e.top=qu(),n.top=e.top)),xn(e,"bottom")&&Re(e.bottom)&&(e.bottom?(je(e.bottom)||(e.bottom=zw()),n.bottom=e.bottom):(e.bottom=qu(),n.bottom=e.bottom)),xn(e,"start")&&Re(e.start)&&(e.start?(je(e.start)||(e.start=zw()),n.start=e.start):(e.start=qu(),n.start=e.start)),xn(e,"end")&&Re(e.end)&&(e.end?(je(e.end)||(e.end=zw()),n.end=e.end):(e.end=qu(),n.end=e.end)),n}function dc(n,e){let t=!1;return k(n.getSelectedRange(),r=>{r.forAll((i,s)=>{if(i<0||s<0)return;const o=n.getCellMeta(i,s).borders;if(o)if(e){if(!xn(o[e],"hide")||o[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function NN(n){return`<span class="selected"></span>${n}`}function c_e(n){return n.some(e=>Re(e.left)||Re(e.right))}function h_e(n){return n.some(e=>Re(e.start)||Re(e.end))}const d_e=new Map([["left","start"],["right","end"]]);function f_e(n){var e;return(e=d_e.get(n))!==null&&e!==void 0?e:n}function g_e(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(sF);return dc(this,"bottom")&&(e=NN(e)),e},callback(e,t){const r=dc(this,"bottom");n.prepareBorder(t,"bottom",r)}}}function m_e(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(oF);return dc(this,e)&&(t=NN(t)),t},callback(t,r){const i=dc(this,e);n.prepareBorder(r,e,i)}}}function p_e(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(aF)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!dc(this)}}}function v_e(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(iF);return dc(this,e)&&(t=NN(t)),t},callback(t,r){const i=dc(this,e);n.prepareBorder(r,e,i)}}}function w_e(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(rF);return dc(this,"top")&&(e=NN(e)),e},callback(e,t){const r=dc(this,"top");n.prepareBorder(t,"top",r)}}}function y_e(n,e,t){return(e=S_e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function S_e(n){var e=C_e(n,"string");return typeof e=="symbol"?e:e+""}function C_e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Cc extends M8{constructor(e,t){super(e,null),y_e(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:r}=e,i=this.getNearestNotHiddenCoords(t,1),s=this.getNearestNotHiddenCoords(r,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=t,s=r),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,t,r){return t<0?t:e.getNearestNotHiddenIndex(t,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(t,r,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(t);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function cO(n){let{activeHeaderClassName:e,...t}=n;return new Cc({className:e,...t,selectionType:I8})}function E_e(n){let{areaCornerVisible:e,...t}=n;return new Cc({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:Ik})}function R_e(n){let{...e}=n;return new Cc({className:"highlight",...e,selectionType:Ik})}function T_e(n){let{columnClassName:e,...t}=n;return new Cc({className:e,...t,selectionType:w0e})}function b_e(n){let{cellCornerVisible:e,...t}=n;return new Cc({className:"current",headerAttributes:[tD()],border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:i0})}function A_e(n){let{border:e,visualCellRange:t,...r}=n;return new Cc({...e,...r,selectionType:y0e},t)}function N_e(n){let{...e}=n;return new Cc({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:p0e})}function cj(n){let{headerClassName:e,...t}=n;return new Cc({className:e,...t,selectionType:Mk})}function M_e(n){let{rowClassName:e,...t}=n;return new Cc({className:e,...t,selectionType:v0e})}function I_e(n,e){O_e(n,e),e.add(n)}function O_e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rs(n,e,t){return(e=__e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function __e(n){var e=P_e(n,"string");return typeof e=="symbol"?e:e+""}function P_e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Cu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var hl=new WeakSet;class x_e{constructor(e){I_e(this,hl),rs(this,"options",void 0),rs(this,"layerLevel",0),rs(this,"focus",void 0),rs(this,"fill",void 0),rs(this,"layeredAreas",new Map),rs(this,"areas",new Map),rs(this,"rowHeaders",new Map),rs(this,"columnHeaders",new Map),rs(this,"activeRowHeaders",new Map),rs(this,"activeColumnHeaders",new Map),rs(this,"activeCornerHeaders",new Map),rs(this,"rowHighlights",new Map),rs(this,"columnHighlights",new Map),rs(this,"customSelections",[]),this.options=e,this.focus=b_e(e),this.fill=N_e(e)}isEnabledFor(e,t){let r=e;e===i0&&(r="current");let i=this.options.disabledCellSelection(t.row,t.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Cu(hl,this,Eu).call(this,this.layeredAreas,E_e)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Cu(hl,this,Eu).call(this,this.areas,R_e)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Cu(hl,this,Eu).call(this,this.rowHeaders,cj)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Cu(hl,this,Eu).call(this,this.columnHeaders,cj)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Cu(hl,this,Eu).call(this,this.activeRowHeaders,cO)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Cu(hl,this,Eu).call(this,this.activeColumnHeaders,cO)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Cu(hl,this,Eu).call(this,this.activeCornerHeaders,cO)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Cu(hl,this,Eu).call(this,this.rowHighlights,M_e)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Cu(hl,this,Eu).call(this,this.columnHighlights,T_e)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(A_e({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),k(this.areas.values(),e=>void e.clear()),k(this.layeredAreas.values(),e=>void e.clear()),k(this.rowHeaders.values(),e=>void e.clear()),k(this.columnHeaders.values(),e=>void e.clear()),k(this.activeRowHeaders.values(),e=>void e.clear()),k(this.activeColumnHeaders.values(),e=>void e.clear()),k(this.activeCornerHeaders.values(),e=>void e.clear()),k(this.rowHighlights.values(),e=>void e.clear()),k(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Eu(n,e){const t=this.layerLevel;if(n.has(t))return n.get(t);const r=e({layerLevel:t,...this.options});return n.set(t,r),r}function hj(n,e,t){return(e=L_e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function L_e(n){var e=H_e(n,"string");return typeof e=="symbol"?e:e+""}function H_e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Qk{constructor(e){hj(this,"ranges",[]),hj(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((r,i)=>r.includes(e)&&t(r,i))}findAll(e){const t=[];return this.ranges.forEach((r,i)=>{r.isEqual(e)&&t.push({range:r,layer:i})}),t}remove(e){return this.ranges=this.ranges.filter(t=>!e.some(r=>r.isEqual(t))),this}removeLayers(e){return this.ranges=this.ranges.filter((t,r)=>!e.includes(r)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new Qk(this.createCellRange);return e.ranges=this.ranges.map(t=>t.clone()),e}map(e){return this.ranges=this.ranges.map((t,r)=>e(t,r)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function D_e(n,e){AX(n,e),e.add(n)}function F_e(n,e,t){return(e=k_e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k_e(n){var e=V_e(n,"string");return typeof e=="symbol"?e:e+""}function V_e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function hO(n,e,t){AX(n,e),e.set(n,t)}function AX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pr(n,e){return n.get(Wt(n,e))}function Gm(n,e,t){return n.set(Wt(n,e),t),t}function Wt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Fu=new WeakMap,mf=new WeakMap,ho=new WeakMap,Gt=new WeakSet;class Zk{constructor(e,t){D_e(this,Gt),hO(this,Fu,void 0),hO(this,mf,0),hO(this,ho,{x:0,y:0}),F_e(this,"tableApi",void 0),Gm(Fu,this,e),this.tableApi=t}setActiveLayerIndex(e){Gm(mf,this,e)}getCurrentSelection(){return pr(Fu,this).peekByIndex(pr(mf,this))}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Gm(ho,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,t);let s=this.getCurrentSelection().highlight;const o=this.tableApi.visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){let{width:u,height:c}=Wt(Gt,this,n1).call(this);const{row:h,col:d}=Wt(Gt,this,mj).call(this,s),f=this.tableApi.fixedRowsBottom(),m=this.tableApi.minSpareRows(),g=this.tableApi.minSpareCols(),C=this.tableApi.autoWrapRow(),y=this.tableApi.autoWrapCol(),w=this.tableApi.createCellCoords(h+i.row,d+i.col);if(w.row>=c){const P=Rs(r&&m>0&&f===0),_=w.col+1,I=_>=u,D=this.tableApi.createCellCoords(w.row-c,I?_-u:_);if(this.runLocalHooks("beforeColumnWrap",P,Wt(Gt,this,zg).call(this,D),I),P.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(y){if(this.shouldSwitchSelectionLayer()&&I&&pr(Fu,this).size()>1){Wt(Gt,this,dj).call(this);const Q=Wt(Gt,this,UE).call(this,"forward");Q!==null&&D.assign(Q)}w.assign(D)}}else if(w.row<0){const P=Rs(y),_=w.col-1,I=_<0,D=this.tableApi.createCellCoords(c+w.row,I?u+_:_);if(this.runLocalHooks("beforeColumnWrap",P,Wt(Gt,this,zg).call(this,D),I),y){if(this.shouldSwitchSelectionLayer()&&I&&pr(Fu,this).size()>1){Wt(Gt,this,fj).call(this);const Q=Wt(Gt,this,UE).call(this,"backward");Q!==null&&D.assign(Q)}w.assign(D)}}if({width:u,height:c}=Wt(Gt,this,n1).call(this),w.col>=u){const P=Rs(r&&g>0),_=w.row+1,I=_>=c,D=this.tableApi.createCellCoords(I?_-c:_,w.col-u);if(this.runLocalHooks("beforeRowWrap",P,Wt(Gt,this,zg).call(this,D),I),P.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(C){if(this.shouldSwitchSelectionLayer()&&I&&pr(Fu,this).size()>1){Wt(Gt,this,dj).call(this);const Q=Wt(Gt,this,UE).call(this,"forward");Q!==null&&D.assign(Q)}w.assign(D)}}else if(w.col<0){const P=Rs(C),_=w.row-1,I=_<0,D=this.tableApi.createCellCoords(I?c+_:_,u+w.col);if(this.runLocalHooks("beforeRowWrap",P,Wt(Gt,this,zg).call(this,D),I),C){if(this.shouldSwitchSelectionLayer()&&I&&pr(Fu,this).size()>1){Wt(Gt,this,fj).call(this);const Q=Wt(Gt,this,UE).call(this,"backward");Q!==null&&D.assign(Q)}w.assign(D)}}const{rowDir:S,colDir:E}=Wt(Gt,this,gj).call(this,w);a=S,l=E,s=Wt(Gt,this,zg).call(this,w)}return this.runLocalHooks("afterTransformStart",s,a,l),{selectionLayer:pr(mf,this),visualCoords:s}}transformEnd(e,t){Gm(ho,this,this.calculateOffset());const r=this.tableApi.createCellCoords(e,t),i=this.getCurrentSelection(),s=this.tableApi.visualToRenderableCoords(i.highlight),o=Wt(Gt,this,DT).call(this,i.to.row,i.from.row),a=Wt(Gt,this,FT).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:h,col:d}=Wt(Gt,this,mj).call(this,i.highlight),f=this.tableApi.createCellCoords(o+r.row,a+r.col),m=i.getTopStartCorner(),g=i.getTopEndCorner(),C=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const E=f.col-d;f.col=Wt(Gt,this,FT).call(this,m.col,g.col)+E}else if(r.col>0&&a<=d&&f.col>d){const E=Wt(Gt,this,FT).call(this,g.col,m.col),P=Math.max(f.col-E,1);f.col=E+P}if(r.row<0&&o>=h&&f.row<h){const E=f.row-h;f.row=Wt(Gt,this,DT).call(this,m.row,C.row)+E}else if(r.row>0&&o<=h&&f.row>h){const E=Wt(Gt,this,DT).call(this,C.row,m.row),P=Math.max(f.row-E,1);f.row=E+P}const{rowDir:y,colDir:w}=Wt(Gt,this,gj).call(this,f);u=y,c=w;const S=Wt(Gt,this,zg).call(this,f);r.row===0&&r.col!==0?l.col=S.col:r.row!==0&&r.col===0?l.row=S.row:(l.row=S.row,l.col=S.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:pr(mf,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function dj(){const n=pr(mf,this)+1;this.setActiveLayerIndex(n>=pr(Fu,this).size()?0:n),Gm(ho,this,this.calculateOffset())}function fj(){const n=pr(mf,this)-1;this.setActiveLayerIndex(n<0?pr(Fu,this).size()-1:n),Gm(ho,this,this.calculateOffset())}function gj(n){const{width:e,height:t}=Wt(Gt,this,n1).call(this);let r=0,i=0;return n.row<0?(r=-1,n.row=0):n.row>0&&n.row>=t&&(r=1,n.row=t-1),n.col<0?(i=-1,n.col=0):n.col>0&&n.col>=e&&(i=1,n.col=e-1),{rowDir:r,colDir:i}}function n1(){return{width:pr(ho,this).x+this.countRenderableColumns(),height:pr(ho,this).y+this.countRenderableRows()}}function UE(n){if(!["forward","backward"].includes(n))return null;const e=this.getCurrentSelection().getTopStartCorner(),t=this.getCurrentSelection().getBottomEndCorner(),[r,i,s,o]=n==="forward"?[e.row,t.row,e.col,t.col]:[t.row,e.row,t.col,e.col],a=Wt(Gt,this,DT).call(this,r,i),l=Wt(Gt,this,FT).call(this,s,o);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function DT(n,e){const t=this.tableApi.findFirstNonHiddenRenderableRow(n,e);return t===null?null:pr(ho,this).y+t}function FT(n,e){const t=this.tableApi.findFirstNonHiddenRenderableColumn(n,e);return t===null?null:pr(ho,this).x+t}function mj(n){const{row:e,col:t}=this.tableApi.visualToRenderableCoords(n);if(e===null||t===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(pr(ho,this).y+e,pr(ho,this).x+t)}function zg(n){const e=n.clone();return e.col=n.col-pr(ho,this).x,e.row=n.row-pr(ho,this).y,this.tableApi.renderableToVisualCoords(e)}Vt(Zk,Hr);class $_e extends Zk{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class U_e extends Zk{calculateOffset(){const e=this.getCurrentSelection(),{row:t,col:r}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,r-1),s=this.tableApi.countRenderableRowsInRange(0,t-1),o=e.highlight.isHeader(),a=o?Math.abs(r):0,l=o?Math.abs(t):0;return{x:r<0?a:-i,y:t<0?l:-s}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}function Od(n,e,t){B_e(n,e),e.set(n,t)}function B_e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _d(n,e,t){return(e=W_e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function W_e(n){var e=j_e(n,"string");return typeof e=="symbol"?e:e+""}function j_e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function wn(n,e){return n.get(NX(n,e))}function ks(n,e,t){return n.set(NX(n,e),t),t}function NX(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Vs=new WeakMap,Gg=new WeakMap,BE=new WeakMap,Dc=new WeakMap,WE=new WeakMap,ow=new WeakMap,jE=new WeakMap;class MX{constructor(e,t){var r=this;_d(this,"settings",void 0),_d(this,"tableProps",void 0),_d(this,"inProgress",!1),_d(this,"selectedRange",new Qk((i,s,o)=>this.tableProps.createCellRange(i,s,o))),_d(this,"highlight",void 0),Od(this,Vs,void 0),Od(this,Gg,void 0),_d(this,"selectedByRowHeader",new Set),_d(this,"selectedByColumnHeader",new Set),Od(this,BE,!1),Od(this,Dc,!1),Od(this,WE,"unknown"),Od(this,ow,-1),Od(this,jE,0),this.settings=e,this.tableProps=t,this.highlight=new x_e({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[tD()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),ks(Vs,this,new $_e(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),ks(Gg,this,new U_e(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),wn(Vs,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformStart",...s)}),wn(Vs,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformStart",...s)}),wn(Vs,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformEnd",...s)}),wn(Vs,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformEnd",...s)}),wn(Vs,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertRowRequire",...s)}),wn(Vs,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertColRequire",...s)}),wn(Vs,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeRowWrap",...s)}),wn(Vs,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeColumnWrap",...s)}),wn(Gg,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformFocus",...s)}),wn(Gg,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(wn(jE,this))}getActiveSelectionLayerIndex(){return wn(jE,this)}setActiveSelectionLayerIndex(e){ks(jE,this,e)}markSource(e){ks(WE,this,e)}markEndSource(){ks(WE,this,"unknown")}getSelectionSource(){return wn(WE,this)}setExpectedLayers(e){ks(ow,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,ks(ow,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=fn(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();ks(Dc,this,!1),ks(BE,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!s||s&&!o&&fn(t))&&(this.selectedRange.clear(),k(this.highlight.getAreas(),l=>void l.clear()),k(this.highlight.getLayeredAreas(),l=>void l.clear()),k(this.highlight.getRowHeaders(),l=>void l.clear()),k(this.highlight.getColumnHeaders(),l=>void l.clear()),k(this.highlight.getActiveRowHeaders(),l=>void l.clear()),k(this.highlight.getActiveColumnHeaders(),l=>void l.clear()),k(this.highlight.getActiveCornerHeaders(),l=>void l.clear()),k(this.highlight.getRowHighlights(),l=>void l.clear()),k(this.highlight.getColumnHighlights(),l=>void l.clear())),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,r)}setRangeEnd(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(t);const r=e.clone(),i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||s>0)&&(i===0&&r.col<0&&!o||s===0&&r.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(r),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&s>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,t),this.applyAndCommit(this.getActiveSelectedRange(),t);const l=wn(ow,this)===-1||this.selectedRange.size()===wn(ow,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(t);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(Ik,e.highlight)&&(this.isMultiple()||t>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),t===1)){const m=this.selectedRange.peekByIndex(t-1);this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(Mk,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),y=this.tableProps.createCellCoords(e.to.row,-1),w=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),S=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(w).commit(),d.add(C).commit(),f.add(w).commit()):(a.add(C).add(y).commit(),l.add(w).add(S).commit(),d.add(C).add(y).commit(),f.add(w).add(S).commit())}const m=!wn(Dc,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),g=!wn(Dc,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),g&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&g&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(t),wn(Vs,this).setActiveLayerIndex(t),wn(Gg,this).setActiveLayerIndex(t);const r=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(i0,r.highlight)&&i.add(r.highlight).commit().syncWith(r),this.inProgress||(ks(BE,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:i}=wn(Vs,this).transformStart(e,t,r);this.setRangeStart(i)}transformEnd(e,t){const{visualCoords:r,selectionLayer:i}=wn(Vs,this).transformEnd(e,t);this.setRangeEnd(r,i)}transformFocus(e,t){const{selectionLayer:r,visualCoords:i}=wn(Gg,this).transformStart(e,t);this.setRangeFocus(i.normalize(),r)}shiftRows(e,t){if(!this.isSelected())return;const r=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(ft(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(ft(s.row+t,c,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(ft(o.row+t,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const r=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,ft(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(s.row,ft(s.col+t,c,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,ft(o.col+t,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const t=Rs(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}isFocusSelectionChanged(){return this.isSelected()&&wn(BE,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>t(i));const r=this.selectedRange.peekByIndex(e);return r?t(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>t(i));const r=this.selectedRange.peekByIndex(e);return r?t(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=t?-a:0;if(u===0&&c===0&&(s===0||o===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(ft(d.row,u,s-1),ft(d.col,c,o-1)));const m=this.tableProps.createCellCoords(u,c),g=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.runLocalHooks("beforeSelectAll",m,g,h),this.setRangeStartOnly(m,void 0,h),ks(Dc,this,f),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.runLocalHooks("afterSelectAll",m,g,h),this.finish()}selectCells(e){var t=this;const r=Up(e);if(r===SN)return!1;if(r===yN)throw new Error(Lt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=SS(r,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(o);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),k(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof t=="string"?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(o-1,s),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=ft(r.row,u,o-1),m=ft(r.col,Math.min(i,s),Math.max(i,s))):(f=ft(r,u,o-1),m=i);const g=this.tableProps.createCellCoords(f,m),C=l===0?0:ft(g.row,u,-1),y=o-1,w=this.tableProps.createCellCoords(C,i),S=this.tableProps.createCellCoords(y,s);this.runLocalHooks("beforeSelectColumns",w,S,g),this.setRangeStartOnly(w,void 0,g),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectColumns",w,S,g),this.finish()}return d}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(t,s-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=ft(r.row,Math.min(e,t),Math.max(e,t)),d=ft(r.col,a,s-1)):(h=e,d=ft(r,a,s-1));const f=this.tableProps.createCellCoords(h,d),m=o===0?0:ft(f.col,a,-1),g=s-1,C=this.tableProps.createCellCoords(e,m),y=this.tableProps.createCellCoords(t,g);this.runLocalHooks("beforeSelectRows",C,y,f),this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectRows",C,y,f),this.finish()}return c}importSelection(e){let{ranges:t,activeRange:r,activeSelectionLayer:i,selectedByRowHeader:s,selectedByColumnHeader:o,disableHeadersHighlight:a}=e;t.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!0,ks(Dc,this,a),this.selectedByRowHeader=new Set(s),this.selectedByColumnHeader=new Set(o),this.setActiveSelectionLayerIndex(0),t.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(r.highlight,i),ks(Dc,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:wn(Dc,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const r=this.selectedRange.ranges.map(o=>o.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),s=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(r.length),r.forEach(o=>{const{from:a,to:l,highlight:u}=o,c=e-1,h=t-1;u.assign({row:ft(u.row,this.settings.navigableHeaders?-1/0:0,c),col:ft(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:ft(a.row,-1/0,c),col:ft(a.col,-1/0,h)}),l.assign({row:ft(l.row,-1/0,c),col:ft(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=s,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const t=this.getLayerLevel(),r=this.getActiveSelectedRange();this.highlight.isEnabledFor(i0,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(t)}}Vt(MX,Hr);function pj(n){let{isShiftKey:e,isLeftClick:t,isRightClick:r,coords:i,selection:s,controller:o,cellCoordsFactory:a}=n;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!s.inInSelection(i),d=t||r&&h;i.row<0&&i.col>=0&&!o.column?d&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?d&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?d&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function z_e(n){let{isLeftClick:e,coords:t,selection:r,controller:i,cellCoordsFactory:s}=n;if(!e)return;const o=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(s(u-1,t.col)):o&&!i.row?r.setRangeEnd(s(t.row,l-1)):i.cell||r.setRangeEnd(t),r.markEndSource()}function vj(n){let{isLeftClick:e,selection:t,cellRangeMapper:r}=n;if(!e||t.settings.selectionMode!=="multiple")return;const i=t.getSelectedRange(),s=i.clone().map(a=>r.toRenderable(a)),o=s.current();if(s.size()>1&&!o.isHeader()&&!t.isMultiple(o)){const a=s.findAll(o);a.length===s.size()?(i.pop(),t.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),t.refresh())}}const G_e=new Map([["touchstart",pj],["touchend",vj],["mousedown",pj],["mouseover",z_e],["mouseup",vj]]);function dO(n,e){G_e.get(n.type)({isShiftKey:n.shiftKey,isLeftClick:iN(n)||n.type==="touchstart",isRightClick:qh(n),...e})}function Y_e(n,e){K_e(n,e),e.add(n)}function K_e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function X_e(n,e,t){return(e=q_e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function q_e(n){var e=Q_e(n,"string");return typeof e=="symbol"?e:e+""}function Q_e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function wj(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const kT="customBorders",Z_e=90;var fO=new WeakSet;class J_e extends yt{constructor(){super(...arguments),Y_e(this,fO),X_e(this,"savedBorders",[])}static get PLUGIN_KEY(){return kT}static get PLUGIN_PRIORITY(){return Z_e}isEnabled(){return!!this.hot.getSettings()[kT]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>wj(fO,this,ePe).call(this,e)),this.addHook("init",()=>wj(fO,this,tPe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let r=["top","bottom","start","end"],i=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),i=lO(t));const s=Up(e),o=SS(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});k(e,a=>{o(a).forAll((l,u)=>{k(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,f_e(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=Up(e),r=SS(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return k(e,s=>{r(s).forAll((o,a)=>{k(this.savedBorders,l=>{l.row===o&&l.col===a&&i.push(sw(l))})})}),i}clearBorders(e){e?this.setBorders(e):(k(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,t,r,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||t>=o)return;let a=uO(e,t);r&&(a=u_e(a,r),k(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",sw(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,t){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Le(e.from.row,r,s=>{Le(e.from.col,i,o=>{const a=uO(s,o);let l=0;s===e.from.row&&xn(t,"top")&&(l+=1,a.top=t.top),s===e.to.row&&xn(t,"bottom")&&(l+=1,a.bottom=t.bottom),o===e.from.col&&xn(t,"start")&&(l+=1,a.start=t.start),o===e.to.col&&xn(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(s,o,"borders",sw(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){const r=bX(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,r,i){let s=this.hot.getCellMeta(e,t).borders;!s||s.border===void 0?s=uO(e,t):s=lO(s),i?(s[r]=qu(),this.countHide(s)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",sw(s)))):(s[r]=zw(),this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",sw(s)))}prepareBorder(e,t,r){k(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)t==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,t,r);else switch(t){case"noBorders":Le(s.col,o.col,a=>{Le(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Le(s.col,o.col,a=>{this.setBorder(s.row,a,t,r)});break;case"bottom":Le(s.col,o.col,a=>{this.setBorder(o.row,a,t,r)});break;case"start":Le(s.row,o.row,a=>{this.setBorder(a,s.col,t,r)});break;case"end":Le(s.row,o.row,a=>{this.setBorder(a,o.col,t,r)});break}})}createCustomBorders(e){k(e,t=>{const r=lO(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,r):this.prepareBorderFromCustomAdded(t.row,t.col,r)})}countHide(e){const{top:t,bottom:r,start:i,end:s}=e;return Er([t,r,i,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const t=At(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){k(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){k(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=At(this.savedBorders,r=>r.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):k(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,r){let i=!1;return k(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return k(o,a=>{a.toggleHiddenClass(t,r)}),i=!0,!1}}),i}checkCustomSelections(e,t,r){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):k(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=t,o.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);k(a,l=>{l.changeBorderStyle(r,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[kT];if(Array.isArray(e)){const t=Oi(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=c_e(e),r=h_e(e);if(t&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function ePe(n){this.hot.getSettings()[kT]&&n.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(nF)},disabled(){const e=this.getSelectedRangeActive();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[w_e(this),v_e(this),g_e(this),m_e(this),p_e(this)]}})}function tPe(){this.changeBorderSettings()}function nPe(n,e){rPe(n,e),e.add(n)}function rPe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gO(n,e,t){return(e=iPe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function iPe(n){var e=sPe(n,"string");return typeof e=="symbol"?e:e+""}function sPe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function yj(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Sj="dragToScroll",oPe=100;var mO=new WeakSet;class aPe extends yt{constructor(){super(...arguments),nPe(this,mO),gO(this,"boundaries",null),gO(this,"callback",null),gO(this,"listening",!1)}static get PLUGIN_KEY(){return Sj}static get PLUGIN_PRIORITY(){return oPe}isEnabled(){return!!this.hot.getSettings()[Sj]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>yj(mO,this,Cj).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>yj(mO,this,Cj).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let r=0,i=0;t<this.boundaries.top?i=t-this.boundaries.top:t>this.boundaries.bottom&&(i=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",r=>this.onMouseMove(r)),t=Gf(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function Cj(n){if(qh(n))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,r)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(t)*50,a+Math.sign(r)*20)}),this.listen()}function lPe(n,e){IX(n,e),e.add(n)}function uPe(n,e,t){IX(n,e),e.set(n,t)}function IX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pO(n,e,t){return(e=cPe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cPe(n){var e=hPe(n,"string");return typeof e=="symbol"?e:e+""}function hPe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function dPe(n,e){return n.get(Lo(n,e))}function OX(n,e,t){return n.set(Lo(n,e),t),t}function Lo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("afterDropdownMenuDefaultOptions");we.getSingleton().register("beforeDropdownMenuShow");we.getSingleton().register("afterDropdownMenuShow");we.getSingleton().register("afterDropdownMenuHide");we.getSingleton().register("afterDropdownMenuExecute");const VT="dropdownMenu",fPe=230,ES="changeType",vO=VT;var MN=new WeakMap,Ta=new WeakSet;class IN extends yt{static get PLUGIN_KEY(){return VT}static get PLUGIN_PRIORITY(){return fPe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[EC,RC,mt,bC,mt,vN,mt,TC,mt,xo]}constructor(e){super(e),lPe(this,Ta),pO(this,"commandExecutor",new fX(this.hot)),pO(this,"itemsFactory",null),pO(this,"menu",null),uPe(this,MN,!1),this.hot.addHook("afterGetColHeader",(t,r)=>Lo(Ta,this,mPe).call(this,t,r))}isEnabled(){return this.hot.getSettings()[VT]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new gX(this.hot,IN.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Lo(Ta,e,CPe).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Lo(Ta,e,SPe).call(e,...s)}),this.addHook("beforeDialogShow",()=>this.close());const t=this.hot.getSettings()[VT],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new gv(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Lo(Ta,this,pPe).call(this)),this.menu.addLocalHook("afterOpen",()=>Lo(Ta,this,vPe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>Lo(Ta,this,wPe).call(this,s)),this.menu.addLocalHook("afterClose",()=>Lo(Ta,this,yPe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),k(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:r}=this.hot.getSelectedRangeActive();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeActive(),s=pN(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${ES}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:vO},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:vO}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vO)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Lo(Ta,this,gPe).call(this,e))}open(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),ct(r,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _X(n){n.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function gPe(n){if(Be(n.target,ES)){const e=pN(this.menu.container,this.hot.rootDocument),t=n.target.getBoundingClientRect();n.stopPropagation(),OX(MN,this,!1),this.open({left:t.left+e.left,top:t.top+n.target.offsetHeight+e.top},{left:t.width,right:0,above:0,below:3})}}function mPe(n,e){const t=e.parentNode;if(!t)return;const r=t.parentNode.childNodes,i=Array.prototype.indexOf.call(r,t);if(n<0||i!==r.length-1)return;const s=e.querySelector(`.${ES}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=ES,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(Pe(o,[fg(),io(" ")]),Pe(e,[J5("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function pPe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function vPe(){this.hot.runHooks("afterDropdownMenuShow",this),Lo(Ta,this,_X).call(this,this.menu)}function wPe(n){Lo(Ta,this,_X).call(this,n)}function yPe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function SPe(n){return dPe(MN,this)?null:n}function CPe(n){Be(n.target,ES)&&OX(MN,this,!0)}IN.SEPARATOR={name:mt};function Ej(n,e,t){return(e=EPe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function EPe(n){var e=RPe(n,"string");return typeof e=="symbol"?e:e+""}function RPe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class TPe{constructor(e){Ej(this,"hot",void 0),Ej(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:r,endCol:i}=this._getDataRange(),s=this.options,o=[];return Le(e,r,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(Le(t,i,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();Le(t,r,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();Le(t,r,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[r=0,i=0,s=t,o=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),s=Math.min(s,t),o=Math.min(o,e),{startRow:r,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function Rj(n,e,t){return(e=bPe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bPe(n){var e=APe(n,"string");return typeof e=="symbol"?e:e+""}function APe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Jk{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){Rj(this,"dataProvider",void 0),Rj(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=qa(this.constructor.DEFAULT_OPTIONS);const r=new Date;return t=lr(qa(Jk.DEFAULT_OPTIONS),t),t=lr(t,e),t.filename=QA(t.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),t}}function NPe(n,e){MPe(n,e),e.add(n)}function MPe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tj(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const PX="\r",IPe='"',OPe=`
`,_Pe="=",PPe="+",xPe="-",LPe="@",HPe="	";var wO=new WeakSet;class DPe extends Jk{constructor(){super(...arguments),NPe(this,wO)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,t=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=At(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),o&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),k(t,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:t=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=on(e);return i===""||(r&&(t=!0),r instanceof RegExp?i=Tj(wO,this,kPe).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=Tj(wO,this,FPe).call(this,i)),(t||i.indexOf(PX)>=0||i.indexOf(IPe)>=0||i.indexOf(OPe)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function FPe(n){return n.startsWith(_Pe)||n.startsWith(PPe)||n.startsWith(xPe)||n.startsWith(LPe)||n.startsWith(HPe)||n.startsWith(PX)?`'${n}`:n}function kPe(n,e){return e.test(n)?`'${n}`:n}const VPe="csv",r1={[VPe]:DPe};function $Pe(n,e,t){return typeof r1[n]=="function"?new r1[n](e,t):null}const UPe="exportFile",BPe=240;class WPe extends yt{static get PLUGIN_KEY(){return UPe}static get PLUGIN_PRIORITY(){return BPe}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,t),o=this._createBlob(s),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!r1[e])throw new Error(`Export format type "${e}" is not supported.`);return $Pe(e,new TPe(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function Yg(n,e,t){return(e=jPe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jPe(n){var e=zPe(n,"string");return typeof e=="symbol"?e:e+""}function zPe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class AC{constructor(e,t){let{id:r,stateless:i=!0}=t;Yg(this,"hot",void 0),Yg(this,"id",void 0),Yg(this,"elements",[]),Yg(this,"hidden",!1),Yg(this,"stateId",""),Yg(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new mN)}getElements(){return this.elements}reset(){k(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),k(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Vt(AC,Hr);const RS={};function Qh(n,e){if(!RS[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:r}=RS[n];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(s){return t.apply(s.meta.instance,[].concat([s],[i]))}}function Nf(n){if(!RS[n])throw Error(`Filter condition "${n}" does not exist.`);return RS[n].descriptor}function hr(n,e,t){t.key=n,RS[n]={condition:e,descriptor:t}}const Gr="none";function GPe(){return!0}hr(Gr,GPe,{name:sN,inputsCount:0,showOperators:!1});const wy="empty";function YPe(n){return Dn(n.value)}hr(wy,YPe,{name:gF,inputsCount:0,showOperators:!0});const $T="not_empty";function KPe(n,e){return!Qh(wy,e)(n)}hr($T,KPe,{name:mF,inputsCount:0,showOperators:!0});const yy="eq";function XPe(n,e){let[t]=e;return on(n.value).toLocaleLowerCase(n.meta.locale)===on(t)}hr(yy,XPe,{name:pF,inputsCount:1,showOperators:!0});const UT="neq";function qPe(n,e){return!Qh(yy,e)(n)}hr(UT,qPe,{name:vF,inputsCount:1,showOperators:!0});const xX="gt";function QPe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>r}hr(xX,QPe,{name:EF,inputsCount:1,showOperators:!0});const LX="gte";function ZPe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>=r}hr(LX,ZPe,{name:RF,inputsCount:1,showOperators:!0});const HX="lt";function JPe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<r}hr(HX,JPe,{name:TF,inputsCount:1,showOperators:!0});const DX="lte";function exe(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<=r}hr(DX,exe,{name:bF,inputsCount:1,showOperators:!0});const eV="date_after";function txe(n,e){let[t]=e;const r=se(n.value,n.meta.dateFormat),i=se(t,n.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}hr(eV,txe,{name:MF,inputsCount:1,showOperators:!0});const tV="date_before";function nxe(n,e){let[t]=e;const r=se(n.value,n.meta.dateFormat),i=se(t,n.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}hr(tV,nxe,{name:IF,inputsCount:1,showOperators:!0});const v0="between";function rxe(n,e){let[t,r]=e,i=t,s=r;if(n.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(n.meta.type==="date"){const o=Qh(tV,[s]),a=Qh(eV,[i]);return o(n)&&a(n)}return n.value>=i&&n.value<=s}hr(v0,rxe,{name:AF,inputsCount:2,showOperators:!0});const FX="not_between";function ixe(n,e){return!Qh(v0,e)(n)}hr(FX,ixe,{name:NF,inputsCount:2,showOperators:!0});const kX="begins_with";function sxe(n,e){let[t]=e;return on(n.value).toLocaleLowerCase(n.meta.locale).startsWith(on(t))}hr(kX,sxe,{name:wF,inputsCount:1,showOperators:!0});const VX="ends_with";function oxe(n,e){let[t]=e;return on(n.value).toLocaleLowerCase(n.meta.locale).endsWith(on(t))}hr(VX,oxe,{name:yF,inputsCount:1,showOperators:!0});const nV="contains";function axe(n,e){let[t]=e;return on(n.value).toLocaleLowerCase(n.meta.locale).indexOf(on(t))>=0}hr(nV,axe,{name:SF,inputsCount:1,showOperators:!0});const $X="not_contains";function lxe(n,e){return!Qh(nV,e)(n)}hr($X,lxe,{name:CF,inputsCount:1,showOperators:!0});const UX="date_tomorrow";function uxe(n){const e=se(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(se().subtract(-1,"days").startOf("day"),"d"):!1}hr(UX,uxe,{name:_F,inputsCount:0});const BX="date_today";function cxe(n){const e=se(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(se().startOf("day"),"d"):!1}hr(BX,cxe,{name:OF,inputsCount:0});const WX="date_yesterday";function hxe(n){const e=se(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(se().subtract(1,"days").startOf("day"),"d"):!1}hr(WX,hxe,{name:PF,inputsCount:0});i9();function dxe(n,e){let t=n;return t===""&&(t=`(${e})`),t}function NC(n){const e=new Set(n);return function(t){return e.has(t)}}function rV(n){return n??""}function i1(n){return Array.from(new Set(n)).map(e=>rV(e)).sort((e,t)=>typeof e=="number"&&typeof t=="number"?e-t:e===t?0:e>t?1:-1)}function bj(n,e,t,r){const i=[],s=n===e;let o;return s||(o=NC(e)),n.forEach(a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:dxe(a,t)};r&&r(u),i.push(u)}),i}const Mf="by_value";function fxe(n,e){let[t]=e;return t(n.value)}hr(Mf,fxe,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[NC(e)]},showOperators:!1});const TS={};function gxe(n){if(!TS[n])throw Error(`Operation with id "${n}" does not exist.`);const e=TS[n].func;return function(t,r){return e(t,r)}}function mxe(n){return TS[n].name}function iV(n,e,t){TS[n]={name:e,func:t}}const $h="conjunction",pxe=HF;function vxe(n,e){return n.every(t=>t.func(e))}iV($h,pxe,vxe);const w0="disjunction",wxe=oN;function yxe(n,e){return n.some(t=>t.func(e))}iV(w0,wxe,yxe);const sV="disjunctionWithExtraCondition",Sxe=oN;function Cxe(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}iV(sV,Sxe,Cxe);const Exe="numeric",jX="text",Rxe="date",Aj={[Exe]:[Gr,mt,wy,$T,mt,yy,UT,mt,xX,LX,HX,DX,v0,FX],[jX]:[Gr,mt,wy,$T,mt,yy,UT,mt,kX,VX,mt,nV,$X],[Rxe]:[Gr,mt,wy,$T,mt,yy,UT,mt,tV,eV,v0,mt,UX,BX,WX]};function Txe(n){const e=[];let t=n;return Aj[t]||(t=jX),k(Aj[t],r=>{let i;r===mt?i={name:mt}:i=qa(Nf(r)),e.push(i)}),e}function aw(n,e,t){return(e=bxe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bxe(n){var e=Axe(n,"string");return typeof e=="symbol"?e:e+""}function Axe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const yO="built",SO="building",Nj=["click","input","keydown","keypress","keyup","focus","blur","change"];let za=class zX{static get DEFAULTS(){return qa({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){aw(this,"hot",void 0),aw(this,"eventManager",new Zo(this)),aw(this,"options",void 0),aw(this,"_element",void 0),aw(this,"buildState",void 0),this.hot=e,this.options=lr(zX.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===SO?this._element:this.buildState===yO?(this.update(),this._element):(this.buildState=SO,this.build(),this.buildState=yO,this._element)}isBuilt(){return this.buildState===yO}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Zi)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,r)=>{this.eventManager.addEventListener(t,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=SO),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ee(this._element,this.options.className),this.options.children.length)k(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),ct(this.options,(r,i)=>{t[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(t[i]=this.translateIfPossible(r))}),this._element.appendChild(t),k(Nj,r=>e(t,r))}else k(Nj,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Vt(za,Hr);function Nxe(n,e){GX(n,e),e.add(n)}function Mxe(n,e,t){GX(n,e),e.set(n,t)}function GX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zE(n,e){return n.get(oV(n,e))}function Ixe(n,e,t){return n.set(oV(n,e),t),t}function oV(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Kg=new WeakMap,Mj=new WeakSet;class Uh extends za{static get DEFAULTS(){return qa({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,lr(Uh.DEFAULTS,t)),Nxe(this,Mj),Mxe(this,Kg,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>oV(Mj,this,Oxe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Ixe(Kg,this,this._element.firstChild),ee(this._element,"htUIInput"),ee(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(zE(Kg,this).type=this.options.type,zE(Kg,this).placeholder=this.translateIfPossible(this.options.placeholder),zE(Kg,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&zE(Kg,this).focus()}}function Oxe(n){this.options.value=n.target.value}function _xe(n,e){YX(n,e),e.add(n)}function lw(n,e,t){YX(n,e),e.set(n,t)}function YX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xg(n,e,t){return n.set(Sy(n,e),t),t}function bn(n,e){return n.get(Sy(n,e))}function Sy(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Tr=new WeakMap,GE=new WeakMap,YE=new WeakMap,CO=new WeakMap,KE=new WeakMap,XE=new WeakSet;class bS extends za{static get DEFAULTS(){return qa({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,lr(bS.DEFAULTS,t)),_xe(this,XE),lw(this,Tr,null),lw(this,GE,[]),lw(this,YE,void 0),lw(this,CO,void 0),lw(this,KE,void 0),this.registerHooks()}getMenu(){return bn(Tr,this)}registerHooks(){this.addLocalHook("click",()=>Sy(XE,this,Lxe).call(this))}setItems(e){Xg(GE,this,this.translateNames(e)),bn(Tr,this)&&bn(Tr,this).setMenuItems(bn(GE,this))}translateNames(e){return k(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),Xg(Tr,this,new gv(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),bn(Tr,this).setMenuItems(bn(GE,this));const e=new za(this.hot,{className:"htUISelectCaption"}),t=new za(this.hot,{className:"htUISelectDropdown"});Xg(YE,this,e),Xg(CO,this,e.element),Xg(KE,this,t),this.hot.getSettings().ariaTags&&(Pe(t.element,[fg()]),Pe(this._element,[Z5()])),k([e,t],r=>this._element.appendChild(r.element)),bn(Tr,this).addLocalHook("select",r=>Sy(XE,this,Pxe).call(this,r)),bn(Tr,this).addLocalHook("afterClose",()=>Sy(XE,this,xxe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=bn(Tr,this).hot.getTranslatedPhrase(sN),bn(CO,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();bn(Tr,this)&&(bn(Tr,this).open(),bn(Tr,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),bn(Tr,this).getNavigator().toFirstItem(),bn(Tr,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){bn(Tr,this)&&bn(Tr,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){bn(Tr,this)&&(bn(Tr,this).destroy(),Xg(Tr,this,null)),bn(YE,this)&&bn(YE,this).destroy(),bn(KE,this)&&bn(KE,this).destroy(),super.destroy()}}function Pxe(n){n.name!==mt&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}function xxe(){this.runLocalHooks("afterClose")}function Lxe(){this.openOptions()}function Hxe(n,e){Dxe(n,e),e.add(n)}function Dxe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ij(n,e,t){return(e=Fxe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fxe(n){var e=kxe(n,"string");return typeof e=="symbol"?e:e+""}function kxe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Oj(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var EO=new WeakSet;class s1 extends AC{constructor(e,t){super(e,{id:t.id,stateless:!1}),Hxe(this,EO),Ij(this,"name",""),Ij(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new bS(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Uh(this.hot,{placeholder:UF})),this.elements.push(new Uh(this.hot,{placeholder:BF})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>Oj(EO,this,Vxe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),k(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>Oj(EO,this,$xe).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=qa(e.command);t.name.startsWith(Vn)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),k(e.args,(r,i)=>{if(i>t.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(r),s[t.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Nf(Gr),t=[];return k(this.getInputElements(),(r,i)=>{e.inputsCount>i&&t.push(r.getValue())}),{command:e,args:t}}updateState(e,t){const r=Nf(e?e.name:Gr);this.state.setValueAtIndex(t,{command:r,args:e?e.args:[]}),e||k(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof bS)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Uh)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,s,o)=>{ee(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ee(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ee(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||k(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[Nf(Gr)];if(e!==null){const{visualIndex:r}=e;t=Txe(this.hot.getDataType(0,r,this.hot.countRows(),r))}k(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function Vxe(n){k(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}function $xe(n){cv(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),la(n))}function _j(n,e,t){Uxe(n,e),e.set(n,t)}function Uxe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uw(n,e){return n.get(KX(n,e))}function Pj(n,e,t){return n.set(KX(n,e),t),t}function KX(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var qg=new WeakMap,RO=new WeakMap;class y0 extends za{static get DEFAULTS(){return qa({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,lr(y0.DEFAULTS,t)),_j(this,qg,void 0),_j(this,RO,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),Pj(RO,this,e),Pj(qg,this,this._element.firstChild),uw(qg,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(uw(RO,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?uw(qg,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(uw(qg,this).checked=e)}focus(){this.isBuilt()&&uw(qg,this).focus()}}function Bxe(n,e){Wxe(n,e),e.add(n)}function Wxe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jxe(n,e,t){return(e=zxe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zxe(n){var e=Gxe(n,"string");return typeof e=="symbol"?e:e+""}function Gxe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Yxe(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const xj=0;var Lj=new WeakSet;class Kxe extends AC{constructor(e,t){super(e,{id:t.id,stateless:!1}),Bxe(this,Lj),jxe(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(ee(t.parentNode,"htFiltersMenuOperators"),k(this.elements,r=>t.appendChild(r.element)),t)}}buildOperatorsElement(){const e=[$h,w0];k(e,t=>{const r=new y0(this.hot,{name:"operator",label:{htmlFor:t,textContent:mxe(t)},value:t,checked:t===e[xj],id:t});r.addLocalHook("change",i=>Yxe(Lj,this,Xxe).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(Lt`Radio button with index ${e} doesn't exist.`);k(this.elements,(t,r)=>{t.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof y0&&t.isChecked());return e?e.getValue():$h}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&k(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$h,t=arguments.length>1?arguments[1]:void 0,r=e;r===sV&&(r=w0),this.state.setValueAtIndex(t,r)}reset(){this.setChecked(xj)}}function Xxe(n){this.setState(n.target.value)}const XX="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o1=XX.length;function ON(n){let e=n+1,t="",r;for(;e>0;)r=(e-1)%o1,t=String.fromCharCode(65+r)+t,e=parseInt((e-r)/o1,10);return t}function qxe(n){let e=0;if(n)for(let t=0,r=n.length-1;t<n.length;t+=1,r-=1)e+=o1**r*(XX.indexOf(n[t])+1);return e-=1,e}function Qxe(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const t=[];let r,i;for(r=0;r<n;r++){const s=[];for(i=0;i<e;i++)s.push(ON(i)+(r+1));t.push(s)}return t}function Zxe(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const t=[];let r,i;for(r=0;r<n;r++){const s={};for(i=0;i<e;i++)s[`prop${i}`]=ON(i)+(r+1);t.push(s)}return t}function Jxe(n,e){const t=[];let r;for(let i=0;i<n;i++){r=[];for(let s=0;s<e;s++)r.push("");t.push(r)}return t}function aV(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n;const r=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{r.push([s+e,a,o])}):Object.keys(i).forEach(o=>{r.push([s+e,o,i[o]])})}),r}function lV(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&je(n[0])&&(e=qA(n[0]))),e}function qX(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}function QX(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const e1e=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:lV,createEmptySpreadsheetData:Jxe,createSpreadsheetData:Qxe,createSpreadsheetObjectData:Zxe,dataRowToChangesArray:aV,isArrayOfArrays:qX,isArrayOfObjects:QX,spreadsheetColumnIndex:qxe,spreadsheetColumnLabel:ON},Symbol.toStringTag,{value:"Module"}));function t1e(n,e,t){n1e(n,e),e.set(n,t)}function n1e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TO(n,e){return n.get(ZX(n,e))}function r1e(n,e,t){return n.set(ZX(n,e),t),t}function ZX(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var cw=new WeakMap;class AS extends za{static get DEFAULTS(){return qa({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,lr(AS.DEFAULTS,t)),t1e(this,cw,void 0)}build(){super.build(),r1e(cw,this,this._element.firstChild)}update(){this.isBuilt()&&(TO(cw,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&TO(cw,this).focus()}activate(){TO(cw,this).click()}}function i1e(n,e){JX(n,e),e.add(n)}function Qg(n,e,t){JX(n,e),e.set(n,t)}function JX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nt(n,e){return n.get(Ym(n,e))}function pa(n,e,t){return n.set(Ym(n,e),t),t}function Ym(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Hj="multipleSelect.itemBox";var ba=new WeakMap,er=new WeakMap,bO=new WeakMap,Ru=new WeakMap,Fc=new WeakMap,kc=new WeakMap,hw=new WeakSet;class NS extends za{static get DEFAULTS(){return qa({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,lr(NS.DEFAULTS,t)),i1e(this,hw),Qg(this,ba,[]),Qg(this,er,void 0),Qg(this,bO,void 0),Qg(this,Ru,void 0),Qg(this,Fc,void 0),Qg(this,kc,void 0),pa(Ru,this,new Uh(this.hot,{placeholder:$F,className:"htUIMultipleSelectSearch"})),pa(Fc,this,new AS(this.hot,{textContent:DF,className:"htUISelectAll"})),pa(kc,this,new AS(this.hot,{textContent:FF,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return nt(er,this)}registerHooks(){nt(Ru,this).addLocalHook("keydown",e=>Ym(hw,this,o1e).call(this,e)),nt(Ru,this).addLocalHook("input",e=>Ym(hw,this,s1e).call(this,e)),nt(Fc,this).addLocalHook("click",e=>Ym(hw,this,a1e).call(this,e)),nt(kc,this).addLocalHook("click",e=>Ym(hw,this,l1e).call(this,e))}setItems(e){var t;pa(ba,this,e),(t=nt(er,this))===null||t===void 0||t.loadData(nt(ba,this))}setLocale(e){pa(bO,this,e)}getLocale(){return nt(bO,this)}getItems(){return[...nt(ba,this)]}getValue(){return c1e(nt(ba,this))}getSearchInputElement(){return nt(Ru,this)}getSelectAllElement(){return nt(Fc,this)}getClearAllElement(){return nt(kc,this)}isSelectedAllValues(){return nt(ba,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),r=new za(this.hot,{className:"htUISelectionControls",children:[nt(Fc,this),nt(kc,this)]});this._element.appendChild(nt(Ru,this).element),this._element.appendChild(r.element),this._element.appendChild(t);const i=s=>{var o;if(!this._element)return;(o=nt(er,this))===null||o===void 0||o.destroy(),ee(s,"htUIMultipleSelectHot"),pa(er,this,new this.hot.constructor(s,{data:nt(ba,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{nt(er,this).listen()},modifyColWidth:u=>{const c=nt(er,this).container.scrollWidth-ar(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),nt(er,this).init();const l=nt(er,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:Hj}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{nt(er,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:Hj})};i(t),this.hot._registerTimeout(()=>i(t),100)}focus(){this.isBuilt()&&nt(er,this).listen()}reset(){nt(Ru,this).reset(),nt(Fc,this).reset(),nt(kc,this).reset()}update(){this.isBuilt()&&(nt(er,this).loadData(u1e(nt(ba,this),this.options.value)),super.update())}destroy(){var e;(e=nt(er,this))===null||e===void 0||e.destroy(),nt(Ru,this).destroy(),nt(kc,this).destroy(),nt(Fc,this).destroy(),pa(Ru,this,null),pa(kc,this,null),pa(Fc,this,null),pa(er,this,null),pa(ba,this,null),super.destroy()}}function s1e(n){const e=n.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[...nt(ba,this)]:t=nt(ba,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),nt(er,this).loadData(t)}function o1e(n){this.runLocalHooks("keydown",n,this),yD(cv,n.keyCode)("ARROW_DOWN")&&(n.preventDefault(),la(n),nt(er,this).listen(),nt(er,this).selectCell(0,0))}function a1e(n){const e=[];n.preventDefault(),nt(er,this).getSourceData().forEach((t,r)=>{t.checked=!0,e.push(aV(t,r)[0])}),nt(er,this).setSourceDataAtCell(e)}function l1e(n){const e=[];n.preventDefault(),nt(er,this).getSourceData().forEach((t,r)=>{t.checked=!1,e.push(aV(t,r)[0])}),nt(er,this).setSourceDataAtCell(e)}function u1e(n,e){const t=NC(e);return n.map(r=>(r.checked=t(r.value),r))}function c1e(n){const e=[];return n.forEach(t=>{t.checked&&e.push(t.value)}),e}function h1e(n,e){d1e(n,e),e.add(n)}function d1e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f1e(n,e,t){return(e=g1e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function g1e(n){var e=m1e(n,"string");return typeof e=="symbol"?e:e+""}function m1e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function qE(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var dw=new WeakSet;class p1e extends AC{constructor(e,t){super(e,{id:t.id,stateless:!1}),h1e(this,dw),f1e(this,"name",""),this.name=t.name,this.elements.push(new NS(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>qE(dw,this,v1e).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>qE(dw,this,w1e).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Mf){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?Gr:Mf},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(r,i,s,o,a)=>{const[l]=Yh(i,h=>h.name===Mf),u={},c=this.hot.getTranslatedPhrase(e0);if(l){const h=o(r,a),d=At(h,w=>w.value),f=new Map(h.map(w=>[w.value,this.hot.getCellMeta(w.meta.visualRow,w.meta.visualCol)])),m=i1(d);s&&(l.args[0]=s);const g=[],C=bj(m,l.args[0],c,w=>{w.checked&&g.push(w.value),qE(dw,this,Dj).call(this,w,f)}),y=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,y).locale,u.args=[g],u.command=Nf(Mf),u.itemsSnapshot=C}else u.args=[],u.command=Nf(Gr);this.state.setValueAtIndex(r,u)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof NS)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,s,o)=>{ee(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ee(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||k(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(e0),t=this._getColumnVisibleValues(),r=t.map(l=>l.value),i=new Map(t.map(l=>[l.value,l.meta])),s=i1(r),o=bj(s,s,e,l=>{qE(dw,this,Dj).call(this,l,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:At(this.hot.getDataAtCol(e.visualIndex),(t,r)=>({value:rV(t),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function v1e(n){cv(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),la(n))}function Dj(n,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(n.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",n.visualValue,e.get(n.value)))}function w1e(n,e){switch(e.type){case"numeric":return s8(n,e);default:return n}}var e7;function y1e(n,e){S1e(n,e),e.add(n)}function S1e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function C1e(n,e,t){return(e=E1e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function E1e(n){var e=R1e(n,"string");return typeof e=="symbol"?e:e+""}function R1e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function T1e(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Fj=new WeakSet;class MS extends AC{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),y1e(this,Fj),C1e(this,"name",""),this.name=t.name,this.elements.push(new Uh(this.hot,{type:"button",value:kF,className:"htUIButton htUIButtonOK",identifier:MS.BUTTON_OK})),this.elements.push(new Uh(this.hot,{type:"button",value:VF,className:"htUIButton htUIButtonCancel",identifier:MS.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){k(this.elements,e=>{e.addLocalHook("click",(t,r)=>T1e(Fj,this,b1e).call(this,t,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(ee(t.parentNode,"htFiltersMenuActionBar"),k(this.elements,r=>t.appendChild(r.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}e7=MS;function b1e(n,e){e.options.identifier===e7.BUTTON_OK?this.accept():this.cancel()}function AO(n,e,t){return(e=A1e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function A1e(n){var e=N1e(n,"string");return typeof e=="symbol"?e:e+""}function N1e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const kj="ConditionCollection.filteringStates";class uV{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;AO(this,"hot",void 0),AO(this,"isMapRegistrable",void 0),AO(this,"filteringStates",new mN),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(kj,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var r;const i=this.filteringStates.getValueAtIndex(t),s=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],o=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$h;return e.length?gxe(r)(e,t):!0}addCondition(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$h,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=t.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(s):c),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(Lt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(fn(TS[r]))throw new Error(Lt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:o,func:Qh(a,o)}]},i):u.push({name:a,args:o,func:Qh(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,r;return(t=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,t)=>{let[r,{operation:i,conditions:s}]=t;return e.push({column:r,operation:i,conditions:s.map(o=>{let{name:a,args:l}=o;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(t=>{t.conditions.forEach(r=>this.addCondition(t.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const r=this.getConditions(e);return t?r.some(i=>i.name===t):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(kj),this.filteringStates=null,this.clearLocalHooks()}}Vt(uV,Hr);function Vj(n,e,t){return(e=M1e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function M1e(n){var e=I1e(n,"string");return typeof e=="symbol"?e:e+""}function I1e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class t7{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];Vj(this,"conditionCollection",void 0),Vj(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return k(this.conditionCollection.getFilteredColumns(),(t,r)=>{let i=this.columnDataFactory(t);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(t,i)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return k(t,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,t){const r=[];return k(t,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(r[s]=e[s])}),r}}function O1e(n,e){_1e(n,e),e.add(n)}function _1e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pd(n,e,t){return(e=P1e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function P1e(n){var e=x1e(n,"string");return typeof e=="symbol"?e:e+""}function x1e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function NO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var QE=new WeakSet;class n7{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];O1e(this,QE),Pd(this,"hot",void 0),Pd(this,"conditionCollection",void 0),Pd(this,"columnDataFactory",void 0),Pd(this,"changes",[]),Pd(this,"grouping",!1),Pd(this,"latestEditedColumnPosition",-1),Pd(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>NO(QE,this,L1e).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>NO(QE,this,H1e).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>NO(QE,this,D1e).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,k(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=L9(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new uV(r.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const g=r.columnDataFactory(h);let C;f.isEmpty()?C=g:C=new t7(f,w=>r.columnDataFactory(w)).filter(),C=At(C,w=>w.meta.visualRow);const y=NC(C);return f.destroy(),Yh(g,w=>y(w.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),ct(this,(e,t)=>{this[t]=null})}}function L1e(n){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(n)}function H1e(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function D1e(){k(this.latestOrderStack,n=>{this.updateStatesAtColumn(n)})}Vt(n7,Hr);function F1e(n){return Kk({initialPage:0,size:()=>n.length,onItemSelect:(t,r)=>{const i=n[t];if(i instanceof NS)return r;if(i.element&&!Yf(i.element))return!1;i.focus()}})}const fw="filters";function k1e(n,e){let t=-1,r;const i=F1e(e),s=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(fw),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof za&&(h.addLocalHook("click",s(h)),h.addLocalHook("focus",s(h)),h.addLocalHook("afterClose",s(h)))}),l(n);function o(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(fw),callback:()=>{h.isSubMenu()&&h.close(),d.listen(fw)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const g=r.getNavigator();g.getCurrentPage()>-1&&(t=g.getCurrentPage()),g.clear(),m.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const g=e[i.getCurrentPage()];g instanceof bS&&(g.openOptions(),m.preventDefault()),g instanceof AS&&(g.activate(),m.preventDefault()),g instanceof za||m.preventDefault()}}],fw)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(fw)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",o),h.addLocalHook("afterOpen",o),r=h}function u(){return r}function c(){return t}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function V1e(n,e){r7(n,e),e.add(n)}function MO(n,e,t){r7(n,e),e.set(n,t)}function r7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gw(n,e,t){return(e=$1e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $1e(n){var e=U1e(n,"string");return typeof e=="symbol"?e:e+""}function U1e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function BT(n,e,t){return n.set(ls(n,e),t),t}function Ho(n,e){return n.get(ls(n,e))}function ls(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const a1="filters",B1e=250,$j=a1;var _u=new WeakMap,l1=new WeakMap,pf=new WeakMap,$s=new WeakSet;class W1e extends yt{static get PLUGIN_KEY(){return a1}static get PLUGIN_PRIORITY(){return B1e}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var t;super(e),t=this,V1e(this,$s),gw(this,"dropdownMenuPlugin",null),gw(this,"conditionCollection",null),gw(this,"conditionUpdateObserver",null),gw(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),gw(this,"filtersRowsMap",null),MO(this,_u,void 0),MO(this,l1,new WeakSet),MO(this,pf,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ls($s,t,q1e).call(t,...i)})}isEnabled(){return!!this.hot.getSettings()[a1]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new SC),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,r=t&&t.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>ls($s,this,Uj).call(this,"accept")),a.addLocalHook("cancel",()=>ls($s,this,Uj).call(this,"cancel")),a.addLocalHook("change",l=>ls($s,this,X1e).call(this,a,l)),a),s=()=>`${this.hot.getTranslatedPhrase(xF)}:`,o=()=>`${this.hot.getTranslatedPhrase(LF)}:`;if(!this.components.get("filter_by_condition")){const a=new s1(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>ls($s,this,Bj).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Kxe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new s1(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>ls($s,this,Bj).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new p1e(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new MS(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new uV(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new n7(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>ls($s,this,Q1e).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return ls($s,e,K1e).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>ls($s,this,Y1e).call(this)),this.addHook("afterDropdownMenuShow",()=>ls($s,this,z1e).call(this)),this.addHook("afterDropdownMenuHide",()=>ls($s,this,G1e).call(this)),this.addHook("afterChange",a=>ls($s,this,j1e).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Ho(_u,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=Ho(_u,this).getMenu(),c=u.getNavigator(),h=Ho(_u,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];BT(_u,this,k1e(this.dropdownMenuPlugin.menu,a));const l=u=>{Ho(_u,this).listen(),u.preventDefault(),cv(u.keyCode,"TAB")&&(u.shiftKey?Ho(_u,this).toPreviousItem():Ho(_u,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,r)=>{t.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:$j})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($j)}addCondition(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:$h;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:t},args:r},i)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const s=this.exportConditions(),o=this.hot.runHooks("beforeFilter",s,Ho(pf,this));if(o!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=At(t.filter(),u=>u.meta.visualRow);const l=NC(i);Le(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),k(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),BT(pf,this,this.exportConditions())}else o!==!1&&!r?(BT(pf,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Ho(pf,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeActive().highlight.col),o!==!1&&(this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),r=[];return k(this.hot.getSourceDataAtCol(t),(i,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(s,t),g=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),t))!==null&&o!==void 0?o:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:rV(g)})}),r}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),r=i1(t);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var t;const r=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,r,i){let s=e;return s===w0&&t.command.key!==Gr&&r.command.key!==Gr&&i.command.key!==Gr?s=sV:i.command.key!==Gr&&(t.command.key===Gr||r.command.key===Gr)&&(s=$h),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new t7(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return k(i,o=>{k(t.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function j1e(n){n&&k(n,e=>{const[,t]=e,r=this.hot.propToCol(t);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function z1e(){const n=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),n.updateMenuDimensions()}function G1e(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Y1e(){const n=this.dropdownMenuPlugin.menu;Ho(l1,this).has(n)||Ho(_u,this).setMenu(n),Ho(l1,this).add(n)}function K1e(n){n.items.push({name:mt}),this.components.forEach(e=>{n.items.push(e.getMenuItemDescriptor())})}function Uj(n){var e;if(n==="accept"){const r=this.getSelectedColumn();if(r===null){var t;(t=this.dropdownMenuPlugin)===null||t===void 0||t.close();return}const{physicalIndex:i}=r,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),s.command.key!==Gr&&(this.conditionCollection.addCondition(i,s,l,u),o.command.key!==Gr&&this.conditionCollection.addCondition(i,o,l,u)),a.command.key!==Gr&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function X1e(n,e){const t=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),n.constructor===s1&&!e.inputsCount&&this.setListeningDropdownMenu(),t.updateMenuDimensions()}function Bj(){this.setListeningDropdownMenu()}function q1e(n,e,t){const r=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(r)&&t===this.hot.view.getColumnHeadersCount()-1?ee(e,"htFiltersActive"):Me(e,"htFiltersActive")}function Q1e(n){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:t,column:r},conditionArgsChange:i}=n;Array.isArray(i)&&BT(pf,this,Ho(pf,this).map(a=>(a.column===r&&t.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const s=t.filter(a=>a.name===Mf),o=t.filter(a=>a.name!==Mf);if(s.length>=2||o.length>=3)wt(Lt`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(n)}}const i7="internal-use-in-handsontable",u1={licenseKey:i7,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function s7(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[Ai])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function o7(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function Z1e(n){var e;const t=n[Ai],r=o7(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),i=s7(n);return{...u1,...r,...i}}function J1e(n){var e;const t=n[Ai],r=o7(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),i=s7(n);return{...r,...i}}function eLe(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function _N(){const n="engine_relationship",e=ua(Ai);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function cV(){const n="shared_engine_usage",e=ua(Ai);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function tLe(n){const e=n.getSettings(),t=e[Ai],r=t==null?void 0:t.engine;if(t===!0||fn(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return nLe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,n)}else if(typeof r=="object"&&fn(r.hyperformula)){const s=_N(),o=cV().get(r);return s.has(r)||s.set(r,[]),s.get(r).push(n),o&&o.push(n.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:i7}),(r.getConfig().leapYear1900!==u1.leapYear1900||uC(r.getConfig().nullDate,u1.nullDate)===!1)&&wt(Lt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function nLe(n,e,t){const r=e[Ai],i=Z1e(e),s=_N(),o=cV();rLe(n,r.functions),iLe(n,r.language);const a=n.buildEmpty(i);return s.set(a,[t]),o.set(a,[t.guid]),sLe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function Wj(n){var e;const t=_N(),r=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function jj(n,e){if(n){const t=_N(),r=t.get(n),i=cV(),s=i.get(n);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&t.delete(n)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(n),n.destroy()))}}function rLe(n,e){e&&e.forEach(t=>{const{name:r,plugin:i,translations:s}=t;try{n.registerFunction(r,i,s)}catch(o){wt(o.message)}})}function iLe(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(r){wt(r.message)}}}function sLe(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:r,expression:i,scope:s,options:o}=t;try{n.addNamedExpression(r,i,s,o)}catch(a){wt(a.message)}}),n.resumeEvaluation())}function oLe(n,e){return(fn(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const a7="DD/MM/YYYY";function aLe(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function lLe(n){return aLe(n)?n.substr(1):n}function uLe(n){return typeof n=="string"&&n.startsWith("=")}function hV(n,e){return typeof n=="string"&&e==="date"}function l7(n,e){return se(n,e,!0).isValid()}function u7(n,e){return se(n,e,!0).format(a7)}function cLe(n,e){return se(n,a7,!0).format(e)}function c7(n,e){const r=new Date(Date.UTC(0,0,n+-1));return se(r).format(e)}function hLe(n,e,t){const r=Array.from(Array(t).keys()).filter(s=>n.includes(s)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function dLe(n,e){const t=[];return n.forEach(r=>{const i={from:r,to:e};t.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),t.push(i)}),t}function fLe(n){return n.forEach((e,t)=>{n.slice(t+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),n}function dV(n,e,t){const r=dLe(n,hLe(n,e,t));return fLe(r)}function xd(n,e,t){gLe(n,e),e.set(n,t)}function gLe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hn(n,e){return n.get(h7(n,e))}function Vc(n,e,t){return n.set(h7(n,e),t),t}function h7(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var mw=new WeakMap,$c=new WeakMap,Us=new WeakMap,ZE=new WeakMap,IO=new WeakMap,OO=new WeakMap,JE=new WeakMap;class zj{constructor(e,t,r){xd(this,mw,void 0),xd(this,$c,void 0),xd(this,Us,void 0),xd(this,ZE,[]),xd(this,IO,[]),xd(this,OO,void 0),xd(this,JE,[]),Vc(mw,this,e),Vc($c,this,t),Vc(Us,this,r)}setRemovedHfIndexes(e){return Vc(JE,this,e.map(t=>{const r=hn($c,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(r)})),hn(JE,this)}getRemovedHfIndexes(){return hn(JE,this)}getHfIndexFromVisualIndex(e){const t=hn($c,this).getIndexesSequence(),r=hn($c,this).getNotTrimmedIndexes();return t.indexOf(r[e],e)}syncMoves(e){const r=`move${_i(hn(mw,this))}s`;hn(Us,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&hn(Us,this).getEngine()[r](hn(Us,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,t,r){r!==!1&&(Vc(IO,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Vc(OO,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(hn(Us,this).isPerformingUndoRedo()||e===!1||t===!1)return;const r=dV(hn(IO,this),hn(OO,this),hn($c,this).getNumberOfIndexes());hn(Us,this).getSheetId()===null?hn(Us,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${_i(hn(mw,this))}Order`;return t=>{if(hn(Us,this).isPerformingUndoRedo())return;const r=hn($c,this).getIndexesSequence();if(t==="update"&&r.length>0){const i=hn(ZE,this).map(l=>r.indexOf(l)),s=hn(Us,this).getEngine().getSheetDimensions(hn(Us,this).getSheetId());let o;hn(mw,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);hn(Us,this).getEngine()[e](hn(Us,this).getSheetId(),i)}Vc(ZE,this,r)}}init(){Vc(ZE,this,hn($c,this).getIndexesSequence())}}function Ld(n,e,t){mLe(n,e),e.set(n,t)}function mLe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tu(n,e){return n.get(d7(n,e))}function Hd(n,e,t){return n.set(d7(n,e),t),t}function d7(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var eR=new WeakMap,tR=new WeakMap,_O=new WeakMap,PO=new WeakMap,xO=new WeakMap,LO=new WeakMap,HO=new WeakMap;class pLe{constructor(e,t,r){Ld(this,eR,void 0),Ld(this,tR,void 0),Ld(this,_O,void 0),Ld(this,PO,!1),Ld(this,xO,!1),Ld(this,LO,null),Ld(this,HO,null),Hd(eR,this,new zj("row",e,this)),Hd(tR,this,new zj("column",t,this)),Hd(_O,this,r)}getForAxis(e){return e==="row"?Tu(eR,this):Tu(tR,this)}setPerformUndo(e){Hd(PO,this,e)}setPerformRedo(e){Hd(xO,this,e)}isPerformingUndoRedo(){return Tu(PO,this)||Tu(xO,this)}getSheetId(){return Tu(HO,this)}getEngine(){return Tu(LO,this)}getPostponeAction(){return Tu(_O,this)}setupSyncEndpoint(e,t){Hd(LO,this,e),Hd(HO,this,t),Tu(eR,this).init(),Tu(tR,this).init()}}function vLe(n,e){f7(n,e),e.add(n)}function Dd(n,e,t){return(e=wLe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wLe(n){var e=yLe(n,"string");return typeof e=="symbol"?e:e+""}function yLe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function DO(n,e,t){f7(n,e),e.set(n,t)}function f7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zh(n,e,t){return n.set(ot(n,e),t),t}function Ff(n,e){return n.get(ot(n,e))}function ot(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ai="formulas",SLe=["maxRows","maxColumns","language"],CLe=260;we.getSingleton().register("afterNamedExpressionAdded");we.getSingleton().register("afterNamedExpressionRemoved");we.getSingleton().register("afterSheetAdded");we.getSingleton().register("afterSheetRemoved");we.getSingleton().register("afterSheetRenamed");we.getSingleton().register("afterFormulasValuesUpdate");const mv=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var fc=new WeakMap,PN=new WeakMap,pw=new WeakMap,ht=new WeakSet;class ELe extends yt{constructor(){var e;super(...arguments),e=this,vLe(this,ht),DO(this,fc,!1),DO(this,PN,!1),DO(this,pw,[["valuesUpdated",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ot(ht,e,kLe).call(e,...r)}],["namedExpressionAdded",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ot(ht,e,VLe).call(e,...r)}],["namedExpressionRemoved",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ot(ht,e,$Le).call(e,...r)}],["sheetAdded",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ot(ht,e,ULe).call(e,...r)}],["sheetRenamed",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ot(ht,e,BLe).call(e,...r)}],["sheetRemoved",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ot(ht,e,WLe).call(e,...r)}]]),Dd(this,"staticRegister",ua("formulas")),Dd(this,"engine",null),Dd(this,"sheetId",null),Dd(this,"sheetName",null),Dd(this,"indexSyncer",null),Dd(this,"rowAxisSyncer",null),Dd(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Ai}static get PLUGIN_PRIORITY(){return CLe}static get SETTING_KEYS(){return[Ai,...SLe]}isEnabled(){return!!this.hot.getSettings()[Ai]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=tLe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){wt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,ot(ht,this,IS).call(this));r!==!1&&ot(ht,this,Cy).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,Gj).call(t,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,Yj).call(t,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,Gj).call(t,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,Yj).call(t,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,ALe).call(t,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,NLe).call(t,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,RLe).call(t,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,MLe).call(t,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,Kj).call(t,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,Kj).call(t,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,ILe).call(t,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,OLe).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,xLe).call(t,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,LLe).call(t,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,_Le).call(t,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,PLe).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,HLe).call(t,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,DLe).call(t,...i)}),this.indexSyncer=new pLe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("beforeColumnMove",(r,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("afterRowMove",(r,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(r,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,bLe).call(t,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,FLe).call(t,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return ot(ht,t,TLe).call(t,...i)}),Ff(pw,this).forEach(r=>{let[i,s]=r;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){Ff(pw,this).forEach(e=>{let[t,r]=e;return this.engine.off(t,r)}),jj(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=J1e(this.hot.getSettings());eLe(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const r=this.hot.getSettings()[Ai];if(Re(r)&&Re(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Ai].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const s=this.addSheet(i??void 0,ot(ht,this,IS).call(this));ot(ht,this,Cy).call(this,s)}}super.updatePlugin(e)}destroy(){Ff(pw,this).forEach(e=>{var t;let[r,i]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(r,i)}),Zh(pw,this,null),jj(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(Re(t)&&!qX(t))return wt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return wt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(r),t),r}catch(r){return wt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){ED(`The sheet named \`${e}\` does not exist, switch aborted.`);return}ot(ht,this,Cy).call(this,e);const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${_i(Ai)}.switchSheet`)}getCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(t);return i!==null&&s!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(r.has(o)||r.add(o))}),Wj(this.engine).forEach((i,s)=>{if((t||s!==this.sheetId)&&r.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=s=>{var o;const{row:a,col:l,sheet:u}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return Re(u)?`${u}:${a}x${l}`:""},i=new Set(t.map(s=>r(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(Re(l)===!1||Re(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=r(s);if(c!==void 0&&!i.has(h)){const d=Wj(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,t,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){wt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,t);return hV(r,s.type)&&(l7(r,s.dateFormat)?r=u7(r,s.dateFormat):uLe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Cy(n){this.sheetName=n,this.sheetId=this.engine.getSheetId(this.sheetName)}function g7(n,e,t){if(je(t)&&t!==null){const r=this.hot.toVisualRow(n),i=this.hot.toVisualColumn(e),s=this.hot.getCellMeta(r,i).valueGetter;return s?s.call(this.hot,t):t.toString()}return t}function IS(n,e,t,r){return this.hot.getSourceDataArray(n,e,t,r).map((i,s)=>i.map((o,a)=>ot(ht,this,g7).call(this,s,a,o)))}function RLe(n,e,t){const r=this.hot.propToCol(t);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},s=this.hot.getCellMeta(e,r);let o=this.engine.getCellValue(i);return s.type==="date"&&bi(o)&&(o=c7(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return n}function TLe(n,e,t){const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=t.getTopStartCorner(),{row:u,col:c}=t.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:g}=h.start,{row:C,col:y}=h.end,w=C-m+1,S=y-g+1;for(let E=0;E<f.length;E+=1)for(let P=0;P<f[E].length;P+=1){const _=f[E][P],I=m+E%w,D=g+P%S,Q=this.hot.getCellMeta(I,D);hV(_,Q.type)&&(_.startsWith("'")?f[E][P]=_.slice(1):this.isFormulaCellType(I,D,this.sheetId)===!1&&(f[E][P]=cLe(_,Q.dateFormat)))}return f}function Gj(n,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(_i(Ai))||Zh(PN,this,fn(this.hot.getSettings().data))}function bLe(){if(Ff(PN,this)){this.switchSheet(this.sheetName);return}const n=ot(ht,this,IS).call(this);n.forEach((t,r)=>{t.forEach((i,s)=>{const o=this.hot.getCellMeta(r,s,{skipMetaExtension:!0}),a=o.dateFormat;hV(i,o.type)&&(l7(i,a)?n[r][s]=u7(i,a):i.startsWith("=")||(n[r][s]=`'${i}`))})}),Zh(fc,this,!0);const e=this.engine.setSheetContent(this.sheetId,n);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Zh(fc,this,!1)}function Yj(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(t.includes(_i(Ai)))return;const r=oLe(this.engine,this.hot.getSettings()[Ai].sheetName);if(ot(ht,this,Cy).call(this,r),t!=="updateSettings")if(Ff(PN,this))this.switchSheet(this.sheetName);else{const i=ot(ht,this,IS).call(this);if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Zh(fc,this,!0);const s=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Zh(fc,this,!1)}}}function ALe(n,e,t,r){if(r!=="get"||Ff(fc,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||n===null||e===null)return;const i=this.getCellType(n,e);if(i==="VALUE"||i==="EMPTY"){t.value=lLe(t.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let o=this.engine.getCellValue(s);const a=this.hot.getCellMeta(n,e,{skipMetaExtension:!0});a.type==="date"&&bi(o)&&(o=c7(o,a.dateFormat)),t.value=typeof o=="object"&&o!==null?o.value:o}function NLe(n,e,t,r){if(r!=="get"||Ff(fc,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(n),s=this.hot.propToCol(e);if(i===null||s===null)return;const o=this.getCellType(i,s);if(o==="VALUE"||o==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};t.value=this.engine.getCellSerialized(l)}function Kj(n,e){if(mv(e))return;const t=[],r=[],i=this.engine.batch(()=>{n.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(o),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};l=ot(ht,this,g7).call(this,c,h,l),c!==null&&h!==null?this.syncChangeWithEngine(o,u,l):t.push([o,u,l]),r.push({address:d})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{t.forEach(o=>{let[a,l,u]=o;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function MLe(n,e){if(mv(e))return;const t=[],r=[];n.forEach(i=>{let[s,o,,a]=i;const l=this.hot.propToCol(o);if(!bi(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){wt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),t.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(t),this.validateDependentCells(t,r)}function ILe(n,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countRows()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function OLe(n,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countCols()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function _Le(n,e,t){return this.rowAxisSyncer.setRemovedHfIndexes(t).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function PLe(n,e,t){return this.columnAxisSyncer.setRemovedHfIndexes(t).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function xLe(n,e,t){if(mv(t))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(r)}function LLe(n,e,t){if(mv(t))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(r)}function HLe(n,e,t,r){if(mv(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function DLe(n,e,t,r){if(mv(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function FLe(n,e,t){var r;Zh(fc,this,!0);const i=ot(ht,this,IS).call(this,t,0,t+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Zh(fc,this,!1),i.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:t+o,sheet:this.sheetId},[[a]])})})}function kLe(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}function VLe(n,e){this.hot.runHooks("afterNamedExpressionAdded",n,e)}function $Le(n,e){this.hot.runHooks("afterNamedExpressionRemoved",n,e)}function ULe(n){this.hot.runHooks("afterSheetAdded",n)}function BLe(n,e){ot(ht,this,Cy).call(this,e),this.hot.runHooks("afterSheetRenamed",n,e)}function WLe(n,e){this.hot.runHooks("afterSheetRemoved",n,e)}function jLe(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedActive();let t=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(t=1)}return this.getTranslatedPhrase(cF,t)},callback(){const{from:e,to:t}=this.getSelectedRangeActive(),r=Math.max(Math.min(e.col,t.col),0),i=Math.max(e.col,t.col),s=[];for(let l=r;l<=i;l+=1)s.push(l);n.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function zLe(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(hF,t)},callback(){var t,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(t=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&t!==void 0?t:0,s=(r=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countCols()-1,n.showColumns(e),this.view.adjustElementsSize(),this.render(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const t=At(n.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeActive(),i=r.getTopStartCorner().col,s=r.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=u.slice(i,s+1);c.push(...f.filter(m=>t.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return k(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function GLe(n,e){m7(n,e),e.add(n)}function YLe(n,e,t){m7(n,e),e.set(n,t)}function m7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fd(n,e){return n.get(th(n,e))}function Xj(n,e,t){return n.set(th(n,e),t),t}function th(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("beforeHideColumns");we.getSingleton().register("afterHideColumns");we.getSingleton().register("beforeUnhideColumns");we.getSingleton().register("afterUnhideColumns");const qj="hiddenColumns",KLe=310;var dl=new WeakMap,kd=new WeakSet;class XLe extends yt{constructor(){super(...arguments),GLe(this,kd),YLe(this,dl,null)}static get PLUGIN_KEY(){return qj}static get PLUGIN_PRIORITY(){return KLe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[qj]}enablePlugin(){var e=this;this.enabled||(Xj(dl,this,new gN),Fd(dl,this).addLocalHook("init",()=>th(kd,this,tHe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Fd(dl,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return th(kd,e,eHe).call(e,...r)}),this.addHook("afterGetCellMeta",(t,r,i)=>th(kd,this,QLe).call(this,t,r,i)),this.addHook("modifyColWidth",(t,r)=>th(kd,this,qLe).call(this,t,r),2),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return th(kd,e,JLe).call(e,...r)}),this.addHook("modifyCopyableRange",t=>th(kd,this,ZLe).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;const s=Fd(dl,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));k(l,u=>{s[u]=!1}),i=Er(s,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",t,i,r&&o)!==!1&&(r&&o&&Fd(dl,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,i,r&&o,r&&i.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{k(e,o=>{Fd(dl,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",t,i,r,r&&i.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}getHiddenColumns(){return At(Fd(dl,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Fd(dl,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){k(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){Xj(dl,this,null),super.destroy()}}function qLe(n,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof n=="number"&&this.hot.hasColHeaders())return n+15}function QLe(n,e,t){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",t.className.indexOf("afterHiddenColumn")===-1&&(t.className+=" afterHiddenColumn");else if(t.className){const r=t.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),t.className=r.join(" ")}}}function ZLe(n){if(this.getSetting("copyPasteEnabled"))return n;const e=[],t=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return k(n,r=>{let i=!0,s=0;Le(r.startCol,r.endCol,o=>{this.isHidden(o)?(i||t(r.startRow,r.endRow,s,o-1),i=!0):(i&&(s=o),o===r.endCol&&t(r.startRow,r.endRow,s,o),i=!1)})}),e}function JLe(n,e){if(!this.getSetting("indicators")||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&t.push("beforeHiddenColumn"),ee(e,t)}function eHe(n){n.items.push({name:mt},jLe(this),zLe(this))}function tHe(){const n=this.getSetting("columns");Array.isArray(n)&&this.hideColumns(n)}function nHe(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedActive();let t=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(t=1)}return this.getTranslatedPhrase(dF,t)},callback(){const{from:e,to:t}=this.getSelectedRangeActive(),r=Math.max(Math.min(e.row,t.row),0),i=Math.max(e.row,t.row),s=[];for(let l=r;l<=i;l+=1)s.push(l);n.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function rHe(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(fF,t)},callback(){var t,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(t=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&t!==void 0?t:0,s=(r=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countRows()-1,n.showRows(e),this.view.adjustElementsSize(),this.render(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const t=At(n.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeActive(),i=r.getTopStartCorner().row,s=r.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=u.slice(i,s+1);c.push(...f.filter(m=>t.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return k(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function iHe(n,e){p7(n,e),e.add(n)}function sHe(n,e,t){p7(n,e),e.set(n,t)}function p7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vd(n,e){return n.get(nh(n,e))}function Qj(n,e,t){return n.set(nh(n,e),t),t}function nh(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("beforeHideRows");we.getSingleton().register("afterHideRows");we.getSingleton().register("beforeUnhideRows");we.getSingleton().register("afterUnhideRows");const Zj="hiddenRows",oHe=320;var fl=new WeakMap,$d=new WeakSet;class aHe extends yt{constructor(){super(...arguments),iHe(this,$d),sHe(this,fl,null)}static get PLUGIN_KEY(){return Zj}static get PLUGIN_PRIORITY(){return oHe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[Zj]}enablePlugin(){var e=this;this.enabled||(Qj(fl,this,new gN),Vd(fl,this).addLocalHook("init",()=>nh($d,this,fHe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Vd(fl,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nh($d,e,dHe).call(e,...r)}),this.addHook("afterGetCellMeta",(t,r,i)=>nh($d,this,uHe).call(this,t,r,i)),this.addHook("modifyRowHeight",(t,r)=>nh($d,this,lHe).call(this,t,r)),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nh($d,e,hHe).call(e,...r)}),this.addHook("modifyCopyableRange",t=>nh($d,this,cHe).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;const s=Vd(fl,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));k(l,u=>{s[u]=!1}),i=Er(s,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",t,i,r&&o)!==!1&&(r&&o&&Vd(fl,this).setValues(s),this.hot.runHooks("afterUnhideRows",t,i,r&&o,r&&i.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{k(e,o=>{Vd(fl,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",t,i,r,r&&i.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}getHiddenRows(){return At(Vd(fl,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Vd(fl,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){k(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){Qj(fl,this,null),super.destroy()}}function lHe(n,e){return this.isHidden(e)?0:n}function uHe(n,e,t){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(n)&&(t.skipRowOnPaste=!0),this.isHidden(n-1))t.className=t.className||"",t.className.indexOf("afterHiddenRow")===-1&&(t.className+=" afterHiddenRow");else if(t.className){const r=t.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),t.className=r.join(" ")}}}function cHe(n){if(this.getSetting("copyPasteEnabled"))return n;const e=[],t=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return k(n,r=>{let i=!0,s=0;Le(r.startRow,r.endRow,o=>{this.isHidden(o)?(i||t(s,o-1,r.startCol,r.endCol),i=!0):(i&&(s=o),o===r.endRow&&t(s,o,r.startCol,r.endCol),i=!1)})}),e}function hHe(n,e){if(!this.getSetting("indicators")||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&t.push("beforeHiddenRow"),ee(e,t)}function dHe(n){n.items.push({name:mt},nHe(this),rHe(this))}function fHe(){const n=this.getSetting("rows");Array.isArray(n)&&this.hideRows(n)}function gHe(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase($D)},callback(e,t){const[{start:{col:r}}]=t;n.freezeColumn(r),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function mHe(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(UD)},callback(e,t){const[{start:{col:r}}]=t;n.unfreezeColumn(r),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function pHe(n,e){v7(n,e),e.add(n)}function vHe(n,e,t){v7(n,e),e.set(n,t)}function v7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c1(n,e){return n.get(S0(n,e))}function FO(n,e,t){return n.set(S0(n,e),t),t}function S0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("beforeColumnFreeze");we.getSingleton().register("afterColumnFreeze");we.getSingleton().register("beforeColumnUnfreeze");we.getSingleton().register("afterColumnUnfreeze");const Jj="manualColumnFreeze",wHe=110;var uf=new WeakMap,kO=new WeakSet;class yHe extends yt{constructor(){super(...arguments),pHe(this,kO),vHe(this,uf,!1)}static get PLUGIN_KEY(){return Jj}static get PLUGIN_PRIORITY(){return wHe}isEnabled(){return!!this.hot.getSettings()[Jj]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>S0(kO,this,SHe).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>S0(kO,this,CHe).call(this,e,t)),super.enablePlugin())}disablePlugin(){FO(uf,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;c1(uf,this)||FO(uf,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;c1(uf,this)||FO(uf,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function SHe(n){n.items.push({name:"---------"},gHe(this),mHe(this))}function CHe(n,e){if(c1(uf,this)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||n.some(r=>r<t))return!1}}function nR(n,e,t){return(e=EHe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function EHe(n){var e=RHe(n,"string");return typeof e=="symbol"?e:e+""}function RHe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const VO=0,ez=1,tz=2,Zg="px";let w7=class{constructor(e){nR(this,"hot",void 0),nR(this,"_element",null),nR(this,"state",VO),nR(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=tz}build(){this.state===VO&&(this._element=this.hot.rootDocument.createElement("div"),this.state=ez)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=VO}isAppended(){return this.state===tz}isBuilt(){return this.state>=ez}setPosition(e,t){bi(e)&&(this._element.style.top=e+Zg),bi(t)&&(this._element.style[this.inlineProperty]=t+Zg)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){bi(e)&&(this._element.style.width=e+Zg),bi(t)&&(this._element.style.height=t+Zg)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){bi(e)&&(this._element.style.marginTop=e+Zg),bi(t)&&(this._element.style[`margin${_i(this.inlineProperty)}`]=t+Zg)}getOffset(){const e=this._element.style,t=`margin${_i(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const THe="ht__manualColumnMove--backlight";let bHe=class extends w7{build(){super.build(),ee(this._element,THe)}};const AHe="ht__manualColumnMove--guideline";let NHe=class extends w7{build(){super.build(),ee(this._element,AHe)}};function MHe(n,e){y7(n,e),e.add(n)}function va(n,e,t){y7(n,e),e.set(n,t)}function y7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gs(n,e,t){return n.set(rh(n,e),t),t}function _e(n,e){return n.get(rh(n,e))}function rh(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("beforeColumnMove");we.getSingleton().register("afterColumnMove");const $O="manualColumnMove",IHe=120,nz="ht__manualColumnMove",C0="show-ui",h1="on-moving--columns",d1="after-selection--columns";var Wi=new WeakMap,dh=new WeakMap,Qu=new WeakMap,WT=new WeakMap,Rh=new WeakMap,Bi=new WeakMap,rR=new WeakMap,Io=new WeakMap,Cm=new WeakMap,E0=new WeakMap,Ey=new WeakMap,Ud=new WeakSet;class OHe extends yt{constructor(){super(...arguments),MHe(this,Ud),va(this,Wi,new bHe(this.hot)),va(this,dh,new NHe(this.hot)),va(this,Qu,[]),va(this,WT,0),va(this,Rh,!1),va(this,Bi,{}),va(this,rR,void 0),va(this,Io,void 0),va(this,Cm,void 0),va(this,E0,void 0),va(this,Ey,void 0)}static get PLUGIN_KEY(){return $O}static get PLUGIN_PRIORITY(){return IHe}isEnabled(){return!!this.hot.getSettings()[$O]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return rh(Ud,e,_He).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return rh(Ud,e,xHe).call(e,...r)}),this.addHook("afterScrollVertically",()=>rh(Ud,this,HHe).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return rh(Ud,e,DHe).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,nz),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Me(this.hot.rootElement,nz),this.unregisterEvents(),_e(Wi,this).destroy(),_e(dh,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const r=_e(rR,this),i=this.isMovePossible(e,t),s=this.hot.runHooks("beforeColumnMove",e,t,r,i);if(gs(rR,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,t);const o=i&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,i,o),o}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const r=this.countFinalIndex(e,t);return gs(rR,this,t),this.moveColumns(e,r)}isMovePossible(e,t){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,s=t<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isColumnOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=Er(e,(i,s)=>(s<t&&(i+=1),i),0);return t-r}getColumnsWidth(e,t){const r=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=t;s+=1){const o=r.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[$O];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const r=[];return Le(e,t,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(_e(Io,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,_e(Io,this)-1);const o=t.hider.offsetWidth,a=t.TBODY.offsetLeft,l=_e(Wi,this).getOffset().start,u=_e(Wi,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,g=Xn(this.hot.rootElement),C=m.innerWidth-_e(Cm,this)-g;h=m.innerWidth-_e(Bi,this).eventPageX-C-(r.scrollX===void 0?i:0)}else h=_e(Bi,this).eventPageX-(_e(Cm,this)-(r.scrollX===void 0?i:0));if(_e(E0,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(_e(Io,this))&&(s+=i),s+=c,_e(Io,this)<0)_e(Ey,this)>0?_e(Bi,this).col=0:_e(Bi,this).col=e>0?e-1:e;else if(_e(Bi,this).TD.offsetWidth/2+s<=h){const m=_e(Io,this)>=_e(WT,this)?_e(WT,this)-1:_e(Io,this);_e(Bi,this).col=m+1,s+=_e(Bi,this).TD.offsetWidth}else _e(Bi,this).col=_e(Io,this);let d=h,f=s;h+u+l>=o?d=o-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:r.scrollX!==void 0&&_e(Io,this)<_e(Ey,this)&&(f-=_e(Cm,this)<=r.scrollX?_e(Cm,this):0),_e(Wi,this).setPosition(null,d),_e(dh,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>rh(Ud,this,PHe).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>rh(Ud,this,LHe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_e(Wi,this).build(),_e(dh,this).build()}destroy(){_e(Wi,this).destroy(),_e(dh,this).destroy(),super.destroy()}}function _He(n,e,t,r){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeActive(),a=Be(n.target,"sortAction");if(!o||!s||_e(Rh,this)||n.button!==0||a){gs(Rh,this,!1),_e(Qu,this).length=0,Me(this.hot.rootElement,[h1,C0]);return}const l=_e(dh,this).isBuilt()&&!_e(dh,this).isAppended(),u=_e(Wi,this).isBuilt()&&!_e(Wi,this).isAppended();l&&u&&(_e(dh,this).appendTo(i.hider),_e(Wi,this).appendTo(i.hider));const{from:c,to:h}=o,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,gs(Rh,this,!0);const m=t.firstChild?b9(n,t.firstChild).x:n.offsetX;_e(Bi,this).eventPageX=n.pageX,gs(Io,this,e.col),_e(Bi,this).TD=t,_e(Bi,this).col=e.col,gs(Qu,this,this.prepareColumnsToMoving(d,f)),gs(E0,this,!!this.hot.getSettings().rowHeaders),gs(WT,this,this.hot.countCols()),gs(Ey,this,this.hot.getSettings().fixedColumnsStart),gs(Cm,this,si(this.hot.rootElement).left);const g=_e(E0,this)?-1:0,C=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,y=e.col<_e(Ey,this),w=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),S=Math.abs(m-(this.hot.isRtl()?t.offsetWidth:0)),E=this.getColumnsWidth(d,e.col-1)+S,P=this.getColumnsWidth(g,d-1)+(y?w:0)+E;_e(Wi,this).setPosition(C,P),_e(Wi,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-C),_e(Wi,this).setOffset(null,-E),ee(this.hot.rootElement,h1)}else Me(this.hot.rootElement,d1),gs(Rh,this,!1),_e(Qu,this).length=0}function PHe(n){_e(Rh,this)&&(_e(Bi,this).eventPageX=n.pageX,this.refreshPositions())}function xHe(n,e,t,r){!this.hot.getSelectedRangeActive()||!_e(Rh,this)||(_e(Qu,this).indexOf(e.col)>-1?Me(this.hot.rootElement,C0):ee(this.hot.rootElement,C0),r.row=!0,r.column=!0,r.cell=!0,gs(Io,this,e.col),_e(Bi,this).TD=t)}function LHe(){const n=_e(Bi,this).col,e=_e(Qu,this).length;if(gs(Io,this,void 0),gs(Rh,this,!1),Me(this.hot.rootElement,[h1,C0,d1]),this.hot.selection.isSelectedByColumnHeader()&&ee(this.hot.rootElement,d1),e<1||n===void 0)return;const t=_e(Qu,this)[0],r=this.hot.toPhysicalColumn(t),i=this.dragColumns(_e(Qu,this),n);if(_e(Qu,this).length=0,i===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const s=this.hot.toVisualColumn(r),o=s+e-1;this.hot.selectColumns(s,o)}}function HHe(){const n=this.hot.view._wt.wtTable,e=n.getColumnHeaderHeight(0)+1,t=n.holder.scrollTop,r=e+t;_e(Wi,this).setPosition(r),_e(Wi,this).setSize(null,n.hider.offsetHeight-r)}function DHe(){this.moveBySettingsOrLoad()}function FHe(n,e){S7(n,e),e.add(n)}function gi(n,e,t){S7(n,e),e.set(n,t)}function S7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gn(n,e,t){return n.set(Aa(n,e),t),t}function pe(n,e){return n.get(Aa(n,e))}function Aa(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const R0="manualColumnResize",kHe=130,rz="manualColumnWidths";var ku=new WeakMap,iR=new WeakMap,Zs=new WeakMap,T0=new WeakMap,Ul=new WeakMap,VHe=new WeakMap,mp=new WeakMap,sR=new WeakMap,as=new WeakMap,Pu=new WeakMap,Zf=new WeakMap,b0=new WeakMap,Km=new WeakMap,Ry=new WeakMap,no=new WeakMap,Ty=new WeakMap,gl=new WeakSet;class $He extends yt{static get PLUGIN_KEY(){return R0}static get PLUGIN_PRIORITY(){return kHe}constructor(e){super(e),FHe(this,gl),gi(this,ku,null),gi(this,iR,null),gi(this,Zs,[]),gi(this,T0,null),gi(this,Ul,null),gi(this,VHe,null),gi(this,mp,null),gi(this,sR,null),gi(this,as,this.hot.rootDocument.createElement("DIV")),gi(this,Pu,this.hot.rootDocument.createElement("DIV")),gi(this,Zf,null),gi(this,b0,!1),gi(this,Km,0),gi(this,Ry,null),gi(this,no,void 0),gi(this,Ty,void 0),ee(pe(as,this),"manualColumnResizer"),ee(pe(Pu,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[R0]}enablePlugin(){var e=this;this.enabled||(Gn(no,this,new ad),pe(no,this).addLocalHook("init",()=>Aa(gl,this,UHe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,pe(no,this)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Aa(gl,e,YHe).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Aa(gl,e,KHe).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Aa(gl,e,XHe).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Gn(Ty,this,pe(no,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",rz,pe(no,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",rz,e),e.value}setManualSize(e,t){const r=Math.max(t,20),i=this.hot.toPhysicalColumn(e);return pe(no,this).setValueAtIndex(i,r),r}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);pe(no,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode||pe(Km,this)>1)return;Gn(ku,this,e);const{_wt:t}=this.hot.view,r=t.wtTable.getCoords(pe(ku,this)),i=r.col;if(i<0)return;const s=or(pe(ku,this)),o=pe(ku,this).getBoundingClientRect(),a=i<t.getSetting("fixedColumnsStart");let l;a&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(pe(ku,this),r.row,r.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(pe(ku,this),r.row,r.col)),Gn(iR,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Gn(Zs,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();k(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;Le(d,f,m=>{pe(Zs,this).includes(m)||pe(Zs,this).push(m)})})}pe(Zs,this).includes(pe(iR,this))||Gn(Zs,this,[pe(iR,this)]),Gn(sR,this,l.start-6),Gn(mp,this,parseInt(o.width,10)),pe(as,this).style.top=`${l.top}px`,pe(as,this).style[this.inlineDir]=`${pe(sR,this)+pe(mp,this)}px`,pe(as,this).style.height=`${s}px`,this.hot.rootElement.appendChild(pe(as,this))}refreshHandlePosition(){pe(as,this).style[this.inlineDir]=`${pe(sR,this)+pe(T0,this)}px`}setupGuidePosition(){const e=parseInt(or(pe(as,this)),10),t=parseInt(pe(as,this).style.top,10)+e,r=this.hot.view.getTableHeight();ee(pe(as,this),"active"),ee(pe(Pu,this),"active"),pe(Pu,this).style.top=`${t}px`,this.refreshGuidePosition(),pe(Pu,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(pe(Pu,this))}refreshGuidePosition(){pe(Pu,this).style[this.inlineDir]=pe(as,this).style[this.inlineDir]}hideHandleAndGuide(){Me(pe(as,this),"active"),Me(pe(Pu,this),"active")}checkIfColumnHeader(e){const t=Kh(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},t=(r,i)=>{const s=this.hot.runHooks("beforeColumnResize",pe(Ul,this),r,!0);s!==void 0&&Gn(Ul,this,s),this.setManualSize(r,pe(Ul,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",pe(Ul,this),r,!0),i&&e()};pe(Km,this)>=2&&(pe(Zs,this).length>1?(k(pe(Zs,this),i=>{t(i)}),e()):k(pe(Zs,this),i=>{t(i,!0)})),Gn(Km,this,0),Gn(Ry,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",r=>Aa(gl,this,BHe).call(this,r)),this.eventManager.addEventListener(t,"mousedown",r=>Aa(gl,this,WHe).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Aa(gl,this,jHe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Aa(gl,this,zHe).call(this)),this.eventManager.addEventListener(pe(as,this),"contextmenu",()=>Aa(gl,this,GHe).call(this))}destroy(){super.destroy()}}function UHe(){const n=this.hot.getSettings()[R0],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((t,r)=>{pe(no,this).setValueAtIndex(r,t)})},!0):Array.isArray(n)?(this.hot.batchExecution(()=>{n.forEach((t,r)=>{pe(no,this).setValueAtIndex(r,t)})},!0),Gn(Ty,this,n)):n===!0&&Array.isArray(pe(Ty,this))&&this.hot.batchExecution(()=>{pe(Ty,this).forEach((t,r)=>{pe(no,this).setValueAtIndex(r,t)})},!0)}function BHe(n){if(!fD(n.target)&&pe(b0,this)!==!0&&this.checkIfColumnHeader(n.target)){const e=this.getClosestTHParent(n.target);if(!e)return;const t=e.getAttribute("colspan");e&&(t===null||t==="1")&&(pe(Zf,this)||this.setupHandlePosition(e))}}function WHe(n){n.target.parentNode===this.hot.rootElement&&Be(n.target,"manualColumnResizer")&&(this.setupHandlePosition(pe(ku,this)),this.setupGuidePosition(),Gn(Zf,this,!0),pe(Ry,this)===null&&(Gn(Ry,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(pe(Ry,this))),Gn(Km,this,pe(Km,this)+1),this.startX=n.pageX,Gn(Ul,this,pe(mp,this)))}function jHe(n){if(pe(Zf,this)){const e=(n.pageX-this.startX)*this.hot.getDirectionFactor();Gn(T0,this,pe(mp,this)+e),k(pe(Zs,this),t=>{Gn(Ul,this,this.setManualSize(t,pe(T0,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function zHe(){const n=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(t,r)=>{this.hot.runHooks("beforeColumnResize",pe(Ul,this),t,!1),r&&n(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",pe(Ul,this),t,!1)};pe(Zf,this)&&(this.hideHandleAndGuide(),Gn(Zf,this,!1),pe(Ul,this)!==pe(mp,this)&&(pe(Zs,this).length>1?(k(pe(Zs,this),r=>{e(r)}),n()):k(pe(Zs,this),r=>{e(r,!0)})),this.setupHandlePosition(pe(ku,this)))}function GHe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(pe(as,this)),this.hot.rootElement.removeChild(pe(Pu,this)),Gn(Zf,this,!1),Gn(b0,this,!0),this.hot._registerImmediate(()=>{Gn(b0,this,!1)})}function YHe(n,e){let t=n;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=pe(no,this).getValueAtIndex(r);this.hot.getSettings()[R0]&&i&&(t=i)}return t}function KHe(n,e){const t=pe(no,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof t=="number"?t:n}function XHe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function UO(n,e,t){return(e=qHe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qHe(n){var e=QHe(n,"string");return typeof e=="symbol"?e:e+""}function QHe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const BO=0,iz=1,sz=2,Jg="px";let C7=class{constructor(e){UO(this,"hot",void 0),UO(this,"_element",null),UO(this,"state",BO),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=sz}build(){this.state===BO&&(this._element=this.hot.rootDocument.createElement("div"),this.state=iz)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=BO}isAppended(){return this.state===sz}isBuilt(){return this.state>=iz}setPosition(e,t){e!==void 0&&(this._element.style.top=e+Jg),t!==void 0&&(this._element.style.left=t+Jg)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+Jg),t&&(this._element.style.height=t+Jg)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+Jg),t&&(this._element.style.marginLeft=t+Jg)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const ZHe="ht__manualRowMove--backlight";class JHe extends C7{build(){super.build(),ee(this._element,ZHe)}}const eDe="ht__manualRowMove--guideline";class tDe extends C7{build(){super.build(),ee(this._element,eDe)}}function nDe(n,e){E7(n,e),e.add(n)}function em(n,e,t){E7(n,e),e.set(n,t)}function E7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function If(n,e,t){return n.set(ih(n,e),t),t}function qe(n,e){return n.get(ih(n,e))}function ih(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("beforeRowMove");we.getSingleton().register("afterRowMove");const WO="manualRowMove",rDe=140,oz="ht__manualRowMove",A0="show-ui",f1="on-moving--rows",g1="after-selection--rows";var ji=new WeakMap,fh=new WeakMap,Zu=new WeakMap,Th=new WeakMap,ms=new WeakMap,oR=new WeakMap,Bd=new WeakSet;class iDe extends yt{constructor(){super(...arguments),nDe(this,Bd),em(this,ji,new JHe(this.hot)),em(this,fh,new tDe(this.hot)),em(this,Zu,[]),em(this,Th,void 0),em(this,ms,{}),em(this,oR,void 0)}static get PLUGIN_KEY(){return WO}static get PLUGIN_PRIORITY(){return rDe}isEnabled(){return!!this.hot.getSettings()[WO]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ih(Bd,e,sDe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ih(Bd,e,aDe).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>ih(Bd,this,uDe).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return ih(Bd,e,cDe).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,oz),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Me(this.hot.rootElement,oz),this.unregisterEvents(),qe(ji,this).destroy(),qe(fh,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const r=qe(oR,this),i=this.isMovePossible(e,t),s=this.hot.runHooks("beforeRowMove",e,t,r,i);if(If(oR,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,t);const o=i&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,i,o),o}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const r=this.countFinalIndex(e,t);return If(oR,this,t),this.moveRows(e,r)}isMovePossible(e,t){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,s=t<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=Er(e,(i,s)=>(s<t&&(i+=1),i),0);return t-r}getRowsHeight(e,t){const r=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=t;s++){const o=r.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[WO];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeActive(),t=[];if(!e)return t;const{from:r,to:i}=e,s=Math.min(r.row,i.row),o=Math.max(r.row,i.row);return Le(s,o,a=>{t.push(a)}),t}refreshPositions(){const e=qe(ms,this).coords,t=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=qe(ms,this).TD,a=this.hot.rootElement,l=si(a),u=Dp(a),c=s.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=qe(ms,this).eventPageY-d+c,m=s.hider.offsetHeight,g=s.TBODY.offsetTop,C=qe(ji,this).getOffset().top,y=qe(ji,this).getSize().height,w=o.offsetHeight/2,S=o.offsetHeight;let E=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const P=f>=E+w;this.isFixedRowTop(e.row)&&(E+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?qe(ms,this).row=t>0?t-1:t:P?(qe(ms,this).row=e.row+1,E+=e.row===0?S-1:S):qe(ms,this).row=e.row;let _=f,I=E;f+y+C>=m?_=m-y-C:f+C<g&&(_=g+Math.abs(C)),E>=m-1&&(I=m-1),qe(ji,this).setPosition(_),qe(fh,this).setPosition(I)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>ih(Bd,this,oDe).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>ih(Bd,this,lDe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){qe(ji,this).build(),qe(fh,this).build()}destroy(){qe(ji,this).destroy(),qe(fh,this).destroy(),super.destroy()}}function sDe(n,e,t,r){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeActive();if(!a||!o||qe(Th,this)||n.button!==0){If(Th,this,!1),qe(Zu,this).length=0,Me(this.hot.rootElement,[f1,A0]);return}const l=qe(fh,this).isBuilt()&&!qe(fh,this).isAppended(),u=qe(ji,this).isBuilt()&&!qe(ji,this).isAppended();l&&u&&(qe(fh,this).appendTo(i.hider),qe(ji,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,If(Th,this,!0),qe(ms,this).eventPageY=n.pageY,qe(ms,this).coords=e,qe(ms,this).TD=t,If(Zu,this,this.prepareRowsToMoving());const m=i.holder.scrollLeft+s.getRowHeaderWidth(),g=this.getRowsHeight(d,e.row-1)+(n.clientY-t.getBoundingClientRect().top);qe(ji,this).setPosition(null,m),qe(ji,this).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),qe(ji,this).setOffset(-g,null),ee(this.hot.rootElement,f1),this.refreshPositions()}else Me(this.hot.rootElement,g1),If(Th,this,!1),qe(Zu,this).length=0}function oDe(n){qe(Th,this)&&(qe(ms,this).eventPageY=n.pageY,this.refreshPositions())}function aDe(n,e,t,r){!this.hot.getSelectedRangeActive()||!qe(Th,this)||(qe(Zu,this).indexOf(e.row)>-1?Me(this.hot.rootElement,A0):ee(this.hot.rootElement,A0),r.row=!0,r.column=!0,r.cell=!0,qe(ms,this).coords=e,qe(ms,this).TD=t)}function lDe(){const n=qe(ms,this).row,e=qe(Zu,this).length;if(If(Th,this,!1),Me(this.hot.rootElement,[f1,A0,g1]),this.hot.selection.isSelectedByRowHeader()&&ee(this.hot.rootElement,g1),e<1||n===void 0)return;const t=qe(Zu,this)[0],r=this.hot.toPhysicalRow(t),i=this.dragRows(qe(Zu,this),n);if(qe(Zu,this).length=0,i===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const s=this.hot.toVisualRow(r),o=s+e-1;this.hot.selectRows(s,o)}}function uDe(){const n=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),t=n.holder.scrollLeft,r=e+t;qe(ji,this).setPosition(null,r),qe(ji,this).setSize(n.hider.offsetWidth-r)}function cDe(){this.moveBySettingsOrLoad()}function hDe(n,e){R7(n,e),e.add(n)}function mi(n,e,t){R7(n,e),e.set(n,t)}function R7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mn(n,e,t){return n.set(Vu(n,e),t),t}function me(n,e){return n.get(Vu(n,e))}function Vu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const N0="manualRowResize",dDe=30,az="manualRowHeights";var Ol=new WeakMap,aR=new WeakMap,Js=new WeakMap,by=new WeakMap,gh=new WeakMap,fV=new WeakMap,pp=new WeakMap,lR=new WeakMap,Fi=new WeakMap,Nl=new WeakMap,Jf=new WeakMap,M0=new WeakMap,Xm=new WeakMap,Ay=new WeakMap,Pa=new WeakMap,Ny=new WeakMap,Uc=new WeakSet;class fDe extends yt{static get PLUGIN_KEY(){return N0}static get PLUGIN_PRIORITY(){return dDe}constructor(e){super(e),hDe(this,Uc),mi(this,Ol,null),mi(this,aR,null),mi(this,Js,[]),mi(this,by,null),mi(this,gh,null),mi(this,fV,null),mi(this,pp,null),mi(this,lR,null),mi(this,Fi,this.hot.rootDocument.createElement("DIV")),mi(this,Nl,this.hot.rootDocument.createElement("DIV")),mi(this,Jf,!1),mi(this,M0,!1),mi(this,Xm,0),mi(this,Ay,null),mi(this,Pa,void 0),mi(this,Ny,void 0),ee(me(Fi,this),"manualRowResizer"),ee(me(Nl,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[N0]}enablePlugin(){this.enabled||(Mn(Pa,this,new ad),me(Pa,this).addLocalHook("init",()=>Vu(Uc,this,SDe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,me(Pa,this)),this.addHook("modifyRowHeight",(e,t)=>Vu(Uc,this,yDe).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Mn(Ny,this,me(Pa,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",az,me(Pa,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",az,e),e.value}setManualSize(e,t){const r=this.hot.toPhysicalRow(e),i=Math.max(t,this.hot.stylesHandler.getDefaultRowHeight());return me(Pa,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return me(by,this)}setupHandlePosition(e){if(me(Xm,this)>1)return;Mn(Ol,this,e);const{view:t}=this.hot,{_wt:r}=t,i=r.wtTable.getCoords(me(Ol,this)),s=i.row;if(s<0)return;const o=Xn(me(Ol,this)),a=me(Ol,this).getBoundingClientRect(),l=s<r.getSetting("fixedRowsTop"),u=s>=t.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(me(Ol,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(me(Ol,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(me(Ol,this),i.row,i.col)),Mn(aR,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Mn(Js,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();k(d,f=>{const m=f.getTopStartCorner().row,g=f.getBottomStartCorner().row;Le(m,g,C=>{me(Js,this).includes(C)||me(Js,this).push(C)})})}me(Js,this).includes(me(aR,this))||Mn(Js,this,[me(aR,this)]),Mn(lR,this,c.top-6),Mn(pp,this,parseInt(a.height,10)),me(Fi,this).style.top=`${me(lR,this)+me(pp,this)}px`,me(Fi,this).style[this.inlineDir]=`${c.start}px`,me(Fi,this).style.width=`${o}px`,this.hot.rootElement.appendChild(me(Fi,this))}refreshHandlePosition(){me(Fi,this).style.top=`${me(lR,this)+me(by,this)}px`}setupGuidePosition(){const e=parseInt(Xn(me(Fi,this)),10),t=parseInt(me(Fi,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();ee(me(Fi,this),"active"),ee(me(Nl,this),"active"),me(Nl,this).style.top=me(Fi,this).style.top,me(Nl,this).style[this.inlineDir]=`${t}px`,me(Nl,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(me(Nl,this))}refreshGuidePosition(){me(Nl,this).style.top=me(Fi,this).style.top}hideHandleAndGuide(){Me(me(Fi,this),"active"),Me(me(Nl,this),"active")}checkIfRowHeader(e){const t=Kh(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&me(gh,this)<t?t:me(gh,this)}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},t=(r,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);s!==void 0&&Mn(gh,this,s),this.setManualSize(r,me(gh,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};me(Xm,this)>=2&&(me(Js,this).length>1?(k(me(Js,this),i=>{t(i)}),e()):k(me(Js,this),i=>{t(i,!0)})),Mn(Xm,this,0),Mn(Ay,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Vu(Uc,this,gDe).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Vu(Uc,this,mDe).call(this,r)),this.eventManager.addEventListener(t,"mousemove",r=>Vu(Uc,this,pDe).call(this,r)),this.eventManager.addEventListener(t,"mouseup",()=>Vu(Uc,this,vDe).call(this)),this.eventManager.addEventListener(me(Fi,this),"contextmenu",()=>Vu(Uc,this,wDe).call(this))}destroy(){super.destroy()}}function gDe(n){if(!fD(n.target)&&me(M0,this)!==!0&&this.checkIfRowHeader(n.target)){const e=this.getClosestTHParent(n.target);e&&(me(Jf,this)||this.setupHandlePosition(e))}}function mDe(n){Be(n.target,"manualRowResizer")&&(this.setupHandlePosition(me(Ol,this)),this.setupGuidePosition(),Mn(Jf,this,!0),me(Ay,this)===null&&(Mn(Ay,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(me(Ay,this))),Mn(Xm,this,me(Xm,this)+1),Mn(fV,this,n.pageY),Mn(gh,this,me(pp,this)))}function pDe(n){me(Jf,this)&&(Mn(by,this,me(pp,this)+(n.pageY-me(fV,this))),k(me(Js,this),e=>{Mn(gh,this,this.setManualSize(e,me(by,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function vDe(){const n=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(t,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),r&&n(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};me(Jf,this)&&(this.hideHandleAndGuide(),Mn(Jf,this,!1),me(gh,this)!==me(pp,this)&&(me(Js,this).length>1?(k(me(Js,this),r=>{e(r)}),n()):k(me(Js,this),r=>{e(r,!0)})),this.setupHandlePosition(me(Ol,this)))}function wDe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(me(Fi,this)),this.hot.rootElement.removeChild(me(Nl,this)),Mn(Jf,this,!1),Mn(M0,this,!0),this.hot._registerImmediate(()=>{Mn(M0,this,!1)})}function yDe(n,e){let t=n;if(this.enabled){const i=this.hot.toPhysicalRow(e),s=me(Pa,this).getValueAtIndex(i);if(this.hot.getSettings()[N0]&&s){var r;(r=this.hot.getPlugin("autoRowSize"))!==null&&r!==void 0&&r.isEnabled()?t=Math.max(s,t??0):t=s}}return t}function SDe(){const n=this.hot.getSettings()[N0],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((t,r)=>{me(Pa,this).setValueAtIndex(r,t)}):Array.isArray(n)?(n.forEach((t,r)=>{me(Pa,this).setValueAtIndex(r,t)}),Mn(Ny,this,n)):n===!0&&Array.isArray(me(Ny,this))&&me(Ny,this).forEach((t,r)=>{me(Pa,this).setValueAtIndex(r,t)})},!0)}var CDe=kA;CDe("flatMap");var EDe=yr,lz=Cr,RDe=iu,TDe=RH,bDe=function(n,e){(!e||typeof n!="string")&&lz(n);var t=TDe(n);return RDe(lz(t!==void 0?EDe(t,n):n))},ADe=an,m1=yr,NDe=Ps,p1=Cr,MDe=iu,IDe=bDe,ODe=TH,v1=xs,_De=bH,PDe=id,T7=!_De("flatMap",function(){}),w1=!T7&&PDe("flatMap",TypeError),xDe=T7||w1,LDe=ODe(function(){for(var n=this.iterator,e=this.mapper,t,r;;){if(r=this.inner)try{if(t=p1(m1(r.next,r.iterator)),!t.done)return t.value;this.inner=null}catch(i){v1(n,"throw",i)}if(t=p1(m1(this.next,n)),this.done=!!t.done)return;try{this.inner=IDe(e(t.value,this.counter++),!1)}catch(i){v1(n,"throw",i)}}});ADe({target:"Iterator",proto:!0,real:!0,forced:xDe},{flatMap:function(e){p1(this);try{NDe(e)}catch(t){v1(this,"throw",t)}return w1?m1(w1,this,e):new LDe(MDe(this),{mapper:e,inner:null})}});function HDe(n,e,t){DDe(n,e),e.set(n,t)}function DDe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wd(n,e,t){return(e=FDe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FDe(n){var e=kDe(n,"string");return typeof e=="symbol"?e:e+""}function kDe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function uz(n,e){return n.get(b7(n,e))}function uR(n,e,t){return n.set(b7(n,e),t),t}function b7(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var jd=new WeakMap;class _l{constructor(e,t,r,i,s,o){Wd(this,"row",void 0),Wd(this,"col",void 0),Wd(this,"rowspan",void 0),Wd(this,"colspan",void 0),Wd(this,"removed",!1),Wd(this,"cellCoordsFactory",void 0),Wd(this,"cellRangeFactory",void 0),HDe(this,jd,null),this.row=e,this.col=t,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:r,rowspan:i,colspan:s}=e;return Lt`The merged cell declared with {row: ${t}, col: ${r},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:r}=e;return Lt`The merged cell declared at [${t}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:r}=e;return Lt`The merged cell declared at [${t}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:r}=e;return Lt`The merged cell declared at [${t}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:r,rowspan:i,colspan:s}=e;return t<0||r<0||i<0||s<0}static isSingleCell(e){let{rowspan:t,colspan:r}=e;return r===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:r}=e;return r===0||t===0}static isOutOfBounds(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const t=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),uR(jd,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const r=e[0]||e[1],i=t+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(t,i),l=Math.max(t,i),u=this[o],c=this[o]+this[s]-1;if(u>=t&&(this[o]+=r),r>0)t<=c&&t>u&&(this[s]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,uR(jd,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[o]-=d+r,this[s]-=h}else if(u<=a&&c>=l)this[s]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[s]-=h}}return uR(jd,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return uz(jd,this)||uR(jd,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),uz(jd,this)}}function VDe(n,e){$De(n,e),e.add(n)}function $De(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cR(n,e,t){return(e=UDe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function UDe(n){var e=BDe(n,"string");return typeof e=="symbol"?e:e+""}function BDe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function zd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Bc=new WeakSet;class I0{constructor(e){VDe(this,Bc),cR(this,"plugin",void 0),cR(this,"mergedCells",[]),cR(this,"mergedCellsMatrix",new Map),cR(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:r}=e;return Lt`The merged cell declared at [${t}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(t))!==null&&r!==void 0?r:!1}getByRange(e){const{row:t,col:r}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.mergedCells.length;let a=!1;for(let l=0;l<o;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=t&&c+d-1<=i&&h>=r&&h+f-1<=s){a=u;break}}return a}filterOverlappingMergeCells(e){const t=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i;for(let u=s;u<s+l;u++)for(let c=o;c<o+a;c++)t.add(`r${u},c${c}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=s;h<s+l;h++){for(let d=o;d<o+a;d++){const f=`r${h},c${d}`;if(t.has(f)){wt(I0.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||t.add(...u),!c})}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=r;l<=s;l++)for(let u=i;u<=o;u++){const c=this.get(l,u);c&&(t||!t&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new _l(r,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=t?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),zd(Bc,this,cz).call(this,a),a):(u&&wt(I0.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,t){const r=this.get(e,t),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),zd(Bc,this,WDe).call(this,r),r):!1}clear(){k(this.mergedCells,e=>{let{row:t,col:r,rowspan:i,colspan:s}=e;Le(t,t+i,o=>{Le(r,r+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){const r=this.get(e,t);if(!r)return!1;const{row:i,col:s,rowspan:o,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=ft(u,i,i+o-1),d=ft(c,s,s+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===t}getFirstRenderableCoords(e,t){const r=this.get(e,t);if(!r||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,t){const r=zd(Bc,this,hR).call(this,e,"col",-1);let i=t;for(let s=0;s<r.length;s++)if(r[s]<=t){i=r[s];break}return i}getEndMostColumnIndex(e,t){const r=zd(Bc,this,hR).call(this,e,"col",1);let i=t;for(let s=0;s<r.length;s++)if(r[s]>=t){i=r[s];break}return i}getTopMostRowIndex(e,t){const r=zd(Bc,this,hR).call(this,e,"row",-1);let i=t;for(let s=0;s<r.length;s++)if(r[s]<=t){i=r[s];break}return i}getBottomMostRowIndex(e,t){const r=zd(Bc,this,hR).call(this,e,"row",1);let i=t;for(let s=0;s<r.length;s++)if(r[s]>=t){i=r[s];break}return i}shiftCollections(e,t,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,t),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{zd(Bc,this,cz).call(this,o)})}}function hR(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=t===1?n.getTopStartCorner():n.getBottomEndCorner(),s=t===1?n.getBottomEndCorner():n.getTopStartCorner();for(let o=i.row;t===1?o<=s.row:o>=s.row;o+=t)for(let a=i.col;t===1?a<=s.col:a>=s.col;a+=t){const l=e==="row"?o:a,u=this.get(o,a);let c=l;u&&(c=t===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function cz(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(t,n)}function WDe(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.get(e).delete(t)}function jO(n,e,t){return(e=jDe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jDe(n){var e=zDe(n,"string");return typeof e=="symbol"?e:e+""}function zDe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class GDe{constructor(e){jO(this,"plugin",void 0),jO(this,"mergedCellsCollection",void 0),jO(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,t){let r=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?r="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?r="up":t[1]===e[1]&&t[2]===e[2]?r="right":r="left",r}snapDragArea(e,t,r,i){const s=t.slice(0),o=this.getAutofillSize(e,t,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(o/d)*d,m=o-f,g=this.getFarthestCollection(e,t,r,i);if(g){if(r==="down"){const C=g.row+g.rowspan-a-m;s[2]+C>=this.plugin.hot.countRows()?s[2]-=m:s[2]+=m?C:0}else if(r==="right"){const C=g.col+g.colspan-l-m;s[3]+C>=this.plugin.hot.countCols()?s[3]-=m:s[3]+=m?C:0}else if(r==="up"){const C=u-m-g.row+1;s[0]+C<0?s[0]+=m:s[0]-=m?C:0}else if(r==="left"){const C=c-m-g.col+1;s[1]+C<0?s[1]+=m:s[1]-=m?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),lr(this.currentFillData,e)}getAutofillSize(e,t,r){const[i,s,o,a]=e,[l,u,c,h]=t;switch(r){case"up":return i-l;case"down":return c-o;case"left":return s-u;case"right":return h-a;default:return null}}getDragArea(e,t,r){const[i,s,o,a]=e,[l,u,c,h]=t;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[o+1,s,c+f,a]}case"left":return[l,u,o,s-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,t,r,i){const[s,o,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?s:o,d=this.getAutofillSize(e,t,r),f=u?a-s+1:l-o+1,m=Math.floor(d/f)*f,g=d-m;let C=null,y=null,w=null;switch(r){case"up":C="includesVertically",w=c-g+1;break;case"left":C="includesHorizontally",w=c-g+1;break;case"down":C="includesVertically",w=h+g-1;break;case"right":C="includesHorizontally",w=h+g-1;break}return k(i,S=>{S[C](w)&&S.isFarther(y,r)&&(y=S)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(u,c)=>{switch(i){case"up":return u.row-c>=t.from.row;case"down":return u.row+u.rowspan-1+c<=t.to.row;case"left":return u.col-c>=t.from.column;case"right":return u.col+u.colspan-1+c<=t.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},r={min:null,max:null};return k(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(t.min===null||s<t.min)&&(t.min=s),(t.max===null||s>t.max)&&(t.max=s),(r.min===null||o<r.min)&&(r.min=o),(r.max===null||o>r.max)&&(r.max=o)}),{from:{row:t.min,column:r.min},to:{row:t.max,column:r.max}}}dragAreaOverlapsCollections(e,t,r){const i=this.getDragArea(e,t,r),[s,o,a,l]=i,u=this.plugin.hot._createCellCoords(s,o),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(m=>{let{colspan:g}=m;return g===h.getWidth()}):!f.every(m=>{let{rowspan:g}=m;return g===h.getHeight()})}}function zO(n,e,t){return(e=YDe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YDe(n){var e=KDe(n,"string");return typeof e=="symbol"?e:e+""}function KDe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class XDe{constructor(e){zO(this,"plugin",void 0),zO(this,"hot",void 0),zO(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,r,i){const s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const c=this.plugin.mergedCellsCollection.get(e,t);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(s<=c.row&&o<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const r=[];if(!t||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<r.length;i+=1){const s=[];for(let o=0;o<t.length;o+=1)s[o]=t[o].includes(r[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function qDe(n){return{key:"mergeCells",name(){const e=this.getSelectedActive();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(WD)}return this.getTranslatedPhrase(BD)},callback(){const e=this.getSelectedRangeActive();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;n.toggleMerge(e),this.selectCell(t.row,t.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedActive();return e?_l.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function My(n,e,t){return(e=QDe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QDe(n){var e=ZDe(n,"string");return typeof e=="symbol"?e:e+""}function ZDe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class hz{constructor(e){My(this,"data",void 0),My(this,"next",null),My(this,"prev",null),this.data=e}}class dR{constructor(){My(this,"first",null),My(this,"last",null)}push(e){const t=new hz(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.last;this.last=t,t.prev=r,r.next=t}return t}unshift(e){const t=new hz(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.first;this.first=t,t.next=r,r.prev=t}}inorder(e){let t=this.first;for(;t;){const r=e(t);if(t===this.last||r===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,r,i;for(;t;){if(t.data===e)return r=t.next,i=t.prev,r&&(r.prev=i),i&&(i.next=r),t===this.first&&(this.first=r),t===this.last&&(this.last=i),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,r;for(;e;)r=e.next,e.next=t,t.prev=e,t=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=t,this.last=r}}function JDe(n,e){A7(n,e),e.add(n)}function Gd(n,e,t){A7(n,e),e.set(n,t)}function A7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(n,e){return n.get(O0(n,e))}function Bs(n,e,t){return n.set(O0(n,e),t),t}function O0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ml=new WeakMap,pl=new WeakMap,vl=new WeakMap,wl=new WeakMap,y1=new WeakMap,fR=new WeakMap,gR=new WeakMap,GO=new WeakSet;class eFe{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:r,columnIndexMapper:i}=e;JDe(this,GO),Gd(this,ml,new dR),Gd(this,pl,new dR),Gd(this,vl,null),Gd(this,wl,null),Gd(this,y1,null),Gd(this,fR,null),Gd(this,gR,null),Bs(y1,this,t),Bs(fR,this,r),Bs(gR,this,i)}getCurrentVerticalNode(){return Bt(wl,this).data}getFirstVerticalNode(){return Bt(pl,this).first.data}getNextVerticalNode(){return Bt(wl,this).next.data}getPrevVerticalNode(){return Bt(wl,this).prev.data}getCurrentHorizontalNode(){return Bt(vl,this).data}getFirstHorizontalNode(){return Bt(ml,this).first.data}getNextHorizontalNode(){return Bt(vl,this).next.data}getPrevHorizontalNode(){return Bt(vl,this).prev.data}setPrevNodeAsActive(){Bs(wl,this,Bt(wl,this).prev),Bs(vl,this,Bt(vl,this).prev)}setNextNodeAsActive(){Bs(wl,this,Bt(wl,this).next),Bs(vl,this,Bt(vl,this).next)}buildFocusOrder(e){Bs(ml,this,new dR),e.forEach((t,r)=>{const i=new WeakSet,s=t.getTopStartCorner(),o=t.getBottomEndCorner();for(let a=s.row;a<=o.row;a++)if(!Bt(fR,this).isHidden(a))for(let l=s.col;l<=o.col;l++){if(Bt(gR,this).isHidden(l))continue;const u=O0(GO,this,dz).call(this,{selectedRange:t,selectionLayer:r,listOrder:Bt(ml,this),mergeCellsVisitor:i,row:a,column:l});u&&Bs(vl,this,u)}}),Bt(ml,this).first&&(Bt(ml,this).first.prev=Bt(ml,this).last,Bt(ml,this).last.next=Bt(ml,this).first),Bs(pl,this,new dR),e.forEach((t,r)=>{const i=new WeakSet,s=t.getTopStartCorner(),o=t.getBottomEndCorner();for(let a=s.col;a<=o.col;a++)if(!Bt(gR,this).isHidden(a))for(let l=s.row;l<=o.row;l++){if(Bt(fR,this).isHidden(l))continue;const u=O0(GO,this,dz).call(this,{selectedRange:t,selectionLayer:r,listOrder:Bt(pl,this),mergeCellsVisitor:i,row:l,column:a});u&&Bs(wl,this,u)}}),Bt(pl,this).first&&(Bt(pl,this).first.prev=Bt(pl,this).last,Bt(pl,this).last.next=Bt(pl,this).first)}setActiveNode(e,t,r){return Bt(ml,this).inorder(i=>{const{selectionLayer:s,rowStart:o,rowEnd:a,colStart:l,colEnd:u}=i.data;if(s===r&&e>=o&&e<=a&&t>=l&&t<=u)return Bs(vl,this,i),!0}),Bt(pl,this).inorder(i=>{const{selectionLayer:s,rowStart:o,rowEnd:a,colStart:l,colEnd:u}=i.data;if(s===r&&e>=o&&e<=a&&t>=l&&t<=u)return Bs(wl,this,i),!0}),this}}function dz(n){let{selectedRange:e,selectionLayer:t,listOrder:r,mergeCellsVisitor:i,row:s,column:o}=n;const a=e.getTopStartCorner(),l=e.getBottomEndCorner(),u=e.highlight.clone().normalize(),c=Bt(y1,this).call(this,s,o);if(c&&i.has(c))return null;const h={selectionLayer:t,colStart:o,colEnd:o,rowStart:s,rowEnd:s};if(c){if(i.add(c),c.row<a.row||c.row+c.rowspan-1>l.row||c.col<a.col||c.col+c.colspan-1>l.col)return null;h.colStart=c.col,h.colEnd=c.col+c.colspan-1,h.rowStart=c.row,h.rowEnd=c.row+c.rowspan-1}const d=r.push(h);return s===u.row&&o===u.col||c&&u.row>=c.row&&u.row<=c.row+c.rowspan-1&&u.col>=c.col&&u.col<=c.col+c.colspan-1?d:null}function N7(n,e,t){const{rowIndexMapper:r,stylesHandler:i}=n,s=i.getDefaultRowHeight();let o=0;for(let l=e;l<e+t;l++)if(!r.isHidden(l)){var a;o+=(a=n.getRowHeight(l))!==null&&a!==void 0?a:s,l===0&&!i.isClassicTheme()&&(o+=1)}return o}function tFe(n){const{hot:e}=n,{rowIndexMapper:t,columnIndexMapper:r}=e,i=new Map;function s(){}function o(a,l,u){const c=n.mergedCellsCollection.get(l,u);if(!je(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:m}=c,[g,C]=n.translateMergedCellToRenderable(h,m,d,f),y=n.getSetting("virtualized");if(d===0&&!e.getSettings().rowHeaders){const F=e._getRowHeightFromSettings(l);if(F!==void 0){const q=e.stylesHandler.areCellsBorderBox()?0:1;i.set(l,F-q)}else if(cC()){const J=N7(e,h,m);i.set(l,J/m)}}const w=t.getRenderableFromVisualIndex(l),S=r.getRenderableFromVisualIndex(u),E=g-w+1,P=C-S+1;let _=t.getNearestNotHiddenIndex(h,1),I=r.getNearestNotHiddenIndex(d,1);if(y){const F=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(F)||(_=Math.max(_,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(F)||(I=Math.max(I,e.getFirstRenderedVisibleColumn()))}const D=Math.min(m,E),Q=Math.min(f,P);_===l&&I===u?(a.setAttribute("rowspan",D),a.setAttribute("colspan",Q)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:s,after:o}}function nFe(n,e){M7(n,e),e.add(n)}function mR(n,e,t){M7(n,e),e.set(n,t)}function M7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YO(n,e,t){return(e=rFe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rFe(n){var e=iFe(n,"string");return typeof e=="symbol"?e:e+""}function iFe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function OS(n,e,t){return n.set(zt(n,e),t),t}function rn(n,e){return n.get(zt(n,e))}function zt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("beforeMergeCells");we.getSingleton().register("afterMergeCells");we.getSingleton().register("beforeUnmergeCells");we.getSingleton().register("afterUnmergeCells");const S1="mergeCells",sFe=150,fz=S1;var Bo=new WeakMap,Wo=new WeakMap,Bl=new WeakMap,gz=new WeakMap,qt=new WeakSet;class oFe extends yt{constructor(){super(...arguments),nFe(this,qt),YO(this,"mergedCellsCollection",null),YO(this,"autofillCalculations",null),YO(this,"selectionCalculations",null),mR(this,Bo,null),mR(this,Wo,{row:0,col:0}),mR(this,Bl,new eFe({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),mR(this,gz,tFe(this))}static get PLUGIN_KEY(){return S1}static get PLUGIN_PRIORITY(){return sFe}static get DEFAULT_SETTINGS(){return{[v8]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[S1]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new I0(this),this.autofillCalculations=new GDe(this),this.selectionCalculations=new XDe(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,aFe).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,uFe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,cFe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,hFe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,dFe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,pz).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,pz).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,gFe).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,mFe).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,pFe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,mz).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,mz).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,lFe).call(e,...r)}),this.addHook("afterRenderer",function(){return rn(gz,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,fFe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,vFe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,wFe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,yFe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,SFe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,CFe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,EFe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,RFe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,TFe).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,bFe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,AFe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,NFe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,MFe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,IFe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return zt(qt,e,OFe).call(e,...r)}),this.addHook("beforeUndoStackChange",(t,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!rD())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:s}=r;for(let o=i+1;o<i+s;o++)t.push(o)}),t=[...new Set(t)],t.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=vS(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=vS(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?_l.containsNegativeValues(e)?(wt(_l.NEGATIVE_VALUES_WARNING(e)),!1):_l.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(wt(_l.IS_OUT_OF_BOUNDS_WARNING(e)),!1):_l.isSingleCell(e)?(wt(_l.IS_SINGLE_CELL(e)),!1):_l.containsZeroSpan(e)?(wt(_l.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),t=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];t.forEach(i=>{const{row:s,col:o,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(s,o),c=this.hot._createCellCoords(s+a-1,o+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=s;d<s+a;d++)for(let f=o;f<o+l;f++)(d!==s||f!==o)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;const{from:t,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,t)?(this.hot.runHooks("beforeMergeCells",e,t),Le(0,o.rowspan-1,c=>{Le(0,o.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+c,o.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,t)?(r?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),l):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),k(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),Le(0,i.rowspan-1,s=>{Le(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const{from:t,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(t.row,t.col);i.row===t.row&&i.col===t.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,r,i){const s=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,t,r,i){const s=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeActive();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:fz})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fz)}modifyViewportRowStart(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(i,s);if(je(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(i,s);if(je(o)){const a=o.row+o.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(s,i);if(je(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(s,i);if(je(o)){const a=o.col+o.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,r,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;t===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+t-1,-1),i===0?l=o.getNearestNotHiddenIndex(r,1):l=o.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,c=r>=0?o.getRenderableFromVisualIndex(l):r;return[u,c]}}function aFe(){this.generateFromSettings(),this.hot.render()}function lFe(n){if(n){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeActive(),r=t.getTopStartCorner(),i=t.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(r.row===e[s].row&&r.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return n}function uFe(n){rn(Wo,this).row=n.row,rn(Wo,this).col=n.col}function cFe(n){const e=this.hot.getSelectedRangeActive(),{highlight:t}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;rn(Bo,this)&&(i.getRenderableFromVisualIndex(rn(Bo,this).row)!==null&&(t.row=rn(Bo,this).row),r.getRenderableFromVisualIndex(rn(Bo,this).col)!==null&&(t.col=rn(Bo,this).col),OS(Bo,this,null));const s=this.mergedCellsCollection.get(t.row,t.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(n.col<0){const c=t.col>=o&&t.col<=a?o-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,t.col)-1,1)}else if(n.col>0){const c=t.col>=o&&t.col<=a?a+1:o,h=r.getNearestNotHiddenIndex(c,1);h===null?n.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,h)-1,1)}const l=s.row,u=s.row+s.rowspan-1;if(n.row<0){const c=t.row>=l&&t.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?n.row=-this.hot.view.countRenderableRowsInRange(0,t.row):n.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,t.row)-1,1)}else if(n.row>0){const c=t.row>=l&&t.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?n.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):n.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,h)-1,1)}}function hFe(n){const e=this.hot.getSelectedRangeActive(),t=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,l)=>{t.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(n.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+n.col;o(r.row,a),e.getHorizontalDirection()==="E-W"&&t.getHorizontalDirection()==="E-W"&&(a=t.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(n.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+n.col;o(r.row,a),e.getHorizontalDirection()==="W-E"&&t.getHorizontalDirection()==="W-E"&&(a=t.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(n.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(n.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+n.row;o(a,r.col),e.getVerticalDirection()==="S-N"&&t.getVerticalDirection()==="S-N"&&(a=t.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(n.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(n.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+n.row;o(a,r.col),e.getVerticalDirection()==="N-S"&&t.getVerticalDirection()==="N-S"&&(a=t.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(n.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function dFe(){const n=this.hot.getSelectedRangeLast(),{highlight:e}=n;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){OS(Bo,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const t=this.mergedCellsCollection.get(e.row,e.col);OS(Bo,this,e.clone()),t&&e.assign(t)}function mz(n,e,t,r){if(n<0||e<0)return;const i=this.mergedCellsCollection.get(n,e);if(!i)return;const{row:s,col:o,colspan:a,rowspan:l}=i,u=s,c=o,h=s+l-1,d=o+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),m=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),g=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[ft(m,u,h),ft(g,c,d),ft(this.hot.getLastRenderedVisibleRow(),u,h),ft(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function fFe(n){n.items.push({name:"---------"},qDe(this))}function pz(){OS(Bo,this,null)}function gFe(){if(rn(Bo,this).isCell())return;const n=this.hot.getSelectedRangeActive(),e=n.getVerticalDirection(),t=n.getHorizontalDirection(),r=rn(Bo,this).clone().normalize();rn(Bl,this).setActiveNode(r.row,r.col),rn(Wo,this).row>0||rn(Wo,this).col>0?rn(Bl,this).setPrevNodeAsActive():(t==="E-W"&&rn(Wo,this).col<0||e==="S-N"&&rn(Wo,this).row<0)&&rn(Bl,this).setNextNodeAsActive()}function mFe(n,e){const{columnIndexMapper:t,rowIndexMapper:r}=this.hot;let i=this.hot.getActiveSelectionLayerIndex(),s=null,o=null;if(rn(Wo,this).col<0){const{rowEnd:a,colEnd:l,selectionLayer:u}=rn(Bl,this).getPrevHorizontalNode();o=t.getNearestNotHiddenIndex(l,-1),s=r.getNearestNotHiddenIndex(a,-1),i=u}else if(rn(Wo,this).col>0){const{rowStart:a,colStart:l,selectionLayer:u}=rn(Bl,this).getNextHorizontalNode();o=t.getNearestNotHiddenIndex(l,1),s=r.getNearestNotHiddenIndex(a,1),i=u}else if(rn(Wo,this).row<0){const{rowEnd:a,colEnd:l,selectionLayer:u}=rn(Bl,this).getPrevVerticalNode();o=t.getNearestNotHiddenIndex(l,-1),s=r.getNearestNotHiddenIndex(a,-1),i=u}else if(rn(Wo,this).row>0){const{rowStart:a,colStart:l,selectionLayer:u}=rn(Bl,this).getNextVerticalNode();o=t.getNearestNotHiddenIndex(l,1),s=r.getNearestNotHiddenIndex(a,1),i=u}if(s!==null||o!==null){this.hot.selection.setActiveSelectionLayerIndex(i);const a=this.hot.getSelectedRangeActive(),l=this.hot._createCellCoords(s,o),u=this.mergedCellsCollection.get(l.row,l.col),c=this.hot.selection.highlight.getFocus();n=l.row,e=l.col,u?a.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(u.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(u.col,1)}):a.highlight.assign(l),c.clear(),c.add(l).commit()}rn(Bl,this).setActiveNode(n,e,i),OS(Wo,this,{row:0,col:0})}function pFe(){rn(Bl,this).buildFocusOrder(this.hot.getSelectedRange())}function vFe(n,e,t){const r=this.mergedCellsCollection.get(n,e);r&&(r.row!==n||r.col!==e?t.copyable=!1:(t.rowspan=r.rowspan,t.colspan=r.colspan))}function wFe(n){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(n,e),this.modifyViewportRowEnd(n,e)}function yFe(n){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(n,e),this.modifyViewportColumnEnd(n,e)}function SFe(n,e){const t=this.autofillCalculations.getDirection(e,n);if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,t))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(r,r,i),o=this.mergedCellsCollection.getWithinRange(s);return o.length===0?n:this.autofillCalculations.snapDragArea(e,n,t,o)}function CFe(n,e){this.mergedCellsCollection.shiftCollections("right",n,e)}function EFe(n,e){this.mergedCellsCollection.shiftCollections("left",n,e)}function RFe(n,e,t){t!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,e)}function TFe(n,e){this.mergedCellsCollection.shiftCollections("up",n,e)}function bFe(n,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}function AFe(n,e){if(e&&e==="area"){const t=this.hot.getSelectedRangeActive(),r=this.mergedCellsCollection.getWithinRange(t);k(r,i=>{t.getBottomEndCorner().row===i.getLastRow()&&t.getBottomEndCorner().col===i.getLastColumn()&&(n[2]=i.row,n[3]=i.col)})}}function NFe(n,e,t,r){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(n,e,t,r)}function MFe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function IFe(n,e,t,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeActive(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function OFe(n,e,t){if(this.hot.getSettings().rowHeaders||t==="bottom"||t==="bottom_inline_start_corner")return n;let r,i;if(t==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(t);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return n;const o=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,m=0;t==="top"||t==="top_inline_start_corner"?m=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):m=f-h,n=Math.max(n??0,N7(this.hot,e,m))}),n}function _Fe(n,e){return function(t,r){const[,...i]=t,[,...s]=r;return function o(a){const l=n[a],u=e[a],c=i[a],h=s[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:K8(u.type))(l,u,d)(c,h);if(m===ql){const g=a+1;if(typeof e[g]<"u")return o(g)}return m}(0)}}const I7="sort";function PFe(n,e,t){const r=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&r.push(`${I7}-${n.getIndexOfColumnInSortQueue(e)+1}`),r}function xFe(n){const e=n.className.split(" "),t=new RegExp(`^${I7}-[0-9]{1,2}$`);return e.filter(r=>t.test(r))}function LFe(n,e,t){return(e=HFe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function HFe(n){var e=DFe(n,"string");return typeof e=="symbol"?e:e+""}function DFe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const _0="multiColumnSorting",FFe=170,vz=_0;Y8(_0,_Fe);class kFe extends rX{constructor(){super(...arguments),LFe(this,"pluginKey",_0)}static get PLUGIN_KEY(){return _0}static get PLUGIN_PRIORITY(){return FFe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,c0)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeActive())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:od,position:"before",group:vz})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vz)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),Me(e,xFe(e)),this.enabled!==!1&&ee(e,PFe(...r))}onAfterOnCellMouseDown(e,t){zk(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,c0))):this.sort(this.getColumnNextConfig(t.col)))}}function wz(n,e,t){return(e=VFe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function VFe(n){var e=$Fe(n,"string");return typeof e=="symbol"?e:e+""}function $Fe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const UFe="multipleSelectionHandles",BFe=160;class WFe extends yt{constructor(){super(...arguments),wz(this,"dragged",[]),wz(this,"lastSetCell",null)}static get PLUGIN_KEY(){return UFe}static get PLUGIN_PRIORITY(){return BFe}isEnabled(){return Ua()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",i=>{let s;if(Be(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeActive(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(Be(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeActive(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",i=>{if(Be(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Be(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,u,c,h;if(e.dragged.length===0)return;const d=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeActive(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,t,r,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?c={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:c={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":s==="bottom"&&(c={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?c={start:t,end:l}:c.end=t;break;case"NW-SE":s==="top"?c={start:t,end:a}:c.end=t;break;case"SE-NW":s==="top"?c={start:t,end:o}:c.end=t;break;case"SW-NE":s==="top"?c={start:t,end:u}:c.end=t;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?c={start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(l.row,t.col)}:c={start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":s==="top"?c={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:c={start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":s==="bottom"?c={start:this.hot._createCellCoords(t.row,u.col),end:this.hot._createCellCoords(o.row,t.col)}:s==="top"&&(c={start:l,end:t});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(c.end=t);break;case"SE-NW":s==="top"?c.end=t:c={start:t,end:o};break}break}return c}isDragged(){return this.dragged.length>0}}function C1(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:r,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:u}}function O7(){return{label:"",isPlaceholder:!0}}function jFe(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;k(n,i=>{const s=[];let o=0;t.push(s),k(i,a=>{const l=C1();if(je(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=on(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=on(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)s.push(O7());return!u})});const r=Math.max(...At(t,i=>i.length));return k(t,i=>{if(i.length<r){const s=At(new Array(r-i.length),()=>C1());i.splice(i.length,0,...s)}}),t}function KO(n,e,t){zFe(n,e),e.set(n,t)}function zFe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wa(n,e){return n.get(_7(n,e))}function vw(n,e,t){return n.set(_7(n,e),t),t}function _7(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const yz=["label","collapsible"];var bu=new WeakMap,Yd=new WeakMap,XO=new WeakMap;class GFe{constructor(){KO(this,bu,[]),KO(this,Yd,0),KO(this,XO,1/0)}setColumnsLimit(e){vw(XO,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];vw(bu,this,jFe(e,wa(XO,this))),vw(Yd,this,wa(bu,this).length)}getData(){return wa(bu,this)}mergeWith(e){k(e,t=>{let{row:r,col:i,...s}=t;const o=this.getHeaderSettings(r,i);o!==null&&lr(o,s,yz)})}map(e){k(wa(bu,this),t=>{k(t,r=>{const i=e({...r});je(i)&&lr(r,i,yz)})})}getHeaderSettings(e,t){var r;if(e>=wa(Yd,this)||e<0)return null;const i=wa(bu,this)[e];return Array.isArray(i)===!1||t>=i.length?null:(r=i[t])!==null&&r!==void 0?r:null}getHeadersSettings(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=wa(Yd,this)||e<0)return i;const s=wa(bu,this)[e];let o=0;for(let a=t;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===r)break;if(o>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return wa(Yd,this)}getColumnsCount(){return wa(Yd,this)>0?wa(bu,this)[0].length:0}clear(){vw(bu,this,[]),vw(Yd,this,0)}}function qO(n,e,t){return(e=YFe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YFe(n){var e=KFe(n,"string");return typeof e=="symbol"?e:e+""}function KFe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const P7="DF-pre-order";function x7(n,e){let t=n.call(e,this);for(let r=0;r<this.childs.length;r++){if(t===!1)return!1;t=x7.call(this.childs[r],n,e)}return t}const XFe="DF-post-order";function L7(n,e){for(let t=0;t<this.childs.length;t++)if(L7.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const H7="BF";function qFe(n,e){const t=[this];function r(){if(t.length===0)return;const i=t.shift();t.push(...i.childs),n.call(e,i)!==!1&&r()}r()}const QFe=H7,Sz=new Map([[P7,x7],[XFe,L7],[H7,qFe]]);class P0{constructor(e){qO(this,"data",{}),qO(this,"parent",null),qO(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new P0({...e.data});for(let r=0;r<e.childs.length;r++)t.addChild(this.cloneTree(e.childs[r]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:QFe;if(!Sz.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);Sz.get(t).call(this,e,this)}walkUp(e){const t=this,r=i=>{e.call(t,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function QO(n,e,t){ZFe(n,e),e.set(n,t)}function ZFe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Di(n,e){return n.get(D7(n,e))}function JFe(n,e,t){return n.set(D7(n,e),t),t}function D7(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var tm=new WeakMap,Kd=new WeakMap,nm=new WeakMap;class eke{constructor(e){QO(this,tm,new Map),QO(this,Kd,new Map),QO(this,nm,null),JFe(nm,this,e)}getRoots(){return Array.from(Di(tm,this).values())}getRootByColumn(e){let t;return Di(Kd,this).has(e)&&(t=Di(tm,this).get(Di(Kd,this).get(e))),t}getNode(e,t){const r=this.getRootByColumn(t);if(!r)return;const i=t-Di(Kd,this).get(t);let s=0,o;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=t===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;Di(Kd,this).clear(),k(Di(tm,this),t=>{let[,{data:{colspan:r}}]=t;for(let i=e;i<e+r;i++)Di(Kd,this).set(i,e);e+=r})}buildTree(){this.clear();const e=Di(nm,this).getColumnsCount();let t=0;for(;t<e;){const r=Di(nm,this).getHeaderSettings(0,t),i=new P0;Di(tm,this).set(t,i),this.buildLeaves(i,t,0,r.origColspan),t+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Di(nm,this).getHeadersSettings(r,t,i);r+=1,k(s,o=>{const a={...o,headerLevel:r-1,columnIndex:t};let l;r===1?(e.data=a,l=e):(l=new P0(a),e.addChild(l)),r<Di(nm,this).getLayersCount()&&this.buildLeaves(l,t,r,o.origColspan),t+=o.origColspan})}clear(){Di(tm,this).clear(),Di(Kd,this).clear()}}function F7(n,e){n.walkDown(t=>{let{data:r,childs:i}=t;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let s=1;s<r.colspan;s++)e(r.columnIndex+s)})}function x0(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function L0(n){return x0(n,"origColspan")===n.data.origColspan}function gV(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(L0(n))return gV(t[0]);e.isCollapsed=!1;const i=t.slice(1),s=new Set;let o=0;if(i.length>0)k(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,F7(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let c=1;c<l;c++)s.add(u+c)}return n.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):L0(a)&&(l.isCollapsed=x0(a,"isCollapsed"))}),{rollbackModification:()=>mV(n),affectedColumns:Array.from(s),colspanCompensation:o}}function mV(n){var e;const{data:t,childs:r}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(L0(n))return mV(r[0]);t.isCollapsed=!0;const s=r.slice(1),o=new Set;if(s.length>0)k(s,l=>{F7(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=t;for(let c=1;c<l;c++){const h=u+c;o.add(h)}}const a=t.colspan-((e=x0(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):L0(l)&&(u.isCollapsed=x0(l,"isCollapsed"))}),{rollbackModification:()=>gV(n),affectedColumns:Array.from(o),colspanCompensation:a}}function tke(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Lt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let r=!1;n.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&n.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function nke(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Lt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let r=!1;n.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&n.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const Cz=new Map([["collapse",mV],["expand",gV],["hide-column",tke],["show-column",nke]]);function rke(n,e,t){if(!Cz.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return Cz.get(n)(e,t)}function pR(n){const e=[];return k(n,t=>{t.walkDown(r=>{const i=r.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,u=ske(e,a);let c=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||c)u.push(O7());else{const f=ike(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function ike(n){const{crossHiddenColumns:e,...t}=C1(n);return t}function ske(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function ZO(n,e,t){oke(n,e),e.set(n,t)}function oke(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ww(n,e,t){return n.set(k7(n,e),t),t}function An(n,e){return n.get(k7(n,e))}function k7(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var yl=new WeakMap,is=new WeakMap,Xd=new WeakMap;class ake{constructor(){ZO(this,yl,new GFe),ZO(this,is,new eke(An(yl,this))),ZO(this,Xd,[[]])}setState(e){An(yl,this).setData(e);let t=!1;try{An(is,this).buildTree()}catch{An(is,this).clear(),An(yl,this).clear(),t=!0}return ww(Xd,this,pR(An(is,this).getRoots())),t}setColumnsLimit(e){An(yl,this).setColumnsLimit(e)}mergeStateWith(e){const t=At(e,r=>{let{row:i,...s}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});An(yl,this).mergeWith(t),An(is,this).buildTree(),ww(Xd,this,pR(An(is,this).getRoots()))}mapState(e){An(yl,this).map(e),An(is,this).buildTree(),ww(Xd,this,pR(An(is,this).getRoots()))}mapNodes(e){return Er(An(is,this).getRoots(),(t,r)=>(r.walkDown(i=>{const s=e(i.data);s!==void 0&&t.push(s)}),t),[])}triggerNodeModification(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));const i=An(is,this).getNode(t,r);let s;return i&&(s=rke(e,i,r),ww(Xd,this,pR(An(is,this).getRoots()))),s}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=An(Xd,this)[e])===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,t){const r=this.getHeaderTreeNode(e,t);return r?{...r.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=An(is,this).getNode(e,t);return r||null}findTopMostEntireHeaderLevel(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=t-e+1;let i=!1,s=null;for(let o=e;o<=t;o++){const a=An(is,this).getRootByColumn(o);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=t&&(s===null||c<s)&&(s=c)},P7)}return i&&s===null?-1:this.levelToRowCoords(s??0)}findLeftMostColumnIndex(e,t){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0};if(i)return t;let s=t-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,t){var r;const{isRoot:i,origColspan:s}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return t+s-1;let o=t+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return An(yl,this).getLayersCount()}getColumnsCount(){return An(yl,this).getColumnsCount()}clear(){ww(Xd,this,[]),An(yl,this).clear(),An(is,this).clear()}}function yw(n,e,t){return(e=lke(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lke(n){var e=uke(n,"string");return typeof e=="symbol"?e:e+""}function uke(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class cke{constructor(e,t){yw(this,"hot",void 0),yw(this,"nestedHeaderSettingsGetter",void 0),yw(this,"layersCount",0),yw(this,"container",void 0),yw(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),r=t.length;this.widthsMap.clear();for(let i=0;i<r;i++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),o=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(o,t[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:r}=this.hot,i=t.createDocumentFragment(),s=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=t.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=t.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;o&&(m+='<button class="changeType"></button>'),sd(d,m),d.colSpan=f.colspan,u.appendChild(d)}}s.appendChild(u)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function hke(n,e){V7(n,e),e.add(n)}function Ez(n,e,t){return(e=dke(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dke(n){var e=fke(n,"string");return typeof e=="symbol"?e:e+""}function fke(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function rm(n,e,t){V7(n,e),e.set(n,t)}function V7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ju(n,e,t){return n.set(br(n,e),t),t}function rt(n,e){return n.get(br(n,e))}function br(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Rz="nestedHeaders",gke=280;var Kt=new WeakMap,Wc=new WeakMap,Iy=new WeakMap,xN=new WeakMap,H0=new WeakMap,qd=new WeakMap,Vr=new WeakSet;class mke extends yt{constructor(){super(...arguments),hke(this,Vr),rm(this,Kt,new ake),rm(this,Wc,null),rm(this,Iy,null),rm(this,xN,!1),rm(this,H0,null),Ez(this,"ghostTable",new cke(this.hot,(e,t)=>this.getHeaderSettings(e,t))),Ez(this,"detectedOverlappedHeaders",!1),rm(this,qd,()=>{var e;const t=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeActive();if(!t)return;const{highlight:r}=t;if(r.isHeader()&&r.col>=0){const s=rt(Kt,this).findLeftMostColumnIndex(r.row,r.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=s,o.visualCellRange.from.col=s,o.visualCellRange.to.col=s,o.commit()}})}static get PLUGIN_KEY(){return Rz}static get PLUGIN_PRIORITY(){return gke}isEnabled(){return!!this.hot.getSettings()[Rz]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&wt(Lt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>br(Vr,this,_ke).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,Pke).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,yke).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,Ske).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,Cke).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,Eke).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,Rke).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,Tke).call(e,...i)}),this.addHook("afterSelection",()=>rt(qd,this).call(this)),this.addHook("afterSelectionFocusSet",()=>rt(qd,this).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,pke).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>br(Vr,this,Ake).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,Mke).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,Ike).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,vke).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,wke).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,bke).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,Nke).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return br(Vr,e,Oke).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",rt(qd,this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",rt(qd,this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();rt(Kt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=rt(Kt,this).setState(e)),this.detectedOverlappedHeaders&&wt(Lt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,r)=>{const i=t===!0?"hide-column":"show-column";rt(Kt,this).triggerColumnModification(i,r)}),!rt(Wc,this)&&this.enabled&&Ju(Wc,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(r=>{let{op:i,index:s,newValue:o}=r;if(i==="replace"){const a=o===!0?"hide-column":"show-column";rt(Kt,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",rt(qd,this)),this.hot.columnIndexMapper.removeLocalHook("cacheUpdated",rt(qd,this)),this.clearColspans(),rt(Kt,this).clear(),rt(Wc,this).unsubscribe(),Ju(Wc,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return rt(Kt,this)}getLayersCount(){return rt(Kt,this).getLayersCount()}getHeaderSettings(e,t){return rt(Kt,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<t;o++){const a=r.childNodes[o];if(!a)break;const l=i.childNodes[o],u=s?s.childNodes[o]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),Me(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Me(l.childNodes[c],"hiddenHeader")),s&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Me(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),s.removeAttribute("colspan"),Me(s,"hiddenHeader"),Me(s,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(o=rt(Kt,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{};if(d||h)ee(s,"hiddenHeader");else if(c>1){var m,g,C;const{wtOverlays:y}=l._wt,w=(m=y.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s),S=(g=y.inlineStartOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(s);((C=y.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s))&&u<r&&ee(s,"hiddenHeaderText");const P=w||S?Math.min(c,r-i):c;P>1&&s.setAttribute("colspan",P)}if(this.hot.view.appendColHeader(u,s,function(){return t.getColumnHeaderValue(...arguments)},e),!d&&!h){const y=s.querySelector("div.relative");y&&f&&f.length>0&&(Me(y,this.hot.getColumnMeta(u).headerClassName),ee(y,f))}}}getColumnHeaderValue(e,t){var r;const{isHidden:i,isPlaceholder:s}=(r=rt(Kt,this).getHeaderSettings(t,e))!==null&&r!==void 0?r:{};return s||i?"":this.hot.getColHeader(e,t)}destroy(){Ju(Kt,this,null),rt(Wc,this)!==null&&(rt(Wc,this).unsubscribe(),Ju(Wc,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return rt(Kt,this).getHeaderTreeNodeData(e.row,e.col)}}function pke(n,e){var t;const r=this.hot.getSelectedRangeActive();if(!r)return n;const{highlight:i}=r,{navigableHeaders:s}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),a=s?i.row:(t=rt(H0,this))===null||t===void 0?void 0:t.row,l=o?n:i.col,u=a<0&&l>=0;if(Ju(H0,this,null),!u)return n;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=rt(Kt,this).findLeftMostColumnIndex(a,l),m=rt(Kt,this).findRightMostColumnIndex(a,l),g=m-f+1;if(f<c&&m>h)return f;if(o){let C=null;return f>=c&&m>h?g>d?(e.value="start",C=f):(e.value="end",C=m):f<c&&m<=h&&(g>d?(e.value="end",C=m):(e.value="start",C=f)),C}return f<=c?f:m}function vke(n,e,t){const r=rt(Kt,this).getHeaderTreeNodeData(e,n);if(!r)return n;const{columnCursor:i,selectionType:s,selectionWidth:o}=t,{isRoot:a,colspan:l}=rt(Kt,this).getHeaderSettings(e,n);if(s===Mk){if(!a)return r.columnIndex}else if(s===I8&&(l>o-i||!a))return null;return n}function wke(n,e,t){let{columnHeadersCount:r}=t;if(r!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:u}=e[s],c=l-o+1,h=a-u+1;if(o>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=o;f<=l;f++){var i;const m=c+f,g=d-a;if(g===0)continue;((i=rt(Kt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(n[m][g]="")}}}function yke(n,e,t,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Ske(n,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;Ju(Iy,this,e.clone()),Ju(xN,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=t,l=!r.inInSelection(e);n.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(iN(n)||qh(n)&&l||T9(n))&&s.push(o,o+a-1,e.row),r.selectColumns(...s)}function Cke(n,e,t,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeActive(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=ft(e.row,-1/0,-1);e.col<c.col?h.push(u.col,s,d):e.col>c.col?h.push(l.col,s+o-1,d):h.push(s,s+o-1,d),this.hot.selection.selectColumns(...h)}function Eke(){Ju(xN,this,!1)}function Rke(){const{navigableHeaders:n}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!rt(xN,this)||!n)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=rt(Kt,this).getHeaderTreeNodeData(rt(Iy,this).row,rt(Iy,this).col);if(e.setHighlight(rt(Iy,this)),s>e.getWidth()||i<t||i+s-1>r){const o=rt(Kt,this).findTopMostEntireHeaderLevel(ft(t,i,i+s-1),ft(r,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function Tke(n){const{highlight:e}=this.hot.getSelectedRangeActive(),t=this.hot._createCellCoords(e.row+n.row,e.col+n.col);if(!(t.isHeader()&&t.col>=0))return;const i=rt(Kt,this).findLeftMostColumnIndex(t.row,t.col),s=rt(Kt,this).findRightMostColumnIndex(t.row,t.col);if(n.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(n.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?n.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function bke(n,e,t){const r=n.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:n.col}),s=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});Ju(H0,this,t.clone()),e.col<n.col?(i&&(n.col=i.columnIndex+i.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=n.col&&(i&&(n.col=i.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function Ake(n){if(rt(Kt,this).getLayersCount()>0){n.length=0;for(let e=0;e<rt(Kt,this).getLayersCount();e++)n.push(this.headerRendererFactory(e))}}function Nke(n){const e=rt(Kt,this).getLayersCount();let t=n.startColumn,r=!!e;for(let i=0;i<e;i++){const s=rt(Kt,this).findLeftMostColumnIndex(i,n.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(r=!1),bi(o)&&o<n.startColumn){t=o;break}}n.startColumn=r?rt(Kt,this).getHeaderTreeNodeData(0,t).columnIndex:t}function Mke(n,e){const t=this.ghostTable.getWidth(e);return n>t?n:t}function Ike(n,e,t){var r;const{label:i}=(r=rt(Kt,this).getHeaderTreeNodeData(t,e))!==null&&r!==void 0?r:{label:""};return i}function Oke(n,e){if(n<0)return this.hot.getCell(n,rt(Kt,this).findLeftMostColumnIndex(n,e),!0)}function _ke(){this.updatePlugin()}function Pke(n,e){e||this.updatePlugin()}function Sw(n,e,t){return(e=xke(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xke(n){var e=Lke(n,"string");return typeof e=="symbol"?e:e+""}function Lke(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Hke{constructor(e,t){Sw(this,"hot",void 0),Sw(this,"data",null),Sw(this,"plugin",void 0),Sw(this,"parentReference",new WeakMap),Sw(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Le(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,r){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&k(e.__children,i=>{this.cacheNode(i,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,r,i){let s=!1,o=t;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),r!=null&&o===r?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&k(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,r,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ct(this.data[0],(t,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(t):r.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(k(r.__children,i=>{t+=1,i.__children&&(t+=this.countChildren(i))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var r;return((r=e.__children)===null||r===void 0?void 0:r[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((t=r.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let r=t;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),r||(r=this.mockNode()),s.__children.push(r),this.rewriteCache();const o=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,t,r){let i=r,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[t]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),s=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(Le(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),Le(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const s=this.getRowIndex(r),o=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,o+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),t&&this.hot.render()}filterData(e,t,r){const i=[];k(r,s=>{i.push(this.getDataObject(s))}),k(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,t,r){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?r?s.__children.splice(o,t,...r):s.__children.splice(o,t):r?this.data.splice(o,t,...r):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,r=t;do r=this.getRowParent(r),r!==null&&(t=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,r,i){const s=t===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>t;let c=s?this.getRowParent(t-1):this.getRowParent(t);c==null&&(c=this.getRowParent(t-1)),c==null&&(c=this.getDataObject(t-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(t),c.__children=[]);const h=s||r||i?c.__children.length:this.getRowIndexWithinParent(t),d=o===c;c.__children.splice(h,0,l[0]),o.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function Tz(n,e,t){return(e=Dke(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Dke(n){var e=Fke(n,"string");return typeof e=="symbol"?e:e+""}function Fke(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class pV{constructor(e,t){Tz(this,"hot",void 0),Tz(this,"plugin",void 0),this.hot=t,this.plugin=e}}class Ll extends pV{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getDataObject(r);if(!i)return;const s=this.dataManager.getRowLevel(r),o=t.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(k(l,c=>{c&&o.removeChild(c)}),ee(t,Ll.CSS_CLASSES.indicatorContainer),s){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);o.innerHTML="",Le(0,s-1,()=>{const d=c.createElement("SPAN");ee(d,Ll.CSS_CLASSES.emptyIndicator),o.appendChild(d)}),o.appendChild(h)}if(this.dataManager.hasChildren(i)){const c=this.hot.rootDocument.createElement("DIV");u&&Pe(c,[fg()]),ee(t,Ll.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(ee(c,`${Ll.CSS_CLASSES.button} ${Ll.CSS_CLASSES.expandButton}`),u&&Pe(t,[Yo(!1)])):(ee(c,`${Ll.CSS_CLASSES.button} ${Ll.CSS_CLASSES.collapseButton}`),u&&Pe(t,[Yo(!0)])),o.appendChild(c)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount);let r=11;this.hot.stylesHandler.isClassicTheme()||(r=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*t+25),this.hot.render()}}class kke extends pV{constructor(e,t){var r;super(e,t),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),k(r.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(r.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,s)=>{Le(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&k(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];k(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),r&&this.trimRows(i),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return k(e,s=>{i.push(s),t&&this.collapseChildRows(s,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);k(i.__children,s=>{const o=this.dataManager.getRowIndex(s);t.push(o),this.collapseChildRows(o,t)})}r&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return k(e,s=>{i.push(s),t&&this.expandChildRows(s,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);k(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);t.push(o),this.expandChildRows(o,t)}})}r&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&k(s.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];k(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),r&&this.untrimRows(i),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];k(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];k(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{k(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{k(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&k(t.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return r=!1,!1}),r}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const r=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const r=this.translateTrimmedRow(t.row);Be(e.target,Ll.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),la(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.view.adjustElementsSize(),this.hot.render()}}function Vke(n,e,t){$ke(n,e),e.set(n,t)}function $ke(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uke(n,e,t){return(e=Bke(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Bke(n){var e=Wke(n,"string");return typeof e=="symbol"?e:e+""}function Wke(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jke(n,e){return n.get(zke(n,e))}function zke(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var bz=new WeakMap;class Gke extends pV{constructor(){super(...arguments),Uke(this,"dataManager",this.plugin.dataManager),Vke(this,bz,{row_above:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(lF)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedActive()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedActive();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(uF)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedActive())},disabled:()=>{const r=this.hot.getSelectedActive(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Le(0,e.items.length-1,r=>{if(r===0)return k(t,(i,s)=>{e.items.splice(r+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Le(0,e.items.length-1,t=>{const r=jke(bz,this)[e.items[t].key];r!=null&&(e.items[t].callback=r)}),e}}function vR(n,e,t){return(e=Yke(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yke(n){var e=Kke(n,"string");return typeof e=="symbol"?e:e+""}function Kke(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Xke{constructor(e){vR(this,"plugin",void 0),vR(this,"hot",void 0),vR(this,"dataManager",void 0),vR(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=r===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const g=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(g,a),g}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(o,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,r,i,i&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:r,dropIndex:i,movePossible:s}=e;let o=!1;return fn(i)&&(wt(Lt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,r,i,s,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let r=this.dataManager.getRowParent(e?t-1:t);return r==null&&(r=this.dataManager.getRowParent(t-1)),r}shiftCollapsibleParentsLocations(e,t,r){r||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,r){const i=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,t,this.movedToCollapsed,i)})})}moveCellsMeta(e,t){const r=[],i=Math.max(...e)<t;e.forEach(s=>{r.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(i?r.length:0),0,...r)}selectCells(e,t){const r=e.length;let i=0,s=0;if(this.movedToCollapsed){let o=null;e[r-1]<t?o=this.dataManager.translateTrimmedRow(t-r):o=this.dataManager.translateTrimmedRow(t);const a=this.dataManager.getRowParent(o===null?this.hot.countSourceRows()-1:o-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),s=i}else e[r-1]<t?(s=t-1,i=s-r+1):(i=t,s=i+r-1);this.hot.selectCells([[i,0,s,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}}function qke(n,e){$7(n,e),e.add(n)}function Az(n,e,t){$7(n,e),e.set(n,t)}function $7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JO(n,e,t){return(e=Qke(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qke(n){var e=Zke(n,"string");return typeof e=="symbol"?e:e+""}function Zke(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jT(n,e){return n.get(Ar(n,e))}function D0(n,e,t){return n.set(Ar(n,e),t),t}function Ar(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const F0="nestedRows",Jke=300,Nz=F0,eVe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var LN=new WeakMap,im=new WeakMap,$r=new WeakSet;class tVe extends yt{constructor(){super(...arguments),qke(this,$r),JO(this,"dataManager",null),JO(this,"headersUI",null),JO(this,"collapsedRowsMap",null),Az(this,LN,!1),Az(this,im,!1)}static get PLUGIN_KEY(){return F0}static get PLUGIN_PRIORITY(){return Jke}isEnabled(){return!!this.hot.getSettings()[F0]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new SC),this.dataManager=new Hke(this,this.hot),this.collapsingUI=new kke(this,this.hot),this.headersUI=new Ll(this,this.hot),this.contextMenuUI=new Gke(this,this.hot),this.rowMoveController=new Xke(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,mVe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,pVe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,iVe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,sVe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,oVe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,rVe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,uVe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,lVe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,cVe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,hVe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,dVe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,fVe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,aVe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,gVe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ar($r,e,nVe).call(e,...r)}),this.addHook("beforeLoadData",t=>Ar($r,this,Mz).call(this,t)),this.addHook("beforeUpdateData",t=>Ar($r,this,Mz).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeActive())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:Nz,relativeToGroup:od,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Nz)}disableCoreAPIModifiers(){D0(im,this,!0)}enableCoreAPIModifiers(){D0(im,this,!1)}onModifyRowData(e){if(!jT(im,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!jT(im,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,r){return jT(im,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,r),!1)}destroy(){super.destroy()}}function nVe(n,e,t,r){return this.rowMoveController.onBeforeRowMove(n,e,t,r)}function rVe(n,e,t){this.collapsingUI.toggleState(n,e,t)}function iVe(n,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(n,e,t),D0(LN,this,!0),this.dataManager.getData().slice()}function sVe(n){return this.contextMenuUI.appendOptions(n)}function oVe(n,e){this.headersUI.appendLevelIndicators(n,e)}function aVe(n){return Math.max(this.headersUI.rowHeaderWidthCache,n)}function lVe(n,e,t,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{D0(LN,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function uVe(n,e,t){const r=Array.from(t.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));t.length=0,t.push(...r)}function cVe(){this.collapsingUI.collapsedRowsStash.stash()}function hVe(n,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function dVe(){this.collapsingUI.collapsedRowsStash.stash()}function fVe(n,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function gVe(){this.dataManager.rewriteCache()}function mVe(){this.headersUI.updateRowHeaderWidth()}function pVe(n,e){jT(LN,this)&&(e.skipRender=!0)}function Mz(n){if(!QX(n)){ED(eVe),this.hot.getSettings()[F0]=!1,this.disablePlugin();return}this.dataManager.setData(n),this.dataManager.rewriteCache()}function vVe(n,e){U7(n,e),e.add(n)}function jc(n,e,t){U7(n,e),e.set(n,t)}function U7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(n,e){return n.get(Oy(n,e))}function Sl(n,e,t){return n.set(Oy(n,e),t),t}function Oy(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const wVe=`
<div data-ref="container" class="ht-pagination handsontable">
  <div class="ht-pagination__inner">
    <div data-ref="pageSizeSection" class="ht-page-size-section">
      <span data-ref="pageSizeLabel" class="ht-page-size-section__label"></span>
      <div class="ht-page-size-section__select-wrapper">
        <select data-ref="pageSizeSelect" name="pageSize" data-hot-input></select>
      </div>
    </div>
    <div data-ref="pageCounterSection" class="ht-page-counter-section"></div>
    <nav data-ref="pageNavSection" class="ht-page-navigation-section">
      <button data-ref="first" class="ht-page-navigation-section__button ht-page-first"></button>
      <button data-ref="prev" class="ht-page-navigation-section__button ht-page-prev"></button>
      <span data-ref="pageNavLabel" class="ht-page-navigation-section__label"></span>
      <button data-ref="next" class="ht-page-navigation-section__button ht-page-next"></button>
      <button data-ref="last" class="ht-page-navigation-section__button ht-page-last"></button>
    </nav>
  </div>
</div>
`;var qm=new WeakMap,cf=new WeakMap,e_=new WeakMap,pi=new WeakMap,sm=new WeakMap,bo=new WeakMap,t_=new WeakMap,n_=new WeakMap,wR=new WeakSet;class B7{constructor(e){let{rootElement:t,uiContainer:r,isRtl:i,themeName:s,phraseTranslator:o,shouldHaveBorder:a,a11yAnnouncer:l}=e;vVe(this,wR),jc(this,qm,void 0),jc(this,cf,void 0),jc(this,e_,!1),jc(this,pi,void 0),jc(this,sm,void 0),jc(this,bo,void 0),jc(this,t_,void 0),jc(this,n_,void 0),Sl(qm,this,t),Sl(cf,this,r),Sl(e_,this,i),Sl(sm,this,s),Sl(bo,this,o),Sl(t_,this,a),Sl(n_,this,l),this.install()}install(){var e;if((e=vt(pi,this))!==null&&e!==void 0&&e.container)return;const t=D5`${wVe}`,{container:r,first:i,prev:s,next:o,last:a,pageSizeSelect:l}=t.refs;Sl(pi,this,t.refs),r.setAttribute("dir",vt(e_,this)?"rtl":"ltr");const u=h=>h.currentTarget.disabled,c=(h,d,f)=>{d.addEventListener(h,m=>{u(m)||f()})};c("click",i,()=>this.runLocalHooks("firstPageClick")),c("focus",i,()=>this.runLocalHooks("focus",i)),c("click",s,()=>this.runLocalHooks("prevPageClick")),c("focus",s,()=>this.runLocalHooks("focus",s)),c("click",o,()=>this.runLocalHooks("nextPageClick")),c("focus",o,()=>this.runLocalHooks("focus",o)),c("click",a,()=>this.runLocalHooks("lastPageClick")),c("focus",a,()=>this.runLocalHooks("focus",a)),c("focus",l,()=>this.runLocalHooks("focus",l)),l.addEventListener("change",()=>{const h=l.value==="auto"?"auto":Number.parseInt(l.value,10);this.runLocalHooks("pageSizeChange",h)}),this.setCounterSectionVisibility(!1),this.setNavigationSectionVisibility(!1),this.setPageSizeSectionVisibility(!1),vt(cf,this)?(vt(cf,this).appendChild(t.fragment),ee(r,[vt(sm,this),"handsontable"])):vt(qm,this).after(t.fragment)}getContainer(){return vt(pi,this).container}getFocusableElements(){const{first:e,prev:t,next:r,last:i,pageSizeSelect:s}=vt(pi,this);return[s,e,t,r,i].filter(o=>!o.disabled)}updateWidth(e){return vt(pi,this).container.style.width=`${e}px`,this}updateTheme(e){if(Sl(sm,this,e),vt(cf,this)){const{container:t}=vt(pi,this);Me(t,/ht-theme-.*/g),vt(sm,this)&&ee(t,vt(sm,this))}return this}getHeight(){return vt(pi,this).container.offsetHeight}refreshBorderState(){const{container:e}=vt(pi,this);return vt(cf,this)||vt(t_,this).call(this)?ee(e,"ht-pagination--bordered"):Me(e,"ht-pagination--bordered"),this}updateState(e){let{currentPage:t,totalPages:r,firstVisibleRowIndex:i,lastVisibleRowIndex:s,totalRenderedRows:o,pageSizeList:a,pageSize:l,autoPageSize:u}=e;const{first:c,prev:h,next:d,last:f,pageCounterSection:m,pageNavSection:g,pageNavLabel:C,pageSizeSelect:y,pageSizeLabel:w}=vt(pi,this),S=vt(bo,this).call(this,zF,{start:i+1,end:s+1,total:o}),E=vt(bo,this).call(this,GF,{currentPage:t,totalPages:r}),P=vt(bo,this).call(this,t0);m.textContent=S,C.textContent=E,y.textContent="",w.textContent=`${P}:`,Pe(g,[io(vt(bo,this).call(this,WF))]),Pe(y,[io(vt(bo,this).call(this,t0)),ys(-1)]),vt(n_,this).call(this,E),this.refreshBorderState(),a.forEach(D=>{const Q=D==="auto"?vt(bo,this).call(this,jF):D,F=new Option(Q,D);(u&&D==="auto"||!u&&D===l)&&(F.selected=!0),y.add(F)});const _=t===1,I=t===r;if(g.style.display!=="none"){const D=vt(qm,this).ownerDocument.activeElement;_?(ee(c,"ht-page-navigation-section__button--disabled"),ee(h,"ht-page-navigation-section__button--disabled"),c.disabled=!0,h.disabled=!0):(Me(c,"ht-page-navigation-section__button--disabled"),Me(h,"ht-page-navigation-section__button--disabled"),c.disabled=!1,h.disabled=!1),I?(ee(d,"ht-page-navigation-section__button--disabled"),ee(f,"ht-page-navigation-section__button--disabled"),d.disabled=!0,f.disabled=!0):(Me(d,"ht-page-navigation-section__button--disabled"),Me(f,"ht-page-navigation-section__button--disabled"),d.disabled=!1,f.disabled=!1),[c,h,d,f].includes(D)&&(h.disabled?d.focus():d.disabled&&h.focus())}return Pe(c,[io(vt(bo,this).call(this,YF)),Vw(_),ys(-1)]),Pe(h,[io(vt(bo,this).call(this,KF)),Vw(_),ys(-1)]),Pe(d,[io(vt(bo,this).call(this,XF)),Vw(I),ys(-1)]),Pe(f,[io(vt(bo,this).call(this,qF)),Vw(I),ys(-1)]),this}setPageSizeSectionVisibility(e){const{pageSizeSection:t,pageSizeSelect:r}=vt(pi,this);return t.style.display=e?"":"none",r.disabled=!e,Oy(wR,this,r_).call(this),this}setCounterSectionVisibility(e){return vt(pi,this).pageCounterSection.style.display=e?"":"none",Oy(wR,this,r_).call(this),this}setNavigationSectionVisibility(e){const{pageNavSection:t,first:r,prev:i,next:s,last:o}=vt(pi,this);return t.style.display=e?"":"none",r.disabled=!e,i.disabled=!e,s.disabled=!e,o.disabled=!e,Oy(wR,this,r_).call(this),this}destroy(){var e;(e=vt(pi,this))===null||e===void 0||e.container.remove(),Sl(pi,this,null)}}function r_(){const{container:n,pageSizeSection:e,pageCounterSection:t,pageNavSection:r}=vt(pi,this),i=e.style.display!=="none"||t.style.display!=="none"||r.style.display!=="none";vt(cf,this)||(i?ee(vt(qm,this).querySelector(".ht-wrapper"),"htPagination"):Me(vt(qm,this).querySelector(".ht-wrapper"),"htPagination")),n.style.display=i?"":"none"}Vt(B7,Hr);const yVe=["nestedRows","mergeCells","fixedRowsTop","fixedRowsBottom"];function SVe(n){return yVe.some(e=>{const t=!!n[e];return t&&wt(Lt`The \`pagination\` plugin cannot be used with the \`${e}\` option.\x20
                        This combination is not supported. The plugin will remain disabled.`),t})}let ro=null,zT=0;function CVe(n){const e=n.ownerDocument;if(!ro){ro=e.createElement("div"),ro.setAttribute("role","status"),ro.setAttribute("aria-live","assertive"),ro.setAttribute("aria-atomic","true");const t=ro.style;t.position="absolute",t.width="1px",t.height="1px",t.margin="-1px",t.overflow="hidden",t.clipPath="rect(0 0 0 0)",t.whiteSpace="nowrap",n.appendChild(ro)}zT+=1}function EVe(){zT!==0&&(zT===1&&(ro.remove(),ro=null),zT-=1)}function RVe(n){ro&&(ro.textContent="",setTimeout(()=>{ro&&(ro.textContent=n)},100))}function i_(n,e,t){return(e=TVe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TVe(n){var e=bVe(n,"string");return typeof e=="symbol"?e:e+""}function bVe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class AVe{constructor(){i_(this,"pageSize",1),i_(this,"totalItems",0),i_(this,"totalPages",0)}calculate(e){let{pageSize:t,totalItems:r}=e;this.pageSize=Math.max(t,1),this.totalItems=r,this.totalPages=Math.max(1,Math.ceil(this.totalItems/this.pageSize))}getTotalPages(){return this.totalPages}getState(e){if(e-=1,e<0||e>=this.getTotalPages())return;const t=e*this.pageSize,r=Math.max(0,Math.min(t+this.pageSize-1,this.totalItems-1));return{startIndex:t,endIndex:r,pageSize:this.pageSize}}}function NVe(n,e,t){return(e=MVe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function MVe(n){var e=IVe(n,"string");return typeof e=="symbol"?e:e+""}function IVe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class OVe{constructor(){NVe(this,"pages",[])}calculate(e){let{itemsSizeProvider:t,viewportSizeProvider:r}=e;const i=t(),s=r(),o=[];let a=0,l=1,u=0;for(let c=0;c<i.length;c++){const h=i[c];u>0&&l+h>=s&&(o.push({startIndex:a,endIndex:c-1,pageSize:u}),a=c,l=1,u=0),l+=h,u+=1}o.push({startIndex:a,endIndex:Math.max(0,i.length-1),pageSize:u}),this.pages=o}getTotalPages(){return this.pages.length}getState(e){if(e-=1,!(e<0||e>=this.getTotalPages()))return this.pages[e]}}const Iz=new Map([["fixed",AVe],["auto",OVe]]);function Oz(n){if(!Iz.has(n))throw new Error(`Unknown pagination strategy type: ${n}`);const e=Iz.get(n);return new e}function _Ve(n){let{focusableElements:e}=n;return Kk({initialPage:0,size:()=>e().length,onItemSelect:r=>{e()[r].focus()}})}function vV(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=_z(n),i=_z(n);return r.addEventListener("focus",()=>t==null?void 0:t.onFocus("from_above")),i.addEventListener("focus",()=>t==null?void 0:t.onFocus("from_below")),e.prepend(r),e.append(i),{focus(s){s==="from_above"?r.focus():i.focus()},activate(){n._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){n._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function _z(n){const t=n.rootDocument.createElement("input");return t.type="text",t.name="htFocusCatcher",t.classList.add("htFocusCatcher"),n.getSettings().ariaTags&&Pe(t,[io("Focus catcher")]),t}function PVe(n,e){W7(n,e),e.add(n)}function Cl(n,e,t){W7(n,e),e.set(n,t)}function W7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ce(n,e){return n.get(Dt(n,e))}function Mr(n,e,t){return n.set(Dt(n,e),t),t}function Dt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Qm="pagination",xVe=900,j7=Qm,Bp=`plugin:${Qm}`,Pz=Lt`The \`auto\` page size setting requires the \`autoRowSize\`\x20
  plugin to be enabled. Set the \`autoRowSize: true\` in the configuration to ensure correct behavior.`;var _y=new WeakMap,Ci=new WeakMap,Ma=new WeakMap,yn=new WeakMap,Do=new WeakMap,k0=new WeakMap,GT=new WeakMap,so=new WeakMap,ka=new WeakMap,jt=new WeakSet,s_=new WeakMap;class LVe extends yt{constructor(){super(...arguments),PVe(this,jt),Cl(this,_y,null),Cl(this,Ci,1),Cl(this,Ma,10),Cl(this,yn,null),Cl(this,Do,null),Cl(this,k0,!1),Cl(this,GT,!1),Cl(this,so,null),Cl(this,ka,null),Cl(this,s_,()=>{var e;!Ce(k0,this)&&(e=this.hot)!==null&&e!==void 0&&e.view&&Dt(jt,this,Of).call(this)})}static get PLUGIN_KEY(){return Qm}static get PLUGIN_PRIORITY(){return xVe}static get DEFAULT_SETTINGS(){return{pageSize:10,pageSizeList:["auto",5,10,20,50,100],initialPage:1,showPageSize:!0,showCounter:!0,showNavigation:!0,uiContainer:null}}isEnabled(){return!!this.hot.getSettings()[Qm]}enablePlugin(){var e,t=this;if(SVe(this.hot.getSettings())){this.hot.getSettings()[Qm]=!1;return}if(this.enabled)return;const r=this.hot.getSettings()[Qm];(r==null?void 0:r.initialPage)!==void 0&&Mr(Ci,this,this.getSetting("initialPage")),(r==null?void 0:r.pageSize)!==void 0&&Mr(Ma,this,this.getSetting("pageSize")),Mr(_y,this,this.hot.rowIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding",!1)),Ce(Ma,this)==="auto"&&!((e=this.hot.getPlugin("autoRowSize"))!==null&&e!==void 0&&e.enabled)&&wt(Pz),Mr(Do,this,Oz(Ce(Ma,this)==="auto"?"auto":"fixed")),Ce(yn,this)||(Mr(yn,this,new B7({rootElement:this.hot.rootGridElement,uiContainer:this.getSetting("uiContainer"),isRtl:this.hot.isRtl(),themeName:this.hot.getSettings().themeName,phraseTranslator:function(){return t.hot.getTranslatedPhrase(...arguments)},shouldHaveBorder:()=>Dt(jt,this,kVe).call(this),a11yAnnouncer:i=>RVe(i)})),Dt(jt,this,xz).call(this),Ce(yn,this).addLocalHook("firstPageClick",()=>this.firstPage()).addLocalHook("prevPageClick",()=>this.prevPage()).addLocalHook("nextPageClick",()=>this.nextPage()).addLocalHook("lastPageClick",()=>this.lastPage()).addLocalHook("pageSizeChange",i=>this.setPageSize(i)).addLocalHook("focus",i=>{Ce(so,this).setCurrentPage(Ce(yn,this).getFocusableElements().indexOf(i)),this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName(Bp),this.hot.listen(),Ce(ka,this).deactivate()})),Ce(so,this)||Mr(so,this,_Ve({focusableElements:()=>Ce(yn,this).getFocusableElements()})),Ce(ka,this)||Mr(ka,this,vV(this.hot,Ce(yn,this).getContainer(),{onFocus:i=>{this.hot.getShortcutManager().setActiveContextName(Bp),this.hot.listen(),i==="from_above"?Ce(so,this).toFirstItem():Ce(so,this).toLastItem(),Ce(ka,this).deactivate()}})),Dt(jt,this,HVe).call(this),Dt(jt,this,DVe).call(this),this.addHook("init",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,GVe).call(t,...s)},-1),this.addHook("beforeSelectAll",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,Lz).call(t,...s)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,Lz).call(t,...s)}),this.addHook("beforeSetRangeEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,VVe).call(t,...s)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,$Ve).call(t,...s)}),this.addHook("beforePaste",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,UVe).call(t,...s)}),this.addHook("afterViewRender",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,WVe).call(t,...s)}),this.addHook("afterRender",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,jVe).call(t,...s)}),this.addHook("afterScrollVertically",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,YVe).call(t,...s)}),this.addHook("afterLanguageChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,KVe).call(t,...s)}),this.addHook("modifyRowHeight",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,BVe).call(t,...s)}),this.addHook("beforeHeightChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,zVe).call(t,...s)}),this.addHook("afterSetTheme",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,XVe).call(t,...s)}),this.addHook("afterDialogShow",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,qVe).call(t,...s)}),this.addHook("beforeDialogHide",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Dt(jt,t,QVe).call(t,...s)}),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",Ce(s_,this)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),Dt(jt,this,Of).call(this),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",Ce(s_,this)).unregisterMap(this.pluginName),Ce(yn,this).destroy(),Mr(yn,this,null),Dt(jt,this,FVe).call(this),super.disablePlugin()}getPaginationData(){const e=Ce(Do,this).getTotalPages();let t=-1,r=-1;const{pageSize:i,startIndex:s}=Ce(Do,this).getState(Ce(Ci,this)),o=this.hot.countRows();let a=0;for(let l=s;a<i&&!(l>=o);l++)this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(l))||(t===-1&&(t=l),r=l,a+=1);return{currentPage:Ce(Ci,this),totalPages:e,pageSize:i,pageSizeList:[...this.getSetting("pageSizeList")],autoPageSize:Ce(Ma,this)==="auto",numberOfRenderedRows:this.hot.rowIndexMapper.getRenderableIndexesLength(),firstVisibleRowIndex:t,lastVisibleRowIndex:r}}setPage(e){const t=Ce(Ci,this);this.hot.runHooks("beforePageChange",t,e)!==!1&&(Mr(Ci,this,e),Dt(jt,this,Of).call(this),this.hot.scrollViewportTo({row:0}),this.hot.runHooks("afterPageChange",t,Ce(Ci,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPage(){this.setPage(this.getSetting("initialPage"))}setPageSize(e){var t;const r=Ce(Ma,this);this.hot.runHooks("beforePageSizeChange",r,e)!==!1&&(e==="auto"&&!((t=this.hot.getPlugin("autoRowSize"))!==null&&t!==void 0&&t.enabled)&&wt(Pz),Mr(Do,this,Oz(e==="auto"?"auto":"fixed")),Mr(Ma,this,e),Dt(jt,this,Of).call(this),this.hot.runHooks("afterPageSizeChange",r,Ce(Ma,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPageSize(){this.setPageSize(this.getSetting("pageSize"))}resetPagination(){this.resetPage(),this.resetPageSize(),Dt(jt,this,xz).call(this)}nextPage(){this.setPage(Ce(Ci,this)+1)}prevPage(){this.setPage(Ce(Ci,this)-1)}firstPage(){this.setPage(1)}lastPage(){this.setPage(Ce(Do,this).getTotalPages())}hasPreviousPage(){return Ce(Ci,this)>1}hasNextPage(){return Ce(Ci,this)<Ce(Do,this).getTotalPages()}getCurrentPageData(){const{firstVisibleRowIndex:e,lastVisibleRowIndex:t}=this.getPaginationData();return e===-1||t===-1?[]:this.hot.getData(e,0,t,this.hot.countCols()-1)}showPageSizeSection(){Ce(yn,this).setPageSizeSectionVisibility(!0),this.hot.runHooks("afterPageSizeVisibilityChange",!0)}hidePageSizeSection(){Ce(yn,this).setPageSizeSectionVisibility(!1),this.hot.runHooks("afterPageSizeVisibilityChange",!1)}showPageCounterSection(){Ce(yn,this).setCounterSectionVisibility(!0),this.hot.runHooks("afterPageCounterVisibilityChange",!0)}hidePageCounterSection(){Ce(yn,this).setCounterSectionVisibility(!1),this.hot.runHooks("afterPageCounterVisibilityChange",!1)}showPageNavigationSection(){Ce(yn,this).setNavigationSectionVisibility(!0),this.hot.runHooks("afterPageNavigationVisibilityChange",!0)}hidePageNavigationSection(){Ce(yn,this).setNavigationSectionVisibility(!1),this.hot.runHooks("afterPageNavigationVisibilityChange",!1)}destroy(){var e;Mr(_y,this,null),Mr(Do,this,null),(e=Ce(yn,this))===null||e===void 0||e.destroy(),Mr(yn,this,null),super.destroy()}}function HVe(){this.eventManager.addEventListener(this.hot.rootDocument,"mouseup",n=>{!Ce(yn,this).getContainer().contains(n.target)&&this.hot.getShortcutManager().getActiveContextName()===Bp&&(Ce(ka,this).activate(),Ce(so,this).clear(),this.hot.getShortcutManager().setActiveContextName("grid"))})}function DVe(){var n;const e=this.hot.getShortcutManager();((n=e.getContext(Bp))!==null&&n!==void 0?n:e.addContext(Bp,"global")).addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:r=>{let i=Ce(so,this).getCurrentPage();if(r.shiftKey){Ce(so,this).toPreviousItem();const s=Ce(so,this).getCurrentPage();if(s>=i){Dt(jt,this,Hz).call(this);return}i=s}else{Ce(so,this).toNextItem();const s=Ce(so,this).getCurrentPage();if(s<=i){Dt(jt,this,Hz).call(this);return}i=s}r.preventDefault()},group:j7})}function FVe(){this.hot.getShortcutManager().getContext(Bp).removeShortcutsByGroup(j7)}function xz(){this.getSetting("showPageSize")?this.showPageSizeSection():this.hidePageSizeSection(),this.getSetting("showCounter")?this.showPageCounterSection():this.hidePageCounterSection(),this.getSetting("showNavigation")?this.showPageNavigationSection():this.hidePageNavigationSection()}function Of(){Mr(k0,this,!0),Ce(_y,this).clear();const n=this.hot.rowIndexMapper.getRenderableIndexes(),e=n.length,{stylesHandler:t}=this.hot;Ce(Do,this).calculate({pageSize:Ce(Ma,this),totalItems:e,viewportSizeProvider:()=>{const{view:s}=this.hot;if(s.isVerticallyScrollableByWindow()){const a=getComputedStyle(this.hot.rootDocument.body),l=Number.parseInt(a.marginTop,10)+Number.parseInt(a.marginBottom,10),u=this.hot.hasColHeaders()?s._wt.wtTable.getColumnHeaderHeight():0,c=Ce(yn,this).getHeight();return s.getWorkspaceHeight()-c-u-l}const o=s.hasHorizontalScroll()?ar():0;return s.getViewportHeight()-o},itemsSizeProvider:()=>{const s=t.getDefaultRowHeight();return this.hot.rowIndexMapper.getRenderableIndexes().map(a=>{var l;return(l=this.hot.getRowHeight(this.hot.toVisualRow(a)))!==null&&l!==void 0?l:s})}});const r=Ce(Do,this).getTotalPages();if(Mr(Ci,this,ft(Ce(Ci,this),1,r)),n.length>0){const{startIndex:s,pageSize:o}=Ce(Do,this).getState(Ce(Ci,this));n.splice(s,o)}n.length>0?this.hot.batchExecution(()=>{n.forEach(s=>Ce(_y,this).setValueAtIndex(s,!0))},!0):this.hot.rowIndexMapper.updateCache(!0),Mr(k0,this,!1);const i=this.getPaginationData();Ce(yn,this).updateState({...i,totalRenderedRows:e}),(this.getSetting("showPageSize")||this.getSetting("showNavigation"))&&i.totalPages>1?Ce(ka,this).activate():Ce(ka,this).deactivate()}function kVe(){if(!this.hot.view)return!0;const{view:n}=this.hot;if(n.isVerticallyScrollableByWindow())return!1;if(n.hasHorizontalScroll()||n.getTableHeight()<n.getWorkspaceHeight())return!0;const{lastVisibleRowIndex:e}=this.getPaginationData();return n.getLastFullyVisibleRow()!==e}function Lz(n,e){const{firstVisibleRowIndex:t,lastVisibleRowIndex:r}=this.getPaginationData();(Ce(Ci,this)>1||n.row>=0)&&(n.row=t),e.row=r}function VVe(n){if(this.hot.selection.isSelectedByColumnHeader()){const{lastVisibleRowIndex:e}=this.getPaginationData();n.row=e}}function $Ve(){if(!this.hot.getSettings().navigableHeaders)return;const n=this.hot.getSelectedRangeLast();if(!n.isSingle()){const{highlight:e}=n;e.row=ft(e.row,n.getTopStartCorner().row,n.getBottomEndCorner().row)}}function UVe(n,e){const{firstVisibleRowIndex:t,lastVisibleRowIndex:r}=this.getPaginationData();if(t===-1||r===-1)return!1;e.forEach(i=>{let{startRow:s}=i;if(n.length===0)return;const o=Math.min(n.length-(r-s+1),n.length);n.splice(0,o)})}function BVe(n,e){if(n===void 0||!Ce(Do,this).getState(Ce(Ci,this)))return;const{firstVisibleRowIndex:t}=this.getPaginationData();return e!==0&&e===t&&(n+=1),n}function WVe(){if(Ce(Ma,this)!=="auto"||Ce(GT,this)){Mr(GT,this,!1);return}Dt(jt,this,Of).call(this),Mr(GT,this,!0),this.hot.view.adjustElementsSize(),this.hot.render()}function jVe(){const{view:n}=this.hot,e=n.isHorizontallyScrollableByWindow()?n.getTotalTableWidth():n.getWorkspaceWidth();Ce(yn,this).updateWidth(e).refreshBorderState()}function zVe(n){return this.getSetting("uiContainer")||!(typeof n=="number"||typeof n=="string"&&/^\d+$/.test(n)||typeof n=="string"&&n.endsWith("px"))?n:`calc(${typeof n=="string"&&n.endsWith("px")?n:`${n}px`} - ${Ce(yn,this).getHeight()}px)`}function GVe(){Ce(Ma,this)!=="auto"&&Dt(jt,this,Of).call(this)}function YVe(){Ce(yn,this).refreshBorderState()}function KVe(){Dt(jt,this,Of).call(this)}function XVe(n){Ce(yn,this).updateTheme(n)}function Hz(){Ce(ka,this).activate(),Ce(so,this).clear(),this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName("grid")}function qVe(){Ce(ka,this).deactivate()}function QVe(){Ce(ka,this).activate()}function o_(n,e,t){return(e=ZVe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ZVe(n){var e=JVe(n,"string");return typeof e=="symbol"?e:e+""}function JVe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class e$e{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;o_(this,"rootWindow",void 0),o_(this,"prefix",void 0),o_(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const r=typeof e>"u"?t:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){k(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function t$e(n,e,t){return(e=n$e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function n$e(n){var e=r$e(n,"string");return typeof e=="symbol"?e:e+""}function r$e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}we.getSingleton().register("persistentStateSave");we.getSingleton().register("persistentStateLoad");we.getSingleton().register("persistentStateReset");const Dz="persistentState",i$e=0,Fz=new WeakSet;class s$e extends yt{constructor(){super(...arguments),t$e(this,"storage",void 0)}static get PLUGIN_KEY(){return Dz}static get PLUGIN_PRIORITY(){return i$e}isEnabled(){return!!this.hot.getSettings()[Dz]}enablePlugin(){this.enabled||(Fz.has(this.hot)||(Fz.add(this.hot),j9("The PersistentState plugin is deprecated and will be removed in version 17.0. Please update your settings to ensure compatibility with future versions.")),this.storage||(this.storage=new e$e(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function o$e(n,e){a$e(n,e),e.add(n)}function a$e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a_(n,e,t){return(e=l$e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function l$e(n){var e=u$e(n,"string");return typeof e=="symbol"?e:e+""}function u$e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function kz(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const l_="search",c$e=190,h$e="htSearchResult",d$e=function(n,e,t,r,i){n.getCellMeta(e,t).isSearchResult=i},f$e=function(n,e,t){return fn(n)||n===null||!n.toLocaleLowerCase||n.length===0||fn(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};var u_=new WeakSet;class g$e extends yt{constructor(){super(...arguments),o$e(this,u_),a_(this,"callback",d$e),a_(this,"queryMethod",f$e),a_(this,"searchResultClass",h$e)}static get PLUGIN_KEY(){return l_}static get PLUGIN_PRIORITY(){return c$e}isEnabled(){return this.hot.getSettings()[l_]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[l_];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return kz(u_,e,Vz).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return kz(u_,e,Vz).call(e,...i)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return Le(0,i-1,l=>{Le(0,s-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||t,m=(h.search.queryMethod||r)(e,c,h);if(m){const g={row:l,col:u,data:c};o.push(g)}d&&d(a,l,u,c,m)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){je(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function Vz(n,e,t,r,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function yR(n,e,t){return(e=m$e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function m$e(n){var e=p$e(n,"string");return typeof e=="symbol"?e:e+""}function p$e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class z7{constructor(e){yR(this,"viewportWidth",void 0),yR(this,"overwriteColumnWidthFn",void 0),yR(this,"baseWidths",new Map),yR(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:t}=e;this.viewportWidth=t,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,t){this.baseWidths.set(e,t)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class v$e extends z7{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],s=[];let o=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),m=this.overwriteColumnWidthFn(f,d);f===m&&f>=Vp?(i.push([d,m]),a+=m):f!==m&&(i.push([d,m]),s.push(d),o-=m)}),o<=Vp){this.stretchedWidths.clear();return}const l=o/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,m]=h,g=m;s.includes(f)||(g=Math.round(m*l)),this.stretchedWidths.set(f,g),u=f,d<i.length-1&&(c+=g)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function $z(n,e,t){w$e(n,e),e.set(n,t)}function w$e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c_(n,e){return n.get(G7(n,e))}function SR(n,e,t){return n.set(G7(n,e),t),t}function G7(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var CR=new WeakMap,Cw=new WeakMap;class y$e extends z7{constructor(){super(...arguments),$z(this,CR,0),$z(this,Cw,-1)}prepare(e){super.prepare(e),SR(CR,this,0),SR(Cw,this,-1)}setColumnBaseWidth(e,t){super.setColumnBaseWidth(e,t),SR(Cw,this,e),SR(CR,this,t)}calculate(){if(c_(Cw,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,s]=i;return r+s},0),t=Math.max(this.viewportWidth-e+c_(CR,this),0);this.stretchedWidths.set(c_(Cw,this),t)}}function S$e(n,e){Y7(n,e),e.add(n)}function ER(n,e,t){Y7(n,e),e.set(n,t)}function Y7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sn(n,e){return n.get(Zm(n,e))}function h_(n,e,t){return n.set(Zm(n,e),t),t}function Zm(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const C$e="stretchColumns";var Wr=new WeakMap,om=new WeakMap,d_=new WeakMap,RR=new WeakMap,Ew=new WeakSet;class E$e{constructor(e){S$e(this,Ew),ER(this,Wr,void 0),ER(this,om,void 0),ER(this,d_,new Map([["all",new v$e(Zm(Ew,this,Uz).bind(this))],["last",new y$e(Zm(Ew,this,Uz).bind(this))]])),ER(this,RR,"none"),h_(Wr,this,e),h_(om,this,Sn(Wr,this).columnIndexMapper.createAndRegisterIndexMap(C$e,"physicalIndexToValue"))}useStrategy(e){h_(RR,this,Sn(d_,this).has(e)?e:"none")}refreshStretching(){if(Sn(RR,this)==="none"){Sn(om,this).clear();return}Sn(Wr,this).batchExecution(()=>{Sn(om,this).clear();const e=Sn(d_,this).get(Sn(RR,this));let r=Sn(Wr,this).view.getViewportWidth();Zm(Ew,this,R$e).call(this)&&(r-=ar(Sn(Wr,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Sn(Wr,this).countCols();i++)Sn(Wr,this).columnIndexMapper.isHidden(Sn(Wr,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Zm(Ew,this,T$e).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[s,o]=i;Sn(om,this).setValueAtIndex(Sn(Wr,this).toPhysicalColumn(s),o)})},!0)}getStretchedWidth(e){return Sn(om,this).getValueAtIndex(Sn(Wr,this).toPhysicalColumn(e))}}function R$e(){const{view:n,stylesHandler:e}=Sn(Wr,this);if(n.isVerticallyScrollableByWindow())return!1;const t=n.getViewportHeight(),r=Sn(Wr,this).countRows(),i=e.getDefaultRowHeight();let s=0,o=!1;for(let l=0;l<r;l++){var a;if(!Sn(Wr,this).rowIndexMapper.isHidden(Sn(Wr,this).toPhysicalRow(l))&&(s+=((a=Sn(Wr,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),s>t)){o=!0;break}}return o}function T$e(n){var e;return(e=Sn(Wr,this).getColWidth(n,"StretchColumns"))!==null&&e!==void 0?e:Vp}function Uz(n,e){return Sn(Wr,this).runHooks("beforeStretchingColumnWidth",n,e)}function b$e(n,e){K7(n,e),e.add(n)}function f_(n,e,t){K7(n,e),e.set(n,t)}function K7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g_(n,e,t){return n.set(V0(n,e),t),t}function xu(n,e){return n.get(V0(n,e))}function V0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const A$e="stretchColumns",N$e=155;var Em=new WeakMap,TR=new WeakMap,Rw=new WeakMap,m_=new WeakSet;class M$e extends yt{constructor(){super(...arguments),b$e(this,m_),f_(this,Em,new E$e(this.hot)),f_(this,TR,null),f_(this,Rw,new ResizeObserver(e=>{requestAnimationFrame(()=>{var t;(t=this.hot)!==null&&t!==void 0&&t.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;xu(TR,this)!==null&&xu(TR,this)!==i.width&&(this.hot.view.adjustElementsSize(),this.hot.refreshDimensions()),g_(TR,this,i.width)})})}))}static get PLUGIN_KEY(){return A$e}static get PLUGIN_PRIORITY(){return N$e}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(xu(Em,this).useStrategy(this.hot.getSettings().stretchH),xu(Rw,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return V0(m_,e,O$e).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return V0(m_,e,I$e).call(e,...r)},10),super.enablePlugin())}updatePlugin(){xu(Em,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),xu(Rw,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return xu(Em,this).getStretchedWidth(e)}destroy(){xu(Rw,this).disconnect(),g_(Rw,this,null),g_(Em,this,null),super.destroy()}}function I$e(n,e,t){if(t===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:n}function O$e(n){n&&xu(Em,this).refreshStretching()}function _$e(n,e){P$e(n,e),e.add(n)}function P$e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bR(n,e,t){return(e=x$e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function x$e(n){var e=L$e(n,"string");return typeof e=="symbol"?e:e+""}function L$e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function p_(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const H$e="touchScroll",D$e=200;var AR=new WeakSet;class F$e extends yt{constructor(){super(...arguments),_$e(this,AR),bR(this,"scrollbars",[]),bR(this,"clones",[]),bR(this,"lockedCollection",!1),bR(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return H$e}static get PLUGIN_PRIORITY(){return D$e}static get SETTING_KEYS(){return!0}isEnabled(){return nD()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>p_(AR,this,k$e).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>p_(AR,this,V$e).call(this)),this.addHook("afterMomentumScroll",()=>p_(AR,this,$$e).call(this))}}function k$e(){if(this.lockedCollection)return;const{topOverlay:n,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(n),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function V$e(){this.freezeOverlays=!0,k(this.clones,n=>{ee(n,"hide-tween")})}function $$e(){this.freezeOverlays=!1,k(this.clones,n=>{Me(n,"hide-tween"),ee(n,"show-tween")}),this.hot._registerTimeout(()=>{k(this.clones,n=>{Me(n,"show-tween")})},400),k(this.scrollbars,n=>{n.refresh(),n.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function U$e(n,e){B$e(n,e),e.add(n)}function B$e(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function W$e(n,e,t){return(e=j$e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function j$e(n){var e=z$e(n,"string");return typeof e=="symbol"?e:e+""}function z$e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function G$e(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const YT="trimRows",Y$e=330;var Bz=new WeakSet;class K$e extends yt{constructor(){super(...arguments),U$e(this,Bz),W$e(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return YT}static get PLUGIN_PRIORITY(){return Y$e}isEnabled(){return!!this.hot.getSettings()[YT]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new SC),this.trimmedRowsMap.addLocalHook("init",()=>G$e(Bz,this,X$e).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[YT];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),k(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{k(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",t,i,r,r&&i.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;r&&o&&(k(e,l=>{s[l]=!1}),i=Er(s,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",t,i,r&&o)!==!1&&(r&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",t,i,r&&o,r&&i.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<t)}destroy(){super.destroy()}}function X$e(){const n=this.hot.getSettings()[YT];Array.isArray(n)&&this.hot.batchExecution(()=>{k(n,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function q$e(n,e,t){return(e=Q$e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Q$e(n){var e=Z$e(n,"string");return typeof e=="symbol"?e:e+""}function Z$e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ca{constructor(e){q$e(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function NR(n,e,t){return(e=J$e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function J$e(n){var e=eUe(n,"string");return typeof e=="symbol"?e:e+""}function eUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wV extends ca{constructor(e){let{stateBefore:t,range:r,type:i,alignment:s}=e;super("cell_alignment"),NR(this,"stateBefore",void 0),NR(this,"range",void 0),NR(this,"type",void 0),NR(this,"alignment",void 0),this.stateBefore=t,this.range=r,this.type=i,this.alignment=s}static startRegisteringEvents(e,t){e.addHook("beforeCellAlignment",(r,i,s,o)=>{t.done(()=>new wV({stateBefore:r,range:i,type:s,alignment:o}))})}undo(e,t){k(this.range,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&e.setCellMeta(i,s,"className",this.stateBefore[i][s]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){Qc(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,s,o)=>e.setCellMeta(r,i,s,o)),e.addHookOnce("afterViewRender",t),e.render()}}function Wz(n,e,t){return(e=tUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tUe(n){var e=nUe(n,"string");return typeof e=="symbol"?e:e+""}function nUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class yV extends ca{constructor(e){let{columns:t,finalIndex:r}=e;super("col_move"),Wz(this,"columns",void 0),Wz(this,"finalColumnIndex",void 0),this.columns=t.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,t){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&t.done(()=>new yV({columns:r,finalIndex:i}))})}undo(e,t){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),dV(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),r.moveColumn(a,o)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,t){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function jz(n,e,t){return(e=rUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rUe(n){var e=iUe(n,"string");return typeof e=="symbol"?e:e+""}function iUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class SV extends ca{constructor(e){let{currentSortState:t,newSortState:r}=e;super("col_sort"),jz(this,"previousSortState",void 0),jz(this,"nextSortState",void 0),this.previousSortState=t,this.nextSortState=r}static startRegisteringEvents(e,t){e.addHook("beforeColumnSort",(r,i,s)=>{s&&t.done(()=>new SV({currentSortState:r,newSortState:i}))})}undo(e,t){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),s=i.isEnabled()?i:r;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),t()}redo(e,t){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),t()}}function zz(n,e,t){return(e=sUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sUe(n){var e=oUe(n,"string");return typeof e=="symbol"?e:e+""}function oUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class CV extends ca{constructor(e){let{index:t,amount:r}=e;super("insert_col"),zz(this,"index",void 0),zz(this,"amount",void 0),this.index=t,this.amount=r}static startRegisteringEvents(e,t){e.addHook("afterCreateCol",(r,i,s)=>{t.done(()=>new CV({index:r,amount:i}),s)})}undo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function Gz(n,e,t){return(e=aUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aUe(n){var e=lUe(n,"string");return typeof e=="symbol"?e:e+""}function lUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class EV extends ca{constructor(e){let{index:t,amount:r}=e;super("insert_row"),Gz(this,"index",void 0),Gz(this,"amount",void 0),this.index=t,this.amount=r}static startRegisteringEvents(e,t){e.addHook("afterCreateRow",(r,i,s)=>{t.done(()=>new EV({index:r,amount:i}),s)})}undo(e,t){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function MR(n,e,t){return(e=uUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function uUe(n){var e=cUe(n,"string");return typeof e=="symbol"?e:e+""}function cUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class RV extends ca{constructor(e){let{changes:t,selected:r,countCols:i,countRows:s}=e;super("change"),MR(this,"changes",void 0),MR(this,"selected",void 0),MR(this,"countCols",void 0),MR(this,"countRows",void 0),this.changes=t,this.selected=r,this.countCols=i,this.countRows=s}static startRegisteringEvents(e,t){e.addHook("beforeChange",function(r,i){const s=r&&r.length;if(!s||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new RV({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};t.done(a,i)})}undo(e,t){const r=Oi(this.changes);for(let i=0,s=r.length;i<s;i++)r[i].splice(3,1);e.addHookOnce("afterChange",()=>{const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const s=e.countCols()-this.countCols;s>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,s,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),t()}),e.setDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,t){const r=Oi(this.changes);for(let i=0,s=r.length;i<s;i++)r[i].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),t()}),e.setDataAtCell(r,null,null,"UndoRedo.redo")}}function Yz(n,e,t){return(e=hUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hUe(n){var e=dUe(n,"string");return typeof e=="symbol"?e:e+""}function dUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class TV extends ca{constructor(e){let{conditionsStack:t,previousConditionsStack:r}=e;super("filter"),Yz(this,"conditionsStack",void 0),Yz(this,"previousConditionsStack",void 0),this.conditionsStack=t,this.previousConditionsStack=r}static startRegisteringEvents(e,t){e.addHook("beforeFilter",(r,i)=>{t.done(()=>new TV({conditionsStack:r,previousConditionsStack:i}))})}undo(e,t){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,t){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.importConditions(this.conditionsStack),r.filter()}}function fUe(n,e,t){return(e=gUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gUe(n){var e=mUe(n,"string");return typeof e=="symbol"?e:e+""}function mUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class bV extends ca{constructor(e){let{data:t,cellRange:r}=e;super("merge_cells"),fUe(this,"cellRange",void 0),this.cellRange=r,this.data=t}static startRegisteringEvents(e,t){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const s=r.getTopStartCorner(),o=r.getBottomEndCorner(),a=e.getData(s.row,s.col,o.row,o.col);t.done(()=>new bV({data:a,cellRange:r}))})}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange)}}var pUe=an,vUe=iv,wUe=c6;pUe({target:"Object",stat:!0},{fromEntries:function(e){var t={};return vUe(e,function(r,i){wUe(t,r,i)},{AS_ENTRIES:!0}),t}});function X7(n,e,t,r,i){const s=["visualRow","visualCol","row","col","prop"],o=s.length,a=[];return Le(r,i,l=>{Le(e,t,u=>{const c=n.getCellMeta(u,l);if(Object.keys(c).length!==o){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return s.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Au(n,e,t){return(e=yUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yUe(n){var e=SUe(n,"string");return typeof e=="symbol"?e:e+""}function SUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class AV extends ca{constructor(e){let{index:t,indexes:r,data:i,amount:s,headers:o,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Au(this,"index",void 0),Au(this,"indexes",void 0),Au(this,"data",void 0),Au(this,"amount",void 0),Au(this,"headers",void 0),Au(this,"columnPositions",void 0),Au(this,"rowPositions",void 0),Au(this,"fixedColumnsStart",void 0),Au(this,"removedCellMetas",void 0),this.index=t,this.indexes=r,this.data=i,this.amount=s,this.headers=o,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,t){e.addHook("beforeRemoveCol",(r,i,s,o)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return Le(l.length-1,m=>{const g=[],C=l[m];Le(u,c,y=>{g.push(C[e.toPhysicalColumn(y)])}),h.push(g)}),Le(i-1,m=>{f.push(e.toPhysicalColumn(u+m))}),Array.isArray(e.getSettings().colHeaders)&&Le(i-1,m=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+m)]||null)}),new AV({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:X7(e,0,e.countRows(),u,c)})};t.done(a,o)})}undo(e,t){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),s=(c,h,d)=>d[this.indexes.indexOf(i[h])],o=this.data.length,a=[];for(let c=0;c<o;c++)a.push(At(this.data[c],s));const l=At(this.headers,s),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),k(e.getSourceDataArray(),(c,h)=>{k(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&k(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function am(n,e,t){return(e=CUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function CUe(n){var e=EUe(n,"string");return typeof e=="symbol"?e:e+""}function EUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class NV extends ca{constructor(e){let{index:t,data:r,fixedRowsBottom:i,fixedRowsTop:s,rowIndexesSequence:o,removedCellMetas:a}=e;super("remove_row"),am(this,"index",void 0),am(this,"data",void 0),am(this,"fixedRowsBottom",void 0),am(this,"fixedRowsTop",void 0),am(this,"rowIndexesSequence",void 0),am(this,"removedCellMetas",void 0),this.index=t,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=s,this.rowIndexesSequence=o,this.removedCellMetas=a}static startRegisteringEvents(e,t){e.addHook("beforeRemoveRow",(r,i,s,o)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Oi(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new NV({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:X7(e,l,u,0,e.countCols()-1)})};t.done(a,o)})}undo(e,t){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,o)=>{Object.keys(s).forEach(a=>{const l=parseInt(a,10);i.push([this.index+o,isNaN(l)?a:l,s[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(s=>{let[o,a,l]=s;e.setCellMetaObject(o,a,l)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function Kz(n,e,t){return(e=RUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function RUe(n){var e=TUe(n,"string");return typeof e=="symbol"?e:e+""}function TUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class MV extends ca{constructor(e){let{rows:t,finalIndex:r}=e;super("row_move"),Kz(this,"rows",void 0),Kz(this,"finalRowIndex",void 0),this.rows=t.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,t){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&t.done(()=>new MV({rows:r,finalIndex:i}))})}undo(e,t){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),dV(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),r.moveRow(a,o)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,t){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function bUe(n,e,t){return(e=AUe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AUe(n){var e=NUe(n,"string");return typeof e=="symbol"?e:e+""}function NUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class IV extends ca{constructor(e){let{cellRange:t}=e;super("unmerge_cells"),bUe(this,"cellRange",void 0),this.cellRange=t}static startRegisteringEvents(e,t){e.addHook("afterUnmergeCells",(r,i)=>{i||t.done(()=>new IV({cellRange:r}))})}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange,!0)}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),e.render()}}function MUe(n,e){[wV,yV,SV,CV,EV,RV,TV,bV,AV,NV,MV,IV].forEach(t=>t.startRegisteringEvents(n,e))}function IUe(n,e){OUe(n,e),e.add(n)}function OUe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v_(n,e,t){return(e=_Ue(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _Ue(n){var e=PUe(n,"string");return typeof e=="symbol"?e:e+""}function PUe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function w_(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Xz="undoRedo",xUe="undoRedo",LUe=1e3;we.getSingleton().register("beforeUndo");we.getSingleton().register("afterUndo");we.getSingleton().register("beforeRedo");we.getSingleton().register("afterRedo");const qz=new Set;var IR=new WeakSet;let HUe=class extends yt{static get PLUGIN_KEY(){return xUe}static get PLUGIN_PRIORITY(){return LUe}static get SETTING_KEYS(){return!0}constructor(e){super(e),IUe(this,IR),v_(this,"doneActions",[]),v_(this,"undoneActions",[]),v_(this,"ignoreNewActions",!1),MUe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return w_(IR,e,DUe).call(e,...r)}),this.registerShortcuts(),w_(IR,this,FUe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),w_(IR,this,kUe).call(this)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:s=>!s.altKey,group:Xz};t.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Xz)}done(e,t){if(this.ignoreNewActions||t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,t)===!1)return;const o=e(),a=this.undoneActions.slice();this.doneActions.push(o),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Oi(t);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const s=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",s),t.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(t)}),this.hot.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Oi(t);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const s=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",s),t.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(t)}),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}};function DUe(n,e){e==="loadData"&&this.clear()}function FUe(){const n=e=>{qz.has(e)||(wt(Lt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),qz.add(e))};this.hot.undo=()=>{n("undo"),this.undo()},this.hot.redo=()=>{n("redo"),this.redo()},this.hot.isUndoAvailable=()=>(n("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(n("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{n("clear"),this.clear()},this.hot.undoRedo=this}function kUe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function y_(n,e,t){VUe(n,e),e.set(n,t)}function VUe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ws(n,e){return n.get(q7(n,e))}function OR(n,e,t){return n.set(q7(n,e),t),t}function q7(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Oo="ht-dialog",$Ue=`
<div data-ref="dialogElement" class="${Oo}">
  <div data-ref="contentWrapperElement" class="${Oo}__content-wrapper">
    <div data-ref="contentElement" class="${Oo}__content"></div>
  </div>
</div>
`;var S_=new WeakMap,ss=new WeakMap,C_=new WeakMap;class Q7{constructor(e){let{rootElement:t,isRtl:r}=e;y_(this,S_,void 0),y_(this,ss,void 0),y_(this,C_,!1),OR(S_,this,t),OR(C_,this,r),this.install()}install(){var e;if((e=Ws(ss,this))!==null&&e!==void 0&&e.dialogElement)return;const t=D5`${$Ue}`;OR(ss,this,t.refs);const{dialogElement:r}=Ws(ss,this);r.addEventListener("click",()=>this.runLocalHooks("clickDialogElement")),Pe(r,[Twe(),ys(-1),["dir",Ws(C_,this)?"rtl":"ltr"]]),Ws(S_,this).after(t.fragment)}getDialogElement(){return Ws(ss,this).dialogElement}isInsideDialog(e){return Ws(ss,this).dialogElement.contains(e)}updateDialog(e){let{isVisible:t,content:r,customClassName:i,background:s,contentBackground:o,animation:a,a11y:l}=e;const{dialogElement:u,contentElement:c}=Ws(ss,this),h=i?` ${i}`:"",d=s?` ${Oo}--background-${s}`:"",f=a?` ${Oo}--animation`:"",m=t?` ${Oo}--show`:"";u.className=`${Oo}${h}${d}${f}${m}`,Pe(u,[l.role==="alertdialog"?uwe():lwe()]),l.ariaLabel&&!l.ariaLabelledby?Pe(u,[l.ariaLabel?io(l.ariaLabel):void 0]):Kl(u,"aria-label"),l.ariaLabelledby?Pe(u,[fwe(l.ariaLabelledby)]):Kl(u,"aria-labelledby"),l.ariaDescribedby?Pe(u,[gwe(l.ariaDescribedby)]):Kl(u,"aria-describedby");const g=o?` ${Oo}__content--background`:"";return c.className=`${Oo}__content${g}`,c.innerHTML="",typeof r=="string"?sd(c,r):(r instanceof HTMLElement||r instanceof DocumentFragment)&&c.appendChild(r),this}showDialog(e){const{dialogElement:t}=Ws(ss,this);return t.style.display="block",e&&t.offsetHeight,ee(t,`${Oo}--show`),this}hideDialog(e){const{dialogElement:t}=Ws(ss,this);return Me(t,`${Oo}--show`),e?t.addEventListener("transitionend",()=>{Be(t,`${Oo}--show`)||(t.style.display="none")},{once:!0}):t.style.display="none",this}focusDialog(){Ws(ss,this).dialogElement.focus()}updateWidth(e){return Ws(ss,this).dialogElement.style.width=`${e}px`,this}updateHeight(e){return Ws(ss,this).dialogElement.style.height=`calc(100% - ${e}px)`,this}destroyDialog(){var e;(e=Ws(ss,this))===null||e===void 0||e.dialogElement.remove(),OR(ss,this,null)}}Vt(Q7,Hr);function UUe(n,e){Z7(n,e),e.add(n)}function _R(n,e,t){Z7(n,e),e.set(n,t)}function Z7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function El(n,e,t){return n.set($u(n,e),t),t}function Ir(n,e){return n.get($u(n,e))}function $u(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const $0="dialog",BUe=360,E1=$0,Wp=`plugin:${$0}`;var $i=new WeakMap,Rm=new WeakMap,vp=new WeakMap,lm=new WeakMap,zc=new WeakSet;class WUe extends yt{constructor(){super(...arguments),UUe(this,zc),_R(this,$i,null),_R(this,Rm,!1),_R(this,vp,null),_R(this,lm,null)}static get PLUGIN_KEY(){return $0}static get PLUGIN_PRIORITY(){return BUe}static get DEFAULT_SETTINGS(){return{content:"",customClassName:"",background:"solid",contentBackground:!1,animation:!0,closable:!1,a11y:{role:"dialog",ariaLabel:"Dialog",ariaLabelledby:"",ariaDescribedby:""}}}static get SETTINGS_VALIDATORS(){return{content:e=>typeof e=="string"||typeof HTMLElement<"u"&&e instanceof HTMLElement||typeof DocumentFragment<"u"&&e instanceof DocumentFragment,customClassName:e=>typeof e=="string",background:e=>["solid","semi-transparent"].includes(e),contentBackground:e=>typeof e=="boolean",animation:e=>typeof e=="boolean",closable:e=>typeof e=="boolean",a11y:e=>je(e)&&(typeof(e==null?void 0:e.role)>"u"||["dialog","alertdialog"].includes(e==null?void 0:e.role))&&(typeof(e==null?void 0:e.ariaLabel)>"u"||typeof(e==null?void 0:e.ariaLabel)=="string")&&(typeof(e==null?void 0:e.ariaLabelledby)>"u"||typeof(e==null?void 0:e.ariaLabelledby)=="string")&&(typeof(e==null?void 0:e.ariaDescribedby)>"u"||typeof(e==null?void 0:e.ariaDescribedby)=="string")}}isEnabled(){return!!this.hot.getSettings()[$0]}enablePlugin(){this.enabled||(Ir($i,this)||(El($i,this,new Q7({rootElement:this.hot.rootGridElement,isRtl:this.hot.isRtl()})),Ir($i,this).addLocalHook("clickDialogElement",()=>$u(zc,this,YUe).call(this)),El(vp,this,vV(this.hot,Ir($i,this).getDialogElement(),{onFocus:e=>{this.hot.getShortcutManager().setActiveContextName(Wp),this.hot.listen(),this.hot.runHooks("afterDialogFocus",`tab_${e}`)}}))),$u(zc,this,jUe).call(this),this.addHook("modifyFocusOnTabNavigation",e=>$u(zc,this,GUe).call(this,e),1),this.addHook("afterViewRender",()=>$u(zc,this,qUe).call(this)),this.addHook("afterListen",()=>$u(zc,this,KUe).call(this)),this.addHook("afterUnlisten",()=>$u(zc,this,XUe).call(this)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),$u(zc,this,zUe).call(this),super.disablePlugin()}isVisible(){return Ir(Rm,this)}show(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.enabled)return;if(this.isVisible()){this.update(e);return}this.hot.runHooks("beforeDialogShow"),this.update(e),Ir($i,this).showDialog(this.getSetting("animation")),El(Rm,this,!0),El(lm,this,this.hot.selection.exportSelection()),this.hot.deselectCell(),this.hot.runHooks("afterDialogShow");const{activeElement:t}=this.hot.rootDocument;(this.hot.rootWrapperElement.contains(t)||this.hot.rootPortalElement.contains(t))&&(this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName(Wp),this.hot.listen(),Ir($i,this).focusDialog(),this.hot.runHooks("afterDialogFocus","show"))}hide(){this.isVisible()&&(this.hot.runHooks("beforeDialogHide"),Ir($i,this).hideDialog(this.getSetting("animation")),this.hot.getShortcutManager().setActiveContextName("grid"),El(Rm,this,!1),Ir(lm,this)?(this.hot.selection.importSelection(Ir(lm,this)),this.hot.view.render(),El(lm,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterDialogHide"))}update(e){this.enabled&&(this.updatePluginSettings(e),Ir($i,this).updateDialog({isVisible:this.isVisible(),content:this.getSetting("content"),customClassName:this.getSetting("customClassName"),background:this.getSetting("background"),contentBackground:this.getSetting("contentBackground"),animation:this.getSetting("animation"),a11y:this.getSetting("a11y")}))}focus(){Ir($i,this).focusDialog()}destroy(){var e;(e=Ir($i,this))===null||e===void 0||e.destroyDialog(),El($i,this,null),El(Rm,this,!1),El(vp,this,null),El(lm,this,null),super.destroy()}}function jUe(){var n;const e=this.hot.getShortcutManager(),t=(n=e.getContext(Wp))!==null&&n!==void 0?n:e.addContext(Wp);t.addShortcut({keys:[["Escape"]],callback:()=>{this.hide()},runOnlyIf:()=>Ir(Rm,this)&&this.getSetting("closable"),group:E1}),t.addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:r=>{this.hot._registerTimeout(()=>{const{activeElement:i}=this.hot.rootDocument;if(!Ir($i,this).isInsideDialog(i)){this.hot.unlisten();return}r.shiftKey?this.hot.runHooks("dialogFocusPreviousElement"):this.hot.runHooks("dialogFocusNextElement")},0)},group:E1})}function zUe(){this.hot.getShortcutManager().getContext(Wp).removeShortcutsByGroup(E1)}function GUe(n){if(this.isVisible())return Ir(vp,this).focus(n),!1}function YUe(){this.isVisible()&&!this.hot.isListening()&&(this.hot.getShortcutManager().setActiveContextName(Wp),this.hot.runHooks("afterDialogFocus","click")),this.hot.listen()}function KUe(){Ir(vp,this).deactivate()}function XUe(){Ir(vp,this).activate()}function qUe(){const{view:n,rootWrapperElement:e,rootWindow:t}=this.hot,r=n.isHorizontallyScrollableByWindow()?n.getTotalTableWidth():n.getWorkspaceWidth();Ir($i,this).updateWidth(r);const i=e.querySelector(".hot-display-license-info");if(i){const s=i.offsetHeight,o=parseFloat(t.getComputedStyle(i).marginTop);Ir($i,this).updateHeight(s+o)}}function QUe(n){let{id:e,icon:t,title:r,description:i}=n;return`
    <div class="${vf}__content">
      <i class="${vf}__icon">${t}</i>
      <div class="${vf}__text">
        <h2 id="${e}-${_f}-title" class="${vf}__title">${r}</h2>
        ${i?`<p id="${e}-${_f}-description" class="${vf}__description">${i}</p>`:""}
      </div>
    </div>
  `}function ZUe(n,e){J7(n,e),e.add(n)}function JUe(n,e,t){J7(n,e),e.set(n,t)}function J7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qz(n,e,t){return n.set(OV(n,e),t),t}function Ys(n,e){return n.get(OV(n,e))}function OV(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const _f="loading",eBe=350,vf=`ht-${_f}`;var vi=new WeakMap,Zz=new WeakSet;class tBe extends yt{constructor(){super(...arguments),ZUe(this,Zz),JUe(this,vi,null)}static get PLUGIN_KEY(){return _f}static get PLUGIN_PRIORITY(){return eBe}static get DEFAULT_SETTINGS(){return{icon:`<svg class="${vf}__icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-width="2" d="M15 8a7 7 0 1 1-3.5-6.062"></path></svg>`,title:void 0,description:""}}static get SETTINGS_VALIDATORS(){return{icon:e=>typeof e=="string",title:e=>typeof e=="string",description:e=>typeof e=="string"}}isEnabled(){return!!this.hot.getSettings()[_f]}enablePlugin(){if(!this.enabled){if(Ys(vi,this)===null){var e;Qz(vi,this,this.hot.getPlugin("dialog")),(e=Ys(vi,this))!==null&&e!==void 0&&e.isEnabled()||(this.hot.getSettings().dialog=!0),this.hot.addHook("afterDialogFocus",()=>OV(Zz,this,nBe).call(this))}super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),super.disablePlugin()}isVisible(){var e,t;return(e=(t=Ys(vi,this))===null||t===void 0?void 0:t.isVisible())!==null&&e!==void 0?e:!1}show(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isEnabled()||!Ys(vi,this)||!((e=Ys(vi,this))!==null&&e!==void 0&&e.isEnabled()))return;if(this.isVisible()){this.update(t);return}this.hot.runHooks("beforeLoadingShow")!==!1&&(this.update(t),Ys(vi,this).show(),this.hot.runHooks("afterLoadingShow"))}hide(){var e;!Ys(vi,this)||!((e=Ys(vi,this))!==null&&e!==void 0&&e.isEnabled())||!this.isVisible()||this.hot.runHooks("beforeLoadingHide")===!1||(Ys(vi,this).hide(),this.hot.runHooks("afterLoadingHide"))}update(e){var t,r;if(!this.isEnabled()||!Ys(vi,this)||!((t=Ys(vi,this))!==null&&t!==void 0&&t.isEnabled()))return;this.updatePluginSettings(e);const i=this.hot.guid,s=this.getSetting("icon"),o=(r=this.getSetting("title"))!==null&&r!==void 0?r:this.hot.getTranslatedPhrase(ek),a=this.getSetting("description"),l=QUe({id:i,icon:s,title:o,description:a});Ys(vi,this).update({content:l,customClassName:vf,background:this.hot.countSourceRows()===0?"solid":"semi-transparent",a11y:{role:"alertdialog",ariaLabelledby:`${i}-${_f}-title`,ariaDescribedby:a?`${i}-${_f}-description`:void 0}})}destroy(){Qz(vi,this,null),super.destroy()}}function nBe(){Ys(vi,this).focus()}function rBe(){pt(py),pt(PAe),pt(vy),pt(hNe),pt(yNe),pt(rX),pt(mMe),pt(sIe),pt(AN),pt(JOe),pt(J_e),pt(aPe),pt(IN),pt(WPe),pt(W1e),pt(ELe),pt(XLe),pt(aHe),pt(yHe),pt(OHe),pt($He),pt(iDe),pt(fDe),pt(oFe),pt(kFe),pt(WFe),pt(mke),pt(tVe),pt(LVe),pt(s$e),pt(g$e),pt(M$e),pt(F$e),pt(K$e),pt(HUe),pt(WUe),pt(tBe)}function eq(){eCe(),MEe(),$Ee(),pRe(),rBe()}var iBe=TypeError,tq=function(n,e){if(n<e)throw new iBe("Not enough arguments");return n},sBe=HA,oBe=/(?:ipad|iphone|ipod).*applewebkit/i.test(sBe),Tw=ur,aBe=HA,lBe=og,PR=function(n){return aBe.slice(0,n.length)===n},nq=function(){return PR("Bun/")?"BUN":PR("Cloudflare-Workers")?"CLOUDFLARE":PR("Deno/")?"DENO":PR("Node.js/")?"NODE":Tw.Bun&&typeof Bun.version=="string"?"BUN":Tw.Deno&&typeof Deno.version=="object"?"DENO":lBe(Tw.process)==="process"?"NODE":Tw.window&&Tw.document?"BROWSER":"REST"}(),uBe=nq,cBe=uBe==="NODE",ao=ur,hBe=eC,dBe=p6,Jz=Sr,fBe=sa,rq=wr,eG=s6,gBe=QH,tG=gH,mBe=tq,pBe=oBe,vBe=cBe,R1=ao.setImmediate,T1=ao.clearImmediate,wBe=ao.process,E_=ao.Dispatch,yBe=ao.Function,nG=ao.MessageChannel,SBe=ao.String,R_=0,Py={},rG="onreadystatechange",_S,Qd,T_,b_;rq(function(){_S=ao.location});var _V=function(n){if(fBe(Py,n)){var e=Py[n];delete Py[n],e()}},A_=function(n){return function(){_V(n)}},iG=function(n){_V(n.data)},sG=function(n){ao.postMessage(SBe(n),_S.protocol+"//"+_S.host)};(!R1||!T1)&&(R1=function(e){mBe(arguments.length,1);var t=Jz(e)?e:yBe(e),r=gBe(arguments,1);return Py[++R_]=function(){hBe(t,void 0,r)},Qd(R_),R_},T1=function(e){delete Py[e]},vBe?Qd=function(n){wBe.nextTick(A_(n))}:E_&&E_.now?Qd=function(n){E_.now(A_(n))}:nG&&!pBe?(T_=new nG,b_=T_.port2,T_.port1.onmessage=iG,Qd=dBe(b_.postMessage,b_)):ao.addEventListener&&Jz(ao.postMessage)&&!ao.importScripts&&_S&&_S.protocol!=="file:"&&!rq(sG)?(Qd=sG,ao.addEventListener("message",iG,!1)):rG in tG("script")?Qd=function(n){eG.appendChild(tG("script"))[rG]=function(){eG.removeChild(this),_V(n)}}:Qd=function(n){setTimeout(A_(n),0)});var iq={set:R1,clear:T1},CBe=an,EBe=ur,oG=iq.clear;CBe({global:!0,bind:!0,enumerable:!0,forced:EBe.clearImmediate!==oG},{clearImmediate:oG});var sq=ur,RBe=eC,TBe=Sr,bBe=nq,ABe=HA,NBe=QH,MBe=tq,IBe=sq.Function,OBe=/MSIE .\./.test(ABe)||bBe==="BUN"&&function(){var n=sq.Bun.version.split(".");return n.length<3||n[0]==="0"&&(n[1]<3||n[1]==="3"&&n[2]==="0")}(),_Be=function(n,e){var t=e?2:1;return OBe?function(r,i){var s=MBe(arguments.length,1)>t,o=TBe(r)?r:IBe(r),a=s?NBe(arguments,t):[],l=s?function(){RBe(o,this,a)}:o;return e?n(l,i):n(l)}:n},PBe=an,oq=ur,aG=iq.set,xBe=_Be,lG=oq.setImmediate?xBe(aG,!1):aG;PBe({global:!0,bind:!0,enumerable:!0,forced:oq.setImmediate!==lG},{setImmediate:lG});function LBe(n,e){HBe(n,e),e.add(n)}function HBe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zd(n,e,t){return(e=DBe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function DBe(n){var e=FBe(n,"string");return typeof e=="symbol"?e:e+""}function FBe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function N_(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xR=new WeakSet;class b1{constructor(e,t,r){LBe(this,xR),Zd(this,"hot",void 0),Zd(this,"tableMeta",void 0),Zd(this,"selection",void 0),Zd(this,"eventManager",void 0),Zd(this,"destroyed",!1),Zd(this,"activeEditor",void 0),Zd(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=r,this.eventManager=new Zo(e),this.hot.addHook("afterDocumentKeyDown",i=>N_(xR,this,uG).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>N_(xR,this,uG).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>N_(xR,this,kBe).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:r,col:i}=t,s=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let o=r,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=K9(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeActive();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,t,r);if(t instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(r))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!t||a)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function uG(n){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||hh(n))return;const{keyCode:t}=n,r=(n.ctrlKey||n.metaKey)&&!n.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!wD(t)&&!P9(t)&&!r&&!this.isEditorOpened()&&this.openEditor("",n)}function kBe(n,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,n,!0))}const cG=new WeakMap;b1.getInstance=function(n,e,t){let r=cG.get(n);return r||(r=new b1(n,e,t),cG.set(n,r)),r};function VBe(n,e){aq(n,e),e.add(n)}function bw(n,e,t){aq(n,e),e.set(n,t)}function aq(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function un(n,e){return n.get(ju(n,e))}function Aw(n,e,t){return n.set(ju(n,e),t),t}function ju(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const wp=Object.freeze({CELL:"cell",MIXED:"mixed"});var mr=new WeakMap,LR=new WeakMap,HR=new WeakMap,DR=new WeakMap,FR=new WeakMap,sh=new WeakSet;class $Be{constructor(e){var t=this;VBe(this,sh),bw(this,mr,void 0),bw(this,LR,void 0),bw(this,HR,1),bw(this,DR,null),bw(this,FR,new Map);const r=e.getSettings();Aw(mr,this,e),Aw(LR,this,r.imeFastEdit?wp.MIXED:wp.CELL),un(mr,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ju(sh,t,BBe).call(t,...s)}),un(mr,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ju(sh,t,hG).call(t,...s)}),un(mr,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ju(sh,t,hG).call(t,...s)}),un(mr,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ju(sh,t,UBe).call(t,...s)})}getFocusMode(){return un(LR,this)}setFocusMode(e){Object.values(wp).includes(e)?Aw(LR,this,e):wt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return un(HR,this)}setRefocusDelay(e){Aw(HR,this,e)}setRefocusElementGetter(e){Aw(DR,this,e)}getRefocusElement(){var e;return typeof un(DR,this)=="function"?un(DR,this).call(this):(e=un(mr,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=r=>{var i,s;const o=(i=un(mr,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=un(mr,this).runHooks("modifyFocusedElement",o.row,o.col,r);Xl(a)||(a=r),a&&!((s=un(mr,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?t(e):ju(sh,this,PV).call(this,r=>t(r))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:un(HR,this);if(un(mr,this).getSettings().imeFastEdit&&!((e=un(mr,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=un(mr,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),un(FR,this).has(t)||un(FR,this).set(t,gC(()=>{if(!un(mr,this).isDestroyed){var s;(s=this.getRefocusElement())===null||s===void 0||s.select()}},t)),un(FR,this).get(t)()}}}function PV(n){var e;const t=(e=un(mr,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!t||!un(mr,this).selection.isCellVisible(t)){n(null);return}const r=un(mr,this).getCell(t.row,t.col,!0);r===null?un(mr,this).addHookOnce("afterScroll",()=>{n(un(mr,this).getCell(t.row,t.col,!0))}):n(r)}function hG(){ju(sh,this,PV).call(this,n=>{const{activeElement:e}=un(mr,this).rootDocument;e&&rN(e)&&e.blur(),this.focusOnHighlightedCell(n)})}function UBe(){ju(sh,this,PV).call(this,n=>{this.getFocusMode()===wp.MIXED&&(n==null?void 0:n.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function BBe(n){typeof n.imeFastEdit=="boolean"&&this.setFocusMode(n.imeFastEdit?wp.MIXED:wp.CELL)}const lq=new WeakMap,xV=Symbol("rootInstance");function WBe(n){lq.set(n,!0)}function jBe(n){return n===xV}function hf(n){return lq.has(n)}function zBe(n,e){uq(n,e),e.add(n)}function Gc(n,e,t){uq(n,e),e.set(n,t)}function uq(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yc(n,e,t){return(e=GBe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function GBe(n){var e=YBe(n,"string");return typeof e=="symbol"?e:e+""}function YBe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Zn(n,e){return n.get(yp(n,e))}function os(n,e,t){return n.set(yp(n,e),t),t}function yp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var M_=new WeakMap,kR=new WeakMap,VR=new WeakMap,Nu=new WeakMap,ya=new WeakMap,I_=new WeakMap,O_=new WeakMap,um=new WeakMap,Gw=new WeakSet;class KBe{constructor(e){zBe(this,Gw),Yc(this,"hot",void 0),Yc(this,"eventManager",void 0),Yc(this,"settings",void 0),Yc(this,"THEAD",void 0),Yc(this,"TBODY",void 0),Yc(this,"_wt",void 0),Yc(this,"activeWt",void 0),Gc(this,M_,0),Gc(this,kR,0),Yc(this,"postponedAdjustElementsSize",!1),Gc(this,VR,!1),Gc(this,Nu,void 0),Gc(this,ya,void 0),Gc(this,I_,0),Gc(this,O_,0),Gc(this,um,null),this.hot=e,this.eventManager=new Zo(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),yp(Gw,this,qBe).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,t){const r=this._wt.getCell(e,t);return r<0?null:r}scrollViewport(e,t,r){return this._wt.scrollViewport(e,t,r)}scrollViewportHorizontally(e,t){return this._wt.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wt.scrollViewportVertically(e,t)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),ee(e,"handsontable"),os(ya,this,t.createElement("TABLE")),ee(Zn(ya,this),"htCore"),this.hot.getSettings().tableClassName&&ee(Zn(ya,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Pe(Zn(ya,this),[Xu()]),Pe(e,[Qve(),e9(-1),JA(this.hot.countCols()),mwe()])),this.THEAD=t.createElement("THEAD"),Zn(ya,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),Zn(ya,this).appendChild(this.TBODY),this.hot.table=Zn(ya,this),this.hot.container.insertBefore(Zn(ya,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:t,rootDocument:r,selection:i,rootWindow:s}=this.hot,o=r.documentElement;this.eventManager.addEventListener(t,"mousedown",l=>{os(VR,this,!0),this.isTextSelectionAllowed(l.target)||(Px(s),l.preventDefault(),s.focus())}),this.eventManager.addEventListener(t,"mouseup",()=>{os(VR,this,!1)}),this.eventManager.addEventListener(t,"mousemove",l=>{Zn(VR,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&Px(s),l.preventDefault())}),this.eventManager.addEventListener(o,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(o,"mouseup",l=>{var u;i.isInProgress()&&iN(l)&&i.finish(),os(Nu,this,!1);const c=rN(r.activeElement),h=(u=r.querySelector(".ht-dialog"))===null||u===void 0?void 0:u.contains(r.activeElement);gy(r.activeElement)&&!c||h||(c||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??t).contains(l.target)&&!qh(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",l=>{i.isInProgress()&&qh(l)&&(i.finish(),os(Nu,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{i.isInProgress()&&i.finish(),os(Nu,this,!1)}),this.eventManager.addEventListener(o,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(Zn(Nu,this)||!t||!this.hot.view)return;const{holder:f}=this._wt.wtTable;if(d===f){const g=ar(r);if(r.elementFromPoint(c+g,h)!==f||r.elementFromPoint(c,h+g)!==f)return}else for(;d!==o;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===t)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Gf(s);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Gf(a);this.eventManager.addEventListener(Zn(ya,this),"selectstart",l=>{this.settings.fragmentSelection||gy(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,r))}translateFromRenderableToVisualIndex(e,t){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return r===null&&(r=e),i===null&&(i=t),[r,i]}countRenderableIndexes(e,t){const r=Math.min(e.getNotTrimmedIndexesLength(),t),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,i){if(isNaN(e)||e<0)return 0;const s=r.getNearestNotHiddenIndex(e,t),o=r.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return t<0?a=o+1:t>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let r=0;for(let i=e;i<=t;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,t){let r=0;for(let i=e;i<=t;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}addClassNameToLicenseElement(e){var t;const r=(t=this.hot.rootElement.parentNode)===null||t===void 0?void 0:t.querySelector(".hot-display-license-info");r&&ee(r,e)}removeClassNameFromLicenseElement(e){var t;const r=(t=this.hot.rootElement.parentNode)===null||t===void 0?void 0:t.querySelector(".hot-display-license-info");r&&Me(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Zn(ya,this),isDataViewInstance:()=>hf(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),os(kR,this,s.length),this.hot.getSettings().ariaTags&&yp(Gw,this,cq).call(this)===this.hot.countCols()&&yp(Gw,this,XBe).call(this,Zn(kR,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),os(M_,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let g=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(g=this.hot.runHooks("beforeValueRender",g,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,g,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,g,f),this.hot.runHooks("afterRenderer",a,l,u,m,g,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Yf(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,os(Nu,this,!0),os(um,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,c),!hh(s)&&(dO(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,os(Nu,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!hh(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!hh(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,c),!hh(s)&&(Zn(Nu,this)&&(!Zn(um,this)||Zn(um,this).x!==s.clientX||Zn(um,this).y!==s.clientY)&&dO(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt,os(um,this,null))},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(hh(s)||this.hot.isDestroyed)&&(dO(s,{coords:u,selection:this.hot.selection,cellRangeMapper:qSe(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{const a=this.hot.rowIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollVertically",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(s,o)=>{const a=this.hot.columnIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,c]=s,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=o>=0?c.getVisualFromRenderableIndex(o):o,d=s>=0?u.getVisualFromRenderableIndex(s):s,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[m,g,C,y]=f;return[m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,g>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(g,1)):g,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,-1)):y]}},onModifyGetCoordsElement:(s,o)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=o>=0?l.getVisualFromRenderableIndex(o):o,c=s>=0?a.getVisualFromRenderableIndex(s):s,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const c=Math.max(1,Math.ceil(u/a*12));s.startRow=Math.max(l-c,0),s.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const c=Math.max(1,Math.ceil(u/a*6));s.startColumn=Math.max(l-c,0),s.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Dk(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(t,"mousedown",s=>{s.target===t&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",s=>{s.target===t&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var t,r;if(gy(e))return!0;const i=kh(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;const s=(t=(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.isSingleCell())!==null&&t!==void 0?t:!1;return!!(this.settings.fragmentSelection==="cell"&&s&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&s)}isMouseDown(){return Zn(Nu,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const r=t.firstChild;if(!Be(r,"relative")){Jl(t),this.appendRowHeader(e,t);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,s=r.createElement("div"),o=r.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),t.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(t.firstChild){const o=t.firstChild;Be(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,r,i),o.className="",ee(o,["relative",...s()])):(Jl(t),this.appendColHeader(e,t,r,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Pe(a,...Xu()),Pe(l,...Xu())),this.updateCellHeader(l,e,r,i),a.appendChild(l),t.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,t,i)}updateCellHeader(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Be(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(t):Be(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(t))),s>-1?sd(e,r(t,i)):(Xh(e,""),ee(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,t){os(I_,this,e),os(O_,this,t)}getLastSize(){return{width:Zn(I_,this),height:Zn(O_,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(t??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(t??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(t??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(t??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Zn(M_,this)}getRowHeadersCount(){return Zn(kR,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function cq(){return parseInt(this.hot.rootElement.getAttribute(JA()[0]),10)}function XBe(n){const e=yp(Gw,this,cq).call(this)+n;Pe(this.hot.rootElement,...JA(e))}function qBe(){const n=this.hot.rootElement;this.hasVerticalScroll()?ee(n,"htHasScrollY"):Me(n,"htHasScrollY"),this.isVerticallyScrollableByWindow()?ee(n,"htVerticallyScrollableByWindow"):Me(n,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?ee(n,"htHasScrollX"):Me(n,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?ee(n,"htHorizontallyScrollableByWindow"):Me(n,"htHorizontallyScrollableByWindow")}function Nw(n,e,t){return(e=QBe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QBe(n){var e=ZBe(n,"string");return typeof e=="symbol"?e:e+""}function ZBe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class JBe{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Nw(this,"hot",void 0),Nw(this,"data",void 0),Nw(this,"dataType","array"),Nw(this,"colToProp",()=>{}),Nw(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return k(this.data,(r,i)=>{const s=this.getAtCell(i,e);t.push(s)}),t}getAtRow(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=t===void 0&&r===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Le(t,r,u=>{l[u-t]=this.getAtPhysicalCell(e,u,a)});else if(je(a)||Pt(a))if(i?l=[]:l={},!s||i){const c=this.countFirstRowKeys()-1;Le(0,c,h=>{const d=this.colToProp(h);if(h>=(t||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):o?bT(l,d,f):l[d]=f}})}else ct(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);o?bT(l,c,h):l[c]=h});return l}setAtCell(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Rs(r);this.hot.runHooks("modifySourceData",e,t,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(t)?this.data[e][t]=r:bT(this.data[e],t,r))}}getAtPhysicalCell(e,t,r){let i=null;if(r)if(typeof t=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?Gb(r,t):r[t]}else typeof t=="function"?i=t(r):i=r[t];if(this.hot.hasHook("modifySourceData")){const s=Rs(i);this.hot.runHooks("modifySourceData",e,t,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,t){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||t===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,t.row),o=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const u=[];return Le(s,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,o,l,r))}),u}getCopyable(e,t){const r=this.propToCol(t);return this.hot.getCellMeta(e,r).copyable?this.getAtCell(this.hot.toPhysicalRow(e),r):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return lV(this.data)}destroy(){this.data=null,this.hot=null}}function eWe(n,e){return ct(e,(t,r)=>{fn(n[r])&&(n[r]=t)}),n}function hq(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function dq(n){Re(n)&&ED(Lt`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function tWe(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n}function fq(n,e){return Array.isArray(n)?n.map(t=>fq(t,e)):QA(n,e)}const{register:nWe,getValues:rWe}=ua("phraseFormatters");function gq(n,e){nWe(n,e)}function iWe(){return rWe()}gq("pluralize",tWe);gq("substitute",fq);/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const mq={languageCode:"en-US",[bD]:"No available options",[AD]:"Insert row above",[ND]:"Insert row below",[MD]:"Insert column left",[ID]:"Insert column right",[OD]:["Remove row","Remove rows"],[_D]:["Remove column","Remove columns"],[PD]:"Undo",[xD]:"Redo",[Jb]:"Read only",[LD]:"Clear column",[KD]:"Alignment",[XD]:"Left",[qD]:"Center",[QD]:"Right",[ZD]:"Justify",[JD]:"Top",[eF]:"Middle",[tF]:"Bottom",[$D]:"Freeze column",[UD]:"Unfreeze column",[nF]:"Borders",[rF]:"Top",[iF]:"Right",[sF]:"Bottom",[oF]:"Left",[aF]:"Remove border(s)",[jD]:"Add comment",[zD]:"Edit comment",[GD]:"Delete comment",[YD]:"Read-only comment",[BD]:"Merge cells",[WD]:"Unmerge cells",[HD]:"Copy",[DD]:["Copy with header","Copy with headers"],[FD]:["Copy with group header","Copy with group headers"],[kD]:["Copy header only","Copy headers only"],[VD]:"Cut",[lF]:"Insert child row",[uF]:"Detach from parent",[cF]:["Hide column","Hide columns"],[hF]:["Show column","Show columns"],[dF]:["Hide row","Hide rows"],[fF]:["Show row","Show rows"],[sN]:"None",[gF]:"Is empty",[mF]:"Is not empty",[pF]:"Is equal to",[vF]:"Is not equal to",[wF]:"Begins with",[yF]:"Ends with",[SF]:"Contains",[CF]:"Does not contain",[EF]:"Greater than",[RF]:"Greater than or equal to",[TF]:"Less than",[bF]:"Less than or equal to",[AF]:"Is between",[NF]:"Is not between",[MF]:"After",[IF]:"Before",[OF]:"Today",[_F]:"Tomorrow",[PF]:"Yesterday",[e0]:"Blank cells",[xF]:"Filter by condition",[LF]:"Filter by value",[HF]:"And",[oN]:"Or",[DF]:"Select all",[FF]:"Clear",[kF]:"OK",[VF]:"Cancel",[$F]:"Search",[UF]:"Value",[BF]:"Second value",[WF]:"Pagination",[t0]:"Page size",[jF]:"Auto",[zF]:"[start] - [end] of [total]",[GF]:"Page [currentPage] of [totalPages]",[YF]:"Go to first page",[KF]:"Go to previous page",[XF]:"Go to next page",[qF]:"Go to last page",[ZF]:"Checked",[JF]:"Unchecked",[ek]:"Loading..."},sWe=sCe,A1=mq.languageCode,{register:oWe,getItem:pq,hasItem:aWe,getValues:lWe}=ua("languagesDictionaries");vq(mq);function vq(n,e){let t=n,r=e;return je(n)&&(r=n,t=r.languageCode),uWe(t,r),oWe(t,Oi(r)),Oi(r)}function uWe(n,e){n!==A1&&eWe(e,pq(A1))}function wq(n){return LV(n)?Oi(pq(n)):null}function LV(n){return aWe(n)}function cWe(){return lWe()}function yq(n,e,t){const r=wq(n);if(r===null)return null;const i=r[e];if(fn(i))return null;const s=hWe(i,t);return Array.isArray(s)?s[0]:s}function hWe(n,e){return iWe().reduce((t,r)=>r(t,e),n)}function dWe(n){let e=hq(n);return LV(e)||(e=A1,dq(n)),e}function __(n,e){const{instance:t,visualRow:r,visualCol:i,valueSetter:s}=e;return Pt(s)?s.call(t,n,r,i,e):n}function fWe(n,e){const{instance:t,visualRow:r,visualCol:i,valueGetter:s}=e;return Pt(s)?s.call(t,n,r,i,e):n}function Jd(n,e,t){return(e=gWe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gWe(n){var e=mWe(n,"string");return typeof e=="symbol"?e:e+""}function mWe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Jm{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,r){Jd(this,"hot",void 0),Jd(this,"metaManager",void 0),Jd(this,"tableMeta",void 0),Jd(this,"dataSource",void 0),Jd(this,"duckSchema",void 0),Jd(this,"colToPropCache",void 0),Jd(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=t,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,t){let i=0,s=0,o=!1;if(typeof t=="function"){const a=qA(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,t.length)}for(r=0;r<i;r++){const a=o?t(r):t[r];if(je(a)){if(typeof a.data<"u"){const l=o?s:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return lV(this.dataSource)}recursiveDuckColumns(e,t,r){let i=t,s=r,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&ct(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&Re(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(Re(t))return this.hot.toVisualColumn(t);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Hp(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,t,r)===!1||o===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<t&&s+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=Oi(this.getSchema()):(m=[],Le(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},lC(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,t,r)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let f=0;for(let m=d;f<t&&l+f<o;m++){if(typeof c!="number"||c>=l+f)if(u>0)for(let g=0;g<u;g+=1)typeof s[g]>"u"&&(s[g]=[]),s[g].push(null);else s.push([null]);else for(let g=0;g<u;g++)s[g].splice(m,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(d,t)),this.hot.columnIndexMapper.insertIndexes(c,f,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-t;const s=this.visualRowsToPhysical(i,t),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,r)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const c=Re(this.tableMeta.columns)||Re(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,r),!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-t:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,t),o=s.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,t,s,r)===!1)return!1;let l=!0;const u=o.length,c=this.dataSource;for(let h=0;h<u;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(s[0],t),h===0&&this.metaManager.removeColumn(s[0],t);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(o[f],1),h===0&&this.metaManager.removeColumn(o[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,t,s,r),this.refreshDuckSchema(),!0}spliceCol(e,t,r){const i=this.hot.getDataAtCol(e),s=i.slice(t,t+r),o=i.slice(t+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];bx(l,o);let c=0;for(;c<r;)l.push(null),c+=1;return P5(l),this.hot.populateFromArray(t,e,l,null,null,"spliceCol"),s}spliceRow(e,t,r){const i=this.hot.getSourceDataAtRow(e),s=i.slice(t,t+r),o=i.slice(t+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];bx(l,o);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,t,[l],null,null,"spliceRow"),s}spliceData(e,t,r){if(this.hot.runHooks("beforeDataSplice",e,t,r)!==!1){const s=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,t,r){let i=this.hot.runHooks("filterData",e,t,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>r.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,t){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const s=this.hot.runHooks("modifyRowData",r);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&xn(i,t))a=i[t];else if(o&&typeof t=="string"&&t.indexOf(".")>-1){let c=i;if(!c)return null;const h=t.split(".");for(let d=0,f=h.length;d<f;d++)if(c=c[h[d]],typeof c>"u")return null;a=c}else typeof t=="function"&&(a=t(this.dataSource.slice(r,r+1)[0]));const l=this.propToCol(t),u=this.hot.toPhysicalColumn(l);if(Df(r)&&Df(u)&&(a=fWe(a,this.metaManager.getCellMeta(r,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=Rs(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,r){const i=this.hot.toPhysicalRow(e);let s=r,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=Rs(s);this.hot.runHooks("modifyData",e,this.propToCol(t),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&xn(o,t))o[t]=s;else if(l&&typeof t=="string"&&t.indexOf(".")>-1){let u=o,c=0,h;const d=t.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=s}else if(typeof t=="function")t(this.dataSource.slice(i,i+1)[0],s);else{if(t==="__proto__"||t==="constructor"||t==="prototype")return;o[t]=s}}visualRowsToPhysical(e,t){const r=this.hot.countSourceRows(),i=[];let s=(r+e)%r,o=t,a;for(;s<r&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,t){const r=this.hot.countCols(),i=[];let s=(r+e)%r,o=t;for(;s<r&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,Jm.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,r){const i=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Jm.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(s=Math.min(e.row,t.row);s<=h;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,t.col);o<=d&&f!==null;o++)a.push(c.call(this,s,this.colToProp(o)));f!==null&&i.push(a)}return i}getText(e,t){return m0(this.getRange(e,t,Jm.DESTINATION_RENDERER))}getCopyableText(e,t){return m0(this.getRange(e,t,Jm.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const Sq=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(n){let e,t,r;for(e=0,t=this.countRows();e<t;e++)if(r=this.getDataAtCell(e,n),Dn(r)===!1)return!1;return!0},isEmptyRow(n){let e,t,r,i;for(e=0,t=this.countCols();e<t;e++)if(r=this.getDataAtCell(n,e),Dn(r)===!1)return typeof r=="object"?(i=this.getCellMeta(n,e),uC(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function dG(n,e,t){return(e=pWe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pWe(n){var e=vWe(n,"string");return typeof e=="symbol"?e:e+""}function vWe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function wWe(){return class{}}class yWe{constructor(e){dG(this,"metaCtor",wWe()),dG(this,"meta",void 0),this.meta=this.metaCtor.prototype,lr(this.meta,Sq()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;lr(this.meta,e),uN(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}function SWe(n,e,t){return(e=CWe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function CWe(n){var e=EWe(n,"string");return typeof e=="symbol"?e:e+""}function EWe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class RWe{constructor(e){SWe(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){lr(this.meta,e),uN(this.meta,e,e)}}function $R(n,e,t){return(e=TWe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TWe(n){var e=bWe(n,"string");return typeof e=="symbol"?e:e+""}function bWe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class U0{constructor(e){$R(this,"valueFactory",void 0),$R(this,"data",[]),$R(this,"index",[]),$R(this,"holes",new Set),this.valueFactory=e}obtain(e){OT(()=>Df(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let r;if(t>=0)r=this.data[t],r===void 0&&(r=this.valueFactory(e),this.data[t]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;OT(()=>Df(e)||Uw(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let o=0;o<t;o++)r.push(i+o),this.data.push(void 0);const s=Uw(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...r,...this.index.slice(s)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;OT(()=>Df(e)||Uw(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Uw(e)?this.index.length-t:e,t);for(let i=0;i<r.length;i++){const s=r[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,t)=>e!==void 0&&!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let t=0;return{next:()=>{if(t<e.length){const r=e[t];return t+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function fG(n,e,t){return(e=AWe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AWe(n){var e=NWe(n,"string");return typeof e=="symbol"?e:e+""}function NWe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const MWe=["data","width"];class IWe{constructor(e){fG(this,"globalMeta",void 0),fG(this,"metas",new U0(()=>this._createMeta())),this.globalMeta=e,this.metas=new U0(()=>this._createMeta())}updateMeta(e,t){const r=this.getMeta(e);lr(r,t),uN(r,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return sRe(this.globalMeta.getMetaConstructor(),MWe).prototype}}function gG(n,e,t){return(e=OWe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function OWe(n){var e=_We(n,"string");return typeof e=="symbol"?e:e+""}function _We(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class PWe{constructor(e){gG(this,"columnMeta",void 0),gG(this,"metas",new U0(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,r){const i=this.getMeta(e,t);lr(i,r),uN(i,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}getMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);return r===void 0?i:i[r]}setMeta(e,t,r,i){var s;const o=this.metas.obtain(e).obtain(t);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(r),o[r]=i}removeMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);delete i[r]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let r=0;r<t.length;r++)Re(t[r])&&e.push(...t[r].values());return e}getMetasAtRow(e){OT(()=>Df(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new U0(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class Cq{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new yWe(e),this.tableMeta=new RWe(this.globalMeta),this.columnMeta=new IWe(this.globalMeta),this.cellMeta=new PWe(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){const i=this.cellMeta.getMeta(e,t);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=t,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,t,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,i){this.cellMeta.setMeta(e,t,r,i)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Vt(Cq,Hr);function mG(n,e,t,r){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=_i(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Pt(d.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),n=i.runHooks(`before${h}`,n,c,l);const f=new Jm(i,n,u);if(e(f),typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){const m=f.getSchema();n=[];let g,C=0,y=0;for(C=0,y=d.startRows;C<y;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)g=Oi(m),n.push(g);else if(i.dataType==="array")g=Oi(m[0]),n.push(g);else{g=[];for(let w=0,S=d.startCols;w<S;w++)g.push(null);n.push(g)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof n} given)`);Array.isArray(n[0])&&(i.dataType="array"),d.data=n,f.dataSource=n,o.data=n,o.dataType=i.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),t(f),i.runHooks(`after${h}`,n,c,l),c||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&Pe(i.rootElement,[e9(-1),JA(i.countCols()+(i.view?i.countRowHeaders():0))])}function pG(n,e,t){return(e=xWe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xWe(n){var e=LWe(n,"string");return typeof e=="symbol"?e:e+""}function LWe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class HWe{constructor(e){var t=this;pG(this,"metaManager",void 0),pG(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return t.extendCellMeta(...arguments)}),we.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:r,col:i}=e;if((t=this.metaSyncMemo.get(r))!==null&&t!==void 0&&t.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=xn(e,"type")?e.type:null;let c=Pt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function DWe(n,e,t){FWe(n,e),e.set(n,t)}function FWe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function P_(n,e,t){return(e=kWe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kWe(n){var e=VWe(n,"string");return typeof e=="symbol"?e:e+""}function VWe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $We(n,e){return n.get(UWe(n,e))}function UWe(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var vG=new WeakMap;class BWe{constructor(e){P_(this,"metaManager",void 0),P_(this,"usageTracker",new Set),P_(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),DWe(this,vG,(t,r,i)=>{if(!i)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:r,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:t,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(t,l,s),o&&this.installPropWatcher(i,l,s)):r&&(this.installPropWatcher(t,l,$We(vG,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,s,o),this[t]=s},enumerable:!0,configurable:!0})}}function WWe(n){return e=>{if(!e)return null;const{rowIndexMapper:t,columnIndexMapper:r}=n;if(t.isHidden(e.row)||r.isHidden(e.col))return null;const i=jb(n),s=zb(n);return e.row=ft(e.row,i.row,s.row),e.col=ft(e.col,i.col,s.col),e}}function jWe(n){const e=WWe(n);let t;const{activate:r,deactivate:i}=vV(n,n.rootGridElement,{onFocus(h){if(h==="from_above"){var d;const m=(d=e(t))!==null&&d!==void 0?d:jb(n),g=n.runHooks("modifyFocusOnTabNavigation","from_above",m);m&&g!==!1&&n.selectCell(m.row,m.col)}else{var f;const m=(f=e(t))!==null&&f!==void 0?f:zb(n),g=n.runHooks("modifyFocusOnTabNavigation","from_below",m);m&&g!==!1&&n.selectCell(m.row,m.col)}n.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;n.addHook("afterListen",()=>{const h=n.getShortcutManager().getActiveContextName(),d=n.getShortcutManager().getContext(h);(d==null?void 0:d.scope)==="table"&&i()}),n.addHook("afterUnlisten",()=>{const h=n.getShortcutManager().getActiveContextName(),d=n.getShortcutManager().getContext(h);(d==null?void 0:d.scope)==="table"&&r()}),n.addHook("afterSelection",(h,d,f,m,g)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,g.value=!0),o){var C;t=(C=n.getSelectedRangeActive())===null||C===void 0?void 0:C.highlight}}),n.addHook("beforeRowWrap",(h,d,f)=>{s.wrapped=!0,s.flipped=f});function u(){s.wrapped=!1,s.flipped=!1,n.deselectCell(),n.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:I9,group:"focusCatcher"};n.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=n.getSettings();a=!0,n.getSelectedRangeActive()&&!h&&(o=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=n.getSettings();if(a=!1,o=!0,!d||!n.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return f&&s.wrapped&&s.flipped&&(t=h.shiftKey?jb(n):zb(n)),u(),!1;h.preventDefault()},position:"after"}])}function pv(n){Xl(n)&&n.scrollIntoView({block:"nearest",inline:"nearest"})}function HN(n){const{selection:e,view:t}=n,r=n.getSelectedRangeActive(),i=e.getSelectionSource(),s=t.getFirstFullyVisibleColumn(),o=t.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=s,c=l>=o,h=t.getFirstFullyVisibleRow(),d=t.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,m=r.getBottomEndCorner().row,g=f<=h,C=m>=d;return{getComputedColumnTarget(y){return i==="mouse"||i==="keyboard"?y.col:u&&c?r.highlight.col:u?a:c?l:y.col},getComputedRowTarget(y){return i==="mouse"||i==="keyboard"?y.row:g&&C?r.highlight.row:g?f:C?m:y.row}}}function zWe(n){return e=>{const t=HN(n).getComputedColumnTarget(e);n.scrollViewportTo({col:t},()=>{const r=!!n.getSettings().colHeaders;pv(n.getCell(r?-1:0,t,!0))})}}function GWe(){return()=>{}}function YWe(n){return e=>{n.scrollViewportTo(e.toObject(),()=>{const t=n.getSelectedRangeActive();if(!t)return;const{row:r,col:i}=t.highlight;pv(n.getCell(r,i,!0))})}}function KWe(n){return e=>{const t=HN(n),r={row:t.getComputedRowTarget(e),col:t.getComputedColumnTarget(e)};n.scrollViewportTo(r,()=>{const{row:i,col:s}=r;pv(n.getCell(i,s,!0))})}}function XWe(n){return e=>{const t=HN(n),r={row:t.getComputedRowTarget(e),col:t.getComputedColumnTarget(e)};n.scrollViewportTo(r,()=>{const{row:i,col:s}=r;pv(n.getCell(i,s,!0))})}}function qWe(n){return e=>{const t=HN(n).getComputedRowTarget(e);n.scrollViewportTo({row:t},()=>{const r=!!n.getSettings().rowHeaders;pv(n.getCell(t,r?-1:0,!0))})}}function QWe(n){return e=>{const t=n.selection.getSelectionSource(),{row:r,col:i}=e,s=()=>{pv(n.getCell(r,i,!0))};if(r<0&&i>=0)n.scrollViewportTo({col:i},s);else if(i<0&&r>=0)n.scrollViewportTo({row:r},s);else{if(t==="mouse"&&(i===n.view.getLastPartiallyVisibleColumn()||r===n.view.getLastPartiallyVisibleRow()))return;n.scrollViewportTo({row:r,col:i},s)}}}function ZWe(n){const{selection:e}=n;let t=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){t=!0},scrollTo(i){var s;if(t||r){t=!1;return}let o;e.isFocusSelectionChanged()?o=YWe(n):e.isSelectedByCorner()?o=GWe():e.isSelectedByRowHeader()?o=qWe(n):e.isSelectedByColumnHeader()?o=zWe(n):e.getSelectedRange().size()===1&&e.isMultiple()?o=KWe(n):e.getSelectedRange().size()===1&&!e.isMultiple()?o=QWe(n):e.getSelectedRange().size()>1&&(o=XWe(n)),(s=o)===null||s===void 0||s(i)}}}const wG=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),UR=n=>n.map(e=>{const t=e.toLowerCase();return wG.has(t)?wG.get(t):t}).sort().join("+"),JWe=n=>n.split("+"),yG=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),x_=n=>{let{which:e,key:t}=n;if(yG.has(e))return yG.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:t.toLowerCase()},Eq=Symbol("shortcut-context");function N1(n){return je(n)&&n.__kindOf===Eq}const e2e=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const t=cN({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${n}" context.`}),r=function(){let{keys:u,callback:c,group:h,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:m=!0,stopPropagation:g=!1,relativeToGroup:C,position:y,forwardToContext:w}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(fn(h))throw new Error("You need to define the shortcut's group.");if(Pt(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(Lt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const S={callback:c,group:h,runOnlyIf:d,captureCtrl:f,preventDefault:m,stopPropagation:g};Re(C)&&(S.relativeToGroup=C,S.position=y),N1(w)&&(S.forwardToContext=w),u.forEach(E=>{const P=UR(E);if(t.hasItem(P)){const I=t.getItem(P);let D=I.findIndex(Q=>Q.group===C);D!==-1?y==="before"?D-=1:D+=1:D=I.length,I.splice(D,0,S)}else t.addItem(P,[S])})},i=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{ct(c,(d,f)=>{Object.prototype.hasOwnProperty.call(h,f)===!1&&(h[f]=c[f])}),r(h)})},s=u=>{const c=UR(u);t.removeItem(c)};return{__kindOf:Eq,scope:e,addShortcut:r,addShortcuts:i,getShortcuts:u=>{const c=UR(u),h=t.getItem(c);return Re(h)?h.slice():[]},hasShortcut:u=>{const c=UR(u);return t.hasItem(c)},removeShortcutsByKeys:s,removeShortcutsByGroup:u=>{t.getItems().forEach(h=>{let[d,f]=h;const m=f.filter(g=>g.group!==u);m.length===0?s(JWe(d)):(f.length=0,f.push(...m))})}}};function t2e(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed(e){return n.has(e)}}}const n2e=["meta","alt","shift","control"],Mw=t2e(),Iw=[];let BR=0;function r2e(n,e,t,r,i){const s=f=>n2e.includes(f),o=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const g=[];return f.altKey&&g.push("alt"),m&&(f.ctrlKey||f.metaKey)?g.push("control/meta"):(f.ctrlKey&&g.push("control"),f.metaKey&&g.push("meta")),f.shiftKey&&g.push("shift"),g},a=f=>{if(e(f)===!1||t(f)===!1||f.keyCode===229||typeof f.key!="string"||hh(f))return;const g=x_(f);let C=[];s(g)||(C=o(f));const y=[g].concat(C);!i(f,y)&&(Kb()&&C.includes("meta")||!Kb()&&C.includes("control"))&&i(f,[g].concat(o(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const m=x_(f);s(m)&&Mw.press(m)}},u=f=>{if(typeof f.key=="string"){const m=x_(f);s(m)&&Mw.release(m)}},c=()=>{Mw.releaseAll()};return{mount:()=>{let f=n;for(BR+=1;f;)BR===1&&(f.document.documentElement.addEventListener("keydown",l),Iw.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Iw.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=Gf(f)},unmount:()=>{let f=n;for(BR-=1;f;){if(BR===0){for(let m=0;m<Iw.length;m++){const{event:g,listener:C}=Iw[m];f.document.documentElement.removeEventListener(g,C)}Iw.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=Gf(f)}},isPressed:f=>Mw.isPressed(f),releasePressedKeys:()=>Mw.releaseAll()}}const i2e=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:r,afterKeyDown:i}=n;const s=cN({errorIdExists:g=>`The "${g}" context name is already registered.`});let o="grid";const a=function(g){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const y=e2e(g,C);return s.addItem(g,y),y},l=()=>o,u=g=>s.getItem(g),c=g=>{if(!s.hasItem(g))throw new Error(Lt`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=g};let h=!1;const d=function(g,C){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const w=N1(y)?y:u(y);let S=!1;if(!w.hasShortcut(C))return S;const E=w.getShortcuts(C);for(let P=0;P<E.length;P++){const{callback:_,runOnlyIf:I,preventDefault:D,stopPropagation:Q,captureCtrl:F,forwardToContext:J}=E[P];if(I(g)===!0){if(h=F,S=_(g,C)===!1,h=!1,D&&g.preventDefault(),Q&&(la(g),g.stopPropagation()),S)break;J&&d(g,C,J)}}return S},m=r2e(e,g=>{const C=l(),y=N1(C)?C:u(C);return t(g,y.scope)},r,i,d);return m.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}};function SG(n){const{classNames:e}=d9(n,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function s2e(n,e){Rq(n,e),e.add(n)}function Kc(n,e,t){Rq(n,e),e.set(n,t)}function Rq(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jn(n,e){return n.get(xa(n,e))}function eo(n,e,t){return n.set(xa(n,e),t),t}function xa(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const CG=23;var Rl=new WeakMap,B0=new WeakMap,HV=new WeakMap,M1=new WeakMap,Zc=new WeakMap,Yw=new WeakMap,PS=new WeakMap,Ow=new WeakMap,Pl=new WeakSet;class o2e{constructor(e){let{rootElement:t,rootDocument:r,onThemeChange:i=()=>{}}=e;s2e(this,Pl),Kc(this,Rl,void 0),Kc(this,B0,void 0),Kc(this,HV,void 0),Kc(this,M1,void 0),Kc(this,Zc,!0),Kc(this,Yw,{}),Kc(this,PS,{}),Kc(this,Ow,void 0),eo(B0,this,t),eo(M1,this,r),eo(Ow,this,i)}isClassicTheme(){return jn(Zc,this)}getCSSVariableValue(e){var t;if(jn(Zc,this))return null;if(jn(Yw,this)[`--ht-${e}`])return jn(Yw,this)[`--ht-${e}`];const r=(t=xa(Pl,this,u2e).call(this,`--ht-${e}`))!==null&&t!==void 0?t:xa(Pl,this,Tq).call(this,`--ht-${e}`);if(r!==null)return jn(Yw,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var t;return(t=jn(PS,this))===null||t===void 0?void 0:t.td[e]}getDefaultRowHeight(){if(jn(Zc,this))return CG;const e=xa(Pl,this,a2e).call(this);return e||CG}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){eo(Rl,this,void 0),eo(Zc,this,!0),jn(Ow,this).call(this,jn(Rl,this)),xa(Pl,this,L_).call(this);return}if(e&&e!==jn(Rl,this)){if(!/ht-theme-.*/.test(e)){wt(`Invalid theme name: ${e}. Please provide a valid theme name.`),eo(Rl,this,void 0),eo(Zc,this,!1),jn(Ow,this).call(this,jn(Rl,this)),xa(Pl,this,L_).call(this);return}jn(Rl,this)&&xa(Pl,this,c2e).call(this),eo(Rl,this,e),eo(Zc,this,!1),jn(Ow,this).call(this,jn(Rl,this)),xa(Pl,this,L_).call(this)}}getThemeName(){return jn(Rl,this)}}function a2e(){const n=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),t=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return n===null||e===null||isNaN(t)?null:n+2*e+t}function L_(){this.isClassicTheme()||eo(HV,this,getComputedStyle(jn(B0,this)));const n=xa(Pl,this,l2e).call(this,["box-sizing","border-bottom-width"]);jn(PS,this).td={...jn(PS,this).td,"box-sizing":n["box-sizing"],"border-bottom-width":n["border-bottom-width"]}}function l2e(n){const e=jn(M1,this),t=jn(B0,this),r=e.createElement("table"),i=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),i.appendChild(s),i.appendChild(o),r.appendChild(i),t.appendChild(r);const l=getComputedStyle(a),u={};return n.forEach(c=>{u[c]=l.getPropertyValue(c)}),t.removeChild(r),u}function u2e(n){const e=Math.ceil(parseFloat(xa(Pl,this,Tq).call(this,n)));return Number.isNaN(e)?null:e}function Tq(n){const e=jn(HV,this).getPropertyValue(n);return e===""?null:e}function c2e(){eo(PS,this,{}),eo(Yw,this,{}),eo(Zc,this,!0)}function h2e(n,e){bq(n,e),e.add(n)}function EG(n,e,t){bq(n,e),e.set(n,t)}function bq(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RG(n,e){return n.get(jp(n,e))}function TG(n,e,t){return n.set(jp(n,e),t),t}function jp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var I1=new WeakMap,O1=new WeakMap,xy=new WeakSet;class d2e{constructor(e){let{rowIndexMapper:t,columnIndexMapper:r}=e;h2e(this,xy),EG(this,I1,void 0),EG(this,O1,void 0),TG(I1,this,t),TG(O1,this,r)}toRenderable(e){const t=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,i=jp(xy,this,bG).call(this,e.from,t,r);if(i===null)return null;const s=jp(xy,this,bG).call(this,e.to,-t,-r);if(s===null)return null;const o=e.clone();return o.from=i,o.to=s,o.includes(e.highlight)||(o.highlight=i),o}}function bG(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const r=jp(xy,this,AG).call(this,RG(I1,this),n.row,e);if(r===null)return null;const i=jp(xy,this,AG).call(this,RG(O1,this),n.col,t);return i===null?null:n.clone().assign({row:r,col:i})}function AG(n,e,t){return e<0?e:n.getNearestNotHiddenIndex(e,t)}let H_=null;const WR=new WeakSet,D_=new Map;function Aq(n,e){var t,r,i=this;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const a=new Zo(o);let l,u,c,h,d,f,m=!0;const g={...e.initialState,...e};jBe(s)&&WBe(this),this.rootContainer=n,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=hf(this)?n.ownerDocument.createElement("div"):n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,hf(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),ee(this.rootElement,["ht-wrapper","handsontable"]),ee(this.rootWrapperElement,"ht-root-wrapper"),ee(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),ee(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const C=(t=g==null?void 0:g.layoutDirection)!==null&&t!==void 0?t:"inherit",y=["rtl","ltr"].includes(C)?C:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),(r=this.rootWrapperElement)===null||r===void 0||r.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new o2e({rootElement:o.rootElement,rootDocument:o.rootDocument,onThemeChange:v=>{hf(this)&&(Me(this.rootWrapperElement,/ht-theme-.*/g),Me(this.rootPortalElement,/ht-theme-.*/g),v&&(ee(this.rootWrapperElement,v),ee(this.rootPortalElement,v),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||wt(`The "${v}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),g.language=dWe(g.language);const w=Object.fromEntries(Object.entries(g).filter(v=>{let[R]=v;return!(we.getSingleton().isRegistered(R)||we.getSingleton().isDeprecated(R))})),S=new Cq(o,w,[HWe,BWe]),E=S.getTableMeta(),P=S.getGlobalMeta(),_=cN();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${ZH()}`,D_.set(this.guid,this),this.columnIndexMapper=new Ux,this.rowIndexMapper=new Ux,this.columnIndexMapper.addLocalHook("indexesSequenceChange",v=>{o.runHooks("afterColumnSequenceChange",v)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",v=>{o.runHooks("afterRowSequenceChange",v)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",v=>{o.runHooks("beforeCompositionStart",v)}),u=new JBe(o);const I=ua(this.guid);I.register("cellRangeMapper",new d2e({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const D=v=>{const{row:R,col:A}=v;return o._createCellCoords(R>=0?o.rowIndexMapper.getRenderableFromVisualIndex(R):R,A>=0?o.columnIndexMapper.getRenderableFromVisualIndex(A):A)},Q=v=>{const{row:R,col:A}=v;return o._createCellCoords(R>=0?o.rowIndexMapper.getVisualFromRenderableIndex(R):R,A>=0?o.columnIndexMapper.getVisualFromRenderableIndex(A):A)},F=(v,R)=>{const A=R>v?1:-1,W=Math.min(v,R),z=Math.max(v,R),X=o.rowIndexMapper.getNearestNotHiddenIndex(v,A);return X===null||A===1&&X>z||A===-1&&X<W?null:X>=0?o.rowIndexMapper.getRenderableFromVisualIndex(X):X},J=(v,R)=>{const A=R>v?1:-1,W=Math.min(v,R),z=Math.max(v,R),X=o.columnIndexMapper.getNearestNotHiddenIndex(v,A);return X===null||A===1&&X>z||A===-1&&X<W?null:X>=0?o.columnIndexMapper.getRenderableFromVisualIndex(X):X};let q=new MX(E,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:v=>l.propToCol(v),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(v,R)=>o._createCellCoords(v,R),createCellRange:(v,R,A)=>o._createCellRange(v,R,A),visualToRenderableCoords:D,renderableToVisualCoords:Q,findFirstNonHiddenRenderableRow:F,findFirstNonHiddenRenderableColumn:J,isDisabledCellSelection:(v,R)=>v<0||R<0?o.getSettings().disableVisualSelection:o.getCellMeta(v,R).disableVisualSelection});this.selection=q;const ie=v=>{let{hiddenIndexesChanged:R}=v;this.forceFullRender=!0,R&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",ie),this.rowIndexMapper.addLocalHook("cacheUpdated",ie),this.selection.addLocalHook("afterSetRangeEnd",(v,R)=>{const A=Rs(!1),W=this.selection.getSelectedRange(),{from:z,to:X}=W.current(),T=W.size()-1;this.runHooks("afterSelection",z.row,z.col,X.row,X.col,A,T),this.runHooks("afterSelectionByProp",z.row,o.colToProp(z.col),X.row,o.colToProp(X.col),A,T),R&&(!A.isTouched()||A.isTouched()&&!A.value)&&f.scrollTo(v);const N=q.isSelectedByRowHeader(),L=q.isSelectedByColumnHeader();N&&L?ee(this.rootElement,["ht__selection--rows","ht__selection--columns"]):N?(Me(this.rootElement,"ht__selection--columns"),ee(this.rootElement,"ht__selection--rows")):L?(Me(this.rootElement,"ht__selection--rows"),ee(this.rootElement,"ht__selection--columns")):Me(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(q.getSelectionSource())||h.closeEditor(null),q.getSelectionSource()!=="refresh"&&(o.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",v=>{this.runHooks("beforeSelectionFocusSet",v.row,v.col)}),this.selection.addLocalHook("afterSetFocus",v=>{const R=Rs(!1);this.runHooks("afterSelectionFocusSet",v.row,v.col,R),(!R.isTouched()||R.isTouched()&&!R.value)&&f.scrollTo(v),h.closeEditor(),o.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",v=>{const R=v.length-1,{from:A,to:W}=v[R];this.runHooks("afterSelectionEnd",A.row,A.col,W.row,W.col,R),this.runHooks("afterSelectionEndByProp",A.row,o.colToProp(A.col),W.row,o.colToProp(W.col),R),q.getSelectionSource()==="refresh"&&(o.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",v=>{const R=this.runHooks("afterIsMultipleSelection",v.value);v.value&&(v.value=R)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),o.view.render(),Me(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("beforeSetRangeStart",...R)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("beforeSetRangeStartOnly",...R)}).addLocalHook("beforeSetRangeEnd",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("beforeSetRangeEnd",...R)}).addLocalHook("beforeSelectColumns",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("beforeSelectColumns",...R)}).addLocalHook("afterSelectColumns",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("afterSelectColumns",...R)}).addLocalHook("beforeSelectRows",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("beforeSelectRows",...R)}).addLocalHook("afterSelectRows",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("afterSelectRows",...R)}).addLocalHook("beforeSelectAll",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("beforeSelectAll",...R)}).addLocalHook("afterSelectAll",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("afterSelectAll",...R)}).addLocalHook("beforeModifyTransformStart",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("modifyTransformStart",...R)}).addLocalHook("afterModifyTransformStart",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("afterModifyTransformStart",...R)}).addLocalHook("beforeModifyTransformFocus",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("modifyTransformFocus",...R)}).addLocalHook("afterModifyTransformFocus",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("afterModifyTransformFocus",...R)}).addLocalHook("beforeModifyTransformEnd",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("modifyTransformEnd",...R)}).addLocalHook("afterModifyTransformEnd",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("afterModifyTransformEnd",...R)}).addLocalHook("beforeRowWrap",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("beforeRowWrap",...R)}).addLocalHook("beforeColumnWrap",function(){for(var v=arguments.length,R=new Array(v),A=0;A<v;A++)R[A]=arguments[A];return i.runHooks("beforeColumnWrap",...R)}).addLocalHook("insertRowRequire",v=>this.alter("insert_row_above",v,1,"auto")).addLocalHook("insertColRequire",v=>this.alter("insert_col_start",v,1,"auto")),c={alter(v,R){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,W=arguments.length>3?arguments[3]:void 0,z=arguments.length>4?arguments[4]:void 0;const X=T=>{if(T.length===0)return[];const N=[...T];return N.sort((V,x)=>{let[U]=V,[Y]=x;return U===Y?0:U>Y?1:-1}),Er(N,(V,x)=>{let[U,Y]=x;const $=V[V.length-1],[j,K]=$,G=j+K;if(U<=G){const ne=Math.max(Y-(G-U),0);$[1]+=ne}else V.push([U,Y]);return V},[N[0]])};switch(v){case"insert_row_below":case"insert_row_above":const T=o.countSourceRows();if(E.maxRows===T)return;const N=v==="insert_row_below"?"below":"above";R=R??(N==="below"?T:0);const{delta:L,startPhysicalIndex:V}=l.createRow(R,A,{source:W,mode:N});q.shiftRows(o.toVisualRow(V),L);break;case"insert_col_start":case"insert_col_end":const x=v==="insert_col_end"?"end":"start";R=R??(x==="end"?o.countSourceCols():0);const{delta:U,startPhysicalIndex:Y}=l.createCol(R,A,{source:W,mode:x});if(U){if(Array.isArray(E.colHeaders)){const K=[o.toVisualColumn(Y),0];K.length+=U,Array.prototype.splice.apply(E.colHeaders,K)}q.shiftColumns(o.toVisualColumn(Y),U)}break;case"remove_row":const $=K=>{let G=0;k(K,ne=>{let[de,Se]=ne;const Ke=Dn(de)?o.countRows()-1:Math.max(de-G,0);if(Number.isInteger(de)&&(de=Math.max(de-G,0)),!l.removeRow(de,Se,W))return;if(q.isSelected()){const{row:Nt}=o.getSelectedRangeActive().highlight;Nt>=de&&Nt<=de+Se-1&&h.closeEditor(!0)}const _t=o.countRows(),Xe=E.fixedRowsTop;Xe>=Ke+1&&(E.fixedRowsTop-=Math.min(Se,Xe-Ke));const Ze=E.fixedRowsBottom;if(Ze&&Ke>=_t-Ze&&(E.fixedRowsBottom-=Math.min(Se,Ze)),_t===0)q.deselect();else if(W==="ContextMenu.removeRow"){const Nt=q.getSelectedRange(),Qr=Nt.pop();Nt.clear().set(Qr.from).current().setTo(Qr.to),q.refresh()}else q.shiftRows(de,-Se);G+=Se})};Array.isArray(R)?$(X(R)):$([[R,A]]);break;case"remove_col":const j=K=>{let G=0;k(K,ne=>{let[de,Se]=ne;const Ke=Dn(de)?o.countCols()-1:Math.max(de-G,0);let St=o.toPhysicalColumn(Ke);if(Number.isInteger(de)&&(de=Math.max(de-G,0)),!l.removeCol(de,Se,W))return;if(q.isSelected()){const{col:Nt}=o.getSelectedRangeActive().highlight;Nt>=de&&Nt<=de+Se-1&&h.closeEditor(!0)}if(o.countCols()===0)q.deselect();else if(W==="ContextMenu.removeColumn"){const Nt=q.getSelectedRange(),Qr=Nt.pop();Nt.clear().set(Qr.from).current().setTo(Qr.to),q.refresh()}else q.shiftColumns(de,-Se);const Ze=E.fixedColumnsStart;Ze>=Ke+1&&(E.fixedColumnsStart-=Math.min(Se,Ze-Ke)),Array.isArray(E.colHeaders)&&(typeof St>"u"&&(St=-1),E.colHeaders.splice(St,Se)),G+=Se})};Array.isArray(R)?j(X(R)):j([[R,A]]);break;default:throw new Error(`There is no such action "${v}"`)}z||c.adjustRowsAndCols(),o.view.adjustElementsSize(),o.view.render()},adjustRowsAndCols(){const v=E.minRows,R=E.minSpareRows,A=E.minCols,W=E.minSpareCols;if(v){const z=o.countRows();z<v&&l.createRow(z,v-z,{source:"auto"})}if(R){const z=o.countEmptyRows(!0);if(z<R){const X=R-z,T=Math.min(X,E.maxRows-o.countSourceRows());l.createRow(o.countRows(),T,{source:"auto"})}}{let z;(A||W)&&(z=o.countEmptyCols(!0));let X=o.countCols();if(A&&!E.columns&&X<A){const T=A-X;z+=T,l.createCol(X,T,{source:"auto"})}if(W&&!E.columns&&o.dataType==="array"&&z<W){X=o.countCols();const T=W-z,N=Math.min(T,E.maxCols-X);l.createCol(X,N,{source:"auto"})}}},populateFromArray(v,R,A,W,z){let X,T,N,L;const V=[],x={},U=[],Y=v.row,$=v.col;if(T=R.length,T===0)return!1;let j=0,K=0;switch(je(A)&&(j=A.col-$+1,K=A.row-Y+1),z){case"shift_down":const ne=uy(R),de=ne.length,Se=Math.max(de,j),Ke=o.getData().slice(Y),St=uy(Ke).slice($,$+Se);for(N=0;N<Se;N+=1)if(N<de){for(X=0,T=ne[N].length;X<K-T;X+=1)ne[N].push(ne[N][X%T]);N<St.length?U.push(ne[N].concat(St[N])):U.push(ne[N].concat(new Array(Ke.length).fill(null)))}else U.push(ne[N%de].concat(St[N]));o.populateFromArray(Y,$,uy(U));break;case"shift_right":const _t=R.length,Xe=Math.max(_t,K),Ze=o.getData().slice(Y).map(Ht=>Ht.slice($));for(X=0;X<Xe;X+=1)if(X<_t){for(N=0,L=R[X].length;N<j-L;N+=1)R[X].push(R[X][N%L]);if(X<Ze.length)for(let Ht=0;Ht<Ze[X].length;Ht+=1)R[X].push(Ze[X][Ht]);else R[X].push(...new Array(Ze[0].length).fill(null))}else R.push(R[X%T].slice(0,Xe).concat(Ze[X]));o.populateFromArray(Y,$,R);break;case"overwrite":default:x.row=v.row,x.col=v.col;let Nt=0,Qr=0,Ls=!0,Hs;const Dr=function($t){let tl=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const dd=R[$t%R.length];return tl!==null?dd[tl%dd.length]:dd},Ds=R.length,ln=A?A.row-v.row+1:0;for(A?T=ln:T=Math.max(Ds,ln),X=0;X<T&&!(A&&x.row>A.row&&ln>Ds||!E.allowInsertRow&&x.row>o.countRows()-1||x.row>=E.maxRows);X++){const Ht=X-Nt,$t=Dr(Ht).length,tl=A?A.col-v.col+1:0;if(A?L=tl:L=Math.max($t,tl),x.col=v.col,Hs=o.getCellMeta(x.row,x.col),(W==="CopyPaste.paste"||W==="Autofill.fill")&&Hs.skipRowOnPaste){Nt+=1,x.row+=1,T+=1;continue}for(Qr=0,N=0;N<L;N++){var G;if(A&&x.col>A.col&&tl>$t||!E.allowInsertColumn&&x.col>o.countCols()-1||x.col>=E.maxCols)break;if(Hs=o.getCellMeta(x.row,x.col),(W==="CopyPaste.paste"||W==="Autofill.fill")&&Hs.skipColumnOnPaste){Qr+=1,x.col+=1,L+=1;continue}if(Hs.readOnly&&W!=="UndoRedo.undo"){x.col+=1;continue}const dd=N-Qr,Tc=!!Hs.valueSetter;let Pi=Dr(Ht,dd),Fs=(G=o.getSourceDataAtCell(x.row,x.col))!==null&&G!==void 0?G:null;if(Pi!==null&&typeof Pi=="object"){if(Array.isArray(Pi)&&Fs===null&&(Fs=[]),!Tc&&(typeof Fs!="object"||Fs===null))Ls=!1;else if(Fs!==null){const bc=Hp(Array.isArray(Fs)?Fs:Fs[0]||Fs),LC=Hp(Array.isArray(Pi)?Pi:Pi[0]||Pi);Tc||uC(bc,LC)||Array.isArray(bc)&&Array.isArray(LC)?Pi=Oi(Pi):Ls=!1}}else!Tc&&Fs!==null&&typeof Fs=="object"&&(Ls=!1);Ls&&V.push([x.row,x.col,Pi]),Ls=!0,x.col+=1}x.row+=1}o.setDataAtCell(V,null,null,W||"populateFromArray");break}}};function fe(v){const R=hq(v);LV(R)?(o.runHooks("beforeLanguageChange",R),P.language=R,o.runHooks("afterLanguageChange",R)):dq(v)}function Ee(v,R){const A=v==="className"?o.rootElement:o.table;if(m)ee(A,R);else{let W=[],z=[];P[v]&&(W=Array.isArray(P[v])?P[v]:Nx(P[v])),R&&(z=Array.isArray(R)?R:Nx(R));const X=Ax(W,z),T=Ax(z,W);X.length&&Me(A,X),T.length&&ee(A,T)}P[v]=R}this.init=function(){u.setData(E.data),o.runHooks("beforeInit"),(Ua()||sD())&&ee(o.rootElement,"mobile"),this.updateSettings(g,!0),this.view=new KBe(this),h=b1.getInstance(o,E,q),f=ZWe(o),d=new $Be(o),hf(this)&&(jWe(o),CVe(o.rootPortalElement),k5(g.licenseKey,this.rootWrapperElement)),o.runHooks("init"),this.render(),m&&o.rootElement.offsetParent===null&&E9(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.view.adjustElementsSize(),o.render()}),typeof m=="object"&&(o.runHooks("afterChange",m[0],m[1]),m=!1),o.runHooks("afterInit")};function ke(){let v=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,v=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&v===!1&&(v=!0,this.onQueueEmpty(this.valid))}}}function be(v,R,A){if(!v.length){A();return}const W=o.getActiveEditor(),z=new ke;let X=!0;z.onQueueEmpty=()=>{W&&X&&W.cancelChanges(),A()};for(let T=v.length-1;T>=0;T--){const[N,L,,V]=v[T],x=l.propToCol(L);let U;Number.isInteger(x)?U=o.getCellMeta(N,x):U={...Object.getPrototypeOf(E),...E},o.getCellValidator(U)&&(z.addValidatorToQueue(),o.validateCell(V,U,function(Y,$){return function(j){if(typeof j!="boolean")throw new Error("Validation error: result is not boolean");j===!1&&$.allowInvalid===!1&&(X=!1,v.splice(Y,1),$.valid=!0),z.removeValidatorFormQueue()}}(T,U),R))}z.checkIfQueueIsEmpty()}function re(v,R){for(let W=v.length-1;W>=0;W--){let z=!1;if(v[W]===null){v.splice(W,1);continue}if(!((v[W][2]===null||v[W][2]===void 0)&&(v[W][3]===null||v[W][3]===void 0))){if(E.allowInsertRow)for(;v[W][0]>o.countRows()-1;){const{delta:X}=l.createRow(void 0,void 0,{source:"auto"});if(X===0){z=!0;break}}if(o.dataType==="array"&&(!E.columns||E.columns.length===0)&&E.allowInsertColumn)for(;l.propToCol(v[W][1])>o.countCols()-1;){const{delta:X}=l.createCol(void 0,void 0,{source:"auto"});if(X===0){z=!0;break}}z||l.set(v[W][0],v[W][1],v[W][3])}}if(v.length>0){c.adjustRowsAndCols(),o.runHooks("beforeChangeRender",v,R),h.closeEditor(),o.view.adjustElementsSize(),o.render(),h.prepareEditor(),o.runHooks("afterChange",v,R||"edit");const W=o.getActiveEditor();W&&Re(W.refreshValue)&&W.refreshValue()}else o.render()}this._createCellCoords=function(v,R){return o.view._wt.createCellCoords(v,R)},this._createCellRange=function(v,R,A){return o.view._wt.createCellRange(v,R,A)},this.validateCell=function(v,R,A,W){let z=o.getCellValidator(R);function X(T){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||R.hidden===!0){A(T);return}const L=R.visualCol,V=R.visualRow,x=o.getCell(V,L,!0);if(x&&x.nodeName!=="TH"){const U=o.rowIndexMapper.getRenderableFromVisualIndex(V),Y=o.columnIndexMapper.getRenderableFromVisualIndex(L);o.view._wt.getSetting("cellRenderer",U,Y,x)}A(T)}F5(z)&&(z=function(T){return function(N,L){L(T.test(N))}}(z)),Pt(z)?(v=o.runHooks("beforeValidate",v,R.visualRow,R.prop,W),o._registerImmediate(()=>{z.call(R,v,T=>{o&&(T=o.runHooks("afterValidate",T,v,R.visualRow,R.prop,W),R.valid=T,X(T),o.runHooks("postAfterValidate",T,v,R.visualRow,R.prop,W))})})):o._registerImmediate(()=>{R.valid=!0,X(R.valid,!1)})};function ae(v,R,A){return Array.isArray(v)?v:[[v,R,A]]}function le(v,R){const A=o.runHooks("beforeChange",v,R||"edit"),W=v.filter(X=>X!==null);if(A===!1||W.length===0){var z;return(z=o.getActiveEditor())===null||z===void 0||z.cancelChanges(),[]}for(let X=W.length-1;X>=0;X--){const[T,N,,L]=W[X],V=l.propToCol(N);let x;Number.isInteger(V)?x=o.getCellMeta(T,V):x={...Object.getPrototypeOf(E),...E},W[X][3]=__(L,x)}return W}this.setDataAtCell=function(v,R,A,W){const z=ae(v,R,A),X=[];let T=W,N,L,V;for(N=0,L=z.length;N<L;N++){const[U,Y,$]=z[N];if(typeof z[N]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof Y!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");Y>=this.countCols()?V=Y:V=l.colToProp(Y),X.push([U,V,u.getAtCell(this.toPhysicalRow(U),Y),$])}!T&&typeof v=="object"&&(T=R);const x=le(X,T);o.runHooks("afterSetDataAtCell",x,T),be(x,T,()=>{re(x,T)})},this.setDataAtRowProp=function(v,R,A,W){const z=ae(v,R,A),X=[];let T=W,N,L;for(N=0,L=z.length;N<L;N++){const[x,U,Y]=z[N];X.push([x,U,u.getAtCell(this.toPhysicalRow(x),U),Y])}!T&&typeof v=="object"&&(T=R);const V=le(X,W);o.runHooks("afterSetDataAtRowProp",V,T),be(V,T,()=>{re(V,T)})},this.listen=function(){o&&!o.isListening()&&(D_.forEach(v=>{o!==v&&v.unlisten()}),H_=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(H_=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return H_===o.guid},this.destroyEditor=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(v),o.view.render(),R&&q.isSelected()&&h.prepareEditor()},this.populateFromArray=function(v,R,A,W,z,X,T){if(!(typeof A=="object"&&typeof A[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const N=typeof W=="number"?o._createCellCoords(W,z):null;return c.populateFromArray(o._createCellCoords(v,R),A,N,X,T)},this.spliceCol=function(v,R,A){for(var W=arguments.length,z=new Array(W>3?W-3:0),X=3;X<W;X++)z[X-3]=arguments[X];return l.spliceCol(v,R,A,...z)},this.spliceRow=function(v,R,A){for(var W=arguments.length,z=new Array(W>3?W-3:0),X=3;X<W;X++)z[X-3]=arguments[X];return l.spliceRow(v,R,A,...z)},this.getSelected=function(){if(q.isSelected())return At(q.getSelectedRange(),v=>{let{from:R,to:A}=v;return[R.row,R.col,A.row,A.col]})},this.getSelectedLast=function(){const v=this.getSelected();let R;return v&&v.length>0&&(R=v[v.length-1]),R},this.getSelectedActive=function(){const v=this.getSelectedRangeActive();if(!v)return;const{from:R,to:A}=v;return[R.row,R.col,A.row,A.col]},this.getSelectedRange=function(){if(q.isSelected())return Array.from(q.getSelectedRange())},this.getSelectedRangeLast=function(){const v=this.getSelectedRange();let R;return v&&v.length>0&&(R=v[v.length-1]),R},this.getSelectedRangeActive=function(){return q.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return q.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(v){if(!q.isSelected()||this.countRows()===0||this.countCols()===0)return;const R=[];k(q.getSelectedRange(),A=>{if(A.isSingleHeader())return;const W=A.getTopStartCorner(),z=A.getBottomEndCorner();Le(W.row,z.row,X=>{Le(W.col,z.col,T=>{this.getCellMeta(X,T).readOnly||R.push([X,T,null])})})}),R.length>0&&this.setDataAtCell(R,v)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const v=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(v,0),!this.isRenderSuspended()&&v===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(v){this.suspendRender();const R=v();return this.resumeRender(),R},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const R=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(R,0),(!this.isExecutionSuspended()&&R===this.executionSuspendedCounter||v)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(v){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const A=v();return this.resumeExecution(R),A},this.batch=function(v){this.suspendRender(),this.suspendExecution();const R=v();return this.resumeExecution(),this.resumeRender(),R},this.refreshDimensions=function(){if(!o.view)return;const v=o.view,{width:R,height:A}=v.getLastSize(),{width:W,height:z}=o.rootElement.getBoundingClientRect(),X=W!==R||z!==A;o.runHooks("beforeRefreshDimensions",{width:R,height:A},{width:W,height:z},X)!==!1&&((X||v._wt.wtOverlays.scrollableElement===o.rootWindow)&&(v.setLastSize(W,z),v.adjustElementsSize(),o.render()),o.runHooks("afterRefreshDimensions",{width:R,height:A},{width:W,height:z},X))},this.updateData=function(v,R){mG(v,A=>{l=A},A=>{l=A,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),q.refresh()},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"updateData",source:R,metaManager:S,firstRun:m})},this.loadData=function(v,R){mG(v,A=>{l=A},()=>{S.clearCellsCache(),o.initIndexMappers(),c.adjustRowsAndCols(),q.refresh(),m&&(m=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"loadData",source:R,metaManager:S,firstRun:m})},this.getInitialColumnCount=function(){const v=E.columns;let R=0;if(Array.isArray(v))R=v.length;else if(Pt(v))if(o.dataType==="array"){const A=this.countSourceCols();for(let W=0;W<A;W+=1)v(W)&&(R+=1)}else(o.dataType==="object"||o.dataType==="function")&&(R=l.colToPropCache.length);else if(Re(E.dataSchema)){const A=l.getSchema();R=Array.isArray(A)?A.length:qA(A)}else R=this.countSourceCols();return R},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(v,R,A,W){return fn(v)?l.getAll():l.getRange(o._createCellCoords(v,R),o._createCellCoords(A,W),l.DESTINATION_RENDERER)},this.getCopyableText=function(v,R,A,W){return l.getCopyableText(o._createCellCoords(v,R),o._createCellCoords(A,W))},this.getCopyableData=function(v,R){return l.getCopyable(v,l.colToProp(R))},this.getCopyableSourceData=function(v,R){return u.getCopyable(v,l.colToProp(R))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(v){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const A=(m?o.loadData:o.updateData).bind(this);let W=!1,z,X;if(Re(v.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Re(v.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Re(v.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(z in v)if(!(z==="data"||z==="language"))if(z==="className")Ee("className",v.className);else if(z==="tableClassName"&&o.table)Ee("tableClassName",v.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(we.getSingleton().isRegistered(z)||we.getSingleton().isDeprecated(z)){const x=v[z];Pt(x)?(we.getSingleton().addAsFixed(z,x,o),E[z]=x):Array.isArray(x)&&(we.getSingleton().add(z,x,o),E[z]=x)}else!R&&xn(v,z)&&(P[z]=v[z]);if(R)o.useTheme(E.themeName||SG(o.rootContainer));else{const x=o.getCurrentThemeName();xn(v,"themeName")&&x!==v.themeName&&o.useTheme(v.themeName)}WR.has(o)&&o.stylesHandler.getThemeName()!==void 0&&WR.delete(o),hf(o)&&!WR.has(o)&&o.stylesHandler.isClassicTheme()&&(j9("Handsontable classic theme is a legacy theme and will be removed in version 17.0. Please update your theme settings to ensure compatibility with future versions."),WR.add(o)),v.data===void 0&&E.data===void 0?A(null,"updateSettings"):v.data!==void 0?A(v.data,"updateSettings"):v.columns!==void 0&&(l.createMap(),o.initIndexMappers()),!m&&v.language&&fe(v.language);const T=o.countCols(),N=E.columns;if(N&&Pt(N)&&(W=!0),(v.cell!==void 0||v.cells!==void 0||v.columns!==void 0)&&S.clearCache(),T>0)for(z=0,X=0;z<T;z++){if(N){const x=W?N(z):N[X];x&&S.updateColumnMeta(X,x)}X+=1}Re(v.cell)&&ct(v.cell,x=>{o.setCellMetaObject(x.row,x.col,x)}),o.runHooks("afterCellMetaReset");let L=o.rootElement.style.height;L!==""&&(L=parseInt(o.rootElement.style.height,10)),R&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"));let V=v.height;if(typeof v.height<"u")if(Pt(V)&&(V=V()),V=o.runHooks("beforeHeightChange",V),V===null){const x=o.rootElement.getAttribute("data-initialstyle");x&&(x.indexOf("height")>-1||x.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",x):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else V!==void 0&&(o.rootElement.style.height=isNaN(V)?`${V}`:`${V}px`,o.rootElement.style.overflow="hidden");if(typeof v.width<"u"){let x=v.width;Pt(x)&&(x=x()),x=o.runHooks("beforeWidthChange",x),o.rootElement.style.width=isNaN(x)?`${x}`:`${x}px`}R||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",v)),c.adjustRowsAndCols(),o.view&&!m&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!R&&o.view&&(L===""||V===""||V===void 0)&&L!==V&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const v=o.getSelectedRangeActive();if(E.getValue){if(Pt(E.getValue))return E.getValue.call(o);if(v)return o.getData()[v.highlight.row][E.getValue]}else if(v)return o.getDataAtCell(v.highlight.row,v.highlight.col);return null},this.getSettings=function(){return E},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(v,R,A,W,z){c.alter(v,R,A,W,z)},this.getCell=function(v,R){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,W=R,z=v;if(R>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(R)))return null;W=this.columnIndexMapper.getRenderableFromVisualIndex(R)}if(v>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(v)))return null;z=this.rowIndexMapper.getRenderableFromVisualIndex(v)}return z===null||W===null||z===void 0||W===void 0?null:o.view.getCellAtCoords(o._createCellCoords(z,W),A)},this.getCoords=function(v){const R=this.view._wt.wtTable.getCoords(v);if(R===null)return null;const{row:A,col:W}=R;let z=A,X=W;return A>=0&&(z=this.rowIndexMapper.getVisualFromRenderableIndex(A)),W>=0&&(X=this.columnIndexMapper.getVisualFromRenderableIndex(W)),o._createCellCoords(z,X)},this.colToProp=function(v){return l.colToProp(v)},this.propToCol=function(v){return l.propToCol(v)},this.toVisualRow=v=>this.rowIndexMapper.getVisualFromPhysicalIndex(v),this.toVisualColumn=v=>this.columnIndexMapper.getVisualFromPhysicalIndex(v),this.toPhysicalRow=v=>this.rowIndexMapper.getPhysicalFromVisualIndex(v),this.toPhysicalColumn=v=>this.columnIndexMapper.getPhysicalFromVisualIndex(v),this.getDataAtCell=function(v,R){return l.get(v,l.colToProp(R))},this.getDataAtRowProp=function(v,R){return l.get(v,R)},this.getDataAtCol=function(v){const R=[],A=l.getRange(o._createCellCoords(0,v),o._createCellCoords(E.data.length-1,v),l.DESTINATION_RENDERER);for(let W=0;W<A.length;W+=1)for(let z=0;z<A[W].length;z+=1)R.push(A[W][z]);return R},this.getDataAtProp=function(v){const R=[],A=l.getRange(o._createCellCoords(0,l.propToCol(v)),o._createCellCoords(E.data.length-1,l.propToCol(v)),l.DESTINATION_RENDERER);for(let W=0;W<A.length;W+=1)for(let z=0;z<A[W].length;z+=1)R.push(A[W][z]);return R},this.getSourceData=function(v,R,A,W){let z;return v===void 0?z=u.getData():z=u.getByRange(o._createCellCoords(v,R),o._createCellCoords(A,W)),z},this.getSourceDataArray=function(v,R,A,W){let z;return v===void 0?z=u.getData(!0):z=u.getByRange(o._createCellCoords(v,R),o._createCellCoords(A,W),!0),z},this.getSourceDataAtCol=function(v){return u.getAtColumn(v)},this.setSourceDataAtCell=function(v,R,A,W){const z=ae(v,R,A),X=this.hasHook("afterSetSourceDataAtCell"),T=[],N=(V,x)=>{const U=this.toVisualRow(V),Y=this.toVisualColumn(x);return Number.isInteger(Y)?this.getCellMeta(U,Y):{...Object.getPrototypeOf(E),...E}};X&&k(z,V=>{let[x,U,Y]=V;const $=__(Y,N(x,U));T.push([x,U,u.getAtCell(x,U),$])}),k(z,V=>{let[x,U,Y]=V;const $=__(Y,N(x,U));u.setAtCell(x,U,$)}),X&&this.runHooks("afterSetSourceDataAtCell",T,W),this.render();const L=o.getActiveEditor();L&&Re(L.refreshValue)&&L.refreshValue()},this.getSourceDataAtRow=function(v){return u.getAtRow(v)},this.getSourceDataAtCell=function(v,R){return u.getAtCell(v,R)},this.getDataAtRow=function(v){return l.getRange(o._createCellCoords(v,0),o._createCellCoords(v,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(v,R,A,W){const z=v===void 0?[0,0,this.countRows(),this.countCols()]:[v,R,A,W],[X,T]=z;let[,,N,L]=z,V=null,x=null;N===void 0&&(N=X),L===void 0&&(L=T);let U="mixed";return Le(Math.max(Math.min(X,N),0),Math.max(X,N),Y=>{let $=!0;return Le(Math.max(Math.min(T,L),0),Math.max(T,L),j=>(x=this.getCellMeta(Y,j).type,V?$=V===x:V=x,$)),U=$?x:"mixed",$}),U},this.removeCellMeta=function(v,R,A){const[W,z]=[this.toPhysicalRow(v),this.toPhysicalColumn(R)];let X=S.getCellMetaKeyValue(W,z,A);o.runHooks("beforeRemoveCellMeta",v,R,A,X)!==!1&&(S.removeCellMeta(W,z,A),o.runHooks("afterRemoveCellMeta",v,R,A,X)),X=null},this.spliceCellsMeta=function(v){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var A=arguments.length,W=new Array(A>2?A-2:0),z=2;z<A;z++)W[z-2]=arguments[z];if(W.length>0&&!Array.isArray(W[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");R>0&&S.removeRow(this.toPhysicalRow(v),R),W.length>0&&k(W.reverse(),X=>{S.createRow(this.toPhysicalRow(v)),k(X,(T,N)=>this.setCellMetaObject(v,N,T))}),o.render()},this.setCellMetaObject=function(v,R,A){typeof A=="object"&&ct(A,(W,z)=>{this.setCellMeta(v,R,z,W)})},this.setCellMeta=function(v,R,A,W){if(o.runHooks("beforeSetCellMeta",v,R,A,W)===!1)return;let X=v,T=R;v<this.countRows()&&(X=this.toPhysicalRow(v)),R<this.countCols()&&(T=this.toPhysicalColumn(R)),S.setCellMeta(X,T,A,W),o.runHooks("afterSetCellMeta",v,R,A,W)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(v,R){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},W=this.toPhysicalRow(v),z=this.toPhysicalColumn(R);return W===null&&(W=v),z===null&&(z=R),S.getCellMeta(W,z,{visualRow:v,visualColumn:R,...A})},this.getColumnMeta=function(v){return S.getColumnMeta(this.toPhysicalColumn(v))},this.getCellMetaAtRow=function(v){return S.getCellsMetaAtRow(v)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||E.columns)},this.getCellRenderer=function(v,R){const A=typeof v=="number"?o.getCellMeta(v,R).renderer:v.renderer;return typeof A=="string"?r0(A):fn(A)?r0("text"):A},this.getCellEditor=function(v,R){const A=typeof v=="number"?o.getCellMeta(v,R).editor:v.editor;return typeof A=="string"?Zb(A):fn(A)?Zb("text"):A},this.getCellValidator=function(v,R){const A=typeof v=="number"?o.getCellMeta(v,R).validator:v.validator;return typeof A=="string"?pk(A):A},this.validateCells=function(v){this._validateCells(v)},this.validateRows=function(v,R){if(!Array.isArray(v))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(R,v)},this.validateColumns=function(v,R){if(!Array.isArray(v))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(R,void 0,v)},this._validateCells=function(v,R,A){const W=new ke;v&&(W.onQueueEmpty=v);let z=o.countRows()-1;for(;z>=0;){if(R!==void 0&&R.indexOf(z)===-1){z-=1;continue}let X=o.countCols()-1;for(;X>=0;){if(A!==void 0&&A.indexOf(X)===-1){X-=1;continue}W.addValidatorToQueue(),o.validateCell(o.getDataAtCell(z,X),o.getCellMeta(z,X),T=>{if(typeof T!="boolean")throw new Error("Validation error: result is not boolean");T===!1&&(W.valid=!1),W.removeValidatorFormQueue()},"validateCells"),X-=1}z-=1}W.checkIfQueueIsEmpty()},this.getRowHeader=function(v){let R=E.rowHeaders,A=v;return A!==void 0&&(A=o.runHooks("modifyRowHeader",A)),A===void 0?(R=[],Le(o.countRows()-1,W=>{R.push(o.getRowHeader(W))})):Array.isArray(R)&&R[A]!==void 0?R=R[A]:Pt(R)?R=R(A):R&&typeof R!="string"&&typeof R!="number"&&(R=A+1),R},this.hasRowHeaders=function(){return!!E.rowHeaders},this.hasColHeaders=function(){if(E.colHeaders!==void 0&&E.colHeaders!==null)return!!E.colHeaders;for(let v=0,R=o.countCols();v<R;v++)if(o.getColHeader(v))return!0;return!1},this.getColHeader=function(v){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const A=o.runHooks("modifyColHeader",v);if(A===void 0){const N=[],L=o.countCols();for(let V=0;V<L;V++)N.push(o.getColHeader(V));return N}let W=E.colHeaders;const z=function(N){const L=[],V=o.countCols();let x=0;for(;x<V;x++)Pt(E.columns)&&E.columns(x)&&L.push(x);return L[N]},X=o.toPhysicalColumn(A),T=z(X);return E.colHeaders===!1?W=null:E.columns&&Pt(E.columns)&&E.columns(T)&&E.columns(T).title?W=E.columns(T).title:E.columns&&E.columns[X]&&E.columns[X].title?W=E.columns[X].title:Array.isArray(E.colHeaders)&&E.colHeaders[X]!==void 0?W=E.colHeaders[X]:Pt(E.colHeaders)?W=E.colHeaders(X):E.colHeaders&&typeof E.colHeaders!="string"&&typeof E.colHeaders!="number"&&(W=ON(A)),W=o.runHooks("modifyColumnHeaderValue",W,v,R),W},this._getColWidthFromSettings=function(v){let R;if(v>=0&&(R=o.getCellMeta(0,v).width),(R===void 0||R===E.width)&&(R=E.colWidths),R!=null){switch(typeof R){case"object":R=R[v];break;case"function":R=R(v);break}typeof R=="string"&&(R=parseInt(R,10))}return R},this.getColWidth=function(v,R){let A=o._getColWidthFromSettings(v);return A=o.runHooks("modifyColWidth",A,v,R),A===void 0&&(A=Vp),A},this._getRowHeightFromSettings=function(v){const R=o.stylesHandler.getDefaultRowHeight();let A=E.rowHeights;if(A!=null){switch(typeof A){case"object":A=A[v];break;case"function":A=A(v);break}typeof A=="string"&&(A=parseInt(A,10))}return A!=null&&A<R?R:A},this.getRowHeight=function(v,R){let A=o._getRowHeightFromSettings(v);return A=o.runHooks("modifyRowHeight",A,v,R),A},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const v=E.maxCols,R=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(v,R)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return xx(o.countRows()-1,A=>{if(o.isEmptyRow(A))R+=1;else if(v===!0)return!1}),R},this.countEmptyCols=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return xx(o.countCols()-1,A=>{if(o.isEmptyCol(A))R+=1;else if(v===!0)return!1}),R},this.isEmptyRow=function(v){return E.isEmptyRow.call(o,v)},this.isEmptyCol=function(v){return E.isEmptyCol.call(o,v)},this.selectCell=function(v,R,A,W){let z=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,X=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return fn(v)||fn(R)?!1:this.selectCells([[v,R,A,W]],z,X)},this.selectCells=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;R===!1&&f.suspend();const W=q.selectCells(v);return W&&A&&o.listen(),f.resume(),W},this.selectColumns=function(v){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v,A=arguments.length>2?arguments[2]:void 0;return q.selectColumns(v,R,A)},this.selectRows=function(v){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v,A=arguments.length>2?arguments[2]:void 0;return q.selectRows(v,R,A)},this.deselectCell=function(){q.deselect()},this.selectAll=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v,A=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),q.selectAll(v,R,A)};const ye=(v,R)=>v.getNearestNotHiddenIndex(R,1,!0);this.scrollViewportTo=function(v,R){if(typeof v=="number"){var A;v={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(A=arguments[4])!==null&&A!==void 0?A:!0}}const{row:W,col:z,considerHiddenIndexes:X}=v??{};let T=W,N=z;if(Pt(R)&&this.addHookOnce("afterScroll",R),X===void 0||X){const U=Number.isInteger(W)&&W>=0,Y=Number.isInteger(z)&&z>=0,$=U?ye(this.rowIndexMapper,W):void 0,j=Y?ye(this.columnIndexMapper,z):void 0;if($===null||j===null)return!1;T=U?o.rowIndexMapper.getRenderableFromVisualIndex($):W,N=Y?o.columnIndexMapper.getRenderableFromVisualIndex(j):z}const L=Number.isInteger(T),V=Number.isInteger(N);let x=!1;return L&&T>=0&&V&&N>=0?x=o.view.scrollViewport(o._createCellCoords(T,N),v.horizontalSnap,v.verticalSnap):L&&T>=0&&(V&&N<0||!V)?x=o.view.scrollViewportVertically(T,v.verticalSnap):V&&N>=0&&(L&&T<0||!L)&&(x=o.view.scrollViewportHorizontally(N,v.horizontalSnap)),Pt(R)&&(x?this.view.render():(this.removeHook("afterScroll",R),this._registerMicrotask(()=>R()))),x},this.scrollToFocusedCell=function(v){if(!this.selection.isSelected())return!1;Pt(v)&&this.addHookOnce("afterScroll",v);const{highlight:R}=this.getSelectedRangeActive(),A=this.scrollViewportTo(R.toObject());return A?this.view.render():Pt(v)&&(this.removeHook("afterScroll",v),this._registerMicrotask(()=>v())),A},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),u&&u.destroy(),u=null,hf(this)&&EVe(),this.getShortcutManager().destroy(),I.clear(),S.clearCache(),D_.delete(this.guid),a.destroy(),h&&h.destroy(),o.rootContainer&&Jl(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),_.getItems().forEach(v=>{let[,R]=v;R.destroy()}),_.clear(),o.runHooks("afterDestroy")},!0),we.getSingleton().destroy(o),ct(o,(v,R,A)=>{Pt(v)?A[R]=ze(R):R!=="guid"&&(A[R]=null)}),o.isDestroyed=!0,l&&l.destroy(),l=null,c=null,q=null,h=null,o=null};function ze(v){return()=>{throw new Error(`The "${v}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(v){return _.getItem(_i(v))},this.getPluginName=function(v){return v===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:_.getId(v)},this.getInstance=function(){return o},this.addHook=function(v,R,A){we.getSingleton().add(v,R,o,A)},this.hasHook=function(v){return we.getSingleton().has(v,o)||we.getSingleton().has(v)},this.addHookOnce=function(v,R,A){we.getSingleton().once(v,R,o,A)},this.removeHook=function(v,R){we.getSingleton().remove(v,R,o)},this.runHooks=function(v,R,A,W,z,X,T){return we.getSingleton().run(o,v,R,A,W,z,X,T)},this.getTranslatedPhrase=function(v,R){return yq(E.language,v,R)},this.toHTML=()=>qx(this),this.toTableElement=()=>{const v=this.rootDocument.createElement("div");return v.insertAdjacentHTML("afterbegin",qx(this)),v.firstElementChild},this.timeouts=[],this.useTheme=v=>{const R=!!m;this.stylesHandler.useTheme(v);const A=this.stylesHandler.getThemeName();R||(o.render(),o.scrollViewportTo(0,0),SG(this.rootContainer)&&(Me(this.rootContainer,/ht-theme-.*/g),A&&ee(this.rootContainer,A))),this.runHooks("afterSetTheme",A,R)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(v){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,A=v;typeof A=="function"&&(A=setTimeout(A,R)),this.timeouts.push(A)},this._clearTimeouts=function(){k(this.timeouts,v=>{clearTimeout(v)})},this.immediates=[],this._registerImmediate=function(v){this.immediates.push(setImmediate(v))},this._clearImmediates=function(){k(this.immediates,v=>{clearImmediate(v)})},this._registerMicrotask=function(v){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||v()})},this._getEditorManager=function(){return h};const et=i2e({handleEvent(){return o.isListening()},beforeKeyDown:v=>this.runHooks("beforeKeyDown",v),afterKeyDown:v=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",v)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",v=>{v.ctrlKey===!1&&v.metaKey===!1&&et.releasePressedKeys()}),this.getShortcutManager=function(){return et},this.getFocusManager=function(){return d},yk().forEach(v=>{const R=vC(v);_.addItem(v,new R(this))}),Jye(o),et.setActiveContextName("grid"),we.getSingleton().run(o,"construct")}No(f8);Ye.editors={BaseEditor:uv};function Ye(n,e){const t=new Aq(n,e||{},xV);return t.init(),t}Ye.Core=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Aq(n,e,xV)};Ye.DefaultSettings=Sq();Ye.hooks=we.getSingleton();Ye.CellCoords=Kf;Ye.CellRange=dv;Ye.packageName="handsontable";Ye.buildDate="23/09/2025 14:16:56";Ye.version="16.1.1";Ye.languages={dictionaryKeys:sWe,getLanguageDictionary:wq,getLanguagesDictionaries:cWe,registerLanguageDictionary:vq,getTranslatedPhrase:yq};function f2e(n){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(t){const r=this.first();let i=r.data("handsontable");if(typeof t!="string"){const u=t||{};return i?i.updateSettings(u):(i=new n.Core(r[0],u),r.data("handsontable",i),i.init()),r}let s;if(i)if(typeof i[t]<"u"){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];s=i[t].call(i,...a),t==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${t}`);return s})}var F_,k_,V_,$_,U_;eq();f2e(Ye);Ye.__GhostTable=Ck;Ye._getListenersCounter=Gwe;Ye._getRegisteredMapsCounter=eAe;Ye.EventManager=Zo;const g2e=[ive,Mwe,e1e,OEe,bwe,dSe,lve,Ywe,bve,qve,sSe,YOe],m2e=[Fwe,Uwe];Ye.helper={};Ye.dom={};k(g2e,n=>{k(Object.getOwnPropertyNames(n),e=>{e.charAt(0)!=="_"&&(Ye.helper[e]=n[e])})});k(m2e,n=>{k(Object.getOwnPropertyNames(n),e=>{e.charAt(0)!=="_"&&(Ye.dom[e]=n[e])})});Ye.cellTypes=(F_=Ye.cellTypes)!==null&&F_!==void 0?F_:{};k(rRe(),n=>{Ye.cellTypes[n]=vk(n)});Ye.cellTypes.registerCellType=No;Ye.cellTypes.getCellType=vk;Ye.editors=(k_=Ye.editors)!==null&&k_!==void 0?k_:{};k(ZSe(),n=>{Ye.editors[`${_i(n)}Editor`]=Zb(n)});Ye.editors.registerEditor=cs;Ye.editors.getEditor=Zb;Ye.renderers=(V_=Ye.renderers)!==null&&V_!==void 0?V_:{};k(NEe(),n=>{const e=r0(n);n==="base"&&(Ye.renderers.cellDecorator=e),Ye.renderers[`${_i(n)}Renderer`]=e});Ye.renderers.registerRenderer=Ks;Ye.renderers.getRenderer=r0;Ye.validators=($_=Ye.validators)!==null&&$_!==void 0?$_:{};k(VEe(),n=>{Ye.validators[`${_i(n)}Validator`]=pk(n)});Ye.validators.registerValidator=gf;Ye.validators.getValidator=pk;Ye.plugins=(U_=Ye.plugins)!==null&&U_!==void 0?U_:{};k(yk(),n=>{Ye.plugins[n]=vC(n)});Ye.plugins[`${_i(yt.PLUGIN_KEY)}Plugin`]=yt;Ye.plugins.registerPlugin=pt;Ye.plugins.getPlugin=vC;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Kn;(function(n){n.RELATIVE="RELATIVE",n.ABSOLUTE="ABSOLUTE"})(Kn||(Kn={}));class zi{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new zi(Kn.ABSOLUTE,e,t)}static relative(e,t){return new zi(Kn.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleColumnAddress(e).col-r.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===Kn.ABSOLUTE}isColumnRelative(){return this.type===Kn.RELATIVE}isAbsolute(){return this.type===Kn.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new zi(this.type,this.col+t,i)}shiftedByColumns(e){return new zi(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=Ga(this,e);let r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),tZ(t,r)}shiftRelativeDimensions(e,t){const r=this.isColumnRelative()?this.col+e:this.col;return new zi(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnAbsolute()?this.col+e:this.col;return new zi(this.type,r,this.sheet)}withSheet(e){return new zi(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Kn.RELATIVE:return`${t}#COLR${this.col}`;case Kn.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(KGe(t))return;const r=FN(t.col);return`${this.type===Kn.ABSOLUTE?"$":""}${r}`}exceedsSheetSizeLimits(e){return this.col>=e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ri{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new Ri(Kn.ABSOLUTE,e,t)}static relative(e,t){return new Ri(Kn.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleRowAddress(e).row-r.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===Kn.ABSOLUTE}isRowRelative(){return this.type===Kn.RELATIVE}isAbsolute(){return this.type===Kn.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new Ri(this.type,this.row+r,i)}shiftedByRows(e){return new Ri(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=Ga(this,e);let r=this.row;return this.isRowRelative()&&(r=e.row+this.row),eZ(t,r)}shiftRelativeDimensions(e,t){const r=this.isRowRelative()?this.row+t:this.row;return new Ri(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isRowAbsolute()?this.row+t:this.row;return new Ri(this.type,r,this.sheet)}withSheet(e){return new Ri(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Kn.RELATIVE:return`${t}#ROWR${this.row}`;case Kn.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);return YGe(t)?void 0:`${this.type===Kn.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Yt;(function(n){n.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",n.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",n.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",n.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(Yt||(Yt={}));class en{constructor(e,t,r,i){this.col=e,this.row=t,this.type=r,this.sheet=i}static fromColAndRow(e,t,r){return(e.isColumnAbsolute()&&t.isRowAbsolute()?en.absolute.bind(this):e.isColumnAbsolute()?en.absoluteCol.bind(this):t.isRowAbsolute()?en.absoluteRow.bind(this):en.relative.bind(this))(e.col,t.row,r)}static relative(e,t,r){return new en(e,t,Yt.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new en(e,t,Yt.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new en(e,t,Yt.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new en(e,t,Yt.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){const t=Ga(this,e);return this.type===Yt.CELL_REFERENCE_ABSOLUTE?ve(t,this.col,this.row):this.type===Yt.CELL_REFERENCE_ABSOLUTE_ROW?ve(t,e.col+this.col,this.row):this.type===Yt.CELL_REFERENCE_ABSOLUTE_COL?ve(t,this.col,e.row+this.row):ve(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?Kn.RELATIVE:Kn.ABSOLUTE;return new zi(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?Kn.RELATIVE:Kn.ABSOLUTE;return new Ri(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=Ga(this,e);let r=this.col;return this.isColumnRelative()&&(r+=e.col),tZ(t,r)}toSimpleRowAddress(e){const t=Ga(this,e);let r=this.row;return this.isRowRelative()&&(r+=e.row),eZ(t,r)}isRowAbsolute(){return this.type===Yt.CELL_REFERENCE_ABSOLUTE||this.type===Yt.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===Yt.CELL_REFERENCE_ABSOLUTE||this.type===Yt.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===Yt.CELL_REFERENCE_RELATIVE||this.type===Yt.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===Yt.CELL_REFERENCE_RELATIVE||this.type===Yt.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===Yt.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new en(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new en(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new en(this.col+t,this.row+r,this.type,i)}withSheet(e){return new en(this.col,this.row,this.type,e)}isInvalid(e){return Cs(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const r=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+t;return new en(r,i,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+t;return new en(r,i,this.type,this.sheet)}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Yt.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case Yt.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case Yt.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case Yt.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(Cs(t))return;const r=FN(t.col),i=this.type===Yt.CELL_REFERENCE_ABSOLUTE||this.type===Yt.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===Yt.CELL_REFERENCE_ABSOLUTE||this.type===Yt.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${r}${i}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const MC=":",Gi="$",p2e="\\s+",v2e="[ \\t\\n\\r]+",DN="A-Za-z-",DV=`${DN}0-9_.`,Nq=`[${DN}0-9_]+`,w2e="'(((?!').|'')*)'",vv=`(${Nq}|${w2e})!`,Mq=`(${vv})?\\${Gi}?[A-Za-z]+\\${Gi}?[0-9]+`,NG=`(${vv})?\\${Gi}?[A-Za-z]+`,MG=`(${vv})?\\${Gi}?[0-9]+`,Iq="[rR][0-9]*[cC][0-9]*",y2e=`(${Mq})[^${DV}]`,Oq=`[${DN}_][${DV}]*`,S2e=["0","1","2","3","4","5","6","7","8","9"],_q=[...Array.from(Array(26)).map((n,e)=>e+65),...Array.from(Array(26)).map((n,e)=>e+97),...Array.from(Array(496)).map((n,e)=>e+192)].map(n=>String.fromCharCode(n));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Pq=new RegExp(`^(${vv})?(\\${Gi}?)([A-Za-z]+)(\\${Gi}?)([0-9]+)$`),C2e=new RegExp(`^(${vv})?(\\${Gi}?)([A-Za-z]+)$`),E2e=new RegExp(`^(${vv})?(\\${Gi}?)([0-9]+)$`),R2e=new RegExp(`^${Nq}$`),Tm=(n,e,t)=>{const r=Pq.exec(e),i=FV(r[6]);let s=kN(r,n);if(s===void 0)return;s===null&&(s=void 0);const o=Number(r[8])-1;return r[5]===Gi&&r[7]===Gi?en.absolute(i,o,s):r[5]===Gi?en.absoluteCol(i,o-t.row,s):r[7]===Gi?en.absoluteRow(i-t.col,o,s):en.relative(i-t.col,o-t.row,s)},W0=(n,e,t)=>{const r=C2e.exec(e);let i=kN(r,n);if(i===void 0)return;i===null&&(i=void 0);const s=FV(r[6]);return r[5]===Gi?zi.absolute(s,i):zi.relative(s-t.col,i)},j0=(n,e,t)=>{const r=E2e.exec(e);let i=kN(r,n);if(i===void 0)return;i===null&&(i=void 0);const s=Number(r[6])-1;return r[5]===Gi?Ri.absolute(s,i):Ri.relative(s-t.row,i)},_1=(n,e,t)=>{const r=Pq.exec(e);if(!r)return;const i=FV(r[6]);let s=kN(r,n);if(s===void 0)return;s===null&&(s=t);const o=Number(r[8])-1;return ve(s,i,o)},T2e=(n,e,t)=>{const r=e.split(MC);if(r.length!==2)return;const[i,s]=r,o=_1(n,i,t);if(o===void 0)return;const a=_1(n,s,o.sheet);if(a!==void 0&&o.sheet===a.sheet)return G1(o,a)},z0=(n,e,t)=>{const r=FN(e.col),i=xq(e.sheet,n);if(i!==void 0)return t!==e.sheet?`${i}!${r}${e.row+1}`:`${r}${e.row+1}`},b2e=(n,e,t)=>{const r=z0(n,e.start,t),i=z0(n,e.end,e.start.sheet);if(!(r===void 0||i===void 0))return`${r}${MC}${i}`};function FV(n){return n.length===1?n.toUpperCase().charCodeAt(0)-65:n.split("").reduce((e,t)=>e*26+(t.toUpperCase().charCodeAt(0)-64),0)-1}function FN(n){let e="";for(;n>=0;)e=String.fromCharCode(n%26+97)+e,n=Math.floor(n/26)-1;return e.toUpperCase()}function xq(n,e){let t=e(n);if(t!==void 0)return R2e.test(t)?t:(t=t.replace(/'/g,"''"),`'${t}'`)}function kN(n,e){var t;let r=(t=n[3])!==null&&t!==void 0?t:n[2];return r?(r=r.replace(/''/g,"'"),e(r)):null}function tn(n){return n&&n.length===0}function Ec(n){return n==null?[]:Object.keys(n)}function Ni(n){for(var e=[],t=Object.keys(n),r=0;r<t.length;r++)e.push(n[t[r]]);return e}function A2e(n,e){for(var t=[],r=Ec(n),i=0;i<r.length;i++){var s=r[i];t.push(e.call(null,n[s],s))}return t}function Te(n,e){for(var t=[],r=0;r<n.length;r++)t.push(e.call(null,n[r],r));return t}function Is(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];Array.isArray(r)?e=e.concat(Is(r)):e.push(r)}return e}function Jo(n){return tn(n)?void 0:n[0]}function Lq(n){var e=n&&n.length;return e?n[e-1]:void 0}function $e(n,e){if(Array.isArray(n))for(var t=0;t<n.length;t++)e.call(null,n[t],t);else if(VV(n))for(var r=Ec(n),t=0;t<r.length;t++){var i=r[t],s=n[i];e.call(null,s,i)}else throw Error("non exhaustive match")}function eu(n){return typeof n=="string"}function ea(n){return n===void 0}function ld(n){return n instanceof Function}function ni(n,e){return e===void 0&&(e=1),n.slice(e,n.length)}function xS(n,e){return e===void 0&&(e=1),n.slice(0,n.length-e)}function Ja(n,e){var t=[];if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];e.call(null,i)&&t.push(i)}return t}function eg(n,e){return Ja(n,function(t){return!e(t)})}function ha(n,e){for(var t=Object.keys(n),r={},i=0;i<t.length;i++){var s=t[i],o=n[s];e(o)&&(r[s]=o)}return r}function Ve(n,e){return VV(n)?n.hasOwnProperty(e):!1}function Lr(n,e){return zp(n,function(t){return t===e})!==void 0}function Os(n){for(var e=[],t=0;t<n.length;t++)e.push(n[t]);return e}function IC(n){var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}function zp(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(e.call(null,r))return r}}function N2e(n,e){for(var t=[],r=0;r<n.length;r++){var i=n[r];e.call(null,i)&&t.push(i)}return t}function ui(n,e,t){for(var r=Array.isArray(n),i=r?n:Ni(n),s=r?[]:Ec(n),o=t,a=0;a<i.length;a++)o=e.call(null,o,i[a],r?a:s[a]);return o}function OC(n){return eg(n,function(e){return e==null})}function kV(n,e){e===void 0&&(e=function(r){return r});var t=[];return ui(n,function(r,i){var s=e(i);return Lr(t,s)?r:(t.push(s),r.concat(i))},[])}function Ba(n){return Array.isArray(n)}function gc(n){return n instanceof RegExp}function VV(n){return n instanceof Object}function Ko(n,e){for(var t=0;t<n.length;t++)if(!e(n[t],t))return!1;return!0}function VN(n,e){return eg(n,function(t){return Lr(e,t)})}function Hq(n,e){for(var t=0;t<n.length;t++)if(e(n[t]))return!0;return!1}function M2e(n,e){for(var t=0;t<n.length;t++)if(n[t]===e)return t;return-1}function el(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++)for(var i=e[r],s=Ec(i),o=0;o<s.length;o++){var a=s[o];n[a]=i[a]}return n}function I2e(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++){var i=e[r];if(!ea(i))for(var s=Ec(i),o=0;o<s.length;o++){var a=s[o];Ve(n,a)||(n[a]=i[a])}}return n}function $N(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return I2e.apply(null,[{}].concat(n))}function Dq(n,e){var t={};return $e(n,function(r){var i=e(r),s=t[i];s?s.push(r):t[i]=[r]}),t}function IG(n,e){for(var t=IC(n),r=Ec(e),i=0;i<r.length;i++){var s=r[i],o=e[s];t[s]=o}return t}function Br(){}function OG(n){return n}function O2e(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];e.push(r!==void 0?r:void 0)}return e}function P1(n){console&&console.error&&console.error("Error: "+n)}function $V(n){console&&console.warn&&console.warn("Warning: "+n)}function _G(){return typeof Map=="function"}function _2e(n,e){e.forEach(function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(i){if(i!=="constructor"){var s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(n.prototype,i,s):n.prototype[i]=t.prototype[i]}})})}function Fq(n){function e(){}e.prototype=n;var t=new e;function r(){return typeof t.bar}return r(),r(),n}function G0(n){return n[n.length-1]}function kq(n){var e=new Date().getTime(),t=n(),r=new Date().getTime(),i=r-e;return{time:i,value:t}}var Vq={exports:{}};(function(n){(function(e,t){n.exports?n.exports=t():e.regexpToAst=t()})(typeof self<"u"?self:Pw,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(g){this.idx=g.idx,this.input=g.input,this.groupIdx=g.groupIdx},e.prototype.pattern=function(g){this.idx=0,this.input=g,this.groupIdx=0,this.consumeChar("/");var C=this.disjunction();this.consumeChar("/");for(var y={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(y,"global");break;case"i":a(y,"ignoreCase");break;case"m":a(y,"multiLine");break;case"u":a(y,"unicode");break;case"y":a(y,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:y,value:C}},e.prototype.disjunction=function(){var g=[];for(g.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),g.push(this.alternative());return{type:"Disjunction",value:g}},e.prototype.alternative=function(){for(var g=[];this.isTerm();)g.push(this.term());return{type:"Alternative",value:g}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var g;switch(this.popChar()){case"=":g="Lookahead";break;case"!":g="NegativeLookahead";break}l(g);var C=this.disjunction();return this.consumeChar(")"),{type:g,value:C}}u()},e.prototype.quantifier=function(g){var C;switch(this.popChar()){case"*":C={atLeast:0,atMost:1/0};break;case"+":C={atLeast:1,atMost:1/0};break;case"?":C={atLeast:0,atMost:1};break;case"{":var y=this.integerIncludingZero();switch(this.popChar()){case"}":C={atLeast:y,atMost:y};break;case",":var w;this.isDigit()?(w=this.integerIncludingZero(),C={atLeast:y,atMost:w}):C={atLeast:y,atMost:1/0},this.consumeChar("}");break}if(g===!0&&C===void 0)return;l(C);break}if(!(g===!0&&C===void 0))return l(C),this.peekChar(0)==="?"?(this.consumeChar("?"),C.greedy=!1):C.greedy=!0,C.type="Quantifier",C},e.prototype.atom=function(){var g;switch(this.peekChar()){case".":g=this.dotAll();break;case"\\":g=this.atomEscape();break;case"[":g=this.characterClass();break;case"(":g=this.group();break}return g===void 0&&this.isPatternCharacter()&&(g=this.patternCharacter()),l(g),this.isQuantifier()&&(g.quantifier=this.quantifier()),g},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[s(`
`),s("\r"),s("\u2028"),s("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var g=this.positiveInteger();return{type:"GroupBackReference",value:g}},e.prototype.characterClassEscape=function(){var g,C=!1;switch(this.popChar()){case"d":g=h;break;case"D":g=h,C=!0;break;case"s":g=f;break;case"S":g=f,C=!0;break;case"w":g=d;break;case"W":g=d,C=!0;break}return l(g),{type:"Set",value:g,complement:C}},e.prototype.controlEscapeAtom=function(){var g;switch(this.popChar()){case"f":g=s("\f");break;case"n":g=s(`
`);break;case"r":g=s("\r");break;case"t":g=s("	");break;case"v":g=s("\v");break}return l(g),{type:"Character",value:g}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var g=this.popChar();if(/[a-zA-Z]/.test(g)===!1)throw Error("Invalid ");var C=g.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:C}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:s("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var g=this.popChar();return{type:"Character",value:s(g)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var g=this.popChar();return{type:"Character",value:s(g)}}},e.prototype.characterClass=function(){var g=[],C=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),C=!0);this.isClassAtom();){var y=this.classAtom(),w=y.type==="Character";if(w&&this.isRangeDash()){this.consumeChar("-");var S=this.classAtom(),E=S.type==="Character";if(E){if(S.value<y.value)throw Error("Range out of order in character class");g.push({from:y.value,to:S.value})}else o(y.value,g),g.push(s("-")),o(S.value,g)}else o(y.value,g)}return this.consumeChar("]"),{type:"Set",complement:C,value:g}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:s("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var g=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),g=!1;break;default:this.groupIdx++;break}var C=this.disjunction();this.consumeChar(")");var y={type:"Group",capturing:g,value:C};return g&&(y.idx=this.groupIdx),y},e.prototype.positiveInteger=function(){var g=this.popChar();if(i.test(g)===!1)throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)g+=this.popChar();return parseInt(g,10)},e.prototype.integerIncludingZero=function(){var g=this.popChar();if(r.test(g)===!1)throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)g+=this.popChar();return parseInt(g,10)},e.prototype.patternCharacter=function(){var g=this.popChar();switch(g){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:s(g)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return r.test(this.peekChar(0))},e.prototype.isClassAtom=function(g){switch(g===void 0&&(g=0),this.peekChar(g)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var g=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(g)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(g){for(var C="",y=0;y<g;y++){var w=this.popChar();if(t.test(w)===!1)throw Error("Expecting a HexDecimal digits");C+=w}var S=parseInt(C,16);return{type:"Character",value:S}},e.prototype.peekChar=function(g){return g===void 0&&(g=0),this.input[this.idx+g]},e.prototype.popChar=function(){var g=this.peekChar(0);return this.consumeChar(),g},e.prototype.consumeChar=function(g){if(g!==void 0&&this.input[this.idx]!==g)throw Error("Expected: '"+g+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,r=/[0-9]/,i=/[1-9]/;function s(g){return g.charCodeAt(0)}function o(g,C){g.length!==void 0?g.forEach(function(y){C.push(y)}):C.push(g)}function a(g,C){if(g[C]===!0)throw"duplicate flag "+C;g[C]=!0}function l(g){if(g===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var c,h=[];for(c=s("0");c<=s("9");c++)h.push(c);var d=[s("_")].concat(h);for(c=s("a");c<=s("z");c++)d.push(c);for(c=s("A");c<=s("Z");c++)d.push(c);var f=[s(" "),s("\f"),s(`
`),s("\r"),s("	"),s("\v"),s("	"),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s("\u2028"),s("\u2029"),s(""),s(""),s(""),s("\uFEFF")];function m(){}return m.prototype.visitChildren=function(g){for(var C in g){var y=g[C];g.hasOwnProperty(C)&&(y.type!==void 0?this.visit(y):Array.isArray(y)&&y.forEach(function(w){this.visit(w)},this))}},m.prototype.visit=function(g){switch(g.type){case"Pattern":this.visitPattern(g);break;case"Flags":this.visitFlags(g);break;case"Disjunction":this.visitDisjunction(g);break;case"Alternative":this.visitAlternative(g);break;case"StartAnchor":this.visitStartAnchor(g);break;case"EndAnchor":this.visitEndAnchor(g);break;case"WordBoundary":this.visitWordBoundary(g);break;case"NonWordBoundary":this.visitNonWordBoundary(g);break;case"Lookahead":this.visitLookahead(g);break;case"NegativeLookahead":this.visitNegativeLookahead(g);break;case"Character":this.visitCharacter(g);break;case"Set":this.visitSet(g);break;case"Group":this.visitGroup(g);break;case"GroupBackReference":this.visitGroupBackReference(g);break;case"Quantifier":this.visitQuantifier(g);break}this.visitChildren(g)},m.prototype.visitPattern=function(g){},m.prototype.visitFlags=function(g){},m.prototype.visitDisjunction=function(g){},m.prototype.visitAlternative=function(g){},m.prototype.visitStartAnchor=function(g){},m.prototype.visitEndAnchor=function(g){},m.prototype.visitWordBoundary=function(g){},m.prototype.visitNonWordBoundary=function(g){},m.prototype.visitLookahead=function(g){},m.prototype.visitNegativeLookahead=function(g){},m.prototype.visitCharacter=function(g){},m.prototype.visitSet=function(g){},m.prototype.visitGroup=function(g){},m.prototype.visitGroupBackReference=function(g){},m.prototype.visitQuantifier=function(g){},{RegExpParser:e,BaseRegExpVisitor:m,VERSION:"0.4.0"}})})(Vq);var _C=Vq.exports,KT={},P2e=new _C.RegExpParser;function UN(n){var e=n.toString();if(KT.hasOwnProperty(e))return KT[e];var t=P2e.pattern(e);return KT[e]=t,t}function x2e(){KT={}}var L2e=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),$q="Complement Sets are not supported for first char optimization",Y0=`Unable to use "first char" lexer optimizations:
`;function H2e(n,e){e===void 0&&(e=!1);try{var t=UN(n),r=x1(t.value,{},t.flags.ignoreCase);return r}catch(s){if(s.message===$q)e&&$V(""+Y0+("	Unable to optimize: < "+n.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),P1(Y0+`
`+("	Failed parsing: < "+n.toString()+` >
`)+("	Using the regexp-to-ast library version: "+_C.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function x1(n,e,t){switch(n.type){case"Disjunction":for(var r=0;r<n.value.length;r++)x1(n.value[r],e,t);break;case"Alternative":for(var i=n.value,r=0;r<i.length;r++){var s=i[r];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var o=s;switch(o.type){case"Character":jR(o.value,e,t);break;case"Set":if(o.complement===!0)throw Error($q);$e(o.value,function(u){if(typeof u=="number")jR(u,e,t);else{var c=u;if(t===!0)for(var h=c.from;h<=c.to;h++)jR(h,e,t);else{for(var h=c.from;h<=c.to&&h<Kw;h++)jR(h,e,t);if(c.to>=Kw)for(var d=c.from>=Kw?c.from:Kw,f=c.to,m=Jh(d),g=Jh(f),C=m;C<=g;C++)e[C]=C}}});break;case"Group":x1(o.value,e,t);break;default:throw Error("Non Exhaustive Match")}var a=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&L1(o)===!1||o.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return Ni(e)}function jR(n,e,t){var r=Jh(n);e[r]=r,t===!0&&D2e(n,e)}function D2e(n,e){var t=String.fromCharCode(n),r=t.toUpperCase();if(r!==t){var i=Jh(r.charCodeAt(0));e[i]=i}else{var s=t.toLowerCase();if(s!==t){var i=Jh(s.charCodeAt(0));e[i]=i}}}function PG(n,e){return zp(n.value,function(t){if(typeof t=="number")return Lr(e,t);var r=t;return zp(e,function(i){return r.from<=i&&i<=r.to})!==void 0})}function L1(n){return n.quantifier&&n.quantifier.atLeast===0?!0:n.value?Ba(n.value)?Ko(n.value,L1):L1(n.value):!1}var F2e=function(n){L2e(e,n);function e(t){var r=n.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return e.prototype.visitChildren=function(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}n.prototype.visitChildren.call(this,t)}},e.prototype.visitCharacter=function(t){Lr(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?PG(t,this.targetCharCodes)===void 0&&(this.found=!0):PG(t,this.targetCharCodes)!==void 0&&(this.found=!0)},e}(_C.BaseRegExpVisitor);function UV(n,e){if(e instanceof RegExp){var t=UN(e),r=new F2e(n);return r.visit(t),r.found}else return zp(e,function(i){return Lr(n,i.charCodeAt(0))})!==void 0}var Uq=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),tu="PATTERN",Pf="defaultMode",zR="modes",Bq=typeof new RegExp("(?:)").sticky=="boolean";function k2e(n,e){e=$N(e,{useSticky:Bq,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(w,S){return S()}});var t=e.tracer;t("initCharCodeToOptimizedIndexMap",function(){aje()});var r;t("Reject Lexer.NA",function(){r=eg(n,function(w){return w[tu]===Ms.NA})});var i=!1,s;t("Transform Patterns",function(){i=!1,s=Te(r,function(w){var S=w[tu];if(gc(S)){var E=S.source;return E.length===1&&E!=="^"&&E!=="$"&&E!=="."?E:E.length===2&&E[0]==="\\"&&!Lr(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],E[1])?E[1]:e.useSticky?LG(S):xG(S)}else{if(ld(S))return i=!0,{exec:S};if(Ve(S,"exec"))return i=!0,S;if(typeof S=="string"){if(S.length===1)return S;var P=S.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),_=new RegExp(P);return e.useSticky?LG(_):xG(_)}else throw Error("non exhaustive match")}})});var o,a,l,u,c;t("misc mapping",function(){o=Te(r,function(w){return w.tokenTypeIdx}),a=Te(r,function(w){var S=w.GROUP;if(S!==Ms.SKIPPED){if(eu(S))return S;if(ea(S))return!1;throw Error("non exhaustive match")}}),l=Te(r,function(w){var S=w.LONGER_ALT;if(S){var E=M2e(r,S);return E}}),u=Te(r,function(w){return w.PUSH_MODE}),c=Te(r,function(w){return Ve(w,"POP_MODE")})});var h;t("Line Terminator Handling",function(){var w=zq(e.lineTerminatorCharacters);h=Te(r,function(S){return!1}),e.positionTracking!=="onlyOffset"&&(h=Te(r,function(S){if(Ve(S,"LINE_BREAKS"))return S.LINE_BREAKS;if(jq(S,w)===!1)return UV(w,S.PATTERN)}))});var d,f,m,g;t("Misc Mapping #2",function(){d=Te(r,Wq),f=Te(s,ije),m=ui(r,function(w,S){var E=S.GROUP;return eu(E)&&E!==Ms.SKIPPED&&(w[E]=[]),w},{}),g=Te(s,function(w,S){return{pattern:s[S],longerAlt:l[S],canLineTerminator:h[S],isCustom:d[S],short:f[S],group:a[S],push:u[S],pop:c[S],tokenTypeIdx:o[S],tokenType:r[S]}})});var C=!0,y=[];return e.safeMode||t("First Char Optimization",function(){y=ui(r,function(w,S,E){if(typeof S.PATTERN=="string"){var P=S.PATTERN.charCodeAt(0),_=Jh(P);B_(w,_,g[E])}else if(Ba(S.START_CHARS_HINT)){var I;$e(S.START_CHARS_HINT,function(Q){var F=typeof Q=="string"?Q.charCodeAt(0):Q,J=Jh(F);I!==J&&(I=J,B_(w,J,g[E]))})}else if(gc(S.PATTERN))if(S.PATTERN.unicode)C=!1,e.ensureOptimizations&&P1(""+Y0+("	Unable to analyze < "+S.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var D=H2e(S.PATTERN,e.ensureOptimizations);tn(D)&&(C=!1),$e(D,function(Q){B_(w,Q,g[E])})}else e.ensureOptimizations&&P1(""+Y0+("	TokenType: <"+S.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),C=!1;return w},[])}),t("ArrayPacking",function(){y=O2e(y)}),{emptyGroups:m,patternIdxToConfig:g,charCodeToPatternIdxToConfig:y,hasCustom:i,canBeOptimized:C}}function V2e(n,e){var t=[],r=U2e(n);t=t.concat(r.errors);var i=B2e(r.valid),s=i.valid;return t=t.concat(i.errors),t=t.concat($2e(s)),t=t.concat(q2e(s)),t=t.concat(Q2e(s,e)),t=t.concat(Z2e(s)),t}function $2e(n){var e=[],t=Ja(n,function(r){return gc(r[tu])});return e=e.concat(j2e(t)),e=e.concat(Y2e(t)),e=e.concat(K2e(t)),e=e.concat(X2e(t)),e=e.concat(z2e(t)),e}function U2e(n){var e=Ja(n,function(i){return!Ve(i,tu)}),t=Te(e,function(i){return{message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:sr.MISSING_PATTERN,tokenTypes:[i]}}),r=VN(n,e);return{errors:t,valid:r}}function B2e(n){var e=Ja(n,function(i){var s=i[tu];return!gc(s)&&!ld(s)&&!Ve(s,"exec")&&!eu(s)}),t=Te(e,function(i){return{message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:sr.INVALID_PATTERN,tokenTypes:[i]}}),r=VN(n,e);return{errors:t,valid:r}}var W2e=/[^\\][\$]/;function j2e(n){var e=function(i){Uq(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitEndAnchor=function(o){this.found=!0},s}(_C.BaseRegExpVisitor),t=Ja(n,function(i){var s=i[tu];try{var o=UN(s),a=new e;return a.visit(o),a.found}catch{return W2e.test(s.source)}}),r=Te(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:sr.EOI_ANCHOR_FOUND,tokenTypes:[i]}});return r}function z2e(n){var e=Ja(n,function(r){var i=r[tu];return i.test("")}),t=Te(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:sr.EMPTY_MATCH_PATTERN,tokenTypes:[r]}});return t}var G2e=/[^\\[][\^]|^\^/;function Y2e(n){var e=function(i){Uq(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitStartAnchor=function(o){this.found=!0},s}(_C.BaseRegExpVisitor),t=Ja(n,function(i){var s=i[tu];try{var o=UN(s),a=new e;return a.visit(o),a.found}catch{return G2e.test(s.source)}}),r=Te(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:sr.SOI_ANCHOR_FOUND,tokenTypes:[i]}});return r}function K2e(n){var e=Ja(n,function(r){var i=r[tu];return i instanceof RegExp&&(i.multiline||i.global)}),t=Te(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:sr.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}});return t}function X2e(n){var e=[],t=Te(n,function(s){return ui(n,function(o,a){return s.PATTERN.source===a.PATTERN.source&&!Lr(e,a)&&a.PATTERN!==Ms.NA&&(e.push(a),o.push(a)),o},[])});t=OC(t);var r=Ja(t,function(s){return s.length>1}),i=Te(r,function(s){var o=Te(s,function(l){return l.name}),a=Jo(s).PATTERN;return{message:"The same RegExp pattern ->"+a+"<-"+("has been used in all of the following Token Types: "+o.join(", ")+" <-"),type:sr.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}});return i}function q2e(n){var e=Ja(n,function(r){if(!Ve(r,"GROUP"))return!1;var i=r.GROUP;return i!==Ms.SKIPPED&&i!==Ms.NA&&!eu(i)}),t=Te(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:sr.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}});return t}function Q2e(n,e){var t=Ja(n,function(i){return i.PUSH_MODE!==void 0&&!Lr(e,i.PUSH_MODE)}),r=Te(t,function(i){var s="Token Type: ->"+i.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+i.PUSH_MODE+"<-which does not exist";return{message:s,type:sr.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}});return r}function Z2e(n){var e=[],t=ui(n,function(r,i,s){var o=i.PATTERN;return o===Ms.NA||(eu(o)?r.push({str:o,idx:s,tokenType:i}):gc(o)&&eje(o)&&r.push({str:o.source,idx:s,tokenType:i})),r},[]);return $e(n,function(r,i){$e(t,function(s){var o=s.str,a=s.idx,l=s.tokenType;if(i<a&&J2e(o,r.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+r.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:sr.UNREACHABLE_PATTERN,tokenTypes:[r,l]})}})}),e}function J2e(n,e){if(gc(e)){var t=e.exec(n);return t!==null&&t.index===0}else{if(ld(e))return e(n,0,[],{});if(Ve(e,"exec"))return e.exec(n,0,[],{});if(typeof e=="string")return e===n;throw Error("non exhaustive match")}}function eje(n){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return zp(e,function(t){return n.source.indexOf(t)!==-1})===void 0}function xG(n){var e=n.ignoreCase?"i":"";return new RegExp("^(?:"+n.source+")",e)}function LG(n){var e=n.ignoreCase?"iy":"y";return new RegExp(""+n.source,e)}function tje(n,e,t){var r=[];return Ve(n,Pf)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Pf+`> property in its definition
`,type:sr.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ve(n,zR)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+zR+`> property in its definition
`,type:sr.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ve(n,zR)&&Ve(n,Pf)&&!Ve(n.modes,n.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+Pf+": <"+n.defaultMode+`>which does not exist
`,type:sr.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ve(n,zR)&&$e(n.modes,function(i,s){$e(i,function(o,a){ea(o)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+s+"> at index: <"+a+`>
`),type:sr.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),r}function nje(n,e,t){var r=[],i=!1,s=OC(Is(A2e(n.modes,function(l){return l}))),o=eg(s,function(l){return l[tu]===Ms.NA}),a=zq(t);return e&&$e(o,function(l){var u=jq(l,a);if(u!==!1){var c=oje(l,u),h={message:c,type:u.issue,tokenType:l};r.push(h)}else Ve(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):UV(a,l.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:sr.NO_LINE_BREAKS_FLAGS}),r}function rje(n){var e={},t=Ec(n);return $e(t,function(r){var i=n[r];if(Ba(i))e[r]=[];else throw Error("non exhaustive match")}),e}function Wq(n){var e=n.PATTERN;if(gc(e))return!1;if(ld(e))return!0;if(Ve(e,"exec"))return!0;if(eu(e))return!1;throw Error("non exhaustive match")}function ije(n){return eu(n)&&n.length===1?n.charCodeAt(0):!1}var sje={test:function(n){for(var e=n.length,t=this.lastIndex;t<e;t++){var r=n.charCodeAt(t);if(r===10)return this.lastIndex=t+1,!0;if(r===13)return n.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function jq(n,e){if(Ve(n,"LINE_BREAKS"))return!1;if(gc(n.PATTERN)){try{UV(e,n.PATTERN)}catch(t){return{issue:sr.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(eu(n.PATTERN))return!1;if(Wq(n))return{issue:sr.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function oje(n,e){if(e.issue===sr.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+n.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===sr.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+n.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function zq(n){var e=Te(n,function(t){return eu(t)&&t.length>0?t.charCodeAt(0):t});return e}function B_(n,e,t){n[e]===void 0?n[e]=[t]:n[e].push(t)}var Kw=256;function Jh(n){return n<Kw?n:XT[n]}var XT=[];function aje(){if(tn(XT)){XT=new Array(65536);for(var n=0;n<65536;n++)XT[n]=n>255?255+~~(n/255):n}}function BN(n,e){var t=n.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function K0(n,e){return n.tokenTypeIdx===e.tokenTypeIdx}var HG=1,Gq={};function PC(n){var e=lje(n);uje(e),hje(e),cje(e),$e(e,function(t){t.isParent=t.categoryMatches.length>0})}function lje(n){for(var e=Os(n),t=n,r=!0;r;){t=OC(Is(Te(t,function(s){return s.CATEGORIES})));var i=VN(t,e);e=e.concat(i),tn(i)?r=!1:t=i}return e}function uje(n){$e(n,function(e){Kq(e)||(Gq[HG]=e,e.tokenTypeIdx=HG++),DG(e)&&!Ba(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),DG(e)||(e.CATEGORIES=[]),dje(e)||(e.categoryMatches=[]),fje(e)||(e.categoryMatchesMap={})})}function cje(n){$e(n,function(e){e.categoryMatches=[],$e(e.categoryMatchesMap,function(t,r){e.categoryMatches.push(Gq[r].tokenTypeIdx)})})}function hje(n){$e(n,function(e){Yq([],e)})}function Yq(n,e){$e(n,function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0}),$e(e.CATEGORIES,function(t){var r=n.concat(e);Lr(r,t)||Yq(r,t)})}function Kq(n){return Ve(n,"tokenTypeIdx")}function DG(n){return Ve(n,"CATEGORIES")}function dje(n){return Ve(n,"categoryMatches")}function fje(n){return Ve(n,"categoryMatchesMap")}function gje(n){return Ve(n,"tokenTypeIdx")}var mje={buildUnableToPopLexerModeMessage:function(n){return"Unable to pop Lexer Mode after encountering Token ->"+n.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(n,e,t,r,i){return"unexpected character: ->"+n.charAt(e)+"<- at offset: "+e+","+(" skipped "+t+" characters.")}},sr;(function(n){n[n.MISSING_PATTERN=0]="MISSING_PATTERN",n[n.INVALID_PATTERN=1]="INVALID_PATTERN",n[n.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",n[n.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",n[n.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",n[n.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",n[n.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",n[n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",n[n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",n[n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",n[n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",n[n.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",n[n.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",n[n.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",n[n.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",n[n.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",n[n.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(sr||(sr={}));var Xw={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:mje,traceInitPerf:!1,skipValidations:!1};Object.freeze(Xw);var Ms=function(){function n(e,t){var r=this;if(t===void 0&&(t=Xw),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=IG(Xw,t);var i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var s,o=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===Xw.lineTerminatorsPattern)r.config.lineTerminatorsPattern=sje;else if(r.config.lineTerminatorCharacters===Xw.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),Ba(e)?(s={modes:{}},s.modes[Pf]=Os(e),s[Pf]=Pf):(o=!1,s=IC(e))}),r.config.skipValidations===!1&&(r.TRACE_INIT("performRuntimeChecks",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(tje(s,r.trackStartLines,r.config.lineTerminatorCharacters))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(nje(s,r.trackStartLines,r.config.lineTerminatorCharacters))})),s.modes=s.modes?s.modes:{},$e(s.modes,function(c,h){s.modes[h]=eg(c,function(d){return ea(d)})});var a=Ec(s.modes);if($e(s.modes,function(c,h){r.TRACE_INIT("Mode: <"+h+"> processing",function(){if(r.modes.push(h),r.config.skipValidations===!1&&r.TRACE_INIT("validatePatterns",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(V2e(c,a))}),tn(r.lexerDefinitionErrors)){PC(c);var d;r.TRACE_INIT("analyzeTokenTypes",function(){d=k2e(c,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})}),r.patternIdxToConfig[h]=d.patternIdxToConfig,r.charCodeToPatternIdxToConfig[h]=d.charCodeToPatternIdxToConfig,r.emptyGroups=IG(r.emptyGroups,d.emptyGroups),r.hasCustom=d.hasCustom||r.hasCustom,r.canModeBeOptimized[h]=d.canBeOptimized}})}),r.defaultMode=s.defaultMode,!tn(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var l=Te(r.lexerDefinitionErrors,function(c){return c.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}$e(r.lexerDefinitionWarning,function(c){$V(c.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(Bq?(r.chopInput=OG,r.match=r.matchWithTest):(r.updateLastIndex=Br,r.match=r.matchWithExec),o&&(r.handleModes=Br),r.trackStartLines===!1&&(r.computeNewColumn=OG),r.trackEndLines===!1&&(r.updateTokenEndLineColumnLocation=Br),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var c=ui(r.canModeBeOptimized,function(h,d,f){return d===!1&&h.push(f),h},[]);if(t.ensureOptimizations&&!tn(c))throw Error("Lexer Modes: < "+c.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),r.TRACE_INIT("clearRegExpParserCache",function(){x2e()}),r.TRACE_INIT("toFastProperties",function(){Fq(r)})})}return n.prototype.tokenize=function(e,t){if(t===void 0&&(t=this.defaultMode),!tn(this.lexerDefinitionErrors)){var r=Te(this.lexerDefinitionErrors,function(o){return o.message}),i=r.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}var s=this.tokenizeInternal(e,t);return s},n.prototype.tokenizeInternal=function(e,t){var r=this,i,s,o,a,l,u,c,h,d,f,m,g,C,y,w=e,S=w.length,E=0,P=0,_=this.hasCustom?0:Math.floor(e.length/10),I=new Array(_),D=[],Q=this.trackStartLines?1:void 0,F=this.trackStartLines?1:void 0,J=rje(this.emptyGroups),q=this.trackStartLines,ie=this.config.lineTerminatorsPattern,fe=0,Ee=[],ke=[],be=[],re=[];Object.freeze(re);var ae=void 0;function le(){return Ee}function ye(G){var ne=Jh(G),de=ke[ne];return de===void 0?re:de}var ze=function(G){if(be.length===1&&G.tokenType.PUSH_MODE===void 0){var ne=r.config.errorMessageProvider.buildUnableToPopLexerModeMessage(G);D.push({offset:G.startOffset,line:G.startLine!==void 0?G.startLine:void 0,column:G.startColumn!==void 0?G.startColumn:void 0,length:G.image.length,message:ne})}else{be.pop();var de=Lq(be);Ee=r.patternIdxToConfig[de],ke=r.charCodeToPatternIdxToConfig[de],fe=Ee.length;var Se=r.canModeBeOptimized[de]&&r.config.safeMode===!1;ke&&Se?ae=ye:ae=le}};function et(G){be.push(G),ke=this.charCodeToPatternIdxToConfig[G],Ee=this.patternIdxToConfig[G],fe=Ee.length,fe=Ee.length;var ne=this.canModeBeOptimized[G]&&this.config.safeMode===!1;ke&&ne?ae=ye:ae=le}et.call(this,t);for(var v;E<S;){l=null;var R=w.charCodeAt(E),A=ae(R),W=A.length;for(i=0;i<W;i++){v=A[i];var z=v.pattern;u=null;var X=v.short;if(X!==!1?R===X&&(l=z):v.isCustom===!0?(y=z.exec(w,E,I,J),y!==null?(l=y[0],y.payload!==void 0&&(u=y.payload)):l=null):(this.updateLastIndex(z,E),l=this.match(z,e,E)),l!==null){if(a=v.longerAlt,a!==void 0){var T=Ee[a],N=T.pattern;c=null,T.isCustom===!0?(y=N.exec(w,E,I,J),y!==null?(o=y[0],y.payload!==void 0&&(c=y.payload)):o=null):(this.updateLastIndex(N,E),o=this.match(N,e,E)),o&&o.length>l.length&&(l=o,u=c,v=T)}break}}if(l!==null){if(h=l.length,d=v.group,d!==void 0&&(f=v.tokenTypeIdx,m=this.createTokenInstance(l,E,f,v.tokenType,Q,F,h),this.handlePayload(m,u),d===!1?P=this.addToken(I,P,m):J[d].push(m)),e=this.chopInput(e,h),E=E+h,F=this.computeNewColumn(F,h),q===!0&&v.canLineTerminator===!0){var L=0,V=void 0,x=void 0;ie.lastIndex=0;do V=ie.test(l),V===!0&&(x=ie.lastIndex-1,L++);while(V===!0);L!==0&&(Q=Q+L,F=h-x,this.updateTokenEndLineColumnLocation(m,d,x,L,Q,F,h))}this.handleModes(v,ze,et,m)}else{for(var U=E,Y=Q,$=F,j=!1;!j&&E<S;)for(w.charCodeAt(E),e=this.chopInput(e,1),E++,s=0;s<fe;s++){var K=Ee[s],z=K.pattern,X=K.short;if(X!==!1?w.charCodeAt(E)===X&&(j=!0):K.isCustom===!0?j=z.exec(w,E,I,J)!==null:(this.updateLastIndex(z,E),j=z.exec(e)!==null),j===!0)break}g=E-U,C=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(w,U,g,Y,$),D.push({offset:U,line:Y,column:$,length:g,message:C})}}return this.hasCustom||(I.length=P),{tokens:I,groups:J,errors:D}},n.prototype.handleModes=function(e,t,r,i){if(e.pop===!0){var s=e.push;t(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)},n.prototype.chopInput=function(e,t){return e.substring(t)},n.prototype.updateLastIndex=function(e,t){e.lastIndex=t},n.prototype.updateTokenEndLineColumnLocation=function(e,t,r,i,s,o,a){var l,u;t!==void 0&&(l=r===a-1,u=l?-1:0,i===1&&l===!0||(e.endLine=s+u,e.endColumn=o-1+-u))},n.prototype.computeNewColumn=function(e,t){return e+t},n.prototype.createTokenInstance=function(){return null},n.prototype.createOffsetOnlyToken=function(e,t,r,i){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:i}},n.prototype.createStartOnlyToken=function(e,t,r,i,s,o){return{image:e,startOffset:t,startLine:s,startColumn:o,tokenTypeIdx:r,tokenType:i}},n.prototype.createFullToken=function(e,t,r,i,s,o,a){return{image:e,startOffset:t,endOffset:t+a-1,startLine:s,endLine:s,startColumn:o,endColumn:o+a-1,tokenTypeIdx:r,tokenType:i}},n.prototype.addToken=function(e,t,r){return 666},n.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},n.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,t++,t},n.prototype.handlePayload=function(e,t){},n.prototype.handlePayloadNoCustom=function(e,t){},n.prototype.handlePayloadWithCustom=function(e,t){t!==null&&(e.payload=t)},n.prototype.match=function(e,t,r){return null},n.prototype.matchWithTest=function(e,t,r){var i=e.test(t);return i===!0?t.substring(r,e.lastIndex):null},n.prototype.matchWithExec=function(e,t){var r=e.exec(t);return r!==null?r[0]:r},n.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var i=kq(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},n.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",n.NA=/NOT_APPLICABLE/,n}();function Sp(n){return Xq(n)?n.LABEL:n.name}function Xq(n){return eu(n.LABEL)&&n.LABEL!==""}var pje="parent",FG="categories",kG="label",VG="group",$G="push_mode",UG="pop_mode",BG="longer_alt",WG="line_breaks",jG="start_chars_hint";function Rt(n){return vje(n)}function vje(n){var e=n.pattern,t={};if(t.name=n.name,ea(e)||(t.PATTERN=e),Ve(n,pje))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return Ve(n,FG)&&(t.CATEGORIES=n[FG]),PC([t]),Ve(n,kG)&&(t.LABEL=n[kG]),Ve(n,VG)&&(t.GROUP=n[VG]),Ve(n,UG)&&(t.POP_MODE=n[UG]),Ve(n,$G)&&(t.PUSH_MODE=n[$G]),Ve(n,BG)&&(t.LONGER_ALT=n[BG]),Ve(n,WG)&&(t.LINE_BREAKS=n[WG]),Ve(n,jG)&&(t.START_CHARS_HINT=n[jG]),t}var tg=Rt({name:"EOF",pattern:Ms.NA});PC([tg]);function BV(n,e,t,r,i,s,o,a){return{image:e,startOffset:t,endOffset:r,startLine:i,endLine:s,startColumn:o,endColumn:a,tokenTypeIdx:n.tokenTypeIdx,tokenType:n}}function Zt(n,e){return BN(n,e)}var Rc=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),hu=function(){function n(e){this.definition=e}return n.prototype.accept=function(e){e.visit(this),$e(this.definition,function(t){t.accept(e)})},n}(),go=function(n){Rc(e,n);function e(t){var r=n.call(this,[])||this;return r.idx=1,el(r,ha(t,function(i){return i!==void 0})),r}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(hu),wv=function(n){Rc(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.orgText="",el(r,ha(t,function(i){return i!==void 0})),r}return e}(hu),_s=function(n){Rc(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,el(r,ha(t,function(i){return i!==void 0})),r}return e}(hu),ai=function(n){Rc(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,el(r,ha(t,function(i){return i!==void 0})),r}return e}(hu),ta=function(n){Rc(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,el(r,ha(t,function(i){return i!==void 0})),r}return e}(hu),na=function(n){Rc(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,el(r,ha(t,function(i){return i!==void 0})),r}return e}(hu),ir=function(n){Rc(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,el(r,ha(t,function(i){return i!==void 0})),r}return e}(hu),mo=function(n){Rc(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,el(r,ha(t,function(i){return i!==void 0})),r}return e}(hu),po=function(n){Rc(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,el(r,ha(t,function(i){return i!==void 0})),r}return e}(hu),Fn=function(){function n(e){this.idx=1,el(this,ha(e,function(t){return t!==void 0}))}return n.prototype.accept=function(e){e.visit(this)},n}();function wje(n){return Te(n,qT)}function qT(n){function e(i){return Te(i,qT)}if(n instanceof go)return{type:"NonTerminal",name:n.nonTerminalName,idx:n.idx};if(n instanceof _s)return{type:"Flat",definition:e(n.definition)};if(n instanceof ai)return{type:"Option",idx:n.idx,definition:e(n.definition)};if(n instanceof ta)return{type:"RepetitionMandatory",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof na)return{type:"RepetitionMandatoryWithSeparator",name:n.name,idx:n.idx,separator:qT(new Fn({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof mo)return{type:"RepetitionWithSeparator",name:n.name,idx:n.idx,separator:qT(new Fn({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof ir)return{type:"Repetition",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof po)return{type:"Alternation",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof Fn){var t={type:"Terminal",name:n.terminalType.name,label:Sp(n.terminalType),idx:n.idx},r=n.terminalType.PATTERN;return n.terminalType.PATTERN&&(t.pattern=gc(r)?r.source:r),t}else{if(n instanceof wv)return{type:"Rule",name:n.name,orgText:n.orgText,definition:e(n.definition)};throw Error("non exhaustive match")}}var WN=function(){function n(){}return n.prototype.walk=function(e,t){var r=this;t===void 0&&(t=[]),$e(e.definition,function(i,s){var o=ni(e.definition,s+1);if(i instanceof go)r.walkProdRef(i,o,t);else if(i instanceof Fn)r.walkTerminal(i,o,t);else if(i instanceof _s)r.walkFlat(i,o,t);else if(i instanceof ai)r.walkOption(i,o,t);else if(i instanceof ta)r.walkAtLeastOne(i,o,t);else if(i instanceof na)r.walkAtLeastOneSep(i,o,t);else if(i instanceof mo)r.walkManySep(i,o,t);else if(i instanceof ir)r.walkMany(i,o,t);else if(i instanceof po)r.walkOr(i,o,t);else throw Error("non exhaustive match")})},n.prototype.walkTerminal=function(e,t,r){},n.prototype.walkProdRef=function(e,t,r){},n.prototype.walkFlat=function(e,t,r){var i=t.concat(r);this.walk(e,i)},n.prototype.walkOption=function(e,t,r){var i=t.concat(r);this.walk(e,i)},n.prototype.walkAtLeastOne=function(e,t,r){var i=[new ai({definition:e.definition})].concat(t,r);this.walk(e,i)},n.prototype.walkAtLeastOneSep=function(e,t,r){var i=zG(e,t,r);this.walk(e,i)},n.prototype.walkMany=function(e,t,r){var i=[new ai({definition:e.definition})].concat(t,r);this.walk(e,i)},n.prototype.walkManySep=function(e,t,r){var i=zG(e,t,r);this.walk(e,i)},n.prototype.walkOr=function(e,t,r){var i=this,s=t.concat(r);$e(e.definition,function(o){var a=new _s({definition:[o]});i.walk(a,s)})},n}();function zG(n,e,t){var r=[new ai({definition:[new Fn({terminalType:n.separator})].concat(n.definition)})],i=r.concat(e,t);return i}var pg=function(){function n(){}return n.prototype.visit=function(e){var t=e;switch(t.constructor){case go:return this.visitNonTerminal(t);case _s:return this.visitFlat(t);case ai:return this.visitOption(t);case ta:return this.visitRepetitionMandatory(t);case na:return this.visitRepetitionMandatoryWithSeparator(t);case mo:return this.visitRepetitionWithSeparator(t);case ir:return this.visitRepetition(t);case po:return this.visitAlternation(t);case Fn:return this.visitTerminal(t);case wv:return this.visitRule(t);default:throw Error("non exhaustive match")}},n.prototype.visitNonTerminal=function(e){},n.prototype.visitFlat=function(e){},n.prototype.visitOption=function(e){},n.prototype.visitRepetition=function(e){},n.prototype.visitRepetitionMandatory=function(e){},n.prototype.visitRepetitionMandatoryWithSeparator=function(e){},n.prototype.visitRepetitionWithSeparator=function(e){},n.prototype.visitAlternation=function(e){},n.prototype.visitTerminal=function(e){},n.prototype.visitRule=function(e){},n}(),yje=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function Sje(n){return n instanceof _s||n instanceof ai||n instanceof ir||n instanceof ta||n instanceof na||n instanceof mo||n instanceof Fn||n instanceof wv}function X0(n,e){e===void 0&&(e=[]);var t=n instanceof ai||n instanceof ir||n instanceof mo;return t?!0:n instanceof po?Hq(n.definition,function(r){return X0(r,e)}):n instanceof go&&Lr(e,n)?!1:n instanceof hu?(n instanceof go&&e.push(n),Ko(n.definition,function(r){return X0(r,e)})):!1}function Cje(n){return n instanceof po}function Da(n){if(n instanceof go)return"SUBRULE";if(n instanceof ai)return"OPTION";if(n instanceof po)return"OR";if(n instanceof ta)return"AT_LEAST_ONE";if(n instanceof na)return"AT_LEAST_ONE_SEP";if(n instanceof mo)return"MANY_SEP";if(n instanceof ir)return"MANY";if(n instanceof Fn)return"CONSUME";throw Error("non exhaustive match")}var Eje=function(n){yje(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var r=t.terminalType.name+this.separator+"Terminal";Ve(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitNonTerminal=function(t){var r=t.nonTerminalName+this.separator+"Terminal";Ve(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(pg),GR=new Eje;function Rje(n){GR.reset(),n.accept(GR);var e=GR.dslMethods;return GR.reset(),e}function xC(n){if(n instanceof go)return xC(n.referencedRule);if(n instanceof Fn)return Aje(n);if(Sje(n))return Tje(n);if(Cje(n))return bje(n);throw Error("non exhaustive match")}function Tje(n){for(var e=[],t=n.definition,r=0,i=t.length>r,s,o=!0;i&&o;)s=t[r],o=X0(s),e=e.concat(xC(s)),r=r+1,i=t.length>r;return kV(e)}function bje(n){var e=Te(n.definition,function(t){return xC(t)});return kV(Is(e))}function Aje(n){return[n.terminalType]}var qq="_~IN~_",Nje=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Mje=function(n){Nje(e,n);function e(t){var r=n.call(this)||this;return r.topProd=t,r.follows={},r}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,r,i){},e.prototype.walkProdRef=function(t,r,i){var s=Oje(t.referencedRule,t.idx)+this.topProd.name,o=r.concat(i),a=new _s({definition:o}),l=xC(a);this.follows[s]=l},e}(WN);function Ije(n){var e={};return $e(n,function(t){var r=new Mje(t).startWalking();el(e,r)}),e}function Oje(n,e){return n.name+e+qq}var _je=4,ud=8,Pje=8,Cp=1<<ud,q0=2<<ud,Ly=3<<ud,Hy=4<<ud,Dy=5<<ud,ep=6<<ud;function Fy(n,e,t){return t|e|n}var xje=32-Pje;function Qq(n,e,t,r){var i=r+1<<xje;return Fy(n,e,t)|i}var Lje=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function GG(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.endOffset=e.endOffset):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset)}function YG(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.startColumn=e.startColumn,n.startLine=e.startLine,n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine)}function Hje(n,e,t){n.children[t]===void 0?n.children[t]=[e]:n.children[t].push(e)}function KG(n,e,t){n.children[e]===void 0?n.children[e]=[t]:n.children[e].push(t)}var WV=function(n){Lje(e,n);function e(t){var r=n.call(this)||this;return r.result=[],r.ruleIdx=t,r}return e.prototype.collectNamedDSLMethod=function(t,r,i){if(!ea(t.name)){var s=void 0;if(t instanceof ai||t instanceof ir||t instanceof ta||t instanceof po)s=new r({definition:t.definition,idx:t.idx});else if(t instanceof na||t instanceof mo)s=new r({definition:t.definition,idx:t.idx,separator:t.separator});else throw Error("non exhaustive match");var o=[s],a=Fy(this.ruleIdx,i,t.idx);this.result.push({def:o,key:a,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,ai,q0)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,ir,Ly)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,ta,Hy)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,na,ep)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,mo,Dy)},e.prototype.visitAlternation=function(t){var r=this;this.collectNamedDSLMethod(t,po,Cp);var i=t.definition.length>1;$e(t.definition,function(s,o){if(!ea(s.name)){var a=s.definition;i?a=[new ai({definition:s.definition})]:a=s.definition;var l=Qq(r.ruleIdx,Cp,t.idx,o);r.result.push({def:a,key:l,name:s.name,orgProd:s})}})},e}(pg);function Dje(n,e){var t={allRuleNames:[]};return $e(n,function(r){var i=e[r.name];t.allRuleNames.push(r.name);var s=new WV(i);r.accept(s),$e(s.result,function(o){o.def,o.key;var a=o.name;t.allRuleNames.push(r.name+a)})}),t}var vg=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Fje=function(n){vg(e,n);function e(t,r){var i=n.call(this)||this;return i.topProd=t,i.path=r,i.possibleTokTypes=[],i.nextProductionName="",i.nextProductionOccurrence=0,i.found=!1,i.isAtEndOfPath=!1,i}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Os(this.path.ruleStack).reverse(),this.occurrenceStack=Os(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(t,r){r===void 0&&(r=[]),this.found||n.prototype.walk.call(this,t,r)},e.prototype.walkProdRef=function(t,r,i){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var s=r.concat(i);this.updateExpectedNext(),this.walk(t.referencedRule,s)}},e.prototype.updateExpectedNext=function(){tn(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(WN),kje=function(n){vg(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.path=r,i.nextTerminalName="",i.nextTerminalOccurrence=0,i.nextTerminalName=i.path.lastTok.name,i.nextTerminalOccurrence=i.path.lastTokOccurrence,i}return e.prototype.walkTerminal=function(t,r,i){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var s=r.concat(i),o=new _s({definition:s});this.possibleTokTypes=xC(o),this.found=!0}},e}(Fje),jN=function(n){vg(e,n);function e(t,r){var i=n.call(this)||this;return i.topRule=t,i.occurrence=r,i.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},i}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(WN),Vje=function(n){vg(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkMany=function(t,r,i){if(t.idx===this.occurrence){var s=Jo(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Fn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkMany.call(this,t,r,i)},e}(jN),XG=function(n){vg(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkManySep=function(t,r,i){if(t.idx===this.occurrence){var s=Jo(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Fn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkManySep.call(this,t,r,i)},e}(jN),$je=function(n){vg(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(t,r,i){if(t.idx===this.occurrence){var s=Jo(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Fn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkAtLeastOne.call(this,t,r,i)},e}(jN),qG=function(n){vg(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(t,r,i){if(t.idx===this.occurrence){var s=Jo(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Fn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkAtLeastOneSep.call(this,t,r,i)},e}(jN);function H1(n,e,t){t===void 0&&(t=[]),t=Os(t);var r=[],i=0;function s(u){return u.concat(ni(n,i+1))}function o(u){var c=H1(s(u),e,t);return r.concat(c)}for(;t.length<e&&i<n.length;){var a=n[i];if(a instanceof _s)return o(a.definition);if(a instanceof go)return o(a.definition);if(a instanceof ai)r=o(a.definition);else if(a instanceof ta){var l=a.definition.concat([new ir({definition:a.definition})]);return o(l)}else if(a instanceof na){var l=[new _s({definition:a.definition}),new ir({definition:[new Fn({terminalType:a.separator})].concat(a.definition)})];return o(l)}else if(a instanceof mo){var l=a.definition.concat([new ir({definition:[new Fn({terminalType:a.separator})].concat(a.definition)})]);r=o(l)}else if(a instanceof ir){var l=a.definition.concat([new ir({definition:a.definition})]);r=o(l)}else{if(a instanceof po)return $e(a.definition,function(u){r=o(u.definition)}),r;if(a instanceof Fn)t.push(a.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:t,suffixDef:ni(n,i)}),r}function Zq(n,e,t,r){var i="EXIT_NONE_TERMINAL",s=[i],o="EXIT_ALTERNATIVE",a=!1,l=e.length,u=l-r-1,c=[],h=[];for(h.push({idx:-1,def:n,ruleStack:[],occurrenceStack:[]});!tn(h);){var d=h.pop();if(d===o){a&&Lq(h).idx<=u&&h.pop();continue}var f=d.def,m=d.idx,g=d.ruleStack,C=d.occurrenceStack;if(!tn(f)){var y=f[0];if(y===i){var w={idx:m,def:ni(f),ruleStack:xS(g),occurrenceStack:xS(C)};h.push(w)}else if(y instanceof Fn)if(m<l-1){var S=m+1,E=e[S];if(t(E,y.terminalType)){var w={idx:S,def:ni(f),ruleStack:g,occurrenceStack:C};h.push(w)}}else if(m===l-1)c.push({nextTokenType:y.terminalType,nextTokenOccurrence:y.idx,ruleStack:g,occurrenceStack:C}),a=!0;else throw Error("non exhaustive match");else if(y instanceof go){var P=Os(g);P.push(y.nonTerminalName);var _=Os(C);_.push(y.idx);var w={idx:m,def:y.definition.concat(s,ni(f)),ruleStack:P,occurrenceStack:_};h.push(w)}else if(y instanceof ai){var I={idx:m,def:ni(f),ruleStack:g,occurrenceStack:C};h.push(I),h.push(o);var D={idx:m,def:y.definition.concat(ni(f)),ruleStack:g,occurrenceStack:C};h.push(D)}else if(y instanceof ta){var Q=new ir({definition:y.definition,idx:y.idx}),F=y.definition.concat([Q],ni(f)),w={idx:m,def:F,ruleStack:g,occurrenceStack:C};h.push(w)}else if(y instanceof na){var J=new Fn({terminalType:y.separator}),Q=new ir({definition:[J].concat(y.definition),idx:y.idx}),F=y.definition.concat([Q],ni(f)),w={idx:m,def:F,ruleStack:g,occurrenceStack:C};h.push(w)}else if(y instanceof mo){var I={idx:m,def:ni(f),ruleStack:g,occurrenceStack:C};h.push(I),h.push(o);var J=new Fn({terminalType:y.separator}),q=new ir({definition:[J].concat(y.definition),idx:y.idx}),F=y.definition.concat([q],ni(f)),D={idx:m,def:F,ruleStack:g,occurrenceStack:C};h.push(D)}else if(y instanceof ir){var I={idx:m,def:ni(f),ruleStack:g,occurrenceStack:C};h.push(I),h.push(o);var q=new ir({definition:y.definition,idx:y.idx}),F=y.definition.concat([q],ni(f)),D={idx:m,def:F,ruleStack:g,occurrenceStack:C};h.push(D)}else if(y instanceof po)for(var ie=y.definition.length-1;ie>=0;ie--){var fe=y.definition[ie],Ee={idx:m,def:fe.definition.concat(ni(f)),ruleStack:g,occurrenceStack:C};h.push(Ee),h.push(o)}else if(y instanceof _s)h.push({idx:m,def:y.definition.concat(ni(f)),ruleStack:g,occurrenceStack:C});else if(y instanceof wv)h.push(Uje(y,m,g,C));else throw Error("non exhaustive match")}}return c}function Uje(n,e,t,r){var i=Os(t);i.push(n.name);var s=Os(r);return s.push(1),{idx:e,def:n.definition,ruleStack:i,occurrenceStack:s}}var Jq=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),sn;(function(n){n[n.OPTION=0]="OPTION",n[n.REPETITION=1]="REPETITION",n[n.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",n[n.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",n[n.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",n[n.ALTERNATION=5]="ALTERNATION"})(sn||(sn={}));function Bje(n){if(n instanceof ai)return sn.OPTION;if(n instanceof ir)return sn.REPETITION;if(n instanceof ta)return sn.REPETITION_MANDATORY;if(n instanceof na)return sn.REPETITION_MANDATORY_WITH_SEPARATOR;if(n instanceof mo)return sn.REPETITION_WITH_SEPARATOR;if(n instanceof po)return sn.ALTERNATION;throw Error("non exhaustive match")}function Wje(n,e,t,r,i,s){var o=jV(n,e,t),a=nQ(o)?K0:BN;return s(o,r,a,i)}function jje(n,e,t,r,i,s){var o=zV(n,e,i,t),a=nQ(o)?K0:BN;return s(o[0],a,r)}function zje(n,e,t,r){var i=n.length,s=Ko(n,function(l){return Ko(l,function(u){return u.length===1})});if(e)return function(l){for(var u=Te(l,function(S){return S.GATE}),c=0;c<i;c++){var h=n[c],d=h.length,f=u[c];if(!(f!==void 0&&f.call(this)===!1))e:for(var m=0;m<d;m++){for(var g=h[m],C=g.length,y=0;y<C;y++){var w=this.LA(y+1);if(t(w,g[y])===!1)continue e}return c}}};if(s&&!r){var o=Te(n,function(l){return Is(l)}),a=ui(o,function(l,u,c){return $e(u,function(h){Ve(l,h.tokenTypeIdx)||(l[h.tokenTypeIdx]=c),$e(h.categoryMatches,function(d){Ve(l,d)||(l[d]=c)})}),l},[]);return function(){var l=this.LA(1);return a[l.tokenTypeIdx]}}else return function(){for(var l=0;l<i;l++){var u=n[l],c=u.length;e:for(var h=0;h<c;h++){for(var d=u[h],f=d.length,m=0;m<f;m++){var g=this.LA(m+1);if(t(g,d[m])===!1)continue e}return l}}}}function Gje(n,e,t){var r=Ko(n,function(u){return u.length===1}),i=n.length;if(r&&!t){var s=Is(n);if(s.length===1&&tn(s[0].categoryMatches)){var o=s[0],a=o.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{var l=ui(s,function(u,c,h){return u[c.tokenTypeIdx]=!0,$e(c.categoryMatches,function(d){u[d]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<i;u++){for(var c=n[u],h=c.length,d=0;d<h;d++){var f=this.LA(d+1);if(e(f,c[d])===!1)continue e}return!0}return!1}}var Yje=function(n){Jq(e,n);function e(t,r,i){var s=n.call(this)||this;return s.topProd=t,s.targetOccurrence=r,s.targetProdType=i,s}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,r,i,s){return t.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=i.concat(s),!0):!1},e.prototype.walkOption=function(t,r,i){this.checkIsTarget(t,sn.OPTION,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkAtLeastOne=function(t,r,i){this.checkIsTarget(t,sn.REPETITION_MANDATORY,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkAtLeastOneSep=function(t,r,i){this.checkIsTarget(t,sn.REPETITION_MANDATORY_WITH_SEPARATOR,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkMany=function(t,r,i){this.checkIsTarget(t,sn.REPETITION,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkManySep=function(t,r,i){this.checkIsTarget(t,sn.REPETITION_WITH_SEPARATOR,r,i)||n.prototype.walkOption.call(this,t,r,i)},e}(WN),eQ=function(n){Jq(e,n);function e(t,r,i){var s=n.call(this)||this;return s.targetOccurrence=t,s.targetProdType=r,s.targetRef=i,s.result=[],s}return e.prototype.checkIsTarget=function(t,r){t.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,sn.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,sn.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,sn.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,sn.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,sn.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,sn.ALTERNATION)},e}(pg);function QG(n){for(var e=new Array(n),t=0;t<n;t++)e[t]=[];return e}function W_(n){for(var e=[""],t=0;t<n.length;t++){for(var r=n[t],i=[],s=0;s<e.length;s++){var o=e[s];i.push(o+"_"+r.tokenTypeIdx);for(var a=0;a<r.categoryMatches.length;a++){var l="_"+r.categoryMatches[a];i.push(o+l)}}e=i}return e}function Kje(n,e,t){for(var r=0;r<n.length;r++)if(r!==t)for(var i=n[r],s=0;s<e.length;s++){var o=e[s];if(i[o]===!0)return!1}return!0}function tQ(n,e){for(var t=Te(n,function(c){return H1([c],1)}),r=QG(t.length),i=Te(t,function(c){var h={};return $e(c,function(d){var f=W_(d.partialPath);$e(f,function(m){h[m]=!0})}),h}),s=t,o=1;o<=e;o++){var a=s;s=QG(a.length);for(var l=function(c){for(var h=a[c],d=0;d<h.length;d++){var f=h[d].partialPath,m=h[d].suffixDef,g=W_(f),C=Kje(i,g,c);if(C||tn(m)||f.length===e){var y=r[c];if(D1(y,f)===!1){y.push(f);for(var w=0;w<g.length;w++){var S=g[w];i[c][S]=!0}}}else{var E=H1(m,o+1,f);s[c]=s[c].concat(E),$e(E,function(P){var _=W_(P.partialPath);$e(_,function(I){i[c][I]=!0})})}}},u=0;u<a.length;u++)l(u)}return r}function jV(n,e,t,r){var i=new eQ(n,sn.ALTERNATION,r);return e.accept(i),tQ(i.result,t)}function zV(n,e,t,r){var i=new eQ(n,t);e.accept(i);var s=i.result,o=new Yje(e,n,t),a=o.startWalking(),l=new _s({definition:s}),u=new _s({definition:a});return tQ([l,u],r)}function D1(n,e){e:for(var t=0;t<n.length;t++){var r=n[t];if(r.length===e.length){for(var i=0;i<r.length;i++){var s=e[i],o=r[i],a=s===o||o.categoryMatchesMap[s.tokenTypeIdx]!==void 0;if(a===!1)continue e}return!0}}return!1}function Xje(n,e){return n.length<e.length&&Ko(n,function(t,r){var i=e[r];return t===i||i.categoryMatchesMap[t.tokenTypeIdx]})}function nQ(n){return Ko(n,function(e){return Ko(e,function(t){return Ko(t,function(r){return tn(r.categoryMatches)})})})}var GV=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function qje(n,e,t,r,i,s){var o=Te(n,function(w){return Zje(w,i)}),a=Te(n,function(w){return sQ(w,w,i)}),l=[],u=[],c=[];Ko(a,tn)&&(l=Te(n,function(w){return oze(w,i)}),u=Te(n,function(w){return aze(w,e,r,i)}),c=cze(n,e,i));var h=fze(n,t,i),d=Te(t,function(w){return rze(w,i)}),f=Qje(n,i),m=gze(n,i),g=Te(n,function(w){return uze(w,i)}),C=Te(n,function(w){return tze(w,i)}),y=Te(n,function(w){return ize(w,n,s,i)});return Is(o.concat(d,f,m,c,a,l,u,h,g,C,y))}function Qje(n,e){var t=[];return $e(n,function(r){var i=new WV("");r.accept(i);var s=Te(i.result,function(o){return o.orgProd});t.push(Te(s,function(o){return nze(r,o,e)}))}),Is(t)}function Zje(n,e){var t=new eze;n.accept(t);var r=t.allProductions,i=Dq(r,Jje),s=ha(i,function(a){return a.length>1}),o=Te(Ni(s),function(a){var l=Jo(a),u=e.buildDuplicateFoundError(n,a),c=Da(l),h={message:u,type:qr.DUPLICATE_PRODUCTIONS,ruleName:n.name,dslName:c,occurrence:l.idx},d=rQ(l);return d&&(h.parameter=d),h});return o}function Jje(n){return Da(n)+"_#_"+n.idx+"_#_"+rQ(n)}function rQ(n){return n instanceof Fn?n.terminalType.name:n instanceof go?n.nonTerminalName:""}var eze=function(n){GV(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(pg),ng=/^[a-zA-Z_]\w*$/,iQ=new RegExp(ng.source.replace("^","^\\$"));function tze(n,e){var t=[],r=n.name;return r.match(ng)||t.push({message:e.buildInvalidRuleNameError({topLevelRule:n,expectedPattern:ng}),type:qr.INVALID_RULE_NAME,ruleName:r}),t}function nze(n,e,t){var r=[],i;return e.name.match(iQ)||(i=t.buildInvalidNestedRuleNameError(n,e),r.push({message:i,type:qr.INVALID_NESTED_RULE_NAME,ruleName:n.name})),r}function rze(n,e){var t=[],r=n.name;return r.match(ng)||t.push({message:e.buildTokenNameError({tokenType:n,expectedPattern:ng}),type:qr.INVALID_TOKEN_NAME}),t}function ize(n,e,t,r){var i=[],s=ui(e,function(a,l){return l.name===n.name?a+1:a},0);if(s>1){var o=r.buildDuplicateRuleNameError({topLevelRule:n,grammarName:t});i.push({message:o,type:qr.DUPLICATE_RULE_NAME,ruleName:n.name})}return i}function sze(n,e,t){var r=[],i;return Lr(e,n)||(i="Invalid rule override, rule: ->"+n+"<- cannot be overridden in the grammar: ->"+t+"<-as it is not defined in any of the super grammars ",r.push({message:i,type:qr.INVALID_RULE_OVERRIDE,ruleName:n})),r}function sQ(n,e,t,r){r===void 0&&(r=[]);var i=[],s=QT(e.definition);if(tn(s))return[];var o=n.name,a=Lr(s,n);a&&i.push({message:t.buildLeftRecursionError({topLevelRule:n,leftRecursionPath:r}),type:qr.LEFT_RECURSION,ruleName:o});var l=VN(s,r.concat([n])),u=Te(l,function(c){var h=Os(r);return h.push(c),sQ(n,c,t,h)});return i.concat(Is(u))}function QT(n){var e=[];if(tn(n))return e;var t=Jo(n);if(t instanceof go)e.push(t.referencedRule);else if(t instanceof _s||t instanceof ai||t instanceof ta||t instanceof na||t instanceof mo||t instanceof ir)e=e.concat(QT(t.definition));else if(t instanceof po)e=Is(Te(t.definition,function(o){return QT(o.definition)}));else if(!(t instanceof Fn))throw Error("non exhaustive match");var r=X0(t),i=n.length>1;if(r&&i){var s=ni(n);return e.concat(QT(s))}else return e}var YV=function(n){GV(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.alternations=[],t}return e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(pg);function oze(n,e){var t=new YV;n.accept(t);var r=t.alternations,i=ui(r,function(s,o){var a=xS(o.definition),l=Te(a,function(u,c){var h=Zq([u],[],null,1);return tn(h)?{message:e.buildEmptyAlternationError({topLevelRule:n,alternation:o,emptyChoiceIdx:c}),type:qr.NONE_LAST_EMPTY_ALT,ruleName:n.name,occurrence:o.idx,alternative:c+1}:null});return s.concat(OC(l))},[]);return i}function aze(n,e,t,r){var i=new YV;n.accept(i);var s=i.alternations,o=t[n.name];o&&(s=eg(s,function(l){return o[Da(l)+(l.idx===0?"":l.idx)]})),s=eg(s,function(l){return l.ignoreAmbiguities===!0});var a=ui(s,function(l,u){var c=u.idx,h=u.maxLookahead||e,d=jV(c,n,h,u),f=hze(d,u,n,r),m=dze(d,u,n,r);return l.concat(f,m)},[]);return a}var lze=function(n){GV(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(pg);function uze(n,e){var t=new YV;n.accept(t);var r=t.alternations,i=ui(r,function(s,o){return o.definition.length>255&&s.push({message:e.buildTooManyAlternativesError({topLevelRule:n,alternation:o}),type:qr.TOO_MANY_ALTS,ruleName:n.name,occurrence:o.idx}),s},[]);return i}function cze(n,e,t){var r=[];return $e(n,function(i){var s=new lze;i.accept(s);var o=s.allProductions;$e(o,function(a){var l=Bje(a),u=a.maxLookahead||e,c=a.idx,h=zV(c,i,l,u),d=h[0];if(tn(Is(d))){var f=t.buildEmptyRepetitionError({topLevelRule:i,repetition:a});r.push({message:f,type:qr.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function hze(n,e,t,r){var i=[],s=ui(n,function(a,l,u){return e.definition[u].ignoreAmbiguities===!0||$e(l,function(c){var h=[u];$e(n,function(d,f){u!==f&&D1(d,c)&&e.definition[f].ignoreAmbiguities!==!0&&h.push(f)}),h.length>1&&!D1(i,c)&&(i.push(c),a.push({alts:h,path:c}))}),a},[]),o=Te(s,function(a){var l=Te(a.alts,function(c){return c+1}),u=r.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:l,prefixPath:a.path});return{message:u,type:qr.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:[a.alts]}});return o}function dze(n,e,t,r){var i=[],s=ui(n,function(o,a,l){var u=Te(a,function(c){return{idx:l,path:c}});return o.concat(u)},[]);return $e(s,function(o){var a=e.definition[o.idx];if(a.ignoreAmbiguities!==!0){var l=o.idx,u=o.path,c=N2e(s,function(d){return e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<l&&Xje(d.path,u)}),h=Te(c,function(d){var f=[d.idx+1,l+1],m=e.idx===0?"":e.idx,g=r.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:f,prefixPath:d.path});return{message:g,type:qr.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:m,alternatives:f}});i=i.concat(h)}}),i}function fze(n,e,t){var r=[],i=Te(e,function(s){return s.name});return $e(n,function(s){var o=s.name;if(Lr(i,o)){var a=t.buildNamespaceConflictError(s);r.push({message:a,type:qr.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),r}function gze(n,e){var t=[];return $e(n,function(r){var i=new WV("");r.accept(i);var s=Dq(i.result,function(a){return a.name}),o=ha(s,function(a){return a.length>1});$e(Ni(o),function(a){var l=Te(a,function(c){return c.orgProd}),u=e.buildDuplicateNestedRuleNameError(r,l);t.push({message:u,type:qr.DUPLICATE_NESTED_NAME,ruleName:r.name})})}),t}var oQ={buildMismatchTokenMessage:function(n){var e=n.expected,t=n.actual;n.previous,n.ruleName;var r=Xq(e),i=r?"--> "+Sp(e)+" <--":"token of type --> "+e.name+" <--",s="Expecting "+i+" but found --> '"+t.image+"' <--";return s},buildNotAllInputParsedMessage:function(n){var e=n.firstRedundant;return n.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(n){var e=n.expectedPathsPerAlt,t=n.actual;n.previous;var r=n.customUserDescription;n.ruleName;var i="Expecting: ",s=Jo(t).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var a=ui(e,function(h,d){return h.concat(d)},[]),l=Te(a,function(h){return"["+Te(h,function(d){return Sp(d)}).join(", ")+"]"}),u=Te(l,function(h,d){return"  "+(d+1)+". "+h}),c=`one of these possible Token sequences:
`+u.join(`
`);return i+c+o},buildEarlyExitMessage:function(n){var e=n.expectedIterationPaths,t=n.actual,r=n.customUserDescription;n.ruleName;var i="Expecting: ",s=Jo(t).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var a=Te(e,function(u){return"["+Te(u,function(c){return Sp(c)}).join(",")+"]"}),l=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+a.join(" ,")+">");return i+l+o}};Object.freeze(oQ);var mze={buildRuleNotFoundError:function(n,e){var t="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+n.name+"<-";return t}},KV={buildDuplicateFoundError:function(n,e){function t(c){return c instanceof Fn?c.terminalType.name:c instanceof go?c.nonTerminalName:""}var r=n.name,i=Jo(e),s=i.idx,o=Da(i),a=t(i),l=s>0,u="->"+o+(l?s:"")+"<- "+(a?"with argument: ->"+a+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+r+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(n,e){var t="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+n.name+`<-
`+("it must match the pattern: ->"+iQ.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return t},buildDuplicateNestedRuleNameError:function(n,e){var t=Jo(e).name,r="Duplicate nested rule name: ->"+t+"<- inside rule: ->"+n.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return r},buildNamespaceConflictError:function(n){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+n.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(n){var e=Te(n.prefixPath,function(i){return Sp(i)}).join(", "),t=n.alternation.idx===0?"":n.alternation.idx,r="Ambiguous alternatives: <"+n.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+t+"> inside <"+n.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return r},buildAlternationAmbiguityError:function(n){var e=Te(n.prefixPath,function(i){return Sp(i)}).join(", "),t=n.alternation.idx===0?"":n.alternation.idx,r="Ambiguous Alternatives Detected: <"+n.ambiguityIndices.join(" ,")+"> in <OR"+t+">"+(" inside <"+n.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return r=r+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError:function(n){var e=Da(n.repetition);n.repetition.idx!==0&&(e+=n.repetition.idx);var t="The repetition <"+e+"> within Rule <"+n.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return t},buildTokenNameError:function(n){var e=n.tokenType.name,t="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+n.expectedPattern.toString()+"<-";return t},buildEmptyAlternationError:function(n){var e="Ambiguous empty alternative: <"+(n.emptyChoiceIdx+1)+">"+(" in <OR"+n.alternation.idx+"> inside <"+n.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(n){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+n.alternation.idx+"> inside <"+n.topLevelRule.name+`> Rule.
 has `+(n.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(n){var e=n.topLevelRule.name,t=Te(n.leftRecursionPath,function(s){return s.name}),r=e+" --> "+t.concat([e]).join(" --> "),i=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+r+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return i},buildInvalidRuleNameError:function(n){var e=n.topLevelRule.name,t=n.expectedPattern.toString(),r="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+t+"<-";return r},buildDuplicateRuleNameError:function(n){var e;n.topLevelRule instanceof wv?e=n.topLevelRule.name:e=n.topLevelRule;var t="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+n.grammarName+"<-";return t}},pze=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function vze(n,e){var t=new wze(n,e);return t.resolveRefs(),t.errors}var wze=function(n){pze(e,n);function e(t,r){var i=n.call(this)||this;return i.nameToTopRule=t,i.errMsgProvider=r,i.errors=[],i}return e.prototype.resolveRefs=function(){var t=this;$e(Ni(this.nameToTopRule),function(r){t.currTopLevel=r,r.accept(t)})},e.prototype.visitNonTerminal=function(t){var r=this.nameToTopRule[t.nonTerminalName];if(r)t.referencedRule=r;else{var i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:i,type:qr.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(pg);function yze(n){n=$N(n,{errMsgProvider:mze});var e={};return $e(n.rules,function(t){e[t.name]=t}),vze(e,n.errMsgProvider)}function Sze(n){return n=$N(n,{errMsgProvider:KV,ignoredIssues:{}}),qje(n.rules,n.maxLookahead,n.tokenTypes,n.ignoredIssues,n.errMsgProvider,n.grammarName)}var aQ="MismatchedTokenException",lQ="NoViableAltException",uQ="EarlyExitException",cQ="NotAllInputParsedException",hQ=[aQ,lQ,uQ,cQ];Object.freeze(hQ);function Q0(n){return Lr(hQ,n.name)}function XV(n,e,t){this.name=aQ,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}XV.prototype=Error.prototype;function dQ(n,e,t){this.name=lQ,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}dQ.prototype=Error.prototype;function fQ(n,e){this.name=cQ,this.message=n,this.token=e,this.resyncedTokens=[]}fQ.prototype=Error.prototype;function gQ(n,e,t){this.name=uQ,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}gQ.prototype=Error.prototype;var j_={},mQ="InRuleRecoveryException";function pQ(n){this.name=mQ,this.message=n}pQ.prototype=Error.prototype;var Cze=function(){function n(){}return n.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ve(e,"recoveryEnabled")?e.recoveryEnabled:Ss.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Eze)},n.prototype.getTokenToInsert=function(e){var t=BV(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},n.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},n.prototype.tryInRepetitionRecovery=function(e,t,r,i){for(var s=this,o=this.findReSyncTokenType(),a=this.exportLexerState(),l=[],u=!1,c=this.LA(1),h=this.LA(1),d=function(){var f=s.LA(0),m=s.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:f,ruleName:s.getCurrRuleFullName()}),g=new XV(m,c,s.LA(0));g.resyncedTokens=xS(l),s.SAVE_ERROR(g)};!u;)if(this.tokenMatcher(h,i)){d();return}else if(r.call(this)){d(),e.apply(this,t);return}else this.tokenMatcher(h,o)?u=!0:(h=this.SKIP_TOKEN(),this.addToResyncTokens(h,l));this.importLexerState(a)},n.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!(r===!1||e===void 0||t===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},n.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t),i=this.getNextPossibleTokenTypes(r);return i},n.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var r=this.getTokenToInsert(e);return r}if(this.canRecoverWithSingleTokenDeletion(e)){var i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new pQ("sad sad panda")},n.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},n.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||tn(t))return!1;var i=this.LA(1),s=zp(t,function(o){return r.tokenMatcher(i,o)})!==void 0;return s},n.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},n.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return Lr(r,e)},n.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var i=t.tokenType;if(Lr(e,i))return i;t=this.LA(r),r++}},n.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return j_;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},n.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return tn(this.LAST_EXPLICIT_RULE_STACK)||(t=Te(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_STACK[i]}),r=Te(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_OCCURRENCE_STACK[i]})),Te(t,function(i,s){return s===0?j_:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:r[s],inRule:e.shortRuleNameToFullName(t[s-1])}})},n.prototype.flattenFollowSet=function(){var e=this,t=Te(this.buildFullFollowKeyStack(),function(r){return e.getFollowSetFromFollowKey(r)});return Is(t)},n.prototype.getFollowSetFromFollowKey=function(e){if(e===j_)return[tg];var t=e.ruleName+e.idxInCallingRule+qq+e.inRule;return this.resyncFollows[t]},n.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,tg)||t.push(e),t},n.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return xS(t)},n.prototype.attemptInRepetitionRecovery=function(e,t,r,i,s,o,a){},n.prototype.getCurrentGrammarPath=function(e,t){var r=this.getHumanReadableRuleStack(),i=Os(this.RULE_OCCURRENCE_STACK),s={ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:t};return s},n.prototype.getHumanReadableRuleStack=function(){var e=this;return tn(this.LAST_EXPLICIT_RULE_STACK)?Te(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):Te(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},n}();function Eze(n,e,t,r,i,s,o){var a=this.getKeyForAutomaticLookahead(r,i),l=this.firstAfterRepMap[a];if(l===void 0){var u=this.getCurrRuleFullName(),c=this.getGAstProductions()[u],h=new s(c,i);l=h.startWalking(),this.firstAfterRepMap[a]=l}var d=l.token,f=l.occurrence,m=l.isEndOfRule;this.RULE_STACK.length===1&&m&&d===void 0&&(d=tg,f=1),this.shouldInRepetitionRecoveryBeTried(d,f,o)&&this.tryInRepetitionRecovery(n,e,t,d)}var Rze=function(){function n(){}return n.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Ve(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Ss.dynamicTokensEnabled,this.maxLookahead=Ve(e,"maxLookahead")?e.maxLookahead:Ss.maxLookahead,this.lookAheadFuncsCache=_G()?new Map:[],_G()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},n.prototype.preComputeLookaheadFunctions=function(e){var t=this;$e(e,function(r){t.TRACE_INIT(r.name+" Rule Lookahead",function(){var i=Rje(r),s=i.alternation,o=i.repetition,a=i.option,l=i.repetitionMandatory,u=i.repetitionMandatoryWithSeparator,c=i.repetitionWithSeparator;$e(s,function(h){var d=h.idx===0?"":h.idx;t.TRACE_INIT(""+Da(h)+d,function(){var f=Wje(h.idx,r,h.maxLookahead||t.maxLookahead,h.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),m=Fy(t.fullRuleNameToShort[r.name],Cp,h.idx);t.setLaFuncCache(m,f)})}),$e(o,function(h){t.computeLookaheadFunc(r,h.idx,Ly,sn.REPETITION,h.maxLookahead,Da(h))}),$e(a,function(h){t.computeLookaheadFunc(r,h.idx,q0,sn.OPTION,h.maxLookahead,Da(h))}),$e(l,function(h){t.computeLookaheadFunc(r,h.idx,Hy,sn.REPETITION_MANDATORY,h.maxLookahead,Da(h))}),$e(u,function(h){t.computeLookaheadFunc(r,h.idx,ep,sn.REPETITION_MANDATORY_WITH_SEPARATOR,h.maxLookahead,Da(h))}),$e(c,function(h){t.computeLookaheadFunc(r,h.idx,Dy,sn.REPETITION_WITH_SEPARATOR,h.maxLookahead,Da(h))})})})},n.prototype.computeLookaheadFunc=function(e,t,r,i,s,o){var a=this;this.TRACE_INIT(""+o+(t===0?"":t),function(){var l=jje(t,e,s||a.maxLookahead,a.dynamicTokensEnabled,i,a.lookAheadBuilderForOptional),u=Fy(a.fullRuleNameToShort[e.name],r,t);a.setLaFuncCache(u,l)})},n.prototype.lookAheadBuilderForOptional=function(e,t,r){return Gje(e,t,r)},n.prototype.lookAheadBuilderForAlternatives=function(e,t,r,i){return zje(e,t,r,i)},n.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return Fy(r,e,t)},n.prototype.getLaFuncFromCache=function(e){},n.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},n.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},n.prototype.setLaFuncCache=function(e,t){},n.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},n.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},n}();function Tze(n){return zN(n.constructor)}var bze=/^\s*function\s*(\S*)\s*\(/,ZG="name";function zN(n){var e=n.name;if(e)return e;var t=n.toString().match(bze)[1];return t}function vQ(n,e){var t=Object.getOwnPropertyDescriptor(n,ZG);return ea(t)||t.configurable?(Object.defineProperty(n,ZG,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function Aze(n,e){for(var t=Ec(n),r=t.length,i=0;i<r;i++)for(var s=t[i],o=n[s],a=o.length,l=0;l<a;l++){var u=o[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function Nze(n,e){var t=function(){};vQ(t,n+"BaseSemantics");var r={visit:function(i,s){if(Ba(i)&&(i=i[0]),!ea(i))return i.fullName!==void 0?this[i.fullName](i.children,s):this[i.name](i.children,s)},validateVisitor:function(){var i=Ize(this,e);if(!tn(i)){var s=Te(i,function(o){return o.msg});throw Error("Errors Detected in CST Visitor <"+zN(this.constructor)+`>:
	`+(""+s.join(`

`).replace(/\n/g,`
	`)))}}};return t.prototype=r,t.prototype.constructor=t,t._RULE_NAMES=e,t}function Mze(n,e,t){var r=function(){};vQ(r,n+"BaseSemanticsWithDefaults");var i=Object.create(t.prototype);return $e(e,function(s){i[s]=Aze}),r.prototype=i,r.prototype.constructor=r,r}var Z0;(function(n){n[n.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",n[n.MISSING_METHOD=1]="MISSING_METHOD"})(Z0||(Z0={}));function Ize(n,e){var t=Oze(n,e),r=Pze(n,e);return t.concat(r)}function Oze(n,e){var t=Te(e,function(r){if(!ld(n[r]))return{msg:"Missing visitor method: <"+r+"> on "+zN(n.constructor)+" CST Visitor.",type:Z0.MISSING_METHOD,methodName:r}});return OC(t)}var _ze=["constructor","visit","validateVisitor"];function Pze(n,e){var t=[];for(var r in n)ng.test(r)&&ld(n[r])&&!Lr(_ze,r)&&!Lr(e,r)&&t.push({msg:"Redundant visitor method: <"+r+"> on "+zN(n.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+ng.source+"/."),type:Z0.REDUNDANT_METHOD,methodName:r});return t}var xze=function(){function n(){}return n.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Ve(e,"outputCst")?e.outputCst:Ss.outputCst,this.nodeLocationTracking=Ve(e,"nodeLocationTracking")?e.nodeLocationTracking:Ss.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Br,this.cstFinallyStateUpdate=Br,this.cstPostTerminal=Br,this.cstPostNonTerminal=Br,this.cstPostRule=Br,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=YG,this.setNodeLocationFromNode=YG,this.cstPostRule=Br,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Br,this.setNodeLocationFromNode=Br,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=GG,this.setNodeLocationFromNode=GG,this.cstPostRule=Br,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Br,this.setNodeLocationFromNode=Br,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Br,this.setNodeLocationFromNode=Br,this.cstPostRule=Br,this.setInitialNodeLocation=Br;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},n.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},n.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},n.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},n.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},n.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},n.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},n.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},n.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},n.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},n.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?r.endOffset=t.endOffset:r.startOffset=NaN},n.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];Hje(r,t,e),this.setNodeLocationFromToken(r.location,t)},n.prototype.cstPostNonTerminal=function(e,t){if(this.isBackTracking()!==!0){var r=this.CST_STACK[this.CST_STACK.length-1];KG(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},n.prototype.getBaseCstVisitorConstructor=function(){if(ea(this.baseCstVisitorConstructor)){var e=Nze(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},n.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(ea(this.baseCstVisitorWithDefaultsConstructor)){var e=Mze(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},n.prototype.nestedRuleBeforeClause=function(e,t){var r;if(e.NAME!==void 0)return r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r},n.prototype.nestedAltBeforeClause=function(e,t,r,i){var s=this.getLastExplicitRuleShortName(),o=Qq(s,r,t,i),a;if(e.NAME!==void 0)return a=e.NAME,this.nestedRuleInvocationStateUpdate(a,o),{shortName:o,nestedName:a}},n.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,i=r[r.length-1];this.nestedRuleFinallyStateUpdate();var s=r[r.length-1];KG(s,t,i),this.setNodeLocationFromNode(s.location,i.location)},n.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},n.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},n.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},n.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},n.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},n.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},n.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},n.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},n}(),Lze=function(){function n(){}return n.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(n.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),n.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):eA},n.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?eA:this.tokVector[t]},n.prototype.consumeToken=function(){this.currIdx++},n.prototype.exportLexerState=function(){return this.currIdx},n.prototype.importLexerState=function(e){this.currIdx=e},n.prototype.resetLexerState=function(){this.currIdx=-1},n.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},n.prototype.getLexerPosition=function(){return this.exportLexerState()},n}(),Hze=function(){function n(){}return n.prototype.ACTION=function(e){return e.call(this)},n.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},n.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},n.prototype.option=function(e,t){return this.optionInternal(t,e)},n.prototype.or=function(e,t){return this.orInternal(t,e)},n.prototype.many=function(e,t){return this.manyInternal(e,t)},n.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},n.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},n.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},n.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},n.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},n.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},n.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},n.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},n.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},n.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},n.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},n.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},n.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},n.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},n.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},n.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},n.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},n.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},n.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},n.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},n.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},n.prototype.OPTION=function(e){return this.optionInternal(e,0)},n.prototype.OPTION1=function(e){return this.optionInternal(e,1)},n.prototype.OPTION2=function(e){return this.optionInternal(e,2)},n.prototype.OPTION3=function(e){return this.optionInternal(e,3)},n.prototype.OPTION4=function(e){return this.optionInternal(e,4)},n.prototype.OPTION5=function(e){return this.optionInternal(e,5)},n.prototype.OPTION6=function(e){return this.optionInternal(e,6)},n.prototype.OPTION7=function(e){return this.optionInternal(e,7)},n.prototype.OPTION8=function(e){return this.optionInternal(e,8)},n.prototype.OPTION9=function(e){return this.optionInternal(e,9)},n.prototype.OR=function(e){return this.orInternal(e,0)},n.prototype.OR1=function(e){return this.orInternal(e,1)},n.prototype.OR2=function(e){return this.orInternal(e,2)},n.prototype.OR3=function(e){return this.orInternal(e,3)},n.prototype.OR4=function(e){return this.orInternal(e,4)},n.prototype.OR5=function(e){return this.orInternal(e,5)},n.prototype.OR6=function(e){return this.orInternal(e,6)},n.prototype.OR7=function(e){return this.orInternal(e,7)},n.prototype.OR8=function(e){return this.orInternal(e,8)},n.prototype.OR9=function(e){return this.orInternal(e,9)},n.prototype.MANY=function(e){this.manyInternal(0,e)},n.prototype.MANY1=function(e){this.manyInternal(1,e)},n.prototype.MANY2=function(e){this.manyInternal(2,e)},n.prototype.MANY3=function(e){this.manyInternal(3,e)},n.prototype.MANY4=function(e){this.manyInternal(4,e)},n.prototype.MANY5=function(e){this.manyInternal(5,e)},n.prototype.MANY6=function(e){this.manyInternal(6,e)},n.prototype.MANY7=function(e){this.manyInternal(7,e)},n.prototype.MANY8=function(e){this.manyInternal(8,e)},n.prototype.MANY9=function(e){this.manyInternal(9,e)},n.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},n.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},n.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},n.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},n.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},n.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},n.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},n.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},n.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},n.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},n.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},n.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},n.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},n.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},n.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},n.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},n.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},n.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},n.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},n.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},n.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},n.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},n.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},n.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},n.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},n.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},n.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},n.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},n.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},n.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},n.prototype.RULE=function(e,t,r){if(r===void 0&&(r=tA),Lr(this.definedRulesNames,e)){var i=KV.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),s={message:i,type:qr.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(s)}this.definedRulesNames.push(e);var o=this.defineRule(e,t,r);return this[e]=o,o},n.prototype.OVERRIDE_RULE=function(e,t,r){r===void 0&&(r=tA);var i=[];i=i.concat(sze(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var s=this.defineRule(e,t,r);return this[e]=s,s},n.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(i){if(Q0(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},n.prototype.getGAstProductions=function(){return this.gastProductionsCache},n.prototype.getSerializedGastProductions=function(){return wje(Ni(this.gastProductionsCache))},n}(),Dze=function(){function n(){}return n.prototype.initRecognizerEngine=function(e,t){if(this.className=Tze(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=K0,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ve(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Ba(e)){if(tn(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Ba(e))this.tokensMap=ui(e,function(o,a){return o[a.name]=a,o},{});else if(Ve(e,"modes")&&Ko(Is(Ni(e.modes)),gje)){var r=Is(Ni(e.modes)),i=kV(r);this.tokensMap=ui(i,function(o,a){return o[a.name]=a,o},{})}else if(VV(e))this.tokensMap=IC(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=tg;var s=Ko(Ni(e),function(o){return tn(o.categoryMatches)});this.tokenMatcher=s?K0:BN,PC(Ni(this.tokensMap))},n.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var i=Ve(r,"resyncEnabled")?r.resyncEnabled:tA.resyncEnabled,s=Ve(r,"recoveryValueFunc")?r.recoveryValueFunc:tA.recoveryValueFunc,o=this.ruleShortNameIdx<<_je+ud;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o;function a(c){try{if(this.outputCst===!0){t.apply(this,c);var h=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(h),h}else return t.apply(this,c)}catch(d){return this.invokeRuleCatch(d,i,s)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(c,h){return c===void 0&&(c=0),this.ruleInvocationStateUpdate(o,e,c),a.call(this,h)};var u="ruleName";return l[u]=e,l.originalGrammarAction=t,l},n.prototype.invokeRuleCatch=function(e,t,r){var i=this.RULE_STACK.length===1,s=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Q0(e)){var o=e;if(s){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(o.resyncedTokens=this.reSyncTo(a),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return r();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,o.partialCstResult=l}throw o}}else{if(i)return this.moveToTerminatedState(),r();throw o}}else throw e},n.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(q0,t),i=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(q0,t);return this.optionInternalLogic(e,t,r)},n.prototype.optionInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(e.DEF!==void 0){if(o=e.DEF,a=e.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=e;if(s.call(this)===!0)return o.call(this)},n.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Hy,e),i=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Hy,e);this.atLeastOneInternalLogic(e,t,r)},n.prototype.atLeastOneInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;if(s.call(this)===!0)for(var u=this.doSingleRepetition(o);s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);else throw this.raiseEarlyExitException(e,sn.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,Hy,e,$je)},n.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(ep,e),i=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(ep,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},n.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(r);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,qG],l,ep,e,qG)}else throw this.raiseEarlyExitException(e,sn.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},n.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Ly,e),i=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Ly,e);return this.manyInternalLogic(e,t,r)},n.prototype.manyInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;for(var u=!0;s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,Ly,e,Vje,u)},n.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Dy,e),i=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Dy,e);this.manySepFirstInternalLogic(e,t,r)},n.prototype.manySepFirstInternalLogic=function(e,t,r){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(r);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,XG],l,Dy,e,XG)}},n.prototype.repetitionSepSecondInternal=function(e,t,r,i,s){for(;r();)this.CONSUME(t),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,i,s],r,ep,e,s)},n.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var r=this.getLexerPosition();return r>t},n.prototype.orInternalNoCst=function(e,t){var r=Ba(e)?e:e.DEF,i=this.getKeyForAutomaticLookahead(Cp,t),s=this.getLaFuncFromCache(i),o=s.call(this,r);if(o!==void 0){var a=r[o];return a.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},n.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Cp,t),i=this.nestedRuleBeforeClause(e,r);try{var s=Ba(e)?e:e.DEF,o=this.getLaFuncFromCache(r),a=o.call(this,s);if(a!==void 0){var l=s[a],u=this.nestedAltBeforeClause(l,t,Cp,a);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new fQ(t,e))}},n.prototype.subruleInternal=function(e,t,r){var i;try{var s=r!==void 0?r.ARGS:void 0;return i=e.call(this,t,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(o){this.subruleInternalError(o,r,e.ruleName)}},n.prototype.subruleInternalError=function(e,t,r){throw Q0(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:r),delete e.partialCstResult),e},n.prototype.consumeInternal=function(e,t,r){var i;try{var s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,r)}catch(o){i=this.consumeInternalRecovery(e,t,o)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i},n.prototype.consumeInternalError=function(e,t,r){var i,s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new XV(i,t,s))},n.prototype.consumeInternalRecovery=function(e,t,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){var i=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===mQ?r:s}}else throw r},n.prototype.saveRecogState=function(){var e=this.errors,t=Os(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},n.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},n.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},n.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},n.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},n.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},n.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),tg)},n.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},n}(),Fze=function(){function n(){}return n.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=$N(e.errorMessageProvider,Ss.errorMessageProvider)},n.prototype.SAVE_ERROR=function(e){if(Q0(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Os(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(n.prototype,"errors",{get:function(){return Os(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),n.prototype.raiseEarlyExitException=function(e,t,r){for(var i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],o=zV(e,s,t,this.maxLookahead),a=o[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:l,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new gQ(c,this.LA(1),this.LA(0)))},n.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=jV(e,i,this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:o,previous:l,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new dQ(u,this.LA(1),l))},n}(),kze=function(){function n(){}return n.prototype.initContentAssist=function(){},n.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(ea(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return Zq([r],t,this.tokenMatcher,this.maxLookahead)},n.prototype.getNextPossibleTokenTypes=function(e){var t=Jo(e.ruleStack),r=this.getGAstProductions(),i=r[t],s=new kje(i,e).startWalking();return s},n}(),GN={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(GN);var JG=!0,eY=Math.pow(2,ud)-1,wQ=Rt({name:"RECORDING_PHASE_TOKEN",pattern:Ms.NA});PC([wQ]);var yQ=BV(wQ,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(yQ);var Vze={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},$ze=function(){function n(){}return n.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},n.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(i){var s=i>0?i:"";e["CONSUME"+s]=function(o,a){return this.consumeInternalRecord(o,i,a)},e["SUBRULE"+s]=function(o,a){return this.subruleInternalRecord(o,i,a)},e["OPTION"+s]=function(o){return this.optionInternalRecord(o,i)},e["OR"+s]=function(o){return this.orInternalRecord(o,i)},e["MANY"+s]=function(o){this.manyInternalRecord(i,o)},e["MANY_SEP"+s]=function(o){this.manySepFirstInternalRecord(i,o)},e["AT_LEAST_ONE"+s]=function(o){this.atLeastOneInternalRecord(i,o)},e["AT_LEAST_ONE_SEP"+s]=function(o){this.atLeastOneSepFirstInternalRecord(i,o)}},r=0;r<10;r++)t(r);e.consume=function(i,s,o){return this.consumeInternalRecord(s,i,o)},e.subrule=function(i,s,o){return this.subruleInternalRecord(s,i,o)},e.option=function(i,s){return this.optionInternalRecord(s,i)},e.or=function(i,s){return this.orInternalRecord(s,i)},e.many=function(i,s){this.manyInternalRecord(i,s)},e.atLeastOne=function(i,s){this.atLeastOneInternalRecord(i,s)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},n.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},n.prototype.ACTION_RECORD=function(e){},n.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},n.prototype.LA_RECORD=function(e){return eA},n.prototype.topLevelRuleRecord=function(e,t){try{var r=new wv({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}},n.prototype.optionInternalRecord=function(e,t){return _w.call(this,ai,e,t)},n.prototype.atLeastOneInternalRecord=function(e,t){_w.call(this,ta,t,e)},n.prototype.atLeastOneSepFirstInternalRecord=function(e,t){_w.call(this,na,t,e,JG)},n.prototype.manyInternalRecord=function(e,t){_w.call(this,ir,t,e)},n.prototype.manySepFirstInternalRecord=function(e,t){_w.call(this,mo,t,e,JG)},n.prototype.orInternalRecord=function(e,t){return Uze.call(this,e,t)},n.prototype.subruleInternalRecord=function(e,t,r){if(J0(t),!e||Ve(e,"ruleName")===!1){var i=new Error("<SUBRULE"+tY(t)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=G0(this.recordingProdStack),o=e.ruleName,a=new go({idx:t,nonTerminalName:o,referencedRule:void 0});return s.definition.push(a),this.outputCst?Vze:GN},n.prototype.consumeInternalRecord=function(e,t,r){if(J0(t),!Kq(e)){var i=new Error("<CONSUME"+tY(t)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=G0(this.recordingProdStack),o=new Fn({idx:t,terminalType:e});return s.definition.push(o),yQ},n}();function _w(n,e,t,r){r===void 0&&(r=!1),J0(t);var i=G0(this.recordingProdStack),s=ld(e)?e:e.DEF,o=new n({definition:[],idx:t});return Ve(e,"NAME")&&(o.name=e.NAME),r&&(o.separator=e.SEP),Ve(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(o),s.call(this),i.definition.push(o),this.recordingProdStack.pop(),GN}function Uze(n,e){var t=this;J0(e);var r=G0(this.recordingProdStack),i=Ba(n)===!1,s=i===!1?n:n.DEF,o=new po({definition:[],idx:e,ignoreAmbiguities:i&&n.IGNORE_AMBIGUITIES===!0});Ve(n,"NAME")&&(o.name=n.NAME),Ve(n,"MAX_LOOKAHEAD")&&(o.maxLookahead=n.MAX_LOOKAHEAD);var a=Hq(s,function(l){return ld(l.GATE)});return o.hasPredicates=a,r.definition.push(o),$e(s,function(l){var u=new _s({definition:[]});o.definition.push(u),Ve(l,"NAME")&&(u.name=l.NAME),Ve(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:Ve(l,"GATE")&&(u.ignoreAmbiguities=!0),t.recordingProdStack.push(u),l.ALT.call(t),t.recordingProdStack.pop()}),GN}function tY(n){return n===0?"":""+n}function J0(n){if(n<0||n>eY){var e=new Error("Invalid DSL Method idx value: <"+n+`>
	`+("Idx value must be a none negative value smaller than "+(eY+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var Bze=function(){function n(){}return n.prototype.initPerformanceTracer=function(e){if(Ve(e,"traceInitPerf")){var t=e.traceInitPerf,r=typeof t=="number";this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=Ss.traceInitPerf;this.traceInitIndent=-1},n.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var i=kq(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},n}(),SQ=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),eA=BV(tg,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(eA);var Ss=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:oQ,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),tA=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),qr;(function(n){n[n.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",n[n.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",n[n.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",n[n.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",n[n.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",n[n.LEFT_RECURSION=5]="LEFT_RECURSION",n[n.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",n[n.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",n[n.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",n[n.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",n[n.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",n[n.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",n[n.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",n[n.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",n[n.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(qr||(qr={}));function Wze(n){return n===void 0&&(n=void 0),function(){return n}}var qV=function(){function n(e,t){t===void 0&&(t=Ss),this.ignoredIssues=Ss.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;r.initErrorHandler(t),r.initLexerAdapter(),r.initLooksAhead(t),r.initRecognizerEngine(e,t),r.initRecoverable(t),r.initTreeBuilder(t),r.initContentAssist(),r.initGastRecorder(t),r.initPerformanceTracer(t),Ve(t,"ignoredIssues")&&t.ignoredIssues!==Ss.ignoredIssues&&$V(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=Ve(t,"ignoredIssues")?t.ignoredIssues:Ss.ignoredIssues,this.skipValidations=Ve(t,"skipValidations")?t.skipValidations:Ss.skipValidations}return n.performSelfAnalysis=function(e){e.performSelfAnalysis()},n.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var t;e.selfAnalysisDone=!0;var r=e.className;e.TRACE_INIT("toFastProps",function(){Fq(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),$e(e.definedRulesNames,function(s){var o=e[s],a=o.originalGrammarAction,l=void 0;e.TRACE_INIT(s+" Rule",function(){l=e.topLevelRuleRecord(s,a)}),e.gastProductionsCache[s]=l})}finally{e.disableRecording()}});var i=[];if(e.TRACE_INIT("Grammar Resolving",function(){i=yze({rules:Ni(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)}),e.TRACE_INIT("Grammar Validations",function(){if(tn(i)&&e.skipValidations===!1){var s=Sze({rules:Ni(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:Ni(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:KV,grammarName:r});e.definitionErrors.push.apply(e.definitionErrors,s)}}),tn(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var s=Ije(Ni(e.gastProductionsCache));e.resyncFollows=s}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(Ni(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var s=Dje(Ni(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=s.allRuleNames}),!n.DEFER_DEFINITION_ERRORS_HANDLING&&!tn(e.definitionErrors))throw t=Te(e.definitionErrors,function(s){return s.message}),new Error(`Parser Definition Errors detected:
 `+t.join(`
-------------------------------
`))})},n.DEFER_DEFINITION_ERRORS_HANDLING=!1,n}();_2e(qV,[Cze,Rze,xze,Lze,Dze,Hze,Fze,kze,$ze,Bze]);(function(n){SQ(e,n);function e(t,r){r===void 0&&(r=Ss);var i=this,s=IC(r);return s.outputCst=!0,i=n.call(this,t,s)||this,i}return e})(qV);var jze=function(n){SQ(e,n);function e(t,r){r===void 0&&(r=Ss);var i=this,s=IC(r);return s.outputCst=!1,i=n.call(this,t,s)||this,i}return e}(qV);/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const nY=(n,e)=>({type:n,message:e});var Wn;(function(n){n.LexingError="LexingError",n.ParserError="ParsingError",n.StaticOffsetError="StaticOffsetError",n.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",n.RangeOffsetNotAllowed="RangeOffsetNotAllowed",n.InvalidRangeSize="InvalidRangeSize"})(Wn||(Wn={}));var O;(function(n){n.EMPTY="EMPTY",n.NUMBER="NUMBER",n.STRING="STRING",n.MINUS_UNARY_OP="MINUS_UNARY_OP",n.PLUS_UNARY_OP="PLUS_UNARY_OP",n.PERCENT_OP="PERCENT_OP",n.CONCATENATE_OP="CONCATENATE_OP",n.EQUALS_OP="EQUALS_OP",n.NOT_EQUAL_OP="NOT_EQUAL_OP",n.GREATER_THAN_OP="GREATER_THAN_OP",n.LESS_THAN_OP="LESS_THAN_OP",n.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",n.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",n.PLUS_OP="PLUS_OP",n.MINUS_OP="MINUS_OP",n.TIMES_OP="TIMES_OP",n.DIV_OP="DIV_OP",n.POWER_OP="POWER_OP",n.FUNCTION_CALL="FUNCTION_CALL",n.NAMED_EXPRESSION="NAMED_EXPRESSION",n.PARENTHESIS="PARENTHESES",n.CELL_REFERENCE="CELL_REFERENCE",n.CELL_RANGE="CELL_RANGE",n.COLUMN_RANGE="COLUMN_RANGE",n.ROW_RANGE="ROW_RANGE",n.ERROR="ERROR",n.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",n.ARRAY="ARRAY"})(O||(O={}));var zo;(function(n){n[n.RELATIVE=0]="RELATIVE",n[n.START_ABSOLUTE=1]="START_ABSOLUTE",n[n.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(zo||(zo={}));const zze=n=>({type:O.EMPTY,leadingWhitespace:n==null?void 0:n.image}),Gze=(n,e)=>({type:O.NUMBER,value:n,leadingWhitespace:e==null?void 0:e.image}),Yze=n=>{var e;return{type:O.STRING,value:n.image.slice(1,-1),leadingWhitespace:(e=n.leadingWhitespace)===null||e===void 0?void 0:e.image}},rY=(n,e)=>({type:O.CELL_REFERENCE,reference:n,leadingWhitespace:e==null?void 0:e.image}),iY=(n,e,t,r)=>(QV(n,e,t),{type:O.CELL_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r}),Kze=(n,e,t,r)=>(QV(n,e,t),{type:O.COLUMN_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r==null?void 0:r.image}),Xze=(n,e,t,r)=>(QV(n,e,t),{type:O.ROW_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r==null?void 0:r.image}),qze=(n,e,t)=>({type:O.CONCATENATE_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),Qze=(n,e,t)=>({type:O.EQUALS_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),Zze=(n,e,t)=>({type:O.NOT_EQUAL_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),Jze=(n,e,t)=>({type:O.GREATER_THAN_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),eGe=(n,e,t)=>({type:O.LESS_THAN_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),tGe=(n,e,t)=>({type:O.GREATER_THAN_OR_EQUAL_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),nGe=(n,e,t)=>({type:O.LESS_THAN_OR_EQUAL_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),rGe=(n,e,t)=>({type:O.PLUS_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),iGe=(n,e,t)=>({type:O.MINUS_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),sGe=(n,e,t)=>({type:O.TIMES_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),oGe=(n,e,t)=>({type:O.DIV_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),aGe=(n,e,t)=>({type:O.POWER_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),lGe=(n,e)=>({type:O.MINUS_UNARY_OP,value:n,leadingWhitespace:e==null?void 0:e.image}),uGe=(n,e)=>({type:O.PLUS_UNARY_OP,value:n,leadingWhitespace:e==null?void 0:e.image}),cGe=(n,e)=>({type:O.PERCENT_OP,value:n,leadingWhitespace:e==null?void 0:e.image}),hGe=(n,e,t,r,i)=>({type:O.FUNCTION_CALL,procedureName:n,args:e,leadingWhitespace:t==null?void 0:t.image,internalWhitespace:r==null?void 0:r.image,hyperlink:i}),sY=(n,e,t)=>({type:O.ARRAY,args:n,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:t==null?void 0:t.image}),dGe=(n,e)=>({type:O.NAMED_EXPRESSION,expressionName:n,leadingWhitespace:e==null?void 0:e.image}),fGe=(n,e,t)=>({type:O.PARENTHESIS,expression:n,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:t==null?void 0:t.image}),Hl=(n,e)=>({type:O.ERROR,error:n,leadingWhitespace:e==null?void 0:e.image}),cm=(n,e,t)=>({type:O.ERROR_WITH_RAW_INPUT,error:e,rawInput:n,leadingWhitespace:t==null?void 0:t.image}),F1=()=>({type:O.ERROR,error:b.parsingError()});function QV(n,e,t){if(n.sheet!==void 0&&e.sheet===void 0||n.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(n.sheet===void 0&&t!==zo.RELATIVE||n.sheet!==void 0&&t===zo.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function bt(n,e){return(e??"")+n}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const CQ={[O.PLUS_OP]:"+",[O.MINUS_OP]:"-",[O.TIMES_OP]:"*",[O.DIV_OP]:"/",[O.CONCATENATE_OP]:"&",[O.POWER_OP]:"^",[O.EQUALS_OP]:"=",[O.NOT_EQUAL_OP]:"<>",[O.GREATER_THAN_OP]:">",[O.GREATER_THAN_OR_EQUAL_OP]:">=",[O.LESS_THAN_OP]:"<",[O.LESS_THAN_OR_EQUAL_OP]:"<="};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const gGe=(n,e,t,r)=>({ast:n,relativeDependencies:e,hasVolatileFunction:t,hasStructuralChangeFunction:r});class mGe{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const r=KN(t,this.functionRegistry),i=gGe(t,r,oh(t,this.functionRegistry.isFunctionVolatile),oh(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const r=this.cache.get(e);return r!==void 0?r.ast:(this.set(e,t),t)}}const oh=(n,e)=>{switch(n.type){case O.EMPTY:case O.NUMBER:case O.STRING:case O.ERROR:case O.ERROR_WITH_RAW_INPUT:case O.CELL_REFERENCE:case O.CELL_RANGE:case O.COLUMN_RANGE:case O.ROW_RANGE:case O.NAMED_EXPRESSION:return!1;case O.PERCENT_OP:case O.PLUS_UNARY_OP:case O.MINUS_UNARY_OP:return oh(n.value,e);case O.CONCATENATE_OP:case O.EQUALS_OP:case O.NOT_EQUAL_OP:case O.LESS_THAN_OP:case O.GREATER_THAN_OP:case O.LESS_THAN_OR_EQUAL_OP:case O.GREATER_THAN_OR_EQUAL_OP:case O.MINUS_OP:case O.PLUS_OP:case O.TIMES_OP:case O.DIV_OP:case O.POWER_OP:return oh(n.left,e)||oh(n.right,e);case O.PARENTHESIS:return oh(n.expression,e);case O.FUNCTION_CALL:return e(n.procedureName)?!0:n.args.some(t=>oh(t,e));case O.ARRAY:return n.args.some(t=>t.some(r=>oh(r,e)))}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class H{}H.DistinctSigns="Distinct signs.";H.WrongArgNumber="Wrong number of arguments.";H.EmptyArg="Empty function argument.";H.EmptyArray="Empty array not allowed.";H.ArrayDimensions="Array dimensions are not compatible.";H.NoSpaceForArrayResult="No space for array result.";H.ValueSmall="Value too small.";H.ValueLarge="Value too large.";H.BadCriterion="Incorrect criterion.";H.RangeManySheets="Range spans more than one sheet.";H.CellRangeExpected="Cell range expected.";H.WrongDimension="Wrong range dimension.";H.ScalarExpected="Cell range not allowed.";H.NumberCoercion="Value cannot be coerced to number.";H.NumberExpected="Number argument expected.";H.IntegerExpected="Value needs to be an integer.";H.BadMode="Mode not recognized.";H.DateBounds="Date outside of bounds.";H.OutOfSheet="Resulting reference is out of the sheet.";H.WrongType="Wrong type of argument.";H.NaN="NaN or infinite value encountered.";H.EqualLength="Ranges need to be of equal length.";H.Negative="Value cannot be negative.";H.NotBinary="String does not represent a binary number.";H.NotOctal="String does not represent an octal number.";H.NotHex="String does not represent a hexadecimal number.";H.EndStartPeriod="End period needs to be at least start period.";H.CellRefExpected="Cell reference expected.";H.EmptyRange="Empty range not allowed.";H.BadRef="Address is not correct.";H.NumberRange="Number-only range expected.";H.ValueNotFound="Value not found.";H.ValueBaseLarge="Value in base too large.";H.ValueBaseSmall="Value in base too small.";H.ValueBaseLong="Value in base too long.";H.NegativeLength="Length cannot be negative.";H.PatternNotFound="Pattern not found.";H.OneValue="Needs at least one value.";H.TwoValues="Range needs to contain at least two elements.";H.ThreeValues="Range needs to contain at least three elements.";H.IndexBounds="Index out of bounds.";H.IndexLarge="Index too large.";H.Formula="Expected formula.";H.NegativeCount="Count cannot be negative.";H.ParseError="Parsing error.";H.SheetRef="Sheet does not exist.";H.PeriodLong="Period number cannot exceed life length.";H.InvalidDate="Invalid date.";H.BitshiftLong="Result of bitshift is too long.";H.EmptyString="Empty-string argument not allowed.";H.LengthBounds="Length out of bounds.";H.NegativeTime="Time cannot be negative.";H.NoDefault="No default option.";H.NoConditionMet="None of the conditions were met.";H.Selector="Selector cannot exceed the number of arguments.";H.StartEndDate="Start date needs to be earlier than end date.";H.IncorrectDateTime="String does not represent correct DateTime.";H.CharacterCodeBounds="Character code out of bounds.";H.NonZero="Argument cannot be 0.";H.LessThanOne="Argument cannot be less than 1.";H.WeekendString="Incorrect weekend bitmask string.";H.InvalidRoman="Invalid roman numeral.";H.WrongOrder="Wrong order of values.";H.ComplexNumberExpected="Complex number expected.";H.ShouldBeIorJ="Should be 'i' or 'j'.";H.SizeMismatch="Array dimensions mismatched.";H.FunctionName=n=>`Function name ${n} not recognized.`;H.NamedExpressionName=n=>`Named expression ${n} not recognized.`;H.LicenseKey=n=>`License key is ${n}.`;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class pGe{constructor(){this.POSSIBLE_START_CHARACTERS=[..._q,...S2e,Gi,"'","_"],this.cellReferenceRegexp=new RegExp(y2e,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const r=this.cellReferenceRegexp.exec(e+"@");return r==null||r[1]==null?null:(r[0]=r[1],r)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class vGe{constructor(){this.POSSIBLE_START_CHARACTERS=[..._q,"_"],this.namedExpressionRegexp=new RegExp(Oq,"y"),this.r1c1CellRefRegexp=new RegExp(`^${Iq}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const r=this.namedExpressionRegexp.exec(e);return r==null||r[0]==null||this.r1c1CellRefRegexp.test(r[0])?null:r}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const LS=Rt({name:"AdditionOp",pattern:Ms.NA}),k1=Rt({name:"PlusOp",pattern:/\+/,categories:LS}),V1=Rt({name:"MinusOp",pattern:/-/,categories:LS}),YN=Rt({name:"MultiplicationOp",pattern:Ms.NA}),EQ=Rt({name:"TimesOp",pattern:/\*/,categories:YN}),RQ=Rt({name:"DivOp",pattern:/\//,categories:YN}),$1=Rt({name:"PowerOp",pattern:/\^/}),TQ=Rt({name:"PercentOp",pattern:/%/}),cd=Rt({name:"BooleanOp",pattern:Ms.NA}),U1=Rt({name:"EqualsOp",pattern:/=/,categories:cd}),bQ=Rt({name:"NotEqualOp",pattern:/<>/,categories:cd}),AQ=Rt({name:"GreaterThanOp",pattern:/>/,categories:cd}),NQ=Rt({name:"LessThanOp",pattern:/</,categories:cd}),MQ=Rt({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:cd}),IQ=Rt({name:"LessThanOrEqualOp",pattern:/<=/,categories:cd}),OQ=Rt({name:"ConcatenateOp",pattern:/&/}),B1=Rt({name:"LParen",pattern:/\(/}),ZT=Rt({name:"RParen",pattern:/\)/}),_Q=Rt({name:"ArrayLParen",pattern:/{/}),PQ=Rt({name:"ArrayRParen",pattern:/}/}),xQ=Rt({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),LQ=Rt({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),HS=Rt({name:"RangeSeparator",pattern:new RegExp(MC)}),ZV=Rt({name:"ColumnRange",pattern:new RegExp(`${NG}${MC}${NG}`)}),JV=Rt({name:"RowRange",pattern:new RegExp(`${MG}${MC}${MG}`)}),e$=Rt({name:"ProcedureName",pattern:new RegExp(`([${DN}][${DV}]*)\\(`)}),z_=new pGe,bh=Rt({name:"CellReference",pattern:z_.match.bind(z_),start_chars_hint:z_.POSSIBLE_START_CHARACTERS,line_breaks:!1}),G_=new vGe,HQ=Rt({name:"NamedExpression",pattern:G_.match.bind(G_),start_chars_hint:G_.POSSIBLE_START_CHARACTERS,line_breaks:!1}),t$=n=>{const e=n.translationPackage.getFunctionTranslation("OFFSET"),t=n.errorMapping,r=n.translationPackage.buildFunctionMapping(),i=new RegExp(n.ignoreWhiteSpace==="standard"?v2e:p2e),s=Rt({name:"WhiteSpace",pattern:i}),o=Rt({name:"ArrayRowSep",pattern:n.arrayRowSeparator}),a=Rt({name:"ArrayColSep",pattern:n.arrayColumnSeparator}),l=Rt({name:"NumberLiteral",pattern:new RegExp(`(([${n.decimalSeparator}]\\d+)|(\\d+([${n.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),u=Rt({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let c,h;n.functionArgSeparator===n.arrayColumnSeparator?(c=a,h=[]):n.functionArgSeparator===n.arrayRowSeparator?(c=o,h=[]):(c=Rt({name:"ArgSeparator",pattern:n.functionArgSeparator}),h=[c]);const d=[s,k1,V1,EQ,RQ,$1,U1,bQ,TQ,MQ,IQ,AQ,NQ,B1,ZT,_Q,PQ,u,e$,HS,...h,ZV,JV,l,xQ,LQ,OQ,cd,LS,YN,bh,HQ,o,a];return{ArgSeparator:c,NumberLiteral:l,OffsetProcedureName:u,ArrayRowSeparator:o,ArrayColSeparator:a,WhiteSpace:s,allTokens:d,errorMapping:t,functionMapping:r,decimalSeparator:n.decimalSeparator,maxColumns:n.maxColumns,maxRows:n.maxRows}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class tp extends jze{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:Wze(zze())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var r;const i=this.CONSUME(e$),s=i.image.toUpperCase().slice(0,-1),o=(r=this.lexerConfig.functionMapping[s])!==null&&r!==void 0?r:s,a=[];let l=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var c;const h=this.CONSUME(this.lexerConfig.ArgSeparator);l.type===O.EMPTY&&(l.leadingWhitespace=(c=h.leadingWhitespace)===null||c===void 0?void 0:c.image),a.push(l),l=this.SUBRULE2(this.booleanExpressionOrEmpty)}),a.push(l),a.length===1&&a[0].type===O.EMPTY&&(a.length=0);const u=this.CONSUME(ZT);return hGe(o,a,i.leadingWhitespace,u.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const r=this.CONSUME(HQ);return dGe(r.image,r.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const r=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(B1),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{r.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(ZT),this.handleOffsetHeuristic(r)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const r=this.CONSUME(ZV),[i,s]=r.image.split(":"),o=this.ACTION(()=>W0(this.sheetMapping,i,this.formulaAddress)),a=this.ACTION(()=>W0(this.sheetMapping,s,this.formulaAddress));if(o===void 0||a===void 0)return Hl(new b(M.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return cm(r.image,new b(M.NAME),r.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Wn.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=tp.fixSheetIdsForRangeEnds(o,a);return Kze(l,u,c,r.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const r=this.CONSUME(JV),[i,s]=r.image.split(":"),o=this.ACTION(()=>j0(this.sheetMapping,i,this.formulaAddress)),a=this.ACTION(()=>j0(this.sheetMapping,s,this.formulaAddress));if(o===void 0||a===void 0)return Hl(new b(M.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return cm(r.image,new b(M.NAME),r.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Wn.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=tp.fixSheetIdsForRangeEnds(o,a);return Xze(l,u,c,r.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const r=this.CONSUME(bh),i=this.ACTION(()=>Tm(this.sheetMapping,r.image,this.formulaAddress));return i===void 0?cm(r.image,new b(M.REF),r.leadingWhitespace):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?cm(r.image,new b(M.NAME),r.leadingWhitespace):rY(i,r.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",r=>{var i;const s=this.CONSUME(bh),o=this.ACTION(()=>Tm(this.sheetMapping,r.image,this.formulaAddress)),a=this.ACTION(()=>Tm(this.sheetMapping,s.image,this.formulaAddress));return o===void 0||a===void 0?this.ACTION(()=>cm(`${r.image}:${s.image}`,new b(M.REF),r.leadingWhitespace)):o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>cm(`${r.image}:${s.image}`,new b(M.NAME),r.leadingWhitespace)):this.buildCellRange(o,a,(i=r.leadingWhitespace)===null||i===void 0?void 0:i.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[r]})},{ALT:()=>{var i;const s=this.SUBRULE(this.offsetProcedureExpression),o=this.ACTION(()=>Tm(this.sheetMapping,r.image,this.formulaAddress));return o===void 0?Hl(new b(M.REF)):s.type===O.CELL_REFERENCE?this.buildCellRange(o,s.reference,(i=r.leadingWhitespace)===null||i===void 0?void 0:i.image):this.parsingError(Wn.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const r=this.CONSUME(bh);return this.CONSUME2(HS),this.SUBRULE(this.endOfRangeExpression,{ARGS:[r]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",r=>{const i=this.CONSUME(bh),s=this.ACTION(()=>Tm(this.sheetMapping,i.image,this.formulaAddress));return s===void 0?this.ACTION(()=>Hl(new b(M.REF))):this.buildCellRange(r.reference,s,r.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[r]})},{ALT:()=>{const i=this.SUBRULE(this.offsetProcedureExpression);return i.type===O.CELL_REFERENCE?this.buildCellRange(r.reference,i.reference,r.leadingWhitespace):this.parsingError(Wn.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const r=this.SUBRULE(this.offsetProcedureExpression);let i;return this.OPTION(()=>{this.CONSUME(HS),r.type===O.CELL_RANGE?i=this.parsingError(Wn.RangeOffsetNotAllowed,"Range offset not allowed here"):i=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[r]})}),i!==void 0?i:r}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const r=[[]];return r[r.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),r[r.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),r.push([]),r[r.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),sY(r)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const r=this.CONSUME(B1),i=this.SUBRULE(this.booleanExpression),s=this.CONSUME(ZT);return fGe(i,r.leadingWhitespace,s.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(_Q),i=this.SUBRULE(this.insideArrayExpression),s=this.CONSUME(PQ);return sY(i.args,r.leadingWhitespace,s.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=r=>{const i=r.replace(this.lexerConfig.decimalSeparator,".");return Number(i)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var r;return this.OR((r=this.atomicExpCache)!==null&&r!==void 0?r:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const i=this.CONSUME(this.lexerConfig.NumberLiteral);return Gze(this.numericStringToNumber(i.image),i.leadingWhitespace)}},{ALT:()=>{const i=this.CONSUME(xQ);return Yze(i)}},{ALT:()=>{const i=this.CONSUME(LQ),s=i.image.toUpperCase(),o=this.lexerConfig.errorMapping[s];return o?Hl(new b(o),i.leadingWhitespace):this.parsingError(Wn.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const r=this.SUBRULE(this.positiveAtomicExpression),i=this.OPTION(()=>this.CONSUME(TQ));return i?cGe(r,i.leadingWhitespace):r}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(LS),i=this.SUBRULE(this.atomicExpression);return Zt(r,k1)?uGe(i,r.leadingWhitespace):Zt(r,V1)?lGe(i,r.leadingWhitespace):(this.customParsingError=nY(Wn.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let r=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const i=this.CONSUME($1),s=this.SUBRULE2(this.atomicExpression);Zt(i,$1)?r=aGe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let r=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const i=this.CONSUME(YN),s=this.SUBRULE2(this.powerExpression);Zt(i,EQ)?r=sGe(r,s,i.leadingWhitespace):Zt(i,RQ)?r=oGe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.additionExpression=this.RULE("additionExpression",()=>{let r=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const i=this.CONSUME(LS),s=this.SUBRULE2(this.multiplicationExpression);Zt(i,k1)?r=rGe(r,s,i.leadingWhitespace):Zt(i,V1)?r=iGe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let r=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const i=this.CONSUME(OQ),s=this.SUBRULE2(this.additionExpression);r=qze(r,s,i.leadingWhitespace)}),r}),this.booleanExpression=this.RULE("booleanExpression",()=>{let r=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const i=this.CONSUME(cd),s=this.SUBRULE2(this.concatenateExpression);Zt(i,U1)?r=Qze(r,s,i.leadingWhitespace):Zt(i,bQ)?r=Zze(r,s,i.leadingWhitespace):Zt(i,AQ)?r=Jze(r,s,i.leadingWhitespace):Zt(i,NQ)?r=eGe(r,s,i.leadingWhitespace):Zt(i,MQ)?r=tGe(r,s,i.leadingWhitespace):Zt(i,IQ)?r=nGe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.formula=this.RULE("formula",()=>(this.CONSUME(U1),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=ve(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),i=[];return this.customParsingError&&i.push(this.customParsingError),i=i.concat(this.errors.map(s=>({type:Wn.ParserError,message:s.message}))),i.length>0&&(r=F1()),{ast:r,errors:i}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){if(e.sheet===void 0&&t.sheet!==void 0)return this.parsingError(Wn.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:s,sheetRefType:o}=tp.fixSheetIdsForRangeEnds(e,t);return iY(i,s,o,r)}static fixSheetIdsForRangeEnds(e,t){const r=tp.rangeSheetReferenceType(e.sheet,t.sheet),i=e.sheet!==void 0&&t.sheet===void 0?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:i,sheetRefType:r}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==O.CELL_REFERENCE)return this.parsingError(Wn.StaticOffsetError,"First argument to OFFSET is not a reference");const r=e[1];let i;if(r.type===O.NUMBER&&Number.isInteger(r.value))i=r.value;else if(r.type===O.PLUS_UNARY_OP&&r.value.type===O.NUMBER&&Number.isInteger(r.value.value))i=r.value.value;else if(r.type===O.MINUS_UNARY_OP&&r.value.type===O.NUMBER&&Number.isInteger(r.value.value))i=-r.value.value;else return this.parsingError(Wn.StaticOffsetError,"Second argument to OFFSET is not a static number");const s=e[2];let o;if(s.type===O.NUMBER&&Number.isInteger(s.value))o=s.value;else if(s.type===O.PLUS_UNARY_OP&&s.value.type===O.NUMBER&&Number.isInteger(s.value.value))o=s.value.value;else if(s.type===O.MINUS_UNARY_OP&&s.value.type===O.NUMBER&&Number.isInteger(s.value.value))o=-s.value.value;else return this.parsingError(Wn.StaticOffsetError,"Third argument to OFFSET is not a static number");const a=e[3];let l;if(a===void 0)l=1;else if(a.type===O.NUMBER){if(l=a.value,l<1)return this.parsingError(Wn.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(Wn.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(Wn.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const u=e[4];let c;if(u===void 0)c=1;else if(u.type===O.NUMBER){if(c=u.value,c<1)return this.parsingError(Wn.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(c))return this.parsingError(Wn.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(Wn.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const h=new en(t.reference.col+o,t.reference.row+i,t.reference.type);let d=h.col,f=h.row;if((t.reference.type===Yt.CELL_REFERENCE_RELATIVE||t.reference.type===Yt.CELL_REFERENCE_ABSOLUTE_COL)&&(f=f+this.formulaAddress.row),(t.reference.type===Yt.CELL_REFERENCE_RELATIVE||t.reference.type===Yt.CELL_REFERENCE_ABSOLUTE_ROW)&&(d=d+this.formulaAddress.col),d<0||f<0)return Hl(new b(M.REF,H.OutOfSheet));if(c===1&&l===1)return rY(h);{const m=new en(h.col+c-1,h.row+l-1,h.type);return iY(h,m,zo.RELATIVE)}}parsingError(e,t){return this.customParsingError=nY(e,t),F1()}static rangeSheetReferenceType(e,t){return e===void 0?zo.RELATIVE:t===void 0?zo.START_ABSOLUTE:zo.BOTH_ABSOLUTE}}class nA{constructor(e){this.lexerConfig=e,this.lexer=new Ms(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}skipWhitespacesInsideRanges(e){return nA.filterTokensByNeighbors(e,(t,r,i)=>(Zt(t,bh)||Zt(t,HS))&&Zt(r,this.lexerConfig.WhiteSpace)&&(Zt(i,bh)||Zt(i,HS)))}skipWhitespacesBeforeArgSeparators(e){return nA.filterTokensByNeighbors(e,(t,r,i)=>!Zt(t,this.lexerConfig.ArgSeparator)&&Zt(r,this.lexerConfig.WhiteSpace)&&Zt(i,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0;const i=[e[r++]];for(;r<e.length-1;)t(e[r-1],e[r],e[r+1])||i.push(e[r]),++r;return i.push(e[r]),i}trimTrailingWhitespaces(e){return e.length>0&&Zt(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class DQ{constructor(e,t,r,i){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=i}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var r,i;switch(e.type){case O.EMPTY:return bt("",e.leadingWhitespace);case O.NUMBER:return bt(FQ(e.value,this.config.decimalSeparator),e.leadingWhitespace);case O.STRING:return bt('"'+e.value+'"',e.leadingWhitespace);case O.FUNCTION_CALL:{const s=e.args.map(l=>l!==void 0?this.unparseAst(l,t):"").join(this.config.functionArgSeparator),a=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+s+bt(")",e.internalWhitespace);return bt(a,e.leadingWhitespace)}case O.NAMED_EXPRESSION:{const s=(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))===null||r===void 0?void 0:r.displayName;return bt(s||e.expressionName,e.leadingWhitespace)}case O.CELL_REFERENCE:{let s;return e.reference.sheet!==void 0?s=this.unparseSheetName(e.reference.sheet)+"!":s="",s+=(i=e.reference.unparse(t))!==null&&i!==void 0?i:this.config.translationPackage.getErrorTranslation(M.REF),bt(s,e.leadingWhitespace)}case O.COLUMN_RANGE:case O.ROW_RANGE:case O.CELL_RANGE:return bt(this.formatRange(e,t),e.leadingWhitespace);case O.PLUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return bt("+",e.leadingWhitespace)+s}case O.MINUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return bt("-",e.leadingWhitespace)+s}case O.PERCENT_OP:return this.unparseAst(e.value,t)+bt("%",e.leadingWhitespace);case O.ERROR:{const s=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:M.ERROR);return bt(s,e.leadingWhitespace)}case O.ERROR_WITH_RAW_INPUT:return bt(e.rawInput,e.leadingWhitespace);case O.PARENTHESIS:{const o="("+this.unparseAst(e.expression,t)+bt(")",e.internalWhitespace);return bt(o,e.leadingWhitespace)}case O.ARRAY:{const s="{"+e.args.map(o=>o.map(a=>this.unparseAst(a,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+bt("}",e.internalWhitespace);return bt(s,e.leadingWhitespace)}default:{const s=this.unparseAst(e.left,t),o=this.unparseAst(e.right,t);return s+bt(CQ[e.type],e.leadingWhitespace)+o}}}unparseSheetName(e){const t=xq(e,this.sheetMappingFn);if(t===void 0)throw new In(e);return t}formatRange(e,t){let r="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==zo.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===zo.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");const s=e.start.unparse(t),o=e.end.unparse(t);return s===void 0||o===void 0?this.config.translationPackage.getErrorTranslation(M.REF):`${r}${s}:${i}${o}`}}function FQ(n,e){return n.toString().replace(".",e)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ky{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=t$(e),this.lexer=new nA(this.lexerConfig),this.formulaParser=new tp(this.lexerConfig,this.sheetMapping),this.cache=new mGe(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const r=this.tokenizeFormula(e);if(r.errors.length>0){const h=r.errors.map(d=>({type:Wn.LexingError,message:d.message}));return{ast:F1(),errors:h,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const i=this.computeHashFromTokens(r.tokens,t);let s=this.cache.get(i);if(s!==void 0)++this.statsCacheUsed;else{const h=this.bindWhitespacesToTokens(r.tokens),d=this.formulaParser.parseFromTokens(h,t);if(d.errors.length>0)return Object.assign(Object.assign({},d),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});s=this.cache.set(i,d.ast)}const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l}=s,u=this.convertReversedRangesToRegularRanges(o),c=KN(u,this.functionRegistry);return{ast:u,errors:[],hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:c}}convertReversedRangesToRegularRanges(e){switch(e.type){case O.EMPTY:case O.NUMBER:case O.STRING:case O.ERROR:case O.ERROR_WITH_RAW_INPUT:case O.CELL_REFERENCE:case O.NAMED_EXPRESSION:return e;case O.CELL_RANGE:{const{start:t,end:r}=e,i=this.orderCellRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case O.COLUMN_RANGE:{const{start:t,end:r}=e,i=this.orderColumnRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case O.ROW_RANGE:{const{start:t,end:r}=e,i=this.orderRowRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case O.PERCENT_OP:case O.PLUS_UNARY_OP:case O.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case O.CONCATENATE_OP:case O.EQUALS_OP:case O.NOT_EQUAL_OP:case O.LESS_THAN_OP:case O.GREATER_THAN_OP:case O.LESS_THAN_OR_EQUAL_OP:case O.GREATER_THAN_OR_EQUAL_OP:case O.MINUS_OP:case O.PLUS_OP:case O.TIMES_OP:case O.DIV_OP:case O.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),r=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:r})}case O.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case O.FUNCTION_CALL:{const t=e.args.map(r=>this.convertReversedRangesToRegularRanges(r));return Object.assign(Object.assign({},e),{args:t})}case O.ARRAY:{const t=e.args.map(r=>r.map(i=>this.convertReversedRangesToRegularRanges(i)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const r=[e,t],[i,s]=r.map(c=>c.toColumnAddress()).sort(zi.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(c=>c.toRowAddress()).sort(Ri.compareByAbsoluteAddress(this.formulaAddress)),[l,u]=r.map(c=>c.sheet).sort(ky.compareSheetIds.bind(this));return{start:en.fromColAndRow(i,o,l),end:en.fromColAndRow(s,a,u)}}orderColumnRangeEnds(e,t){const r=[e,t],[i,s]=r.sort(zi.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(l=>l.sheet).sort(ky.compareSheetIds.bind(this));return{start:new zi(i.type,i.col,o),end:new zi(s.type,s.col,a)}}orderRowRangeEnds(e,t){const r=[e,t],[i,s]=r.sort(Ri.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(l=>l.sheet).sort(ky.compareSheetIds.bind(this));return{start:new Ri(i.type,i.row,o),end:new Ri(s.type,s.row,a)}}static compareSheetIds(e,t){return e=e??1/0,t=t??1/0,e-t}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(t===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,relativeDependencies:o}=t;return{ast:r,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}}}computeHashFromTokens(e,t){var r;let i="",s=0;for(;s<e.length;){const o=e[s];if(Zt(o,bh)){const a=Tm(this.sheetMapping,o.image,t);a===void 0?i=i.concat(o.image):i=i.concat(a.hash(!0))}else if(Zt(o,e$)){const a=o.image.toUpperCase().slice(0,-1),l=(r=this.lexerConfig.functionMapping[a])!==null&&r!==void 0?r:a;i=i.concat(l,"(")}else if(Zt(o,ZV)){const[a,l]=o.image.split(":"),u=W0(this.sheetMapping,a,t),c=W0(this.sheetMapping,l,t);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else if(Zt(o,JV)){const[a,l]=o.image.split(":"),u=j0(this.sheetMapping,a,t),c=j0(this.sheetMapping,l,t);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else i=i.concat(o.image);s++}return i}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case O.EMPTY:return e.leadingWhitespace||"";case O.NUMBER:return bt(FQ(e.value,this.config.decimalSeparator),e.leadingWhitespace);case O.STRING:return bt('"'+e.value+'"',e.leadingWhitespace);case O.NAMED_EXPRESSION:return bt(e.expressionName,e.leadingWhitespace);case O.FUNCTION_CALL:{const t=e.args.map(i=>this.computeHashOfAstNode(i)).join(this.config.functionArgSeparator),r=e.procedureName+"("+t+bt(")",e.internalWhitespace);return bt(r,e.leadingWhitespace)}case O.CELL_REFERENCE:return bt(e.reference.hash(!0),e.leadingWhitespace);case O.COLUMN_RANGE:case O.ROW_RANGE:case O.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==zo.RELATIVE),r=e.end.hash(e.sheetReferenceType===zo.BOTH_ABSOLUTE);return bt(t+":"+r,e.leadingWhitespace)}case O.MINUS_UNARY_OP:return bt("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case O.PLUS_UNARY_OP:return bt("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case O.PERCENT_OP:return this.computeHashOfAstNode(e.value)+bt("%",e.leadingWhitespace);case O.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:M.ERROR);return bt(t,e.leadingWhitespace)}case O.ERROR_WITH_RAW_INPUT:return bt(e.rawInput,e.leadingWhitespace);case O.ARRAY:{const t=e.args.map(r=>r.map(i=>this.computeHashOfAstNode(i)).join(",")).join(";");return bt("{"+t+bt("}",e.internalWhitespace),e.leadingWhitespace)}case O.PARENTHESIS:{const r="("+this.computeHashOfAstNode(e.expression)+bt(")",e.internalWhitespace);return bt(r,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+bt(CQ[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],r=e[0];Zt(r,this.lexerConfig.WhiteSpace)||t.push(r);for(let i=1;i<e.length;++i){const s=e[i];if(Zt(s,this.lexerConfig.WhiteSpace))continue;const o=e[i-1];Zt(o,this.lexerConfig.WhiteSpace)&&(s.leadingWhitespace=o),t.push(s)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const bm=(n,e,t,r)=>{switch(n.type){case O.EMPTY:case O.NUMBER:case O.STRING:case O.ERROR:return;case O.NAMED_EXPRESSION:{r&&t.push(new ec(n.expressionName));return}case O.CELL_REFERENCE:{r&&t.push(new kQ(n.reference));return}case O.CELL_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new wGe(n.start,n.end));return}case O.COLUMN_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new yGe(n.start,n.end));return}case O.ROW_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new SGe(n.start,n.end));return}case O.PERCENT_OP:case O.PLUS_UNARY_OP:case O.MINUS_UNARY_OP:{bm(n.value,e,t,!0);return}case O.CONCATENATE_OP:case O.EQUALS_OP:case O.NOT_EQUAL_OP:case O.LESS_THAN_OP:case O.GREATER_THAN_OP:case O.LESS_THAN_OR_EQUAL_OP:case O.GREATER_THAN_OR_EQUAL_OP:case O.MINUS_OP:case O.PLUS_OP:case O.TIMES_OP:case O.DIV_OP:case O.POWER_OP:bm(n.left,e,t,!0),bm(n.right,e,t,!0);return;case O.PARENTHESIS:bm(n.expression,e,t,r);return;case O.FUNCTION_CALL:{const i=!e.doesFunctionNeedArgumentToBeComputed(n.procedureName);n.args.forEach(s=>bm(s,e,t,i));return}}},KN=(n,e)=>{const t=new Array;return bm(n,e,t,!0),t};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class kQ{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class wGe{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new xe(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class yGe{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new ic(t.sheet,t.col,r.col)}}class SGe{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new sc(t.sheet,t.row,r.row)}}class ec{constructor(e){this.name=e}absolutize(e){return this}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Dl=(n,e)=>n.map(t=>t.absolutize(e)),CGe=n=>n.filter(e=>e instanceof ec?!0:e instanceof xe?!(Cs(e.start)||Cs(e.end)):!Cs(e));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const ut=Symbol("Empty value");function ge(n){return n instanceof du?n.val:n}class du{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function n$(n,e){if(typeof n=="number")return e;{const t=n.fromNumber(e);return t.format=n.format,t}}class r$ extends du{getDetailedType(){return Ae.NUMBER_DATE}}class W1 extends du{getDetailedType(){return Ae.NUMBER_CURRENCY}}class i$ extends du{getDetailedType(){return Ae.NUMBER_TIME}}class s$ extends du{getDetailedType(){return Ae.NUMBER_DATETIME}}class JT extends du{getDetailedType(){return Ae.NUMBER_PERCENT}}function It(n){return typeof n=="number"||n instanceof du}var Ae;(function(n){n.NUMBER_RAW="NUMBER_RAW",n.NUMBER_DATE="NUMBER_DATE",n.NUMBER_TIME="NUMBER_TIME",n.NUMBER_DATETIME="NUMBER_DATETIME",n.NUMBER_CURRENCY="NUMBER_CURRENCY",n.NUMBER_PERCENT="NUMBER_PERCENT"})(Ae||(Ae={}));function EGe(n){return n instanceof du?n.getDetailedType():Ae.NUMBER_RAW}function RGe(n){if(n instanceof du)return n.format}function rA(n){return n instanceof du?{type:n.getDetailedType(),format:n.format}:{type:Ae.NUMBER_RAW}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ne{constructor(e,t,r,i){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=i,this.size=e===void 0?new gt(t.effectiveWidth(r),t.effectiveHeight(r)):new gt(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new Ne(e,t,r,!0)}static onlyNumbers(e){return new Ne(e,void 0,void 0,!0)}static onlyValues(e){return new Ne(e,void 0,void 0,void 0)}static onlyRange(e,t){return new Ne(void 0,e,t,void 0)}static fromScalar(e){return new Ne([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let r=0;r<this._data[0].length;r++)e.push(this._data[t][r]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const r=this.data[t];for(let i=0;i<r.length;++i)yield ve(e.sheet,e.col+i,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let r=0;r<this.size.width;++r)yield[this._data[t][r],ve(e.sheet,e.col+r,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if(typeof t!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof Ne?(this._hasOnlyNumbers=!1,new b(M.VALUE,H.ScalarExpected)):(It(t)||(this._hasOnlyNumbers=!1),t)}))}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Bh{constructor(){this.changes=new Map}static empty(){return new Bh}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(e){let t=[];return this.changes.forEach(r=>{const i=e.exportChange(r);Array.isArray(i)?t=t.concat(i):t.push(i)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,t){const r=t.value;if(r instanceof Ne)for(const i of r.effectiveAddressesFromData(e))this.changes.delete(Vy(i));this.changes.set(Vy(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ts{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new Ts(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new Ts(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),r=Math.min(this.rowEnd,e.rowEnd);return t>r?null:new Ts(this.sheet,t,r)}firstRow(){return new Ts(this.sheet,this.rowStart,this.rowStart)}}class lo{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new lo(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new lo(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),r=Math.min(this.columnEnd,e.columnEnd);return t>r?null:new lo(this.sheet,t,r)}firstColumn(){return new lo(this.sheet,this.columnStart,this.columnStart)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Ge;(function(n){n.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",n.PARSER="PARSER",n.GRAPH_BUILD="GRAPH_BUILD",n.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",n.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",n.TOP_SORT="TOP_SORT",n.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",n.EVALUATION="EVALUATION",n.VLOOKUP="VLOOKUP",n.TRANSFORM_ASTS="TRANSFORM_ASTS",n.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",n.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",n.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",n.ADJUSTING_RANGES="ADJUSTING_RANGES",n.ADJUSTING_GRAPH="ADJUSTING_GRAPH",n.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",n.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(Ge||(Ge={}));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class VQ{constructor(){this.stats=new Map([[Ge.CRITERION_FUNCTION_FULL_CACHE_USED,0],[Ge.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=((e=this.stats.get(Ge.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(Ge.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=((e=this.stats.get(Ge.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(Ge.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(Ge.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(Ge.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const r=Date.now(),i=this.startTimes.get(e);if(i){let s=(t=this.stats.get(e))!==null&&t!==void 0?t:0;s+=r-i,this.stats.set(e,s),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,t){this.start(e);const r=t();return this.end(e),r}snapshot(){return new Map(this.stats)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class TGe extends VQ{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class In extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class $Q extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class DS extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class kf extends Error{constructor(){super("Sheet size limit exceeded")}}class eb extends Error{constructor(){super("This is not a formula")}}class UQ extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class gr extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class FS extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class BQ extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class WQ extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class kS extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class jQ extends Error{constructor(){super("There is no operation to undo")}}class zQ extends Error{constructor(){super("There is no operation to redo")}}class GQ extends Error{constructor(){super("There is nothing to paste")}}function bGe(n,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class YQ extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,bGe,4)}`)}}class Mt extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class AGe extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class KQ extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class XQ extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class qQ extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class QQ extends Error{constructor(){super("Computations are suspended")}}class Am extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class ZQ extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class j1 extends Error{constructor(){super("Language not registered.")}}class JQ extends Error{constructor(){super("Language already registered.")}}class Gp extends Error{static functionNotDeclaredInPlugin(e,t){return new Gp(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new Gp(`Function method ${e} not found in plugin ${t}`)}}class Vf extends Error{static cannotRegisterFunctionWithId(e){return new Vf(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new Vf(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new Vf("Cannot unregister protected plugin")}}class np extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class iA extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class o$ extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class NGe extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class MGe{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new In(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new In(e.sheet);const r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}strategyFor(e){const t=this.mapping.get(e);if(t===void 0)throw new In(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:r,width:i,fill:s}=t,o=this.policy.call(s);this.addSheet(e,new o(i,r))}getCellValue(e){const t=this.getCell(e);return t===void 0?ut:t instanceof nr?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof Wh?t.getValues().rawValue:t instanceof nr?t.getArrayCellRawValue(e):null}setCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw new Error("Cannot move cell. Destination already occupied.");const i=r.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,i),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return t===void 0?!1:t.has(e)}getHeight(e){const t=this.mapping.get(e);if(t===void 0)throw new In(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new In(e);return t.getWidth()}addRows(e,t,r){const i=this.mapping.get(e);if(i===void 0)throw new In(e);i.addRows(t,r)}removeRows(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new In(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){const i=this.mapping.get(e);if(i===void 0)throw new In(e);i.addColumns(t,r)}removeColumns(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new In(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(t!==void 0)yield*t.getEntries(e);else throw new In(e)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class IGe{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(t!=null&&t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(Vy(e))}setArray(e,t){this.arrayMapping.set(Vy(e.start),t)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(Vy(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,r){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.row?[o.shifted(0,r),s]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,r){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.col?[o.shifted(r,0),s]:void 0})}updateArrayVerticesInSheet(e,t){const r=Array();for(const[i,s]of this.arrayMapping.entries()){if(s.sheet!==e)continue;const o=t(i,s);o!==void 0&&(this.removeArray(i),r.push(o))}r.forEach(([i,s])=>{this.setArray(i,s)})}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class qw{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class Yp{constructor(e){if(this.size=new gt(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof Ne?new Yp(e.data):new Yp([[e]])}simpleRangeValue(){return Ne.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let r=0;r<this.height();r++)this.array[r].splice(e,0,...new Array(t).fill(ut));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const r=t-e+1;this.array.splice(e,r),this.size.height-=r}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const r=t-e+1;for(const i of this.array)i.splice(e,r);this.size.width-=r}nullArrays(e,t){const r=[];for(let i=0;i<e;++i)r.push(new Array(t).fill(ut));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class Y_{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class uo{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,i){return r.isScalar()?new Wl(e,t,i):new nr(e,t,r,i)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,r,i]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=r,this.version=i}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class nr extends uo{constructor(e,t,r,i=0){super(e,t,i),r.isRef?this.array=new Y_(new b(M.REF,H.NoSpaceForArrayResult),gt.error()):this.array=new qw(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof b)return this.setErrorValue(e),e;const t=Yp.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof qw)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof qw))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;try{return this.array.get(t,r)}catch{return new b(M.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);if(!(t instanceof b||t===ut))return ge(t)}setArrayCellValue(e,t){const r=e.col-this.cellAddress.col,i=e.row-this.cellAddress.row;this.array instanceof Yp&&this.array.set(r,i,t)}setNoSpace(){return this.array=new Y_(new b(M.SPILL,H.NoSpaceForArrayResult),gt.error()),this.getCellValue()}getRange(){return xe.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return xe.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof qw)}columnsFromArray(){return lo.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return Ts.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return $S(this.cellAddress,e)}setErrorValue(e){this.array=new Y_(e,this.array.size)}}class Wl extends uo{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ei{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var r;return(r=this.getCriterionFunctionValues(e).get(t))===null||r===void 0?void 0:r[0]}getCriterionFunctionValues(e){var t;return(t=this.criterionFunctionCache.get(e))!==null&&t!==void 0?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const OGe=(n,e,t,r,i)=>{if(e instanceof Ei){const a=e.range.intersectionWith(t);return a!==void 0?Array.from(a.addresses(i)):[]}let s,o;if(e instanceof uo)s=e.getFormula(r),o=e.getAddress(r);else return[];return KN(s,n).filter(a=>a instanceof kQ).map(a=>a.dependency.toSimpleCellAddress(o)).filter(a=>t.addressInRange(a))};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Uu;(function(n){n[n.ON_STACK=0]="ON_STACK",n[n.PROCESSED=1]="PROCESSED",n[n.POPPED=2]="POPPED"})(Uu||(Uu={}));class _Ge{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,r){const i=e.reverse();return i.forEach(s=>this.runDFS(s)),this.postprocess(i,r,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(t=>t!==void 0&&this.nodesSparseArray[t])}runDFS(e){if(this.nodeStatus[e]!==void 0)return;this.nodeStatus[e]=Uu.ON_STACK;const t=[e],r=[];for(;t.length>0;){const i=t[t.length-1];switch(this.nodeStatus[i]){case Uu.ON_STACK:{this.handleOnStack(i,r,t);break}case Uu.PROCESSED:{this.handleProcessed(i,r,t);break}case Uu.POPPED:{t.pop();break}}}}handleOnStack(e,t,r){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(i=>{this.entranceTime[i]===void 0&&(r.push(i),this.parent[i]=e,this.nodeStatus[i]=Uu.ON_STACK)}),this.nodeStatus[e]=Uu.PROCESSED}handleProcessed(e,t,r){let i=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(s=>{this.inSCC[s]||(i=this.parent[s]===e?Math.min(i,this.low[s]):Math.min(i,this.entranceTime[s]))}),this.low[e]=i,i===this.entranceTime[e]){const s=[];do s.push(t[t.length-1]),t.pop();while(s[s.length-1]!==e);s.forEach(o=>{this.inSCC[o]=!0}),this.order.push(...s),s.length>1&&s.forEach(o=>{this.sccNonSingletons[o]=!0})}r.pop(),this.nodeStatus[e]=Uu.POPPED}postprocess(e,t,r){const i=[];e.forEach(a=>{i[a]=!0});const s=[],o=[];return this.order.reverse(),this.order.forEach(a=>{const l=this.getAdjacentNodeIds(a);this.sccNonSingletons[a]||l.includes(a)?(o.push(this.nodesSparseArray[a]),t(this.nodesSparseArray[a]),l.forEach(u=>i[u]=!0)):(s.push(this.nodesSparseArray[a]),i[a]&&r(this.nodesSparseArray[a])&&l.forEach(u=>i[u]=!0))}),{sorted:s,cycled:o}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class PGe{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return this.processedValue===null&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class xGe{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new PGe({dirty:[],volatile:[]},t=>this.processDirtyAndVolatileNodeIds(t)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>e!==void 0)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const r=this.getNodeId(e),i=this.getNodeId(t);return r===void 0||i===void 0?!1:this.edgesSparseArray[r].includes(i)}adjacentNodes(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(r=>r!==void 0).map(r=>this.nodesSparseArray[r]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(t!==void 0)return t;const r=this.nextId;return this.nextId++,this.nodesSparseArray[r]=e,this.edgesSparseArray[r]=[],this.nodesIds.set(e,r),r}addEdge(e,t){const r=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);this.edgesSparseArray[r].includes(i)||this.edgesSparseArray[r].push(i)}removeNode(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(i=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(i)),this.dirtyAndVolatileNodeIds.markAsModified());const r=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),r}removeEdge(e,t){const r=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);const s=this.edgesSparseArray[r].indexOf(i);if(s===-1)throw new Error("Edge does not exist");delete this.edgesSparseArray[r][s]}removeEdgeIfExists(e,t){const r=this.getNodeId(e),i=this.getNodeId(t);if(r===void 0||i===void 0)return;const s=this.edgesSparseArray[r].indexOf(i);s!==-1&&delete this.edgesSparseArray[r][s]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,r){const i=new _Ge(this.nodesSparseArray,this.edgesSparseArray),s=e.map(o=>this.getNodeId(o)).filter(o=>o!==void 0);return i.getTopSortedWithSccSubgraphFrom(s,t,r)}markNodeAsVolatile(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);t!==void 0&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);t!==void 0&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return typeof e=="number"?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(r=>r!==void 0&&this.nodesSparseArray[r]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([r,i])=>{this.removeEdgeIfExists(i,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(r=>this.nodesSparseArray[r]).filter(r=>r!==void 0)}missingNodeError(e){return new Error(`Unknown node ${e}`)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class LGe{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,r;return(r=(t=this.rangeMapping.get(e))===null||t===void 0?void 0:t.size)!==null&&r!==void 0?r:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);t===void 0&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const r=tb(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){const t=e.getStart().sheet,r=this.rangeMapping.get(t);if(r===void 0)return;const i=tb(e.getStart(),e.getEnd());r.delete(i),r.size===0&&this.rangeMapping.delete(t)}getRange(e,t){const r=this.rangeMapping.get(e.sheet),i=tb(e,t);return r==null?void 0:r.get(i)}fetchRange(e,t){const r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}truncateRanges(e,t){const r=Array(),i=Array(),s=Array(),o=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const c=u.range;e.start<=t(u.range.end)&&(c.removeSpan(e),c.shouldBeRemoved()?(this.removeByKey(o,l),r.push(u)):i.push([l,u]),s.push(u))}const a=[];i.sort((l,u)=>DGe(l[1],u[1],t));for(const[l,u]of i){const c=HGe(u.range);if(c===l)continue;const h=this.getByKey(o,c);this.removeByKey(o,l),h!==void 0&&u!=h?a.push([h,u]):this.setRange(u)}return{verticesToRemove:r,verticesToMerge:a,verticesWithChangedSize:s}}moveAllRangesInSheetAfterRowByRows(e,t,r){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.row?(s.range.shiftByRows(r),{changedSize:!1,vertex:s}):t>s.start.row&&t<=s.end.row?(s.range.expandByRows(r),{changedSize:!0,vertex:s}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,r){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.col?(s.range.shiftByColumns(r),{changedSize:!1,vertex:s}):t>s.start.col&&t<=s.end.col?(s.range.expandByColumns(r),{changedSize:!0,vertex:s}):void 0)}moveRangesInsideSourceRange(e,t,r,i){this.updateVerticesFromSheet(e.sheet,(s,o)=>{if(e.containsRange(o.range))return o.range.shiftByColumns(t),o.range.shiftByRows(r),o.range.moveToSheet(i),{changedSize:!1,vertex:o}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=ve(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(r!==void 0){const i=xe.fromSimpleCellAddresses(ve(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:r,restRange:i}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var r;return(r=this.rangeMapping.get(e))===null||r===void 0?void 0:r.get(t)}updateVerticesFromSheet(e,t){const r=Array();for(const[i,s]of this.entriesFromSheet(e)){const o=t(i,s);o!==void 0&&(this.removeByKey(e,i),r.push(o))}return r.forEach(i=>{this.setRange(i.vertex)}),{verticesWithChangedSize:r.filter(i=>i.changedSize).map(i=>i.vertex)}}}function tb(n,e){return`${n.col},${n.row},${e.col},${e.row}`}function HGe(n){return tb(n.start,n.end)}const DGe=(n,e,t)=>{const r=t(n.range.start),i=t(n.range.start);if(r===i){const s=t(n.range.end),o=t(e.range.end);return s-o}else return r-i};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class FGe{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const t=[];for(const r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){const t=this.functions[e];if(t===void 0)throw new Am(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===M.LIC)return`#${M.LIC}!`;const t=this.errors[e];if(t===void 0)throw new Am(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(t===void 0)throw new Am(`ui.${e}`);return t}checkUI(){for(const e of Object.values(VS))if(!(e in this.ui))throw new Am(`ui.${e}`)}checkErrors(){for(const e of Object.values(M))if(!(e in this.errors)&&e!==M.LIC)throw new Am(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const r of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(r))throw new ZQ(r)}}function kGe(n){return new FGe(Object.assign({},n.functions),Object.assign({},n.errors),Object.assign({},n.ui))}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var VS;(function(n){n.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(VS||(VS={}));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function Nm(n){return n.toLowerCase()}class VGe{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return Nm(this.displayName)}}class $Ge{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=t=>{const r=this.mappingFromCanonicalName.get(Nm(t));if(r===void 0)throw new $Q(t);return r.id},this.get=t=>{var r;return(r=this.mappingFromCanonicalName.get(Nm(t)))===null||r===void 0?void 0:r.id},this.fetchDisplayName=t=>this.fetchSheetById(t).displayName,this.sheetNamePrefix=e.getUITranslation(VS.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=Nm(e);if(this.mappingFromCanonicalName.has(t))throw new DS(e);this.lastSheetId++;const r=new VGe(this.lastSheetId,e);return this.store(r),r.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return(t=this.mappingFromId.get(e))===null||t===void 0?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(Nm(e))}renameSheet(e,t){const r=this.fetchSheetById(e),i=r.displayName;if(i===t)return;const s=this.mappingFromCanonicalName.get(Nm(t));if(s!==void 0&&s.id!==r.id)throw new DS(t);const o=r.canonicalName;return this.mappingFromCanonicalName.delete(o),r.displayName=t,this.store(r),i}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(t===void 0)throw new In(e);return t}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class a${constructor(e,t,r,i,s,o,a,l){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=i,this.stats=s,this.lazilyTransformingAstService=o,this.functionRegistry=a,this.namedExpressions=l,this.changes=Bh.empty(),this.dependencyQueryAddresses=u=>{if(u instanceof Ei)return this.rangeDependencyQuery(u).map(([c,h])=>c);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[h,d]=c;return d.map(f=>f instanceof ec?this.namedExpressions.namedExpressionOrPlaceholder(f.name,h.sheet).address:Bn(f)?f:G1(f.start,f.end))}else return[]}},this.dependencyQueryVertices=u=>{if(u instanceof Ei)return this.rangeDependencyQuery(u);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[h,d]=c;return d.map(f=>{if(f instanceof xe)return[f.start,this.rangeMapping.fetchRange(f.start,f.end)];if(f instanceof ec){const m=this.namedExpressions.namedExpressionOrPlaceholder(f.name,h.sheet);return[m.address,this.addressMapping.fetchCell(m.address)]}else return[f,this.addressMapping.fetchCell(f)]})}else return[]}},this.rangeDependencyQuery=u=>{const c=[],{smallerRangeVertex:h,restRange:d}=this.rangeMapping.findSmallerRange(u.range);let f;h!==void 0&&this.graph.adjacentNodes(h).has(u)?(f=d,c.push([new xe(h.start,h.end),h])):f=u.range;for(const m of f.addresses(this)){const g=this.addressMapping.getCell(m);g!==void 0&&c.push([m,g])}return c},this.formulaDependencyQuery=u=>{let c,h;if(u instanceof uo)h=u.getAddress(this.lazilyTransformingAstService),c=u.getFormula(this.lazilyTransformingAstService);else return;const d=KN(c,this.functionRegistry);return[h,Dl(d,h)]},this.graph=new xGe(this.dependencyQueryVertices)}static buildEmpty(e,t,r,i,s){return new a$(new MGe(t.chooseAddressMappingPolicy),new LGe,new $Ge(t.translationPackage),new IGe,s,e,r,i)}setFormulaToCell(e,t,r,i,s,o){const a=uo.fromAst(t,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(a),this.processCellDependencies(r,a),this.graph.markNodeAsDirty(a),s&&this.markAsVolatile(a),o&&this.markAsDependentOnStructureChange(a),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);if(r instanceof nr&&this.arrayMapping.removeArray(r.getRange()),r instanceof Wh)r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsDirty(r));else{const i=new Wh(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,i),this.addressMapping.setCell(e,i),this.graph.markNodeAsDirty(i)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(t===void 0)return Bh.empty();if(this.graph.adjacentNodes(t).size>0){const r=new mh;this.exchangeGraphNode(t,r),this.graph.adjacentNodesCount(r)===0?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const r=this.graph.getNodeId(t);e.forEach(i=>{if(i instanceof xe){const s=i;let o=this.getRange(s.start,s.end);o===void 0&&(o=new Ei(s),this.rangeMapping.setRange(o)),this.graph.addNodeAndReturnId(o);const a=this.graph.getNodeId(o);s.isFinite()||this.graph.markNodeAsInfiniteRange(a);const{smallerRangeVertex:l,restRange:u}=this.rangeMapping.findSmallerRange(s);if(l!==void 0){if(this.graph.addEdge(l,a),o.bruteForce){o.bruteForce=!1;for(const h of s.addresses(this))this.graph.removeEdge(this.fetchCell(h),a)}}else o.bruteForce=!0;const c=this.arrayMapping.getArray(u);if(c!==void 0)this.graph.addEdge(c,a);else for(const h of u.addresses(this)){const{vertex:d,id:f}=this.fetchCellOrCreateEmpty(h);this.graph.addEdge(f??d,a)}this.graph.addEdge(a,r),s.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(i instanceof ec){const s=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:o,id:a}=this.fetchNamedExpressionVertex(i.name,s);this.graph.addEdge(a??o,r)}else{const{vertex:s,id:o}=this.fetchCellOrCreateEmpty(i);this.graph.addEdge(o??s,r)}})}fetchNamedExpressionVertex(e,t){const r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}exchangeNode(e,t){const r=this.fetchCellOrCreateEmpty(e).vertex,i=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(r,i)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(t!==void 0)return{vertex:t,id:void 0};const r=new mh,i=this.graph.addNodeAndReturnId(r);return this.addressMapping.setCell(e,r),{vertex:r,id:i}}removeRows(e){this.stats.measure(Ge.ADJUSTING_GRAPH,()=>{for(const[r,i]of this.addressMapping.entriesFromRowsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof nr)if(i.isLeftCorner(r))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(Ge.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(Ge.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,i=>i.row);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(Ge.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,r]of this.addressMapping.sheetEntries(e)){for(const i of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(i);this.removeVertex(r),this.addressMapping.removeCell(t)}this.stats.measure(Ge.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const r of t)this.removeVertex(r);this.stats.measure(Ge.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const t=new Set;for(const[r,i]of this.addressMapping.sheetEntries(e))i instanceof nr?t.add(i):this.setCellEmpty(r);for(const r of t.values())this.setArrayEmpty(r);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(Ge.ADJUSTING_GRAPH,()=>{for(const[r,i]of this.addressMapping.entriesFromColumnsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof nr)if(i.isLeftCorner(r))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(Ge.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(Ge.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,i=>i.col);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(Ge.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(Ge.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(Ge.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(Ge.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const r of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(Ge.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(Ge.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(Ge.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const r of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(t===void 0)return!1;for(const r of t.addresses(this)){const i=this.addressMapping.getCell(r);if(i!==void 0&&!(i instanceof mh)&&i!==e)return!1}return!0}moveCells(e,t,r,i){for(const s of e.addressesWithDirection(t,r,this)){const o=ve(i,s.col+t,s.row+r);let a=this.addressMapping.getCell(s);const l=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(s),a!==void 0){this.graph.markNodeAsDirty(a),this.addressMapping.setCell(o,a);let u;for(const c of this.graph.adjacentNodes(a))c instanceof Ei&&!e.containsRange(c.range)&&(u=u??this.fetchCellOrCreateEmpty(s).vertex,this.graph.addEdge(u,c),this.graph.removeEdge(a,c));u&&(this.graph.markNodeAsDirty(u),this.addressMapping.setCell(s,u))}if(l!==void 0){a===void 0&&this.addressMapping.removeCell(o);for(const u of this.graph.adjacentNodes(l))a=a??this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(a,u),this.graph.markNodeAsDirty(a);this.removeVertex(l)}}for(const s of this.rangeMapping.rangeVerticesContainedInRange(e))for(const o of this.graph.adjacentNodes(s))if(o instanceof Ei&&!e.containsRange(o.range)){this.graph.removeEdge(s,o);for(const a of s.range.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,o),this.addressMapping.setCell(a,l),this.graph.markNodeAsDirty(l)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,i)}setArrayEmpty(e){const t=xe.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(const i of t.addresses(this))this.addressMapping.removeCell(i);for(const i of r.values()){const s=OGe(this.functionRegistry,i,e.getRange(),this.lazilyTransformingAstService,this);for(const o of s){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,i)}s.length>0&&this.graph.markNodeAsDirty(i)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof nr&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof Ne?new b(M.VALUE,H.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof Wl&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const r=this.getScalarValue(t);r!==ut&&(yield[ge(r),t])}}computeListOfValuesInRange(e){const t=[];for(const r of e.addresses(this)){const i=this.getScalarValue(r);t.push(i)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let r;t instanceof uo?r=this.formulaDirectDependenciesToArray(t,e):r=this.rangeDirectDependenciesToArray(t,e);let i=!1;for(const[s,o]of r)e.isLeftCorner(s)&&(i=!0),this.graph.addEdge(o,t),this.graph.markNodeAsDirty(o);i||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof nr&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=Bh.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),r=[];return t.forEach(i=>{const s=i;s instanceof Ei?r.push(G1(s.start,s.end)):r.push(s.getAddress(this.lazilyTransformingAstService))}),r}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(t,i)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:o})=>o.range.addressInRange(e));if(t.length<=0)return;const{vertex:r,id:i}=this.fetchCellOrCreateEmpty(e),s=i??this.graph.getNodeId(r);t.forEach(({id:o})=>{this.graph.addEdge(s,o)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(r=>{this.graph.hasNode(r)&&this.graph.adjacentNodes(r).forEach(i=>{i instanceof nr&&t.add(i)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:r})=>{const i=e.range.intersectionWith(r.range);i!==void 0&&i.addresses(this).forEach(s=>{const{vertex:o,id:a}=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(a??o,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const r of t.addresses(this)){const i=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new b(M.REF),r,i):(this.addressMapping.removeCell(r),this.changes.addChange(ut,r,i)):this.changes.addChange(ut,r,i)}}*formulaDirectDependenciesToArray(e,t){var r;const[,i]=(r=this.formulaDependencyQuery(e))!==null&&r!==void 0?r:[];if(i!==void 0){for(const s of i)if(!(s instanceof ec||s instanceof xe)&&t.getRange().addressInRange(s)){const o=this.fetchCellOrCreateEmpty(s).vertex;yield[s,o]}}}*rangeDirectDependenciesToArray(e,t){const{restRange:r}=this.rangeMapping.findSmallerRange(e.range);for(const i of r.addresses(this))if(t.getRange().addressInRange(i)){const s=this.fetchCellOrCreateEmpty(i).vertex;yield[i,s]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const r of t)(r instanceof uo||r instanceof Ei)&&(yield r)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,r){const i=Array.from(this.rangeMapping.rangesInSheet(e));for(const s of i)if(s.range.includesRow(t+r))if(s.bruteForce){const o=s.range.rangeWithSameWidth(t,r);for(const a of o.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,s)}}else{let o=s,a=this.rangeMapping.findSmallerRange(o.range);if(a.smallerRangeVertex!==void 0)continue;for(;a.smallerRangeVertex===void 0;){const l=new Ei(xe.spanFrom(o.range.start,o.range.width(),o.range.height()-1));this.rangeMapping.setRange(l),this.graph.addNodeAndReturnId(l);const u=new xe(ve(o.range.start.sheet,o.range.start.col,o.range.end.row),o.range.end);this.addAllFromRange(u,o),this.graph.addEdge(l,o),o=l,a=this.rangeMapping.findSmallerRange(o.range)}this.graph.addEdge(a.smallerRangeVertex,o),this.addAllFromRange(a.restRange,o),this.graph.removeEdge(a.smallerRangeVertex,s)}}addAllFromRange(e,t){for(const r of e.addresses(this)){const{vertex:i,id:s}=this.fetchCellOrCreateEmpty(r);this.graph.addEdge(s??i,t)}}fixRangesWhenAddingColumns(e,t,r){for(const i of this.rangeMapping.rangesInSheet(e))if(i.range.includesColumn(t+r)){let s;i.bruteForce?s=i.range.rangeWithSameHeight(t,r):s=xe.spanFrom(ve(e,t,i.range.end.row),r,1);for(const o of s.addresses(this)){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,i)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),r=xe.spanFrom(t,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof nr&&this.setArray(r,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(t,e),e instanceof nr){if(!this.isThereSpaceForArray(e))return;for(const s of r.addresses(this)){if(e.isLeftCorner(s))continue;const o=this.getCell(s);this.exchangeOrAddGraphNode(o,e)}}for(const s of r.addresses(this))this.addressMapping.setCell(s,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof nr))return;const r=xe.spanFromOrUndef(t,e.width,e.height);if(r!==void 0&&(this.setArray(r,e),!!this.isThereSpaceForArray(e)))for(const i of r.addresses(this))this.addressMapping.setCell(i,e)}truncateRanges(e,t){const{verticesToRemove:r,verticesToMerge:i,verticesWithChangedSize:s}=this.rangeMapping.truncateRanges(e,t);for(const[o,a]of i)this.mergeRangeVertices(o,a);for(const o of r)this.removeVertexAndCleanupDependencies(o);return s}fixArraysAfterAddingRow(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(Ts.fromRowStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.col;o<=s.end.col;++o)for(let a=t;a<=s.end.row;++a){const l=ve(e,o,a),u=ve(e,o,a+r),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ut,u,c)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(Ts.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}fixArraysAfterAddingColumn(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(lo.fromColumnStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.row;o<=s.end.row;++o)for(let a=t;a<=s.end.col;++a){const l=ve(e,a,o),u=ve(e,a+r,o),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ut,u,c)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(lo.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof nr?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof nr&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof Ei&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),r.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(e,i)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const r=t.values().next().value;t.delete(r);const[i,s]=r;this.graph.hasNode(s)&&this.graph.adjacentNodesCount(s)===0&&((s instanceof Ei||s instanceof mh)&&this.graph.removeNode(s).forEach(o=>t.add(o)),s instanceof Ei?this.rangeMapping.removeRange(s):s instanceof mh&&this.addressMapping.removeCell(i))}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class mh{constructor(){}getCellValue(){return ut}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Wh{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ep{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map(t=>t.message).find(t=>t);return b.parsingError(e)}getFormula(){return this.rawInput}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class UGe{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return(t=this.mapping.get(e.col))===null||t===void 0?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!!(!((t=this.mapping.get(e.col))===null||t===void 0)&&t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;(t=this.mapping.get(e.col))===null||t===void 0||t.delete(e.row)}addRows(e,t){this.mapping.forEach(r=>{const i=new Map;r.forEach((s,o)=>{o>=e&&(i.set(o+t,s),r.delete(o))}),i.forEach((s,o)=>{r.set(o,s)})}),this.height+=t}addColumns(e,t){const r=new Map;this.mapping.forEach((i,s)=>{s>=e&&(r.set(s+t,i),this.mapping.delete(s))}),r.forEach((i,s)=>{this.mapping.set(s,i)}),this.width+=t}removeRows(e){this.mapping.forEach(i=>{const s=new Map;i.forEach((o,a)=>{a>=e.rowStart&&(i.delete(a),a>e.rowEnd&&s.set(a-e.numberOfRows,o))}),s.forEach((o,a)=>{i.set(a,o)})});const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){const t=new Map;this.mapping.forEach((s,o)=>{o>=e.columnStart&&(this.mapping.delete(o),o>e.columnEnd&&t.set(o-e.numberOfColumns,s))}),t.forEach((s,o)=>{this.mapping.set(o,s)});const r=Math.min(this.width-1,e.columnEnd),i=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-i)}*getEntries(e){for(const[t,r]of this.mapping)for(const[i,s]of r)yield[ve(e,t,i),s]}*verticesFromColumn(e){const t=this.mapping.get(e);if(t!==void 0)for(const[r,i]of t)yield i}*verticesFromRow(e){for(const t of this.mapping.values()){const r=t.get(e);r!==void 0&&(yield r)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[i,s]of r)yield s}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const r of e.rows()){const i=t.get(r);i!==void 0&&(yield i)}}*entriesFromRowsSpan(e){for(const[t,r]of this.mapping.entries())for(const i of e.rows()){const s=r.get(i);s!==void 0&&(yield[ve(e.sheet,t,i),s])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[i,s]of r.entries())yield[ve(e.sheet,t,i),s]}}*vertices(){for(const[e,t]of this.mapping)for(const[r,i]of t)i!==void 0&&(yield i)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class BGe{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let r=0;r<t;r++)this.mapping[r]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return t?!!t[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,t){const r=[];for(let i=0;i<t;i++)r.push(new Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(e,t){for(let r=0;r<this.height;r++)this.mapping[r]!==void 0&&this.mapping[r].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){for(let i=0;i<this.height;i++)this.mapping[i]!==void 0&&this.mapping[i].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),r=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r){const i=this.getCellVertex(r,t);i&&(yield[ve(e,r,t),i])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const i=this.getCellVertex(t,r);i&&(yield i)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const i=this.getCellVertex(t,r);i&&(yield i)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const i=this.getCellVertex(t,r);i&&(yield[ve(e.sheet,t,r),i])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const i=this.getCellVertex(t,r);i&&(yield[ve(e.sheet,t,r),i])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}getCellVertex(e,t){var r;return(r=this.mapping[t])===null||r===void 0?void 0:r[e]}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var M;(function(n){n.DIV_BY_ZERO="DIV_BY_ZERO",n.NAME="NAME",n.VALUE="VALUE",n.NUM="NUM",n.NA="NA",n.CYCLE="CYCLE",n.REF="REF",n.SPILL="SPILL",n.LIC="LIC",n.ERROR="ERROR"})(M||(M={}));var vs;(function(n){n.FORMULA="FORMULA",n.VALUE="VALUE",n.ARRAY="ARRAY",n.EMPTY="EMPTY",n.ARRAYFORMULA="ARRAYFORMULA"})(vs||(vs={}));const WGe=(n,e)=>n instanceof nr?n.isLeftCorner(e)?vs.ARRAYFORMULA:vs.ARRAY:n instanceof Wl||n instanceof Ep?vs.FORMULA:n instanceof Wh?vs.VALUE:vs.EMPTY;var sA;(function(n){n.EMPTY="EMPTY",n.NUMBER="NUMBER",n.STRING="STRING",n.BOOLEAN="BOOLEAN",n.ERROR="ERROR"})(sA||(sA={}));var z1;(function(n){n.NUMBER="NUMBER"})(z1||(z1={}));const Va=Object.assign(Object.assign({},sA),z1),jGe=Object.assign(Object.assign({},sA),Ae),oY=n=>{switch(n){case Va.EMPTY:return 0;case Va.NUMBER:return 1;case Va.STRING:return 2;case Va.BOOLEAN:return 3;case Va.ERROR:return 4}throw new Error("Cell value not computed")},oA=n=>{if(n===ut)return Va.EMPTY;if(n instanceof b||n instanceof Ne)return Va.ERROR;if(typeof n=="string")return Va.STRING;if(It(n))return Va.NUMBER;if(typeof n=="boolean")return Va.BOOLEAN;throw new Error("Cell value not computed")},zGe=n=>It(n)?EGe(n):oA(n),GGe=n=>{if(It(n))return RGe(n)};class b{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(e){return new b(M.ERROR,`${H.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return this.root===void 0?new b(this.type,this.message,e):this}}const eZ=(n,e)=>({sheet:n,row:e}),YGe=n=>n.row<0,tZ=(n,e)=>({sheet:n,col:e}),KGe=n=>n.col<0,ve=(n,e,t)=>({sheet:n,col:e,row:t}),Cs=n=>n.col<0||n.row<0,XGe=(n,e,t,r)=>ve(e,n.col+t,n.row+r),Vy=n=>`${n.sheet},${n.row},${n.col}`;function Bn(n){var e,t,r;return n&&(typeof n=="object"||typeof n=="function")&&typeof((e=n)===null||e===void 0?void 0:e.sheet)=="number"&&typeof((t=n)===null||t===void 0?void 0:t.col)=="number"&&typeof((r=n)===null||r===void 0?void 0:r.row)=="number"}const Ga=(n,e)=>{var t;return(t=n.sheet)!==null&&t!==void 0?t:e.sheet},$S=(n,e)=>n.sheet===e.sheet&&n.col===e.col&&n.row===e.row;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const qGe="AbsoluteCellRange: Wrong range size";function js(n){return n&&(typeof n=="object"||typeof n=="function")?"start"in n&&Bn(n.start)&&"end"in n&&Bn(n.end):!1}const G1=(n,e)=>({start:n,end:e});class xe{constructor(e,t){if(e.sheet!==t.sheet)throw new FS(e.sheet,t.sheet);this.start=ve(e.sheet,e.col,e.row),this.end=ve(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new FS(e.sheet,t.sheet);const r=t.col-e.col,i=t.row-e.row;return Number.isFinite(i)&&Number.isFinite(r)?new xe(e,t):Number.isFinite(i)?new sc(e.sheet,e.row,t.row):new ic(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===O.CELL_RANGE?xe.fromCellRange(e,t):e.type===O.COLUMN_RANGE?ic.fromColumnRange(e,t):sc.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return xe.fromAst(e,t)}catch{return}}static fromCellRange(e,t){return new xe(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){const i=xe.spanFromOrUndef(e,t,r);if(i===void 0)throw new Error(qGe);return i}static spanFromOrUndef(e,t,r){if(!Number.isFinite(t)&&Number.isFinite(r))return e.col!==0?void 0:new sc(e.sheet,e.row,e.row+r-1);if(!Number.isFinite(r)&&Number.isFinite(t))return e.row!==0?void 0:new ic(e.sheet,e.col,e.col+t-1);if(Number.isFinite(r)&&Number.isFinite(t))return new xe(e,ve(e.sheet,e.col+t-1,e.row+r-1))}static fromCoordinates(e,t,r,i,s){return new xe(ve(e,t,r),ve(e,i,s))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),s=Math.min(this.end.col,e.end.col);if(!(t>r||i>s))return new xe(ve(this.sheet,i,t),ve(this.sheet,s,r))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return xe.spanFrom(ve(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof Ts?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return xe.spanFrom(ve(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return xe.spanFrom(ve(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let r=0;r<this.width();++r){const i=ve(this.sheet,this.start.col+r,this.start.row+t);e[t].push(i)}}return e}withStart(e){return new xe(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return $S(this.start,e.start)&&$S(this.end,e.end)}addressesArrayMap(e,t){const r=[];let i=this.start.row;for(;i<=this.effectiveEndRow(e);){let s=this.start.col;const o=[];for(;s<=this.effectiveEndColumn(e);)o.push(t(ve(this.start.sheet,s,i))),s++;r.push(o),i++}return r}addresses(e){const t=[];let r=this.start.row;const i=this.effectiveEndRow(e),s=this.effectiveEndColumn(e);for(;r<=i;){let o=this.start.col;for(;o<=s;)t.push(ve(this.start.sheet,o,r)),o++;r++}return t}*addressesWithDirection(e,t,r){if(e>0)if(t>0){let i=this.effectiveEndRow(r);for(;i>=this.start.row;){let s=this.effectiveEndColumn(r);for(;s>=this.start.col;)yield ve(this.start.sheet,s,i),s-=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(r);){let s=this.effectiveEndColumn(r);for(;s>=this.start.col;)yield ve(this.start.sheet,s,i),s-=1;i+=1}}else if(t>0){let i=this.effectiveEndRow(r);for(;i>=this.start.row;){let s=this.start.col;for(;s<=this.effectiveEndColumn(r);)yield ve(this.start.sheet,s,i),s+=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(r);){let s=this.start.col;for(;s<=this.effectiveEndColumn(r);)yield ve(this.start.sheet,s,i),s+=1;i+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return ve(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class ic extends xe{constructor(e,t,r){super(ve(e,t,0),ve(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const r=e.start.toSimpleColumnAddress(t),i=e.end.toSimpleColumnAddress(t);if(r.sheet!==i.sheet)throw new FS(r.sheet,i.sheet);return new ic(r.sheet,r.col,i.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new ic(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new ic(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class sc extends xe{constructor(e,t,r){super(ve(e,0,t),ve(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){const r=e.start.toSimpleRowAddress(t),i=e.end.toSimpleRowAddress(t);if(r.sheet!==i.sheet)throw new FS(r.sheet,i.sheet);return new sc(r.sheet,r.row,i.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new sc(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new sc(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ql{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function QGe(n){const e=n.caseSensitive?n.accentSensitive?"variant":"case":n.accentSensitive?"accent":"base",t=n.caseFirst,r=n.ignorePunctuation;return new Intl.Collator(n.localeLang,{sensitivity:e,caseFirst:t,ignorePunctuation:r})}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const ZGe="i",JGe=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class eYe{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(i,s)=>this.compare(i,s)<0,this.leq=(i,s)=>this.compare(i,s)<=0,this.gt=(i,s)=>this.compare(i,s)>0,this.geq=(i,s)=>this.compare(i,s)>=0,this.eq=(i,s)=>this.compare(i,s)===0,this.neq=(i,s)=>this.compare(i,s)!==0,this.pow=(i,s)=>Math.pow(ge(i),ge(s)),this.addWithEpsilonRaw=(i,s)=>{const o=i+s;return Math.abs(o)<this.actualEps*Math.abs(i)?0:o},this.addWithEpsilon=(i,s)=>{const o=uY(i,s);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(ge(i),ge(s)),o)},this.unaryMinus=i=>n$(i,-ge(i)),this.unaryPlus=i=>i,this.unaryPercent=i=>new JT(ge(i)/100),this.concat=(i,s)=>i.concat(s),this.nonstrictadd=(i,s)=>i instanceof b?i:s instanceof b?s:typeof i=="number"?typeof s=="number"?this.addWithEpsilonRaw(i,s):i:typeof s=="number"?s:0,this.subtract=(i,s)=>{const o=uY(i,s),a=ge(i),l=ge(s);let u=a-l;return Math.abs(u)<this.actualEps*Math.abs(a)&&(u=0),this.ExtendedNumberFactory(u,o)},this.divide=(i,s)=>{const o=ge(i),a=ge(s);if(a===0)return new b(M.DIV_BY_ZERO);{const l=cY(i,s);return this.ExtendedNumberFactory(o/a,l)}},this.multiply=(i,s)=>{const o=cY(i,s);return this.ExtendedNumberFactory(ge(i)*ge(s),o)},this.manyToExactComplex=i=>{const s=[];for(const o of i){if(o instanceof b)return o;if(It(o)||typeof o=="string"){const a=this.coerceScalarToComplex(o);a instanceof b||s.push(a)}}return s},this.coerceNumbersExactRanges=i=>this.manyToNumbers(i,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=i=>this.manyToNumbers(i,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=i=>{const s=[];for(const o of i){if(o instanceof b)return o;It(o)&&s.push(ge(o))}return s},this.manyToOnlyNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof b)return o;if(It(o))s.push(ge(o));else if(o!==ut)return new b(M.VALUE,H.NumberExpected)}return s},this.manyToCoercedNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof b)return o;if(o===ut)continue;const a=this.coerceScalarToNumberOrError(o);It(a)&&s.push(ge(a))}return s},this.collator=QGe(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r=="string"&&t.test(this.normalizeString(r))}neqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r!="string"||!t.test(this.normalizeString(r))}searchString(e,t){var r;const s=this.buildRegex(e,!1).exec(t);return(r=s==null?void 0:s.index)!==null&&r!==void 0?r:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const r=e.charAt(t);if(US(r)||this.config.useRegularExpressions&&BS(r))return!0}return!1}floatCmp(e,t){const r=ge(e),i=ge(t),s=1+this.actualEps;return i>=0&&r*s>=i&&r<=i*s||i<=0&&r*s<=i&&r>=i*s?0:r>i?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof b?e:(t=this.coerceToMaybeNumber(e))!==null&&t!==void 0?t:new b(M.VALUE,H.NumberCoercion)}coerceToMaybeNumber(e){var t;return(t=this.coerceNonDateScalarToMaybeNumber(e))!==null&&t!==void 0?t:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===ut)return 0;if(typeof e=="string"){if(e==="")return 0;const t=this.coerceStringToMaybePercentNumber(e);if(t!==void 0)return t;const r=this.coerceStringToMaybeCurrencyNumber(e);return r!==void 0?r:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return It(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const r=t.slice(0,t.length-1).trim(),i=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(i!==void 0)return new JT(i/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(t!==void 0){const[r,i]=t,s=this.numberLiteralsHelper.numericStringToMaybeNumber(i);if(s!==void 0)return new W1(s,r)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const i of e)if(i instanceof Ne)t.push(i);else if(i!==ut){const s=this.coerceScalarToComplex(i);if(s instanceof b)return s;t.push(s)}const r=[];for(const i of t)if(i instanceof Ne){const s=this.manyToExactComplex(i.valuesFromTopLeftCorner());if(s instanceof b)return s;r.push(...s)}else r.push(i);return r}coerceScalarToComplex(e){return e instanceof b?e:e===ut?[0,0]:It(e)?[ge(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new b(M.NUM,H.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:r,format:i}=t;switch(r){case Ae.NUMBER_RAW:return e;case Ae.NUMBER_CURRENCY:return new W1(e,i??this.config.currencySymbol[0]);case Ae.NUMBER_DATE:return new r$(e,i);case Ae.NUMBER_DATETIME:return new s$(e,i);case Ae.NUMBER_TIME:return new i$(e,i);case Ae.NUMBER_PERCENT:return new JT(e,i)}}buildRegex(e,t=!0){e=this.normalizeString(e);let r,i=this.config.useWildcards,s=this.config.useRegularExpressions;if(s)try{RegExp(e)}catch{s=!1,i=!1}return s?r=iYe(e,this.config.caseSensitive):i?r=nYe(e,this.config.caseSensitive):r=rYe(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=oZ(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if(typeof e=="string"||typeof t=="string"){const r=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof t=="string"?this.dateTimeHelper.dateStringToDateNumber(t):t;if(It(r)&&It(i))return this.floatCmp(r,i)}return e===ut?e=aY(t):t===ut&&(t=aY(e)),typeof e=="string"&&typeof t=="string"?this.stringCmp(e,t):typeof e=="boolean"&&typeof t=="boolean"?lY(Y1(e),Y1(t)):It(e)&&It(t)?this.floatCmp(e,t):e===ut&&t===ut?0:lY(oY(oA(e)),oY(oA(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const r=[];for(const s of e)if(s instanceof Ne)r.push(s);else{const o=ge(this.coerceScalarToNumberOrError(s));if(o instanceof b)return o;r.push(o)}const i=[];for(const s of r)if(s instanceof Ne){const o=t(s.valuesFromTopLeftCorner());if(o instanceof b)return o;i.push(...o)}else i.push(s);return i}coerceStringToComplex(e){const t=JGe.exec(e);if(t===null)return new b(M.NUM,H.ComplexNumberExpected);let r;if(t[6]!==void 0?r=t[1]==="-"?[0,-1]:[0,1]:r=this.parseComplexToken(t[1]+t[3],t[5]),r instanceof b||t[8]===void 0)return r;let i;return t[14]!==void 0?i=t[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(t[9]+t[11],t[13]),i instanceof b?i:t[5]!==""||t[13]===""?new b(M.NUM,H.ComplexNumberExpected):t[8]==="+"?[r[0]+i[0],r[1]+i[1]]:[r[0]-i[0],r[1]-i[1]]}parseComplexToken(e,t){const r=ge(this.coerceNonDateScalarToMaybeNumber(e));return r===void 0?new b(M.NUM,H.ComplexNumberExpected):t===""?[r,0]:[0,r]}}function Un([n,e],t){if(!isFinite(n)||!isFinite(e))return new b(M.NUM,H.NaN);if(t=t??ZGe,e===0)return`${n}`;const r=`${e===-1||e===1?"":Math.abs(e)}${t}`;return n===0?`${e<0?"-":""}${r}`:`${n}${e<0?"-":"+"}${r}`}function nZ(n){return n instanceof Ne?n:Ne.fromScalar(n)}function Y1(n){return Number(n)}function aY(n){return typeof n=="string"?"":It(n)?0:typeof n=="boolean"?!1:ut}function rZ(n){if(n instanceof b||typeof n=="boolean")return n;if(n===ut)return!1;if(It(n))return ge(n)!==0;{const e=n.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function K1(n){return n instanceof b||typeof n=="string"?n:n===ut?"":It(n)?ge(n).toString():n?"TRUE":"FALSE"}function K_(n){return n===ut?0:n}function lY(n,e){const t=ge(n),r=ge(e);return t>r?1:t<r?-1:0}function iZ(n){return isNaN(n)||n===1/0||n===-1/0}function sZ(n){return n===0?0:n}function US(n){return["*","?"].includes(n)}const tYe=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function BS(n){return tYe.includes(n)}function nYe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);if(i==="~"){if(r==n.length-1){t+="~";continue}const s=n.charAt(r+1);US(s)||BS(s)?(t+="\\"+s,r++):(t+=s,r++)}else US(i)?t+="."+i:BS(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function rYe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);US(i)||BS(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function iYe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);US(i)||BS(i)||e?t+=i:t+=i.toLowerCase()}return t}function uY(n,e){const{type:t,format:r}=rA(n),{type:i,format:s}=rA(e);if(t===Ae.NUMBER_RAW)return{type:i,format:s};if(i===Ae.NUMBER_RAW)return{type:t,format:r};if((t===Ae.NUMBER_DATETIME||t===Ae.NUMBER_DATE)&&(i===Ae.NUMBER_DATETIME||i===Ae.NUMBER_DATE))return{type:Ae.NUMBER_RAW};if(t===Ae.NUMBER_TIME){if(i===Ae.NUMBER_DATE)return{type:Ae.NUMBER_DATETIME,format:`${s} ${r}`};if(i===Ae.NUMBER_DATETIME)return{type:Ae.NUMBER_DATETIME,format:s}}if(i===Ae.NUMBER_TIME){if(t===Ae.NUMBER_DATE)return{type:Ae.NUMBER_DATETIME,format:`${r} ${s}`};if(t===Ae.NUMBER_DATETIME)return{type:Ae.NUMBER_DATETIME,format:r}}return{type:t,format:r}}function cY(n,e){let{type:t,format:r}=rA(n),{type:i,format:s}=rA(e);return t===Ae.NUMBER_PERCENT&&(t=Ae.NUMBER_RAW,r=void 0),i===Ae.NUMBER_PERCENT&&(i=Ae.NUMBER_RAW,s=void 0),t===Ae.NUMBER_RAW?{type:i,format:s}:i===Ae.NUMBER_RAW?{type:t,format:r}:{type:Ae.NUMBER_RAW}}function $y(n){return oZ(n.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function nb(n,e){var t;if(n.isAdHoc())return(t=n.data[0])===null||t===void 0?void 0:t[0];const r=n.range;if(e.formulaAddress.sheet===r.sheet){if(r.width()===1){const i=e.formulaAddress.row-r.start.row;if(i>=0&&i<r.height())return n.data[i][0]}else if(r.height()===1){const i=e.formulaAddress.col-r.start.col;if(i>=0&&i<r.width())return n.data[0][i]}}}function oZ(n,e){return n.normalize(e.toUpperCase())}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var p;(function(n){n.STRING="STRING",n.NUMBER="NUMBER",n.BOOLEAN="BOOLEAN",n.SCALAR="SCALAR",n.NOERROR="NOERROR",n.RANGE="RANGE",n.INTEGER="INTEGER",n.COMPLEX="COMPLEX",n.ANY="ANY"})(p||(p={}));class Qe{constructor(e){this.coerceScalarToNumberOrError=t=>this.arithmeticHelper.coerceScalarToNumberOrError(t),this.runFunction=(t,r,i,s)=>{const o=this.evaluateArguments(t,r,i),a=o.map(([m,g])=>m),l=o.map(([m,g])=>g),u=this.buildMetadataForEachArgumentValue(a.length,i),c=r.arraysFlag&&!i.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(u,a.length))return new b(M.NA,H.WrongArgNumber);const[h,d]=c?this.calculateSizeOfVectorizedResultArray(a,u):[1,1];if(h===1&&d===1){const m=this.vectorizeAndBroadcastArgumentsIfNecessary(c,a,u,0,0);return this.calculateSingleCellOfResultArray(r,m,u,l,s,i.returnNumberType)}const f=[...Array(h).keys()].map(m=>[...Array(d).keys()].map(g=>{const C=this.vectorizeAndBroadcastArgumentsIfNecessary(c,a,u,m,g),y=this.calculateSingleCellOfResultArray(r,C,u,l,s,i.returnNumberType);if(y instanceof Ne)throw new Error("Function returning array cannot be vectorized.");return y}));return Ne.onlyValues(f)},this.runFunctionWithReferenceArgument=(t,r,i,s,o,a=()=>new b(M.NA,H.CellRefExpected))=>{if(t.length===0)return this.returnNumberWrapper(s(),i.returnNumberType);if(t.length>1)return new b(M.NA,H.WrongArgNumber);let l=t[0];for(;l.type===O.PARENTHESIS;)l=l.expression;let u;if(l.type===O.CELL_REFERENCE)u=l.reference.toSimpleCellAddress(r.formulaAddress);else if(l.type===O.CELL_RANGE||l.type===O.COLUMN_RANGE||l.type===O.ROW_RANGE)try{u=xe.fromAst(l,r.formulaAddress).start}catch{return new b(M.REF,H.CellRefExpected)}return u!==void 0?this.returnNumberWrapper(o(u),i.returnNumberType):this.runFunction(t,r,i,a)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const r=[];for(const i of e){const s=this.evaluateAst(i,t);if(s instanceof Ne)for(const o of s.valuesFromTopLeftCorner())r.push([o,!0]);else r.push([s,!1])}return r}coerceToType(e,t,r){let i;if(e instanceof Ne)switch(t.argumentType){case p.RANGE:case p.ANY:i=e;break;default:{const s=nb(e,r);if(s===void 0)return;e=s}}if(!(e instanceof Ne))switch(t.argumentType){case p.INTEGER:case p.NUMBER:const s=this.coerceScalarToNumberOrError(e);if(!It(s)){i=s;break}const o=ge(s);if(t.maxValue!==void 0&&o>t.maxValue)return new b(M.NUM,H.ValueLarge);if(t.minValue!==void 0&&o<t.minValue)return new b(M.NUM,H.ValueSmall);if(t.lessThan!==void 0&&o>=t.lessThan)return new b(M.NUM,H.ValueLarge);if(t.greaterThan!==void 0&&o<=t.greaterThan)return new b(M.NUM,H.ValueSmall);if(t.argumentType===p.INTEGER&&!Number.isInteger(o))return new b(M.NUM,H.IntegerExpected);i=s;break;case p.STRING:i=K1(e);break;case p.BOOLEAN:i=rZ(e);break;case p.SCALAR:case p.NOERROR:case p.ANY:i=e;break;case p.RANGE:if(e instanceof b)return e;i=nZ(e);break;case p.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(ge(e))}return t.passSubtype||i===void 0?i:ge(i)}calculateSingleCellOfResultArray(e,t,r,i,s,o){const a=this.coerceArgumentsToRequiredTypes(e,t,r,i);if(a instanceof b)return a;const l=s(...a);return this.returnNumberWrapper(l,o)}coerceArgumentsToRequiredTypes(e,t,r,i){const s=[];for(let o=0;o<r.length;o++){const a=r[o],l=t[o]!==void 0?t[o]:a==null?void 0:a.defaultValue;if(l===void 0){s.push(void 0);continue}const u=this.coerceToType(l,a,e);if(u===void 0&&!i[o])return new b(M.VALUE,H.WrongType);if(u instanceof b&&a.argumentType!==p.SCALAR)return u;s.push(u)}return s}vectorizeAndBroadcastArgumentsIfNecessary(e,t,r,i,s){return t.map((o,a)=>e&&this.isRangePassedAsAScalarArgument(o,r[a])?this.vectorizeAndBroadcastRangeArgument(o,i,s):o)}vectorizeAndBroadcastRangeArgument(e,t,r){var i;const s=e.height()===1?0:t,o=e.width()===1?0:r;return(i=e.data[s])===null||i===void 0?void 0:i[o]}evaluateArguments(e,t,r){return r.expandRanges?this.listOfScalarValues(e,t):e.map(i=>[this.evaluateAst(i,t),!1])}buildMetadataForEachArgumentValue(e,t){const r=t.parameters?[...t.parameters]:[];if(t.repeatLastArgs!==void 0&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>r.length;)r.push(...r.slice(r.length-t.repeatLastArgs));return r}isNumberOfArgumentValuesValid(e,t){return t>e.length?!1:t<e.length?e.slice(t).every(s=>(s==null?void 0:s.optionalArg)||(s==null?void 0:s.defaultValue)!==void 0):!0}calculateSizeOfVectorizedResultArray(e,t){const r=e.filter((o,a)=>this.isRangePassedAsAScalarArgument(o,t[a])),i=Math.max(1,...r.map(o=>o.height())),s=Math.max(1,...r.map(o=>o.width()));return[i,s]}isRangePassedAsAScalarArgument(e,t){return e==null||t==null?!1:e instanceof Ne&&![p.RANGE,p.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(t!==void 0)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return t!==void 0&&It(e)?this.arithmeticHelper.ExtendedNumberFactory(ge(e),{type:t,format:r}):e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class gt{constructor(e,t,r=!1){this.width=e,this.height=t,this.isRef=r}static error(){return new gt(1,1,!0)}static scalar(){return new gt(1,1,!1)}isScalar(){return this.width===1&&this.height===1||this.isRef}}function sYe(n,e){return new gt(Math.max(n.width,e.width),Math.max(n.height,e.height))}function oYe(n){return new gt(n.width,n.height)}class aYe{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case O.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case O.COLUMN_RANGE:case O.ROW_RANGE:case O.CELL_RANGE:{const r=xe.fromAstOrUndef(e,t.formulaAddress);return r===void 0?gt.error():new gt(r.width(),r.height(),!0)}case O.ARRAY:{const r=[],i=[];for(const a of e.args){const l=a.map(h=>this.checkArraySizeForAst(h,t)),u=Math.min(...l.map(h=>h.height)),c=l.reduce((h,d)=>h+d.width,0);r.push(u),i.push(c)}const s=r.reduce((a,l)=>a+l,0),o=Math.min(...i);return new gt(o,s)}case O.STRING:case O.NUMBER:return gt.scalar();case O.CELL_REFERENCE:return new gt(1,1,!0);case O.DIV_OP:case O.CONCATENATE_OP:case O.EQUALS_OP:case O.GREATER_THAN_OP:case O.GREATER_THAN_OR_EQUAL_OP:case O.LESS_THAN_OP:case O.LESS_THAN_OR_EQUAL_OP:case O.MINUS_OP:case O.NOT_EQUAL_OP:case O.PLUS_OP:case O.POWER_OP:case O.TIMES_OP:{const r=this.checkArraySizeForAst(e.left,t),i=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(r.height>1||r.width>1||i.height>1||i.width>1)?gt.error():sYe(r,i)}case O.MINUS_UNARY_OP:case O.PLUS_UNARY_OP:case O.PERCENT_OP:{const r=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(r.height>1||r.width>1)?gt.error():oYe(r)}case O.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case O.EMPTY:return gt.error();default:return gt.error()}}checkArraySizeForFunction(e,t){const r=this.functionRegistry.getArraySizeFunction(e.procedureName);if(r!==void 0)return r(e,t);const i=this.functionRegistry.getMetadata(e.procedureName);if(i===void 0||i.expandRanges||!t.arraysFlag||i.vectorizationForbidden||i.parameters===void 0)return new gt(1,1);const s=e.args.map(u=>{var c;return this.checkArraySizeForAst(u,new Ql(t.formulaAddress,t.arraysFlag||((c=i==null?void 0:i.arrayFunction)!==null&&c!==void 0?c:!1)))}),o=[...i.parameters];if(i.repeatLastArgs!==void 0&&o.length<s.length&&(s.length-o.length)%i.repeatLastArgs!==0)return gt.error();for(;o.length<s.length;){if(i.repeatLastArgs===void 0)return gt.error();o.push(...o.slice(o.length-i.repeatLastArgs))}let a=1,l=1;for(let u=0;u<s.length;u++)o[u].argumentType!==p.RANGE&&o[u].argumentType!==p.ANY&&(l=Math.max(l,s[u].height),a=Math.max(a,s[u].width));return new gt(a,l)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class aZ{constructor(e,t,r){var i;this.value=t,this.address=r,this.type=e.type,this.message=(i=e.message)!==null&&i!==void 0?i:""}toString(){return this.value}valueOf(){return this.value}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function Ut(n,e,t){if(typeof n>"u")return ii.defaultConfig[t];if(typeof e=="string"){if(typeof n===e)return n;throw new Mt(e,t)}else{if(e.includes(n))return n;throw new qQ(e.map(r=>`'${r}'`).join(" "),t)}}function hm(n,e,t){if(n<t)throw new KQ(e,t)}function lYe(n,e,t){if(n>t)throw new XQ(e,t)}function YR(n,e,t,r){if(e(n))return n;if(typeof n>"u")return ii.defaultConfig[r];throw new Mt(t,r)}function hY(...n){const e=new Map;n.forEach(r=>{const i=e.get(r.value)||[];i.push(r.name),e.set(r.value,i)});const t=[];for(const r of e.values())r.length>1&&t.push(r);if(t.length>0){t.forEach(i=>i.sort());const r=t.map(i=>`[${i}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${r}`)}}function ue(n,e,t){if(typeof n!==e)throw new Mt(e,t)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const l$=new RegExp("^ss(\\.(s+|0+))?$"),uYe=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),cYe=new RegExp("\\s+"),lZ=new RegExp("[ /.-]"),X1=":",dY=1e3,hYe=uZ(gYe),dYe=uZ(mYe);function fYe(n,e,t){if(e===void 0&&t===void 0)return;let r=n.replace(cYe," ").trim().toLowerCase();if(!pYe(r))return;let i=r.substring(r.length-2);i==="am"||i==="pm"?r=r.substring(0,r.length-2).trim():(i=r.substring(r.length-1),i==="a"||i==="p"?r=r.substring(0,r.length-1).trim():i=void 0);const s=r.split(lZ);s.length>=2&&s[s.length-2].includes(X1)&&(s[s.length-2]=s[s.length-2]+"."+s[s.length-1],s.pop());const o=s[s.length-1].split(X1);if(i!==void 0&&o.push(i),s.length===1)return fY(o,t);if(o.length===1)return gY(s,e);const a=gY(s.slice(0,s.length-1),e),l=fY(o,t);if(a!==void 0)return l===void 0?void 0:Object.assign(Object.assign({},a),l)}function fY(n,e){var t,r,i;if(e===void 0)return;const{itemsCount:s,hourItem:o,minuteItem:a,secondItem:l}=hYe(e);let u;if(n[n.length-1]==="am"||n[n.length-1]==="a"?(u=!1,n.pop()):(n[n.length-1]==="pm"||n[n.length-1]==="p")&&(u=!0,n.pop()),n.length!==s)return;const c=Number((t=n[l])!==null&&t!==void 0?t:"0");if(!Number.isFinite(c))return;const h=Math.round(c*dY)/dY,d=Number((r=n[a])!==null&&r!==void 0?r:"0");if(!(Number.isFinite(d)&&Number.isInteger(d)))return;const f=Number((i=n[o])!==null&&i!==void 0?i:"0");return!(Number.isFinite(f)&&Number.isInteger(f))||u!==void 0&&(f<0||f>12)?void 0:{hours:u!==void 0?f%12+(u?12:0):f,minutes:d,seconds:h}}function gY(n,e){var t;if(e===void 0)return;const{itemsCount:r,dayItem:i,monthItem:s,shortYearItem:o,longYearItem:a}=dYe(e);if(n.length!==r)return;const l=Number(n[i]);if(!(Number.isFinite(l)&&Number.isInteger(l)))return;const u=Number(n[s]);if(!(Number.isFinite(u)&&Number.isInteger(u))||n[a]&&n[o])return;const c=Number((t=n[a])!==null&&t!==void 0?t:n[o]);if(Number.isFinite(c)&&Number.isInteger(c)&&!(n[a]&&(c<1e3||c>9999))&&!(n[o]&&(c<0||c>99)))return{year:c,month:u,day:l}}function gYe(n){const e=n.toLowerCase().trim(),r=(e.endsWith("am/pm")?e.substring(0,e.length-5):e.endsWith("a/p")?e.substring(0,n.length-3):e).trim().split(X1);return{itemsCount:r.length,hourItem:r.indexOf("hh"),minuteItem:r.indexOf("mm"),secondItem:r.findIndex(i=>l$.test(i))}}function mYe(n){const e=n.toLowerCase().trim().split(lZ);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}}function pYe(n){return uYe.test(n)}function uZ(n){const e={};return t=>{const r=e[t];if(r!==void 0)return r;const i=n(t);return e[t]=i,i}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const q1=[31,28,31,30,31,30,31,31,30,31,30,31],rp=[0,31,59,90,120,151,181,212,243,273,304,334],KR=60,XR=60,Q1=24;function Uy(n){return n&&(typeof n=="object"||typeof n=="function")?"year"in n&&typeof n.year=="number"&&"month"in n&&typeof n.month=="number"&&"day"in n&&typeof n.day=="number":!1}function cZ(n){return n&&(typeof n=="object"||typeof n=="function")?"hours"in n&&typeof n.hours=="number"&&"minutes"in n&&typeof n.minutes=="number"&&"seconds"in n&&typeof n.seconds=="number":!1}const vYe={year:9999,month:12,day:31};class wYe{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(vYe),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:r="",timeFormat:i=""}=this.parseDateTimeFromConfigFormats(e);if(t!==void 0)return cZ(t)?Uy(t)?new s$(Tp(t)+this.dateToNumber(t),r+" "+i):new i$(Tp(t),i):Uy(t)?new r$(this.dateToNumber(t),r):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=q1[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;const i=t-this.dateToNumberFromZero({year:r,month:1,day:1}),s=yYe(i-(this.isLeapYear(r)&&i>=59?1:0)),o=i-rp[s]-(this.isLeapYear(r)&&s>1?1:0);return{year:r,month:s+1,day:o+1}}numberToSimpleDateTime(e){const t=Rp(e%1),r=Math.floor(t.hours/Q1);t.hours=t.hours%Q1;const i=this.numberToSimpleDate(Math.floor(e)+r);return Object.assign(Object.assign({},i),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&t===2?29:q1[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return e.day===31&&(e.day=30),e.day===30&&t.day===31&&(t.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,t.month===2&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){const i=this.parseDateTime(e,t,r);if(!(Uy(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}parseDateTimeFromFormats(e,t,r){const i=t.length===0?[void 0]:t,s=r.length===0?[void 0]:r;for(const o of i)for(const a of s){const l=this.parseSingleFormat(e,o,a);if(l!==void 0)return{dateTime:l,timeFormat:a,dateFormat:o}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+rp[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function yYe(n){let e=0;return rp[e+6]<=n&&(e+=6),rp[e+3]<=n&&(e+=3),rp[e+2]<=n?e+=2:rp[e+1]<=n&&(e+=1),e}function mY(n,e){const t=12*n.year+n.month-1+e;return{year:Math.floor(t/12),month:t%12+1,day:n.day}}function SYe(n){return{year:n.year,month:n.month,day:Math.min(n.day,q1[n.month-1])}}function X_(n){return Math.round(n*3600*24)/(3600*24)}function CYe(n,e=1){return Math.round(n*e)/e}function Rp(n){const e=n*Q1*XR*KR,t=CYe(e%KR,1e5)%KR,r=(e-t)/KR,i=Math.round(r%XR)%XR,s=(r-i)/XR;return{hours:Math.round(s),minutes:i,seconds:t}}function Tp(n){return((n.seconds/60+n.minutes)/60+n.hours)/24}function pY(n){return{year:n.year,month:n.month,day:Math.min(30,n.day)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class EYe{call(){return BGe}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const vY=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,wY=/(\\.|[#0]+(\.[#0]*)?)/g;var jl;(function(n){n.FORMAT="FORMAT",n.FREE_TEXT="FREE_TEXT"})(jl||(jl={}));function qR(n,e){return{type:n,value:e}}var aA;(function(n){n.DATE="DATE",n.NUMBER="NUMBER",n.STRING="STRING"})(aA||(aA={}));function RYe(n){vY.lastIndex=0;const e=[];let t;do t=vY.exec(n),t!==null&&e.push(t);while(t);return e}function TYe(n){wY.lastIndex=0;const e=wY.exec(n);return e!==null?[e]:[]}function hZ(n,e){const t=[];let r=0;for(let s=0;s<n.length;++s){const o=n[s];if(o.index!==r){const a=e.substr(r,o.index-r);t.push(qR(jl.FREE_TEXT,a))}o[0].startsWith("\\")?t.push(qR(jl.FREE_TEXT,o[0])):t.push(qR(jl.FORMAT,o[0])),r=o.index+o[0].length}const i=n[n.length-1];if(i.index+i[0].length<e.length){const s=e.substr(i.index+i[0].length,e.length);t.push(qR(jl.FREE_TEXT,s))}return t}function dZ(n){const e=RYe(n);if(!e.every(t=>fZ(t)))return{type:aA.DATE,tokens:hZ(e,n)}}function bYe(n){const e=TYe(n);if(!e.every(t=>fZ(t)))return{type:aA.NUMBER,tokens:hZ(e,n)}}function fZ(n){return n[0].startsWith("\\")}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function AYe(n,e,t,r){const i=t.stringifyDateTime(r.numberToSimpleDateTime(n),e);if(i!==void 0)return i;const s=t.stringifyDuration(Rp(n),e);if(s!==void 0)return s;const o=bYe(e);return o!==void 0?MYe(o.tokens,n):e}function ws(n,e){let t=`${n}`;for(;t.length<e;)t="0"+t;return t}function NYe(n,e){let t=`${n}`;for(;t.length<e;)t=t+"0";return t}function yY(n,e){return n.split(e).length-1}function MYe(n,e){let t="";for(let r=0;r<n.length;++r){const i=n[r];if(i.type===jl.FREE_TEXT){t+=i.value;continue}const s=i.value.split("."),o=s[0],a=s[1]||"",l=s[1]?".":"",u=Number(e.toFixed(a.length)).toString().split(".");let c=u[0]||"",h=u[1]||"";if(o.length>c.length){const f=yY(o.substr(0,o.length-c.length),"0");c=ws(c,f+c.length)}const d=yY(a.substr(h.length,a.length-h.length),"0");h=NYe(h,d+h.length),t+=c+l+h}return t}function IYe(n,e){const t=dZ(e);if(t===void 0)return;const r=t.tokens;let i="";for(const s of r){if(s.type===jl.FREE_TEXT){i+=s.value;continue}switch(s.value.toLowerCase()){case"h":case"hh":{i+=ws(n.hours,s.value.length),n.hours=0;break}case"[hh]":{i+=ws(n.hours,s.value.length-2),n.hours=0;break}case"m":case"mm":{i+=ws(n.minutes,s.value.length),n.minutes=0;break}case"[mm]":{i+=ws(n.minutes+60*n.hours,s.value.length-2),n.minutes=0,n.hours=0;break}case"s":case"ss":{i+=ws(Math.floor(n.seconds),s.value.length);break}default:{if(l$.test(s.value)){const o=Math.max(s.value.length-3,0);i+=`${n.seconds<10?"0":""}${Math.floor(n.seconds*Math.pow(10,o))/Math.pow(10,o)}`;continue}return}}}return i}function OYe(n,e){const t=dZ(e);if(t===void 0)return;const r=t.tokens;let i="",s=!1;const o=r.some(a=>a.type===jl.FORMAT&&(a.value==="a/p"||a.value==="A/P"||a.value==="am/pm"||a.value==="AM/PM"));for(let a=0;a<r.length;a++){const l=r[a];if(l.type===jl.FREE_TEXT){i+=l.value;continue}switch(l.value.toLowerCase()){case"h":case"hh":{s=!0,i+=ws(o?(n.hours+11)%12+1:n.hours,l.value.length);break}case"d":case"dd":{i+=ws(n.day,l.value.length);break}case"s":case"ss":{i+=ws(Math.floor(n.seconds),l.value.length);break}case"m":case"mm":{a+1<r.length&&r[a+1].value.startsWith(":")&&(s=!0),s?i+=ws(n.minutes,l.value.length):i+=ws(n.month,l.value.length),s=!0;break}case"yy":{i+=ws(n.year%100,l.value.length);break}case"yyyy":{i+=n.year;break}case"am/pm":case"a/p":{const[u,c]=l.value.split("/");i+=n.hours<12?u:c;break}default:{if(l$.test(l.value)){const u=l.value.length-3;i+=`${n.seconds<10?"0":""}${Math.floor(n.seconds*Math.pow(10,u))/Math.pow(10,u)}`;continue}return}}}return i}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Z1="length",By=n=>parseInt(n,16),SY=n=>parseInt(n,10),q_=n=>(n+"").replace(/\-/g,""),lA=(n,e,t)=>n.substr(e,t),Ia=n=>n.codePointAt(0)-65;function _Ye(n){return q_(n)[Z1]===25?By(lA(q_(n),By("12"),Ia("F")))/(By(lA(q_(n),Ia("C"),Ia("Y")>>4))||(~~![][Z1]<<3)+1):0}function PYe(n){if(n=(n+"").replace(/\-/g,""),n[Z1]!==Ia("Z"))return!1;let e=0;return[[0,Ia("G")+1],[Ia("H"),Ia("H")-1],[Ia("G")+Ia("H"),Ia("G")]].reduce((t,[r,i],s)=>(t|=(SY(`${SY(By(lA(n,e+r-(s===0?0:2),i+(s?2:0)))+(By(lA(n,e+r+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,t),Ia("A"))==="1">>1}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const xYe={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:n})=>`The license key for HyperFormula expired on ${n}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let CY=!1;function LYe(n){const e={template:"missing",vars:{}};if(n==="gpl-v3"||n==="internal-use-in-handsontable")e.template="valid";else if(typeof n=="string"&&PYe(n)){const[t,r,i]="18/07/2024".split("/"),s=Math.floor(new Date(`${r}/${t}/${i}`).getTime()/864e5),o=_Ye(n);e.vars.keyValidityDate=HYe(new Date((o+1)*864e5)),s>o?e.template="expired":e.template="valid"}else n!==""&&(e.template="invalid");return!CY&&e.template!=="valid"&&(console.warn(xYe[e.template](e.vars)),CY=!0),e.template}function HYe(n){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()],r=n.getDate(),i=n.getFullYear();return`${t} ${r}, ${i}`}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Cn;(function(n){class e{constructor(l){this.value=l,this.value=n$(this.value,sZ(ge(this.value)))}}n.Number=e;class t{constructor(l){this.value=l}}n.String=t;class r{constructor(l){this.value=l}}n.Boolean=r;class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}n.Empty=i;class s{constructor(l){this.formula=l}}n.Formula=s;class o{constructor(l,u){this.value=new b(l,u)}}n.Error=o})(Cn||(Cn={}));function DYe(n){return n.startsWith("=")}function FYe(n){const e=n.toLowerCase();return e==="true"||e==="false"}function kYe(n,e){const t=n.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(e,t)}class VYe{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(e){if(e==null)return Cn.Empty.getSingletonInstance();if(typeof e=="number")return iZ(e)?new Cn.Error(M.NUM,H.ValueLarge):new Cn.Number(e);if(typeof e=="boolean")return new Cn.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),r=Tp({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=t+r;return i<0?new Cn.Error(M.NUM,H.DateBounds):i%1===0?new Cn.Number(new r$(i,"Date()")):i<1?new Cn.Number(new i$(i,"Date()")):new Cn.Number(new s$(i,"Date()"))}else if(typeof e=="string"){if(FYe(e))return new Cn.Boolean(e.toLowerCase()==="true");if(DYe(e))return new Cn.Formula(e);if(kYe(e,this.config.errorMapping))return new Cn.Error(this.config.errorMapping[e.toUpperCase()]);{let t=e.trim(),r=0,i;if(t.endsWith("%"))r=1,t=t.slice(0,t.length-1);else{const a=this.currencyMatcher(t);a!==void 0&&(r=2,[i,t]=a)}const s=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(s!==void 0){let a;return r===1?a=new JT(s/100):r===2?a=new W1(s,i):a=s,new Cn.Number(a)}const o=this.dateHelper.dateStringToDateNumber(t);return o!==void 0?new Cn.Number(o):new Cn.String(e.startsWith("'")?e.slice(1):e)}}else throw new YQ(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var wf;(function(n){n[n.COPY=0]="COPY",n[n.CUT=1]="CUT"})(wf||(wf={}));var ti;(function(n){n[n.VALUE=0]="VALUE",n[n.EMPTY=1]="EMPTY",n[n.FORMULA=2]="FORMULA",n[n.PARSING_ERROR=3]="PARSING_ERROR"})(ti||(ti={}));class EY{constructor(e,t,r,i,s){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=i,this.content=s}*getContent(e){if(this.content!==void 0)for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r)yield[ve(e.sheet,e.col+r,e.row+t),this.content[t][r]]}}class $Ye{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new EY(e,t,r,wf.CUT)}copy(e,t,r){const i=[];for(let s=0;s<r;++s){i[s]=[];for(let o=0;o<t;++o){const a=this.operations.getClipboardCell(ve(e.sheet,e.col+o,e.row+s));i[s].push(a)}}this.clipboard=new EY(e,t,r,wf.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===wf.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(Cs(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new gr("a valid target address.");const t=xe.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new kf;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===wf.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===wf.COPY}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class uA{constructor(e,t,r,i){this.displayName=e,this.address=t,this.added=r,this.options=i}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new uA(this.displayName,this.address,this.added,this.options)}}class UYe{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));if(t&&t.added)return t}remove(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class RY{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class rg{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new UYe,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var r,i;return t===void 0?this.workbookStore.isNameAvailable(e):(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.isNameAvailable(e))!==null&&i!==void 0?i:!0}namedExpressionInAddress(e){const t=this.addressCache.get(e);if(t&&t.added)return t}namedExpressionForScope(e,t){var r;return t===void 0?this.workbookStore.getExisting(e):(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e)}nearestNamedExpression(e,t){var r,i;return(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var r,i;return(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.has(e))!==null&&i!==void 0?i:!1}isNameValid(e){const t=new RegExp(`^${Mq}$`),r=new RegExp(`^${Iq}$`),i=new RegExp(`^${Oq}$`);return t.test(e)||r.test(e)?!1:i.test(e)}addNamedExpression(e,t,r){const i=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);let s=i.get(e);return s!==void 0?(s.added=!0,s.displayName=e,s.options=r):(s=new uA(e,this.nextAddress(),!0,r),i.add(s)),this.addressCache.set(s.address.row,s),s}restoreNamedExpression(e,t){const r=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var r;return(r=this.worksheetStoreOrCreate(t).get(e))!==null&&r!==void 0?r:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return t===void 0&&(t=new uA(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r;t===void 0?r=this.workbookStore:r=this.worksheetStore(t);const i=r==null?void 0:r.get(e);if(r===void 0||i===void 0||!i.added)throw Error("Named expression does not exist");r.remove(e),r instanceof RY&&r.mapping.size===0&&this.worksheetStores.delete(t),this.addressCache.delete(i.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(t=>t.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,r)=>{t.getAllNamedExpressions().forEach(i=>{e.push({expression:i,scope:r})})}),e}getAllNamedExpressionsForScope(e){var t,r;return e===void 0?this.workbookStore.getAllNamedExpressions():(r=(t=this.worksheetStores.get(e))===null||t===void 0?void 0:t.getAllNamedExpressions())!==null&&r!==void 0?r:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new RY,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return ve(rg.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}rg.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const ah=n=>{switch(n.type){case O.EMPTY:case O.NUMBER:case O.STRING:case O.ERROR:case O.ERROR_WITH_RAW_INPUT:return!1;case O.CELL_REFERENCE:return!n.reference.isAbsolute();case O.CELL_RANGE:case O.COLUMN_RANGE:case O.ROW_RANGE:return!n.start.isAbsolute();case O.NAMED_EXPRESSION:return!1;case O.PERCENT_OP:case O.PLUS_UNARY_OP:case O.MINUS_UNARY_OP:return ah(n.value);case O.CONCATENATE_OP:case O.EQUALS_OP:case O.NOT_EQUAL_OP:case O.LESS_THAN_OP:case O.GREATER_THAN_OP:case O.LESS_THAN_OR_EQUAL_OP:case O.GREATER_THAN_OR_EQUAL_OP:case O.MINUS_OP:case O.PLUS_OP:case O.TIMES_OP:case O.DIV_OP:case O.POWER_OP:return ah(n.left)||ah(n.right);case O.PARENTHESIS:return ah(n.expression);case O.FUNCTION_CALL:return n.args.some(e=>ah(e));case O.ARRAY:return n.args.some(e=>e.some(t=>ah(t)))}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class hd{performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[i,s]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService)),o=t.rememberNewAst(i);r.setFormula(o),r.setAddress(s)}}transformSingleAst(e,t){const r=this.transformAst(e,t),i=this.fixNodeAddress(t);return[r,i]}transformAst(e,t){switch(e.type){case O.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case O.CELL_RANGE:return this.transformCellRangeAst(e,t);case O.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case O.ROW_RANGE:return this.transformRowRangeAst(e,t);case O.EMPTY:case O.ERROR:case O.NUMBER:case O.NAMED_EXPRESSION:case O.ERROR_WITH_RAW_INPUT:case O.STRING:return e;case O.PERCENT_OP:case O.MINUS_UNARY_OP:case O.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case O.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(r=>this.transformAst(r,t))});case O.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case O.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(r=>r.map(i=>this.transformAst(i,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const r=this.transformCellAddress(e.reference,t);return r instanceof en?Object.assign(Object.assign({},e),{reference:r}):r===M.REF?Hl(new b(M.REF)):e}transformCellRangeAst(e,t){const r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===M.REF?Hl(new b(M.REF)):e}transformColumnRangeAst(e,t){const r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===M.REF?Hl(new b(M.REF)):e}transformRowRangeAst(e,t){const r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===M.REF?Hl(new b(M.REF)):e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class BYe extends hd{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=Ga(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const i=e.toSimpleColumnAddress(t);return r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet?e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i===M.REF||s===M.REF?M.REF:i||s?[i||e,s||t]:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class J1 extends hd{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){const r=Ga(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const i=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?e.isRowAbsolute()||t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i===M.REF||s===M.REF?M.REF:i||s?[i||e,s||t]:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class WYe extends hd{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return e.isInvalid(t)?M.REF:!1}transformCellRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?M.REF:!1}transformColumnRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?M.REF:!1}transformRowRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?M.REF:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class jYe extends hd{constructor(e,t,r,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=i,this.dependentFormulaTransformer=new zYe(e,t,r,i)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return ve(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){const r=this.sourceRange;if(e instanceof en){const i=e.toSimpleCellAddress(t);if(r.addressInRange(i))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){const i=this.sourceRange;if(e instanceof en&&t instanceof en){const s=e.toSimpleCellAddress(r),o=t.toSimpleCellAddress(r);if(i.addressInRange(s)&&i.addressInRange(o))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class zYe extends hd{constructor(e,t,r,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=i}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.shouldMove(e,t)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof en?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof Ri?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i&&s?[i,s]:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class GYe extends hd{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=Ga(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(i.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return M.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const i=Ga(e,r);let s=e,o=t;if(this.columnsSpan.sheet===i){const u=e.toSimpleColumnAddress(r),c=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=c.col)return M.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(s=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(c.col-this.columnsSpan.columnStart+1)))}const a=this.transformCellAddress(s,r),l=this.transformCellAddress(o,r);if(a===!1&&l===!1)return[s,o];if(a===M.REF||l===M.REF)throw Error("Cannot happen");return[a||s,l||o]}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class eL extends hd{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const r=Ga(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(i.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return M.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const i=Ga(e,r);let s=e,o=t;if(this.rowsSpan.sheet===i){const u=e.toSimpleRowAddress(r),c=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=c.row)return M.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(s=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(c.row-this.rowsSpan.rowStart+1)))}const a=this.transformCellAddress(s,r),l=this.transformCellAddress(o,r);return a===!1&&l===!1?[s,o]:a===M.REF||l===M.REF?M.REF:[a||s,l||o]}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class YYe extends hd{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[i]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService));r.setFormula(i)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?M.REF:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function gZ(n){if(!Array.isArray(n))throw new gr("an array of arrays.");for(let e=0;e<n.length;e++)if(!Array.isArray(n[e]))throw new gr("an array of arrays.")}function cA(n){let e=0,t=0,r=0;for(let s=0;s<n.length;s++){let o=0;for(let a=0;a<n[s].length;a++){const l=n[s][a];l!=null&&(o=a+1,++r)}e=Math.max(e,o),o>0&&(t=s+1)}const i=e*t;return{height:t,width:e,fill:i===0?0:r/i}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class mZ{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return hA(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Ts.fromNumberOfRows(this.sheet,e[0],e[1]))}}class pZ{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return dA(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Ts.fromNumberOfRows(this.sheet,e[0],e[1]))}}class vZ{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return dA(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>lo.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class wZ{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return hA(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>lo.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class KYe{constructor(e,t,r,i,s,o,a,l,u){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=i,this.parser=s,this.stats=o,this.lazilyTransformingAstService=a,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=Bh.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const r of e.rowsSpans()){const i=this.doRemoveRows(r);i&&t.push(i)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const r of e.columnsSpans()){const i=this.doRemoveColumns(r);i&&t.push(i)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(Ge.TRANSFORM_ASTS,()=>{const i=new YYe(e);i.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(i)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const r=this.namedExpressions.getAllNamedExpressionsForScope(e).map(i=>this.removeNamedExpression(i.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:r}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e),r=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,cA(r)),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,i){const s=Ts.fromNumberOfRows(e,i,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(s),i<t&&(t+=r);const o=ve(e,0,t),a=ve(e,0,i);this.moveCells(o,Number.POSITIVE_INFINITY,r,a);const l=Ts.fromNumberOfRows(e,t,r);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,i){const s=lo.fromNumberOfColumns(e,i,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(s),i<t&&(t+=r);const o=ve(e,t,0),a=ve(e,i,0);this.moveCells(o,r,Number.POSITIVE_INFINITY,a);const l=lo.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,i){this.ensureItIsPossibleToMoveCells(e,t,r,i);const s=xe.spanFrom(e,t,r),o=xe.spanFrom(i,t,r),a=i.col-e.col,l=i.row-e.row,u=i.sheet,c=this.getRangeClipboardCells(o),h=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.removeValues(h);const d=this.dependencyGraph.rawValuesFromRange(s);this.columnSearch.moveValues(d,a,l,u);let f=0;this.stats.measure(Ge.TRANSFORM_ASTS,()=>{const g=new jYe(s,a,l,u);g.performEagerTransformations(this.dependencyGraph,this.parser),f=this.lazilyTransformingAstService.addTransformation(g)}),this.dependencyGraph.moveCells(s,a,l,u);const m=this.updateNamedExpressionsForMovedCells(e,t,r,i);return{version:f,overwrittenCellsData:c,addedGlobalNamedExpressions:m}}setRowOrder(e,t){const r=[];let i=[];for(const[s,o]of t)if(s!==o){const a=xe.spanFrom({sheet:e,col:0,row:s},1/0,1),l=this.getRangeClipboardCells(a);i=i.concat(l),r.push(l.map(([{sheet:u,col:c},h])=>[{sheet:u,col:c,row:o},h]))}return r.forEach(s=>this.restoreClipboardCells(e,s.values())),i}setColumnOrder(e,t){const r=[];let i=[];for(const[s,o]of t)if(s!==o){const a=xe.spanFrom({sheet:e,col:s,row:0},1,1/0),l=this.getRangeClipboardCells(a);i=i.concat(l),r.push(l.map(([{sheet:u,col:c,row:h},d])=>[{sheet:u,col:o,row:h},d]))}return r.forEach(s=>this.restoreClipboardCells(e,s.values())),i}addNamedExpression(e,t,r,i){const s=this.namedExpressions.addNamedExpression(e,r,i);this.storeNamedExpressionInCell(s.address,t),this.adjustNamedExpressionEdges(s,e,r)}restoreNamedExpression(e,t,r){const i=e.displayName;this.restoreCell(e.address,t);const s=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(s,i,r)}changeNamedExpressionExpression(e,t,r,i){const s=this.namedExpressions.namedExpressionForScope(e,r);if(!s)throw new kS(e);const o=s.copy();s.options=i;const a=this.getClipboardCell(s.address);return this.storeNamedExpressionInCell(s.address,t),[o,a]}removeNamedExpression(e,t){const r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new kS(e);this.namedExpressions.remove(r.displayName,t);const i=this.getClipboardCell(r.address);if(t!==void 0){const s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,s.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,i]}ensureItIsPossibleToMoveCells(e,t,r,i){if(Cs(e)||!(fA(t)&&fA(r)||XYe(e,t,r))||Cs(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new gr("a valid range of cells to move.");const s=xe.spanFrom(e,t,r),o=xe.spanFrom(i,t,r);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new kf;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new np;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new iA}restoreClipboardCells(e,t){const r=[];for(const[i,s]of t)if(this.restoreCell(i,s),s.type===ti.FORMULA){const{dependencies:o}=this.parser.fetchCachedResult(s.hash);r.push(...this.updateNamedExpressionsForTargetAddress(e,i,o))}return r}restoreCell(e,t){switch(t.type){case ti.VALUE:{this.setValueToCell(t,e);break}case ti.FORMULA:{this.setFormulaToCellFromCache(t.hash,e);break}case ti.EMPTY:{this.setCellEmpty(e);break}case ti.PARSING_ERROR:{this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof mh)return[e,{type:ti.EMPTY}];if(t instanceof Wh)return[e,Object.assign({type:ti.VALUE},t.getValues())];if(t instanceof uo)return[t.getAddress(this.lazilyTransformingAstService),{type:ti.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof Ep)return[e,{type:ti.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof mh)return{type:ti.EMPTY};if(t instanceof Wh)return Object.assign({type:ti.VALUE},t.getValues());if(t instanceof nr){const r=t.getArrayCellValue(e);return r===ut?{type:ti.EMPTY}:{type:ti.VALUE,parsedValue:r,rawValue:t.getArrayCellRawValue(e)}}else{if(t instanceof Wl)return{type:ti.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof Ep)return{type:ti.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),i=new Array(t);for(let s=0;s<t;s++){i[s]=new Array(r);for(let o=0;o<r;o++){const a=ve(e,o,s);i[s][o]=this.getClipboardCell(a)}}return i}getRangeClipboardCells(e){const t=[];for(const r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(e,t){const r=this.cellContentParser.parse(t),i=this.getOldContent(e);if(r instanceof Cn.Formula){const s=this.parser.parse(r.formula,e),{ast:o,errors:a}=s;if(a.length>0)this.setParsingErrorToCell(r.formula,a,e);else try{const l=this.arraySizePredictor.checkArraySize(o,e);if(l.width<=0||l.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,l,s)}catch(l){if(!l.message)throw l;const u={type:Wn.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(r.formula,[u],e)}}else r instanceof Cn.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e);return i}setSheetContent(e,t){this.clearSheet(e);for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++){const s=ve(e,i,r);this.setCellContent(s,t[r][i])}}setParsingErrorToCell(e,t,r){const i=this.dependencyGraph.getCellValue(r),s=new Ep(t,e),o=this.dependencyGraph.setParsingErrorToCell(r,s);this.columnSearch.remove(ge(i),r),this.columnSearch.applyChanges(o.getChanges()),this.changes.addAll(o),this.changes.addChange(s.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}){const a=this.dependencyGraph.getCellValue(e),l=this.dependencyGraph.setFormulaToCell(e,r,Dl(o,e),t,i,s);this.columnSearch.remove(ge(a),e),this.columnSearch.applyChanges(l.getChanges()),this.changes.addAll(l)}setValueToCell(e,t){const r=this.dependencyGraph.getCellValue(t),i=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(ge(r),ge(e.parsedValue),t),this.columnSearch.applyChanges(i.getChanges().filter(s=>!$S(s.address,t))),this.changes.addAll(i),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(ge(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(ut,e)}setFormulaToCellFromCache(e,t){const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}=this.parser.fetchCachedResult(e),a=Dl(o,t),[l]=new WYe(t.sheet).transformSingleAst(r,t);this.parser.rememberNewAst(l);const u=CGe(a),c=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,l,u,c,i,s)}rowEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getHeight(t);return e>=r}getAndClearContentChanges(){const e=this.changes;return this.changes=Bh.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:r,contentChanges:i}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(i.getChanges());let s=0;return this.stats.measure(Ge.TRANSFORM_ASTS,()=>{const o=new eL(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(r),{version:s,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:r,contentChanges:i}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(i.getChanges()),this.columnSearch.removeColumns(e);let s=0;return this.stats.measure(Ge.TRANSFORM_ASTS,()=>{const o=new GYe(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(r),{version:s,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(Ge.TRANSFORM_ASTS,()=>{const r=new J1(e);r.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(r)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const r=t.getFormula(this.lazilyTransformingAstService),i=t.getAddress(this.lazilyTransformingAstService),s=this.parser.computeHashFromAst(r);this.setFormulaToCellFromCache(s,i)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:r}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(Ge.TRANSFORM_ASTS,()=>{const i=new BYe(e);i.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(i)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getWidth(t);return e>=r}adjustNamedExpressionEdges(e,t,r){if(r===void 0)return;const{vertex:i,id:s}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=s??this.dependencyGraph.graph.getNodeId(i),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:l,id:u}=this.dependencyGraph.fetchCellOrCreateEmpty(a.address),c=u??this.dependencyGraph.graph.getNodeId(l);for(const h of this.dependencyGraph.graph.adjacentNodes(l))if(h instanceof Wl&&h.getAddress(this.lazilyTransformingAstService).sheet===r){const d=h.getFormula(this.lazilyTransformingAstService),f=h.getAddress(this.lazilyTransformingAstService),{dependencies:m}=this.parser.fetchCachedResultForAst(d);for(const g of Dl(m,f))g instanceof ec&&g.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(c,h),this.dependencyGraph.graph.addEdge(o,h))}}storeNamedExpressionInCell(e,t){const r=this.cellContentParser.parse(t);if(r instanceof Cn.Formula){const i=this.parser.parse(r.formula,ve(-1,0,0));if(ah(i.ast))throw new o$;const{ast:s,hasVolatileFunction:o,hasStructuralChangeFunction:a,dependencies:l}=i;this.dependencyGraph.setFormulaToCell(e,s,Dl(l,e),gt.scalar(),o,a)}else r instanceof Cn.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,i){if(e.sheet===i.sheet)return[];const s=[],o=xe.spanFrom(i,t,r);for(const a of o.addresses(this.dependencyGraph)){const l=this.addressMapping.fetchCell(a);if(l instanceof Wl&&a.sheet!==e.sheet){const u=l.getFormula(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(u);s.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,a,c))}}return s}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];const i=[],s=this.addressMapping.fetchCell(t);for(const o of Dl(r,t)){if(!(o instanceof ec))continue;const a=o.name,l=this.dependencyGraph.fetchNamedExpressionVertex(a,e).vertex,c=this.namedExpressions.isExpressionInScope(a,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(a,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(a,l,i);c!==l&&(this.dependencyGraph.graph.removeEdgeIfExists(l,s),this.dependencyGraph.graph.addEdge(c,s))}return i}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(rg.SHEET_FOR_WORKBOOK_EXPRESSIONS,new UGe(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),r.push(i.normalizeExpressionName()),t instanceof Wl){const s=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:u}=s;this.dependencyGraph.setFormulaToCell(i.address,o,Dl(u,i.address),gt.scalar(),a,l)}else t instanceof mh?this.setCellEmpty(i.address):t instanceof Wh&&this.setValueToCell(t.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address).vertex}}function hA(n){if(n.length<=1)return n;const e=[...n].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1],l=a[0]+a[1];return s<=l?a[1]+=Math.max(0,o-(l-s)):i.push([s,o]),i},[e[0]]);let r=0;for(let i=0;i<t.length;++i)t[i][0]-=r,r+=t[i][1];return t}function dA(n){if(n.length<=1)return n;const e=[...n].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1];return s===a[0]?a[1]=Math.max(a[1],o):i.push([s,o]),i},[e[0]]);let r=0;for(let i=0;i<t.length;++i)t[i][0]+=r,r+=t[i][1];return t}function fA(n){return Number.isInteger(n)&&n>0}function XYe(n,e,t){return n.row===0&&fA(e)&&t===Number.POSITIVE_INFINITY||n.col===0&&fA(t)&&e===Number.POSITIVE_INFINITY}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Rr{}class qYe extends Rr{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class QYe extends Rr{constructor(e,t,r,i,s,o,a){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=i,this.overwrittenCellsData=s,this.addedGlobalNamedExpressions=o,this.version=a}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class ZYe extends Rr{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class JYe extends Rr{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class e3e extends Rr{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class t3e extends Rr{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class n3e extends Rr{constructor(e,t,r,i,s){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=i,this.version=s,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class r3e extends Rr{constructor(e,t,r,i,s){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=i,this.version=s,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class i3e extends Rr{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class s3e extends Rr{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class o3e extends Rr{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class a3e extends Rr{constructor(e,t,r,i,s){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=i,this.version=s}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class l3e extends Rr{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class u3e extends Rr{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class c3e extends Rr{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class h3e extends Rr{constructor(e,t,r,i){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=i}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class d3e extends Rr{constructor(e,t,r,i){super(),this.name=e,this.newContent=t,this.scope=r,this.options=i}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class f3e extends Rr{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class g3e extends Rr{constructor(e,t,r,i,s){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=i,this.options=s}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class m3e extends Rr{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class p3e{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new m3e}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:r}=e;for(let i=r.length-1;i>=0;--i){const s=r[i];this.operations.addRows(new pZ(t,[[s.rowFrom,s.rowCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:r}=e;for(let i=r.length-1;i>=0;--i){const s=r[i];this.operations.addColumns(new vZ(t,[[s.columnFrom,s.columnCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let r=t.length-1;r>=0;--r){const i=t[r];this.operations.removeRows(new mZ(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let r=t.length-1;r>=0;--r){const i=t[r];this.operations.removeColumns(new wZ(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const r=t.address,[i,s]=t.oldContent;$S(r,i)||this.operations.setCellEmpty(r),this.operations.restoreCell(i,s)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:r}=e;this.operations.addSheet(e.sheetName);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=ve(r,o,i);this.operations.restoreCell(l,a)}}for(const[i,s]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(i,s,r);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:r}=e;for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=ve(r,o,i);this.operations.restoreCell(l,a)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:r}=e;this.operations.clearSheet(r);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=ve(r,o,i);this.operations.restoreCell(l,a)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:r}=e,i=r.length,s=r[0].length;for(let o=0;o<i;++o)for(let a=0;a<s;++a){const l=ve(t.sheet,t.col+a,t.row+o);this.operations.restoreCell(l,r[o][a])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:r}=e;this.operations.setSheetContent(t,r)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const r of t){const[i,s]=r;this.operations.setFormulaToCellFromCache(s,i)}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class v3e{constructor(e,t,r,i,s,o,a,l,u,c){this.operations=t,this.undoRedo=r,this.clipboardOperations=i,this.dependencyGraph=s,this.columnSearch=o,this.parser=a,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=c,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const r=new pZ(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new ZYe(r))}removeRows(e,...t){const r=new mZ(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeRows(r);this.undoRedo.saveOperation(new qYe(r,i))}addColumns(e,...t){const r=new vZ(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new i3e(r))}removeColumns(e,...t){const r=new wZ(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeColumns(r);this.undoRedo.saveOperation(new s3e(r,i))}moveCells(e,t,r,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:s,overwrittenCellsData:o,addedGlobalNamedExpressions:a}=this.operations.moveCells(e,t,r,i);this.undoRedo.saveOperation(new QYe(e,t,r,i,o,a,s))}moveRows(e,t,r,i){this.ensureItIsPossibleToMoveRows(e,t,r,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.moveRows(e,t,r,i);this.undoRedo.saveOperation(new n3e(e,t,r,i,s))}moveColumns(e,t,r,i){this.ensureItIsPossibleToMoveColumns(e,t,r,i),this.undoRedo.clearRedoStack();const s=this.operations.moveColumns(e,t,r,i);this.undoRedo.saveOperation(new r3e(e,t,r,i,s))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!dm(t))throw new gr("width to be positive integer.");if(!dm(r))throw new gr("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){const t=this.clipboardOperations.clipboard;if(t===void 0)throw new GQ;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const r=xe.spanFrom(e,t.width,t.height),i=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack();const s=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new h3e(e,i,t.content,s))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new o3e(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:i,scopedNamedExpressions:s}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new a3e(t,e,r,s,i))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const r=this.operations.renameSheet(e,t);return r!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new l3e(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new u3e(e,t))}setCellContents(e,t){if(!(t instanceof Array))t=[[t]];else for(let i=0;i<t.length;i++)if(!(t[i]instanceof Array))throw new gr("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const r=[];for(let i=0;i<t.length;i++)for(let s=0;s<t[i].length;s++){const o={sheet:e.sheet,row:e.row+i,col:e.col+s},a=t[i][s];this.clipboardOperations.abortCut();const l=this.operations.setCellContent(o,a);r.push({address:o,newContent:a,oldContent:l})}this.undoRedo.saveOperation(new c3e(r))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),gZ(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new t3e(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new JYe(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new In(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[r,i]of t)if(r!==i){const s=xe.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new np}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new e3e(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new In(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[r,i]of t)if(r!==i){const s=xe.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new np}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new In(e);const i=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==i)throw new gr(`number of ${r}s provided to be sheet ${r==="row"?"height":"width"}.`);const s=[];for(let o=0;o<i;o++)t[o]!==o&&s.push([o,t[o]]);return s}undo(){if(this.undoRedo.isUndoStackEmpty())throw new jQ;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new zQ;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,i){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new d3e(e,t,r,i))}changeNamedExpressionExpression(e,t,r,i){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);const[s,o]=this.operations.changeNamedExpressionExpression(e,r,t,i);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new g3e(s,r,o,t,i))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[r,i]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new f3e(r,i,t)),r}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),this.namedExpressions.namedExpressionForScope(e,r)===void 0)throw new kS(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),this.namedExpressions.namedExpressionForScope(e,t)===void 0)throw new kS(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new In(e);const r=this.dependencyGraph.getSheetHeight(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(r+i>this.maxRows)throw new kf;for(const[s,o]of t)if(!ef(s)||!dm(o))throw new gr("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[r,i]of t){const s=r+i-1;if(!ef(r)||!ef(s))throw new gr("starting and ending row to be nonnegative.");if(s<r)throw new gr("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new In(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new In(e);const r=this.dependencyGraph.getSheetWidth(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(r+i>this.maxColumns)throw new kf;for(const[s,o]of t)if(!ef(s)||!dm(o))throw new gr("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[r,i]of t){const s=r+i-1;if(!ef(r)||!ef(s))throw new gr("starting and ending column to be nonnegative.");if(s<r)throw new gr("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new In(e)}}ensureItIsPossibleToMoveRows(e,t,r,i){this.ensureItIsPossibleToAddRows(e,[i,r]);const s=ve(e,0,t),o=ve(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||Cs(s)||Cs(o)||!dm(r)||i<=t+r&&i>=t)throw new gr("a valid range of rows to move.");const a=this.dependencyGraph.getSheetWidth(e),l=xe.spanFrom(s,a,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new np;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(Ts.fromNumberOfRows(e,i-1,2)))throw new iA}ensureItIsPossibleToMoveColumns(e,t,r,i){this.ensureItIsPossibleToAddColumns(e,[i,r]);const s=ve(e,t,0),o=ve(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||Cs(s)||Cs(o)||!dm(r)||i<=t+r&&i>=t)throw new gr("a valid range of columns to move.");const a=this.dependencyGraph.getSheetHeight(e),l=xe.spanFrom(s,r,a);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new np;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(lo.fromNumberOfColumns(e,i-1,2)))throw new iA}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new DS(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new In(e);const r=this.sheetMapping.get(t);if(r!==void 0&&r!==e)throw new DS(t)}ensureItIsPossibleToChangeContent(e){if(Cs(e))throw new UQ(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new In(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const r=cA(t),i=xe.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(i);for(const s of i.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(s)}ensureItIsPossibleToChangeSheetContents(e,t){const r=cA(t),i=xe.spanFrom(ve(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(i)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new kf}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new In(e)}validateRowOrColumnMapping(e,t,r){const i=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),s=t.map(([a,l])=>a).sort((a,l)=>a-l),o=t.map(([a,l])=>l).sort((a,l)=>a-l);for(let a=0;a<s.length;a++){if(!ef(s[a])||s[a]>=i)throw new gr(`${r} numbers to be nonnegative integers and less than sheet ${r==="row"?"height":"width"}.`);if(s[a]===s[a+1])throw new gr(`source ${r} numbers to be unique.`);if(s[a]!==o[a])throw new gr(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new WQ(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new BQ(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof Cn.Formula){const r=this.parser.parse(t.formula,ve(-1,0,0));if(ah(r.ast))throw new o$}}}function dm(n){return Number.isInteger(n)&&n>0}function ef(n){return Number.isInteger(n)&&n>=0}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class w3e{constructor(e,t,r,i,s,o){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=i,this.dependencyGraph=s,this.columnSearch=o}run(){this.stats.start(Ge.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(Ge.TOP_SORT),this.stats.measure(Ge.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=Bh.empty();return this.stats.measure(Ge.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,r=>{if(r instanceof uo){const i=r.isComputed()?r.getCellValue():void 0,s=this.recomputeFormulaVertexValue(r);if(s!==i){const o=r.getAddress(this.lazilyTransformingAstService);return t.addChange(s,o),this.columnSearch.change(ge(i),ge(s),o),!0}return!1}else return r instanceof Ei&&r.clearCache(),!0},r=>{if(r instanceof Ei)r.clearCache();else if(r instanceof uo){const i=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(ge(r.valueOrUndef()),i);const s=new b(M.CYCLE,void 0,r);r.setCellValue(s),t.addChange(s,i)}})}),t}runAndForget(e,t,r){const i=[];for(const o of Dl(r,t))if(o instanceof xe){const a=o;if(this.dependencyGraph.getRange(a.start,a.end)===void 0){const l=new Ei(a);this.dependencyGraph.rangeMapping.setRange(l),i.push(l)}}const s=this.evaluateAstToCellValue(e,new Ql(t,this.config.useArrayArithmetic));return i.forEach(o=>{this.dependencyGraph.rangeMapping.removeRange(o)}),s}recomputeFormulas(e,t){e.forEach(r=>{r instanceof uo&&r.setCellValue(new b(M.CYCLE,void 0,r))}),t.forEach(r=>{if(r instanceof uo){const i=this.recomputeFormulaVertexValue(r),s=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(ge(i),s)}else r instanceof Ei&&r.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof nr&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const r=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(r,new Ql(t,this.config.useArrayArithmetic,e));return e.setCellValue(i)}}evaluateAstToCellValue(e,t){const r=this.interpreter.evaluateAst(e,t);return r instanceof Ne?r:r===ut&&this.config.evaluateNullToZero?0:r}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class tL{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class yZ{constructor(e,t){this.name=e,this.newValue=t}}class y3e{constructor(e,t,r,i){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=i}exportChange(e){const t=e.value,r=e.address;if(r.sheet===rg.SHEET_FOR_WORKBOOK_EXPRESSIONS){const i=this.namedExpressions.namedExpressionInAddress(r.row);if(!i)throw new Error("Missing named expression");return new yZ(i.displayName,this.exportScalarOrRange(t))}else if(t instanceof Ne){const i=[];for(const[s,o]of t.entriesFromTopLeftCorner(r))i.push(new tL(o,this.exportValue(s)));return i}else return new tL(r,this.exportValue(t))}exportValue(e){return e instanceof Ne?this.detailedError(new b(M.VALUE,H.ScalarExpected)):this.config.smartRounding&&It(e)?this.cellValueRounding(ge(e)):e instanceof b?this.detailedError(e):e===ut?null:ge(e)}exportScalarOrRange(e){return e instanceof Ne?e.rawData().map(t=>t.map(r=>this.exportValue(r))):this.exportValue(e)}detailedError(e){var t,r;let i;const s=(t=e.root)===null||t===void 0?void 0:t.getAddress(this.lazilyTransformingService);return s!==void 0&&(s.sheet===rg.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(r=this.namedExpressions.namedExpressionInAddress(s.row))===null||r===void 0?void 0:r.displayName:i=z0(this.sheetIndexMapping,s,-1)),new aZ(e,this.config.translationPackage.getErrorTranslation(e.type),i)}cellValueRounding(e){if(e===0)return e;const t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class S3e{constructor(e,t,r,i,s,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=i,this.stats=s,this.arraySizePredictor=o,this.buildStrategy=new C3e(e,t,r,s,i,o)}buildGraph(e,t){const r=t.measure(Ge.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(Ge.PROCESS_DEPENDENCIES,()=>this.processDependencies(r))}processDependencies(e){e.forEach((t,r)=>{this.dependencyGraph.processCellDependencies(t,r)})}}class C3e{constructor(e,t,r,i,s,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=i,this.cellContentParser=s,this.arraySizePredictor=o}run(e){const t=new Map;for(const r in e){const i=this.dependencyGraph.getSheetId(r),s=e[r];for(let o=0;o<s.length;++o){const a=s[o];for(let l=0;l<a.length;++l){const u=a[l],c=ve(i,l,o),h=this.cellContentParser.parse(u);if(h instanceof Cn.Formula){const d=this.stats.measure(Ge.PARSER,()=>this.parser.parse(h.formula,c));if(d.errors.length>0){this.shrinkArrayIfNeeded(c);const f=new Ep(d.errors,h.formula);this.dependencyGraph.addVertex(c,f)}else{this.shrinkArrayIfNeeded(c);const f=this.arraySizePredictor.checkArraySize(d.ast,c);if(f.isScalar()){const m=new Wl(d.ast,c,0);t.set(m,Dl(d.dependencies,c)),this.dependencyGraph.addVertex(c,m),d.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(m),d.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(m)}else{const m=new nr(d.ast,c,new gt(f.width,f.height));t.set(m,Dl(d.dependencies,c)),this.dependencyGraph.addArrayVertex(c,m)}}}else if(!(h instanceof Cn.Empty)){this.shrinkArrayIfNeeded(c);const d=new Wh(h.value,u);this.columnIndex.add(ge(h.value),c),this.dependencyGraph.addVertex(c,d)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof nr&&this.dependencyGraph.shrinkArrayToCorner(t)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const QR=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class SZ extends Qe{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:r,licenseKey:i}=this.config;let s;return QR.has(i)?s=QR.get(i):QR.has(r)?s=QR.get(r):r==="valid"&&(s=i.slice(-5)),`HyperFormula v${ci.version}, ${s}`})}}SZ.implementedFunctions={VERSION:{method:"version",parameters:[]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function Q_(n,e){var t;let r=e.implementedFunctions[n];const i=(t=e.aliases)===null||t===void 0?void 0:t[n];if(i!==void 0){if(r!==void 0)throw new NGe(n,e.name);r=e.implementedFunctions[i]}if(r===void 0)throw Gp.functionNotDeclaredInPlugin(n,e.name);return r}class _r{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=t=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(t),this.isFunctionVolatile=t=>this.volatileFunctions.has(t),this.isArrayFunction=t=>this.arrayFunctions.has(t),this.isFunctionDependentOnSheetStructureChange=t=>this.structuralChangeFunctions.has(t),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)_r.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(_r.plugins);for(const[t,r]of _r.protectedFunctions())_r.loadFunctionUnprotected(r,t,this.instancePlugins);for(const[t,r]of this.instancePlugins.entries())this.categorizeFunction(t,Q_(t,r))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),t!==void 0&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),r!==void 0&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw Vf.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw Vf.cannotUnregisterProtectedPlugin();for(const[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(ci.getRegisteredLanguagesCodes());Object.keys(e).forEach(r=>{t.has(r)&&ci.getLanguage(r).extendFunctions(e[r])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(r=>{this.loadPluginFunction(e,r,t)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(r=>{this.loadPluginFunction(e,r,t)})}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw Vf.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static loadFunctionUnprotected(e,t,r){const i=Q_(t,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,i))r.set(t,e);else throw Gp.functionMethodNotFound(i,e.name)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)t!==void 0&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const t=[];for(const[r,i]of this.instancePlugins.entries()){let s=t.find(u=>u instanceof i);s===void 0&&(s=new i(e),t.push(s));const o=Q_(r,i),a=o.method;this.functions.set(r,[a,s]);const l=o.arraySizeMethod;l!==void 0&&this.arraySizeFunctions.set(r,[l,s])}}getFunctionPlugin(e){if(!_r.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,i]=t;return(s,o)=>i[r](s,o)}else return}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,i]=t;return(s,o)=>i[r](s,o)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,r]of this.instancePlugins)_r.functionIsProtected(t)||e.add(r);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}_r.plugins=new Map;_r._protectedPlugins=new Map([["VERSION",SZ],["OFFSET",void 0]]);/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Yr;(function(n){n.GREATER_THAN="GREATER_THAN",n.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",n.LESS_THAN="LESS_THAN",n.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",n.NOT_EQUAL="NOT_EQUAL",n.EQUAL="EQUAL"})(Yr||(Yr={}));const ZR=(n,e)=>({operator:n,value:e});class E3e{constructor(e){var t,r,i,s;this.trueString=(r=(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||t===void 0?void 0:t.toLowerCase())!==null&&r!==void 0?r:"true",this.falseString=(s=(i=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||i===void 0?void 0:i.toLowerCase())!==null&&s!==void 0?s:"false"}fromCellValue(e,t){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const r=this.parseCriterion(e,t);if(r!==void 0)return{raw:e,lambda:b3e(r,t)}}parseCriterion(e,t){if(typeof e=="number"||typeof e=="boolean")return ZR(Yr.EQUAL,e);if(typeof e=="string"){const r=R3e.exec(e);let i,s;r?(s=T3e(r[1]),i=r[2]):(s=Yr.EQUAL,i=e);const o=t.coerceToMaybeNumber(i),a=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(s===void 0)return;if(i==="")return ZR(s,null);if(o===void 0){if(s===Yr.EQUAL||s===Yr.NOT_EQUAL)return ZR(s,a??i)}else return ZR(s,ge(o))}}}const R3e=/([<>=]+)(.*)/;function T3e(n){switch(n){case">":return Yr.GREATER_THAN;case">=":return Yr.GREATER_THAN_OR_EQUAL;case"<":return Yr.LESS_THAN;case"<=":return Yr.LESS_THAN_OR_EQUAL;case"<>":return Yr.NOT_EQUAL;case"=":return Yr.EQUAL;default:return}}const b3e=(n,e)=>{switch(n.operator){case Yr.GREATER_THAN:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)>0:t=>!1;case Yr.GREATER_THAN_OR_EQUAL:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)>=0:t=>!1;case Yr.LESS_THAN:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)<0:t=>!1;case Yr.LESS_THAN_OR_EQUAL:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)<=0:t=>!1;case Yr.EQUAL:return typeof n.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,n.value)===0;if(typeof t=="string"){if(t==="")return!1;const r=e.coerceToMaybeNumber(t);return r===void 0?!1:e.floatCmp(r,n.value)===0}else return!1}:typeof n.value=="string"?e.eqMatcherFunction(n.value):typeof n.value=="boolean"?t=>typeof t=="boolean"&&t===n.value:t=>t===ut;case Yr.NOT_EQUAL:return typeof n.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,n.value)!==0;if(typeof t=="string"){if(t==="")return!0;const r=e.coerceToMaybeNumber(t);return r===void 0?!0:e.floatCmp(r,n.value)!==0}else return!0}:typeof n.value=="string"?e.neqMatcherFunction(n.value):typeof n.value=="boolean"?t=>typeof t!="boolean"||t!==n.value:t=>t!==ut}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class A3e{constructor(e,t,r,i,s,o,a,l,u,c){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=i,this.arithmeticHelper=s,this.functionRegistry=o,this.namedExpressions=a,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=c,this.equalOp=(h,d)=>Ao(this.arithmeticHelper.eq,h,d),this.notEqualOp=(h,d)=>Ao(this.arithmeticHelper.neq,h,d),this.greaterThanOp=(h,d)=>Ao(this.arithmeticHelper.gt,h,d),this.lessThanOp=(h,d)=>Ao(this.arithmeticHelper.lt,h,d),this.greaterThanOrEqualOp=(h,d)=>Ao(this.arithmeticHelper.geq,h,d),this.lessThanOrEqualOp=(h,d)=>Ao(this.arithmeticHelper.leq,h,d),this.concatOp=(h,d)=>Ao(this.arithmeticHelper.concat,K1(h),K1(d)),this.plusOp=(h,d)=>Ao(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.minusOp=(h,d)=>Ao(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.timesOp=(h,d)=>Ao(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.powerOp=(h,d)=>Ao(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.divOp=(h,d)=>Ao(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.unaryMinusOp=h=>TY(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.percentOp=h=>TY(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.unaryPlusOp=h=>this.arithmeticHelper.unaryPlus(h),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new E3e(e)}evaluateAst(e,t){let r=this.evaluateAstWithoutPostprocessing(e,t);if(It(r)){if(iZ(ge(r)))return new b(M.NUM,H.NaN);r=n$(r,sZ(ge(r)))}return r instanceof Ne&&r.height()===1&&r.width()===1&&([[r]]=r.data),N3e(r,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case O.EMPTY:return ut;case O.CELL_REFERENCE:{const r=e.reference.toSimpleCellAddress(t.formulaAddress);return Cs(r)?new b(M.REF,H.BadRef):this.dependencyGraph.getCellValue(r)}case O.NUMBER:case O.STRING:return e.value;case O.CONCATENATE_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,i,t)}case O.EQUALS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,r,i,t)}case O.NOT_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,r,i,t)}case O.GREATER_THAN_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,r,i,t)}case O.LESS_THAN_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,r,i,t)}case O.GREATER_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,r,i,t)}case O.LESS_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,r,i,t)}case O.PLUS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,r,i,t)}case O.MINUS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,r,i,t)}case O.TIMES_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,r,i,t)}case O.POWER_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,r,i,t)}case O.DIV_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,r,i,t)}case O.PLUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,r,t)}case O.MINUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,r,t)}case O.PERCENT_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,r,t)}case O.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!_r.functionIsProtected(e.procedureName))return new b(M.LIC,H.LicenseKey(this.config.licenseKeyValidityState));const r=this.functionRegistry.getFunction(e.procedureName);return r!==void 0?r(e,new Ql(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new b(M.NAME,H.FunctionName(e.procedureName))}case O.NAMED_EXPRESSION:{const r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return r?this.dependencyGraph.getCellValue(r.address):new b(M.NAME,H.NamedExpressionName(e.expressionName))}case O.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new b(M.REF,H.RangeManySheets);const r=xe.fromCellRange(e,t.formulaAddress),i=this.dependencyGraph.getArray(r);if(i){const s=i.array;if(s instanceof qw)throw new Error("Array should be already computed");if(s instanceof b)return s;if(s instanceof Yp)return Ne.fromRange(s.raw(),r,this.dependencyGraph);throw new Error("Unknown array")}else return Ne.onlyRange(r,this.dependencyGraph)}case O.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new b(M.REF,H.RangeManySheets);const r=ic.fromColumnRange(e,t.formulaAddress);return Ne.onlyRange(r,this.dependencyGraph)}case O.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new b(M.REF,H.RangeManySheets);const r=sc.fromRowRangeAst(e,t.formulaAddress);return Ne.onlyRange(r,this.dependencyGraph)}case O.PARENTHESIS:return this.evaluateAst(e.expression,t);case O.ARRAY:{let r;const i=[];for(const s of e.args){let o;const a=[];for(const u of s){const c=nZ(this.evaluateAst(u,t)),h=c.height();if(o===void 0)o=h,a.push(...c.data);else if(o===h)for(let d=0;d<h;d++)a[d].push(...c.data[d]);else return new b(M.REF,H.SizeMismatch)}const l=a[0].length;if(r===void 0)r=l,i.push(...a);else if(r===l)i.push(...a);else return new b(M.REF,H.SizeMismatch)}return Ne.onlyValues(i)}case O.ERROR_WITH_RAW_INPUT:case O.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,r){var i;if(t instanceof Ne&&!r.arraysFlag&&(t=(i=nb(t,r))!==null&&i!==void 0?i:new b(M.VALUE,H.ScalarExpected)),t instanceof b)return t;if(t instanceof Ne){const s=t.data.map(o=>o.map(e));return Ne.onlyValues(s)}return e(t)}binaryRangeWrapper(e,t,r,i){var s,o;if(t instanceof Ne&&!i.arraysFlag&&(t=(s=nb(t,i))!==null&&s!==void 0?s:new b(M.VALUE,H.ScalarExpected)),t instanceof b)return t;if(r instanceof Ne&&!i.arraysFlag&&(r=(o=nb(r,i))!==null&&o!==void 0?o:new b(M.VALUE,H.ScalarExpected)),r instanceof b)return r;if(t instanceof Ne||r instanceof Ne){if(!(t instanceof Ne))if(r.isAdHoc()){const c=r.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)c[h][d]=e(t,c[h][d]);return Ne.onlyValues(c)}else t=Ne.fromScalar(t);if(!(r instanceof Ne))if(t.isAdHoc()){const c=t.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)c[h][d]=e(c[h][d],r);return Ne.onlyValues(c)}else r=Ne.fromScalar(r);if(t.width()===r.width()&&t.height()===r.height()){if(t.isAdHoc()){const c=t.data,h=r.data;for(let d=0;d<c.length;d++)for(let f=0;f<c[0].length;f++)c[d][f]=e(c[d][f],h[d][f]);return Ne.onlyValues(c)}if(r.isAdHoc()){const c=t.data,h=r.data;for(let d=0;d<c.length;d++)for(let f=0;f<c[0].length;f++)h[d][f]=e(c[d][f],h[d][f]);return Ne.onlyValues(h)}}const a=Math.max(t.width(),r.width()),l=Math.max(t.height(),r.height()),u=Array(l);for(let c=0;c<l;c++)u[c]=Array(a);for(let c=0;c<l;c++){const h=t.height()!==1?c:0,d=r.height()!==1?c:0;for(let f=0;f<a;f++){const m=t.width()!==1?f:0,g=r.width()!==1?f:0;h<t.height()&&d<r.height()&&m<t.width()&&g<r.width()?u[c][f]=e(t.data[h][m],r.data[d][g]):u[c][f]=new b(M.NA)}}return Ne.onlyValues(u)}return e(t,r)}}function TY(n,e){return e instanceof b?e:n(e)}function Ao(n,e,t){return e instanceof b?e:t instanceof b?t:n(e,t)}function N3e(n,e){return n instanceof b&&e!==void 0?n.attachRootVertex(e):n}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class M3e{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(r=>r.performEagerTransformations(e,t))}transformSingleAst(e,t){let[r,i]=[e,t];return this.transformations.forEach(s=>{[r,i]=s.transformSingleAst(r,i)}),[r,i]}isIrreversible(){return!0}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class I3e{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new M3e(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,r){this.stats.start(Ge.TRANSFORM_ASTS_POSTPONED);for(let s=r;s<this.transformations.length;s++){const o=this.transformations[s];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(s,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[a,l]=o.transformSingleAst(e,t);e=a,t=l}const i=this.parser.rememberNewAst(e);return this.stats.end(Ge.TRANSFORM_ASTS_POSTPONED),[i,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let r=e;r<this.transformations.length;r++){const i=this.transformations[r];(!t||t(i))&&(yield i)}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const rb=-1;function O3e(n,e,{searchCoordinate:t,orderingDirection:r,matchExactly:i},s){const o=e.start[t],a=t==="col"?e.effectiveEndColumn(s):e.effectiveEndRow(s),l=t==="col"?d=>ge(s.getCellValue(ve(e.sheet,d,e.start.row))):d=>ge(s.getCellValue(ve(e.sheet,e.start.col,d))),u=r==="asc"?(d,f)=>bY(d,f):(d,f)=>-bY(d,f),c=_3e(d=>u(n,l(d))>=0,o,a),h=l(c);return c===rb||typeof h!=typeof n||i&&h!==n?rb:c-o}function _3e(n,e,t){let r=e,i=t;for(;r<i;){const s=Math.ceil((r+i)/2);n(s)?r=s:i=s-1}return r===i&&n(r)?r:rb}function bY(n,e){return typeof n==typeof e?n===ut?0:n<e?-1:n>e?1:0:n===ut?-1:e===ut?1:e instanceof b||typeof n=="number"&&typeof e=="string"||typeof n=="number"&&typeof e=="boolean"?-1:typeof n=="string"&&typeof e=="number"?1:typeof n=="string"&&typeof e=="boolean"?-1:1}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class CZ{constructor(e){this.dependencyGraph=e}advancedFind(e,t){let r;const i=t.range;i===void 0?r=t.valuesFromTopLeftCorner():r=this.dependencyGraph.computeListOfValuesInRange(i);for(let s=0;s<r.length;s++)if(e(ge(r[s])))return s;return-1}basicFind(e,t,r,{ordering:i,matchExactly:s}){const o=typeof e=="string"?$y(e):e,a=t.range;return a===void 0?this.findNormalizedValue(o,t.valuesFromTopLeftCorner()):i==="none"?this.findNormalizedValue(o,this.dependencyGraph.computeListOfValuesInRange(a)):O3e(o,a,{searchCoordinate:r,orderingDirection:i,matchExactly:s},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(ge).map(r=>typeof r=="string"?$y(r):r).indexOf(e)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class EZ extends CZ{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,i){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class yf{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new EZ(e)}add(e,t){if(!(e===ut||e instanceof b))if(e instanceof Ne)for(const[r,i]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(ge(r),i);else this.addSingleCellValue(e,t)}remove(e,t){if(e!==void 0)if(e instanceof Ne)for(const[r,i]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(ge(r),i);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(const t of e)t.oldValue!==void 0&&this.change(ge(t.oldValue),ge(t.value),t.address)}moveValues(e,t,r,i){for(const[s,o]of e){const a=XGe(o,i,t,r);this.remove(s,o),this.add(s,a)}}removeValues(e){for(const[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,matchExactly:i}){const s=i===!0?"findFirst":"findLast",o=this.findUsingColumnIndex(e,t,s);return o!==void 0?o:this.binarySearchStrategy.find(e,t,{ordering:r,matchExactly:i})}findUsingColumnIndex(e,t,r){const i=t.range;if(i===void 0)return;this.ensureRecentData(i.sheet,i.start.col,e);const s=this.getColumnMap(i.sheet,i.start.col);if(!s)return-1;const o=typeof e=="string"?$y(e):e,a=s.get(o);if(!a||!a.index||a.index.length===0)return;const l=yf.findRowBelongingToRange(a,i,r);return l!==void 0?l-i.start.row:void 0}static findRowBelongingToRange(e,t,r){const i=t.start.row,s=t.end.row,o=r==="findFirst"?tf(i,e.index,"upperBound"):tf(s,e.index,"lowerBound");if(o===-1)return;const a=e.index[o];return a>=i&&a<=s?a:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const r=this.index.get(e);let i=r[t];return i||(i=new Map,r[t]=i),i}getValueIndex(e,t,r){const i=this.getColumnMap(e,t);let s=this.getColumnMap(e,t).get(r);return s||(s={version:this.transformingService.version(),index:[]},i.set(r,s)),s}ensureRecentData(e,t,r){const i=this.getValueIndex(e,t,r),s=this.transformingService.version();if(i.version===s)return;const o=this.transformingService.getTransformationsFrom(i.version,a=>a.sheet===e&&(a instanceof J1||a instanceof eL));for(const a of o)a instanceof J1?this.addRows(t,a.rowsSpan,r):a instanceof eL&&this.removeRows(t,a.rowsSpan,r);i.version=s}addSingleCellValue(e,t){this.stats.measure(Ge.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),typeof e=="string"&&(e=$y(e));const r=this.getValueIndex(t.sheet,t.col,e);yf.addValue(r,t.row)})}removeSingleValue(e,t){this.stats.measure(Ge.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const r=this.getColumnMap(t.sheet,t.col);typeof e=="string"&&(e=$y(e));const i=r.get(e);if(!i)return;const s=tf(t.row,i.index);s>-1&&i.index.splice(s,1),i.index.length===0&&r.delete(e),r.size===0&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,r){const i=this.getValueIndex(t.sheet,e,r);yf.shiftRows(i,t.rowStart,t.numberOfRows)}removeRows(e,t,r){const i=this.getValueIndex(t.sheet,e,r);yf.removeRowsFromValues(i,t),yf.shiftRows(i,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const r=tf(t,e.index,"lowerBound");e.index[r]===t||e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){const r=tf(t.rowStart,e.index,"upperBound"),i=tf(t.rowEnd,e.index,"lowerBound");r>-1&&i>-1&&r<=i&&e.index[r]<=t.rowEnd&&e.index.splice(r,i-r+1)}static shiftRows(e,t,r){const i=tf(t,e.index,"upperBound");if(i!==-1)for(let s=i;s<e.index.length;++s)e.index[s]+=r}}function tf(n,e,t="upperBound"){let r=0,i=e.length-1;for(;r<=i;){const a=Math.floor((r+i)/2);if(n>e[a])r=a+1;else if(n<e[a])i=a-1;else return a}const s=t==="lowerBound"?i:r;return s>=0&&s<=e.length?s:-1}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function P3e(n,e,t){return e.useColumnIndex?new yf(n,e,t):new EZ(n)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class x3e{constructor(e){this.config=e;const t=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,r=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${r}\\d+)|(\\d+(${t}\\d{3,})*(${r}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);return isNaN(t)?void 0:t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class u${constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof Wl){const r=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(r.procedureName==="HYPERLINK")return r.hyperlink}}getCellFormula(e,t){const r=this.dependencyGraph.getCell(e);if(r instanceof Wl){const i=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=t??e,this.unparser.unparse(i,t)}else if(r instanceof nr){const i=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(i.row!==e.row||i.col!==e.col||i.sheet!==e.sheet)return;t=t??e;const s=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(s!==void 0)return this.unparser.unparse(s,t)}else if(r instanceof Ep)return r.getFormula()}getCellSerialized(e,t){var r;return(r=this.getCellFormula(e,t))!==null&&r!==void 0?r:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,t=>this.getCellValue(t))}getSheetFormulas(e){return this.genericSheetGetter(e,t=>this.getCellFormula(t))}genericSheetGetter(e,t){const r=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),s=new Array(r);for(let o=0;o<r;o++){s[o]=new Array(i);for(let a=0;a<i;a++){const l=ve(e,a,o);s[o][a]=t(l)}for(let a=i-1;a>=0&&(s[o][a]===null||s[o][a]===void 0);a--)s[o].pop()}for(let o=r-1;o>=0&&s[o].length===0;o--)s.pop();return s}genericAllSheetsGetter(e){const t={};for(const r of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(i)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,t=>this.getCellSerialized(t))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const r of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(r);e[i]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(r=>({name:r.expression.displayName,expression:this.getCellSerialized(r.expression.address),scope:r.scope!==void 0?e[r.scope]:void 0,options:r.expression.options}))}withNewConfig(e,t){const r=new DQ(e,t$(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new u$(this.dependencyGraph,r,this.exporter)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class JR{static buildFromSheets(e,t={},r=[]){const i=new ii(t);return this.buildEngine(i,e,r)}static buildFromSheet(e,t={},r=[]){const i=new ii(t),s=i.translationPackage.getUITranslation(VS.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,{[s]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new ii(e),{},t)}static rebuildWithConfig(e,t,r,i){return this.buildEngine(e,t,r,i)}static buildEngine(e,t={},r=[],i=e.useStats?new VQ:new TGe){i.start(Ge.BUILD_ENGINE_TOTAL);const s=new rg,o=new _r(e),a=new I3e(i),l=a$.buildEmpty(a,e,o,s,i),u=P3e(l,e,i),c=l.sheetMapping,h=l.addressMapping;for(const J in t)if(Object.prototype.hasOwnProperty.call(t,J)){const q=t[J];gZ(q);const ie=cA(q);if(ie.height>e.maxRows||ie.width>e.maxColumns)throw new kf;const fe=c.addSheet(J);h.autoAddSheet(fe,ie)}const d=new ky(e,o,c.get);a.parser=d;const f=new DQ(e,t$(e),c.fetchDisplayName,s),m=new wYe(e),g=new x3e(e),C=new eYe(e,m,g),y=new VYe(e,m,g),w=new aYe(e,o),S=new KYe(e,l,u,y,d,i,a,s,w),E=new p3e(e,S);a.undoRedo=E;const P=new $Ye(e,l,S),_=new v3e(e,S,E,P,l,u,d,y,a,s);r.forEach(J=>{_.ensureItIsPossibleToAddNamedExpression(J.name,J.expression,J.scope),_.operations.addNamedExpression(J.name,J.expression,J.scope,J.options)});const I=new y3e(e,s,c.fetchDisplayName,a),D=new u$(l,f,I),Q=new A3e(e,l,u,i,C,o,s,D,w,m);i.measure(Ge.GRAPH_BUILD,()=>{new S3e(l,u,d,y,i,w).buildGraph(t,i)});const F=new w3e(e,i,Q,a,l,u);return F.run(),i.end(Ge.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:l,columnSearch:u,parser:d,unparser:f,cellContentParser:y,evaluator:F,lazilyTransformingAstService:a,crudOperations:_,exporter:I,namedExpressions:s,serialization:D,functionRegistry:o}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function L3e(n){for(const[e,t]of Object.entries(n))t instanceof Function?n[e]=H3e(t):delete n[e]}function H3e(n){return()=>{throw new Error(`The "${n}" method cannot be called because this HyperFormula instance has been destroyed`)}}var RZ={exports:{}};function c$(){}c$.prototype={on:function(n,e,t){var r=this.e||(this.e={});return(r[n]||(r[n]=[])).push({fn:e,ctx:t}),this},once:function(n,e,t){var r=this;function i(){r.off(n,i),e.apply(t,arguments)}return i._=e,this.on(n,i,t)},emit:function(n){var e=[].slice.call(arguments,1),t=((this.e||(this.e={}))[n]||[]).slice(),r=0,i=t.length;for(r;r<i;r++)t[r].fn.apply(t[r].ctx,e);return this},off:function(n,e){var t=this.e||(this.e={}),r=t[n],i=[];if(r&&e)for(var s=0,o=r.length;s<o;s++)r[s].fn!==e&&r[s].fn._!==e&&i.push(r[s]);return i.length?t[n]=i:delete t[n],this}};RZ.exports=c$;var D3e=RZ.exports.TinyEmitter=c$;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var xl;(function(n){n.SheetAdded="sheetAdded",n.SheetRemoved="sheetRemoved",n.SheetRenamed="sheetRenamed",n.NamedExpressionAdded="namedExpressionAdded",n.NamedExpressionRemoved="namedExpressionRemoved",n.ValuesUpdated="valuesUpdated",n.EvaluationSuspended="evaluationSuspended",n.EvaluationResumed="evaluationResumed"})(xl||(xl={}));class F3e extends D3e{emit(e,...t){return super.emit(e,...t),this}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ci{constructor(e,t,r,i,s,o,a,l,u,c,h,d,f,m){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=i,this._parser=s,this._unparser=o,this._cellContentParser=a,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=c,this._exporter=h,this._namedExpressions=d,this._serialization=f,this._functionRegistry=m,this._emitter=new F3e,this._evaluationSuspended=!1}static get defaultConfig(){return k3e()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(JR.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(JR.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(JR.buildEmpty(e,t))}static getLanguage(e){ue(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(t===void 0)throw new j1;return t}static registerLanguage(e,t){if(ue(e,"string","languageCode"),this.registeredLanguages.has(e))throw new JQ;this.registeredLanguages.set(e,kGe(t))}static unregisterLanguage(e){if(ue(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new j1}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){_r.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){_r.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){ue(e,"string","functionId"),_r.registerFunction(e,t,r)}static unregisterFunction(e){ue(e,"string","functionId"),_r.unregisterFunction(e)}static unregisterAllFunctions(){_r.unregisterAll()}static getRegisteredFunctionNames(e){ue(e,"string","code");const t=_r.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return ue(e,"string","functionId"),_r.getFunctionPlugin(e)}static getAllFunctionPlugins(){return _r.getPlugins()}static buildFromEngineState(e){return new ci(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return ue(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return ue(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return ue(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return ue(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([r,i])=>this._config[r]===i)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(Bn(e))t=new xe(e,e);else if(js(e))t=new xe(e.start,e.end);else throw new Mt("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(t);for(const r of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(r)}catch{return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return ue(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){ue(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch{return!1}}setRowOrder(e,t){ue(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}isItPossibleToSetRowOrder(e,t){ue(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch{return!1}}swapColumnIndexes(e,t){return ue(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){ue(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch{return!1}}setColumnOrder(e,t){ue(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}isItPossibleToSetColumnOrder(e,t){ue(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch{return!1}}isItPossibleToAddRows(e,...t){ue(e,"number","sheetId");const r=dA(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...r),!0}catch{return!1}}addRows(e,...t){return ue(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){ue(e,"number","sheetId");const r=hA(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...r),!0}catch{return!1}}removeRows(e,...t){return ue(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){ue(e,"number","sheetId");const r=dA(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...r),!0}catch{return!1}}addColumns(e,...t){return ue(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){ue(e,"number","sheetId");const r=hA(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...r),!0}catch{return!1}}removeColumns(e,...t){return ue(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!Bn(t))throw new Mt("SimpleCellAddress","destinationLeftCorner");if(!js(e))throw new Mt("SimpleCellRange","source");try{const r=new xe(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch{return!1}}moveCells(e,t){if(!Bn(t))throw new Mt("SimpleCellAddress","destinationLeftCorner");if(!js(e))throw new Mt("SimpleCellRange","source");const r=new xe(e.start,e.end);return this._crudOperations.moveCells(r.start,r.width(),r.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,r,i){ue(e,"number","sheetId"),ue(t,"number","startRow"),ue(r,"number","numberOfRows"),ue(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,i),!0}catch{return!1}}moveRows(e,t,r,i){return ue(e,"number","sheetId"),ue(t,"number","startRow"),ue(r,"number","numberOfRows"),ue(i,"number","targetRow"),this._crudOperations.moveRows(e,t,r,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,i){ue(e,"number","sheetId"),ue(t,"number","startColumn"),ue(r,"number","numberOfColumns"),ue(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,i),!0}catch{return!1}}moveColumns(e,t,r,i){return ue(e,"number","sheetId"),ue(t,"number","startColumn"),ue(r,"number","numberOfColumns"),ue(i,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,i),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!js(e))throw new Mt("SimpleCellRange","source");const t=new xe(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!js(e))throw new Mt("SimpleCellRange","source");const t=new xe(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!Bn(e))throw new Mt("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!js(e))throw new Mt("SimpleCellRange","source");return new xe(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellValue(i)))}getRangeFormulas(e){if(!js(e))throw new Mt("SimpleCellRange","source");return new xe(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellFormula(i)))}getRangeSerialized(e){if(!js(e))throw new Mt("SimpleCellRange","source");return new xe(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellSerialized(i)))}getFillRangeData(e,t,r=!1){if(!js(e))throw new Mt("SimpleCellRange","source");if(!js(t))throw new Mt("SimpleCellRange","target");const i=new xe(e.start,e.end),s=new xe(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),s.arrayOfAddressesInRange().map(o=>o.map(a=>{const l=((a.row-(r?t:e).start.row)%i.height()+i.height())%i.height()+e.start.row,u=((a.col-(r?t:e).start.col)%i.width()+i.width())%i.width()+e.start.col;return this._serialization.getCellSerialized({row:l,col:u,sheet:i.sheet},a)}))}isItPossibleToAddSheet(e){ue(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&ue(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(xl.SheetAdded,t),t}isItPossibleToRemoveSheet(e){ue(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){ue(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(xl.SheetRemoved,t,r),r}isItPossibleToClearSheet(e){ue(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return ue(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){ue(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch{return!1}}setSheetContent(e,t){return ue(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return ue(e,"string","cellAddress"),ue(t,"number","sheetId"),_1(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return ue(e,"string","cellRange"),ue(t,"number","sheetId"),T2e(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");return ue(t,"number","sheetId"),z0(this.sheetMapping.fetchDisplayName,e,t)}simpleCellRangeToString(e,t){if(!js(e))throw new Mt("SimpleCellRange","cellRange");return ue(t,"number","sheetId"),b2e(this.sheetMapping.fetchDisplayName,e,t)}getCellDependents(e){let t;if(Bn(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(js(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Mt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(Bn(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(js(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Mt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return ue(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return ue(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return ue(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return WGe(t,e)}doesCellHaveSimpleValue(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");return this.getCellType(e)===vs.VALUE}doesCellHaveFormula(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===vs.FORMULA||t===vs.ARRAYFORMULA}isCellEmpty(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");return this.getCellType(e)===vs.EMPTY}isCellPartOfArray(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===vs.ARRAY||t===vs.ARRAYFORMULA}getCellValueType(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return oA(t)}getCellValueDetailedType(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return zGe(t)}getCellValueFormat(e){if(!Bn(e))throw new Mt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return GGe(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){ue(e,"number","sheetId"),ue(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch{return!1}}renameSheet(e,t){ue(e,"number","sheetId"),ue(t,"string","newName");const r=this._crudOperations.renameSheet(e,t);r!==void 0&&this._emitter.emit(xl.SheetRenamed,r,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(xl.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(xl.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){ue(e,"string","expressionName"),r!==void 0&&ue(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch{return!1}}addNamedExpression(e,t,r,i){ue(e,"string","expressionName"),r!==void 0&&ue(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,i);const s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(xl.NamedExpressionAdded,e,s),s}getNamedExpressionValue(e,t){ue(e,"string","expressionName"),t!==void 0&&ue(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r)return this._serialization.getCellValue(r.address)}getNamedExpressionFormula(e,t){ue(e,"string","expressionName"),t!==void 0&&ue(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r!==void 0)return this._serialization.getCellFormula(r.address)}getNamedExpression(e,t){ue(e,"string","expressionName"),t!==void 0&&ue(t,"number","scope");const r=this._namedExpressions.namedExpressionForScope(e,t);if(r===void 0)return;const i=this._serialization.getCellFormula(r.address);return{name:e,scope:t,expression:i,options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){ue(e,"string","expressionName"),r!==void 0&&ue(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch{return!1}}changeNamedExpression(e,t,r,i){return ue(e,"string","expressionName"),r!==void 0&&ue(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){ue(e,"string","expressionName"),t!==void 0&&ue(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch{return!1}}removeNamedExpression(e,t){ue(e,"string","expressionName"),t!==void 0&&ue(t,"number","scope");const r=this._crudOperations.removeNamedExpression(e,t);if(r){const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(xl.NamedExpressionRemoved,r.displayName,i),i}else return[]}listNamedExpressions(e){return e!==void 0&&ue(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){ue(e,"string","formulaString");const{ast:t,address:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new eb;return this._unparser.unparse(t,r)}calculateFormula(e,t){ue(e,"string","formulaString"),ue(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:r,address:i,dependencies:s}=this.extractTemporaryFormula(e,t);if(r===void 0)throw new eb;const o=this.evaluator.runAndForget(r,i,s);return this._exporter.exportScalarOrRange(o)}getNamedExpressionsFromFormula(e){ue(e,"string","formulaString");const{ast:t,dependencies:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new eb;const i=r.filter(o=>o instanceof ec).map(o=>o.name);return[...new Set(i)]}validateFormula(e){ue(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return t!==void 0}getRegisteredFunctionNames(){return ci.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return ue(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return ue(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return ue(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return ue(e,"number","val"),Rp(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){L3e(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new QQ}extractTemporaryFormula(e,t=1){const r=this._cellContentParser.parse(e),i={sheet:t,col:0,row:0};if(!(r instanceof Cn.Formula))return{address:i,dependencies:[]};const{ast:s,errors:o,dependencies:a}=this._parser.parse(r.formula,i);return o.length>0?{address:i,dependencies:[]}:{ast:s,address:i,dependencies:a}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),s=this._serialization.getAllNamedExpressionsSerialized(),o=JR.rebuildWithConfig(t,i,s,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(xl.ValuesUpdated,r),r}}}ci.version="2.7.1";ci.buildDate="18/07/2024 11:23:17";ci.releaseDate="18/07/2024";ci.languages={};ci.registeredLanguages=new Map;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const AY=new WeakMap;class ii{constructor(e={},t=!0){const{accentSensitive:r,binarySearchThreshold:i,caseSensitive:s,caseFirst:o,chooseAddressMappingPolicy:a,context:l,currencySymbol:u,dateFormats:c,decimalSeparator:h,evaluateNullToZero:d,functionArgSeparator:f,functionPlugins:m,ignorePunctuation:g,leapYear1900:C,localeLang:y,language:w,ignoreWhiteSpace:S,licenseKey:E,matchWholeCell:P,arrayColumnSeparator:_,arrayRowSeparator:I,maxRows:D,maxColumns:Q,nullYear:F,nullDate:J,parseDateTime:q,precisionEpsilon:ie,precisionRounding:fe,stringifyDateTime:Ee,stringifyDuration:ke,smartRounding:be,timeFormats:re,thousandSeparator:ae,useArrayArithmetic:le,useStats:ye,undoLimit:ze,useColumnIndex:et,useRegularExpressions:v,useWildcards:R}=e;t&&ii.warnDeprecatedOptions(e),this.useArrayArithmetic=Ut(le,"boolean","useArrayArithmetic"),this.accentSensitive=Ut(r,"boolean","accentSensitive"),this.caseSensitive=Ut(s,"boolean","caseSensitive"),this.caseFirst=Ut(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=Ut(g,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=a??ii.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...YR(c,Array.isArray,"array","dateFormats")],this.timeFormats=[...YR(re,Array.isArray,"array","timeFormats")],this.functionArgSeparator=Ut(f,"string","functionArgSeparator"),this.decimalSeparator=Ut(h,[".",","],"decimalSeparator"),this.language=Ut(w,"string","language"),this.ignoreWhiteSpace=Ut(S,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=Ut(E,"string","licenseKey"),this.thousandSeparator=Ut(ae,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=Ut(_,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=Ut(I,[";","|"],"arrayRowSeparator"),this.localeLang=Ut(y,"string","localeLang"),this.functionPlugins=[...m??ii.defaultConfig.functionPlugins],this.smartRounding=Ut(be,"boolean","smartRounding"),this.evaluateNullToZero=Ut(d,"boolean","evaluateNullToZero"),this.nullYear=Ut(F,"number","nullYear"),hm(this.nullYear,"nullYear",0),lYe(this.nullYear,"nullYear",100),this.precisionRounding=Ut(fe,"number","precisionRounding"),hm(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=Ut(ie,"number","precisionEpsilon"),hm(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=Ut(et,"boolean","useColumnIndex"),this.useStats=Ut(ye,"boolean","useStats"),this.binarySearchThreshold=i??ii.defaultConfig.binarySearchThreshold,this.parseDateTime=Ut(q,"function","parseDateTime"),this.stringifyDateTime=Ut(Ee,"function","stringifyDateTime"),this.stringifyDuration=Ut(ke,"function","stringifyDuration"),this.translationPackage=ci.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=YR(J,Uy,"IDate","nullDate"),this.leapYear1900=Ut(C,"boolean","leapYear1900"),this.undoLimit=Ut(ze,"number","undoLimit"),this.useRegularExpressions=Ut(v,"boolean","useRegularExpressions"),this.useWildcards=Ut(R,"boolean","useWildcards"),this.matchWholeCell=Ut(P,"boolean","matchWholeCell"),hm(this.undoLimit,"undoLimit",0),this.maxRows=Ut(D,"number","maxRows"),hm(this.maxRows,"maxRows",1),this.maxColumns=Ut(Q,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(u),hm(this.maxColumns,"maxColumns",1),this.context=l,AY.set(this,{licenseKeyValidityState:LYe(this.licenseKey)}),hY({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),hY({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...YR(e,Array.isArray,"array","currencySymbol")];return t.forEach(r=>{if(typeof r!="string")throw new Mt("string[]","currencySymbol");if(r==="")throw new AGe("currencySymbol")}),t}get licenseKeyValidityState(){return AY.get(this).licenseKeyValidityState}getConfig(){return TZ(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return ii.warnDeprecatedOptions(e),new ii(t,!1)}static warnDeprecatedOptions(e){ii.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,r,i){e!==void 0&&console.warn(i===void 0?`${t} option is deprecated since ${r}`:`${t} option is deprecated since ${r}, please use ${i}`)}}ii.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new EYe,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:fYe,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:OYe,stringifyDuration:IYe,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function TZ(n){var e;const t={};for(const r in ii.defaultConfig){const i=(e=n[r])!==null&&e!==void 0?e:ii.defaultConfig[r];Array.isArray(i)?t[r]=[...i]:t[r]=i}return t}function k3e(){return TZ({})}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const nL={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var lh;(function(n){n[n.FullyAbsolute=1]="FullyAbsolute",n[n.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",n[n.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",n[n.FullyRelative=4]="FullyRelative"})(lh||(lh={}));class bZ extends Qe{verifyAddressArguments(e,t,r,i){if(i){if(e<1||t<1)return new b(M.VALUE,H.LessThanOne)}else if(lh.FullyAbsolute==r){if(e<1||t<1)return new b(M.VALUE,H.LessThanOne)}else if(lh.RowAbsoluteColRelative==r){if(e<1)return new b(M.VALUE,H.LessThanOne)}else if(lh.RowRelativeColAbsolute==r&&t<1)return new b(M.VALUE,H.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(r,i,s,o,a)=>{const l=this.verifyAddressArguments(r,i,s,o);if(l!==void 0)return l;const u=FN(i-1);let c="";a!=null&&(c=`${a}!`);const h=i==0?"C":`C[${i}]`,d=r==0?"R":`R[${r}]`;return lh.FullyRelative==s?o?`${c}${u}${r}`:`${c}${d}${h}`:lh.RowRelativeColAbsolute==s?o?`${c}$${u}${r}`:`${c}${d}C${i}`:lh.RowAbsoluteColRelative==s?o?`${c}${u}$${r}`:`${c}R${r}${h}`:o?`${c}$${u}$${r}`:`${c}R${r}C${i}`})}}bZ.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:p.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:p.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class AZ extends Qe{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),r=>r)}arrayformulaArraySize(e,t){if(e.args.length!==1)return gt.error();const r=this.metadata("ARRAYFORMULA");return e.args.map(s=>{var o;return this.arraySizeForAst(s,new Ql(t.formulaAddress,t.arraysFlag||((o=r==null?void 0:r.arrayFunction)!==null&&o!==void 0?o:!1)))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(r,i,s)=>{i=Math.min(i,r.height()),s=Math.min(s,r.width());const o=r.data,a=[];for(let l=0;l<i;l++)a.push(o[l].slice(0,s));return Ne.onlyValues(a)})}arrayconstrainArraySize(e,t){if(e.args.length!==3)return gt.error();const r=this.metadata("ARRAY_CONSTRAIN"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new Ql(t.formulaAddress,t.arraysFlag||((l=r==null?void 0:r.arrayFunction)!==null&&l!==void 0?l:!1)))});let{height:s,width:o}=i[0];return e.args[1].type===O.NUMBER&&(s=Math.min(s,e.args[1].value)),e.args[2].type===O.NUMBER&&(o=Math.min(o,e.args[2].value)),s<1||o<1||!Number.isInteger(s)||!Number.isInteger(o)?gt.error():new gt(o,s)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(r,...i)=>{for(const a of i)if(r.width()!==a.width()||r.height()!==a.height())return new b(M.NA,H.EqualLength);if(r.width()>1&&r.height()>1)return new b(M.NA,H.WrongDimension);const s=r.data,o=[];for(let a=0;a<r.height();a++){const l=[];for(let u=0;u<r.width();u++){let c=!0;for(const h of i)if(rZ(h.data[a][u])!==!0){c=!1;break}c&&l.push(s[a][u])}l.length>0&&o.push(l)}return o.length>0?Ne.onlyValues(o):new b(M.NA,H.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return gt.error();const r=this.metadata("FILTER"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new Ql(t.formulaAddress,t.arraysFlag||((l=r==null?void 0:r.arrayFunction)!==null&&l!==void 0?l:!1)))}),s=Math.max(...i.map(a=>a.width)),o=Math.max(...i.map(a=>a.height));return new gt(s,o)}}AZ.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:p.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:p.RANGE},{argumentType:p.INTEGER,minValue:1},{argumentType:p.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class NZ extends Qe{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}NZ.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const V3e=0xffffffffffff,NY=-53,MY=53;class MZ extends Qe{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),IZ)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),OZ)}}MZ.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:p.INTEGER,minValue:0},{argumentType:p.INTEGER,minValue:NY,maxValue:MY}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:p.INTEGER,minValue:0},{argumentType:p.INTEGER,minValue:NY,maxValue:MY}]}};function IZ(n,e){return e<0?OZ(n,-e):_Z(n*Math.pow(2,e))}function OZ(n,e){return e<0?IZ(n,-e):_Z(Math.floor(n/Math.pow(2,e)))}function _Z(n){return n>V3e?new b(M.NUM,H.BitshiftLong):n}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class PZ extends Qe{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(r,i)=>r&i)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(r,i)=>r|i)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(r,i)=>r^i)}}PZ.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:p.INTEGER,minValue:0},{argumentType:p.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:p.INTEGER,minValue:0},{argumentType:p.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:p.INTEGER,minValue:0},{argumentType:p.INTEGER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class xZ extends Qe{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(r,i,s)=>r?i:s)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...r)=>{for(let i=0;i<r.length;i+=2)if(r[i])return r[i+1];return new b(M.NA,H.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...r)=>r.filter(i=>i!==void 0).every(i=>!!i))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...r)=>r.filter(i=>i!==void 0).some(i=>i))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),r=>!r)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...r)=>{let i=0;return r.filter(s=>s!==void 0).forEach(s=>{s&&i++}),i%2===1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(r,...i)=>{const s=i.length;let o=0;for(;o+1<s;o+=2)if(!(i[o]instanceof b)&&this.arithmeticHelper.eq(r,i[o]))return i[o+1];return o<s?i[o]:new b(M.NA,H.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(r,i)=>r instanceof b?i:r)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(r,i)=>r instanceof b&&r.type===M.NA?i:r)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(r,...i)=>r>i.length?new b(M.NUM,H.Selector):i[r-1])}}xZ.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:p.BOOLEAN},{argumentType:p.SCALAR,passSubtype:!0},{argumentType:p.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:p.BOOLEAN},{argumentType:p.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:p.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:p.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:p.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:p.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:p.NOERROR},{argumentType:p.SCALAR,passSubtype:!0},{argumentType:p.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:p.SCALAR,passSubtype:!0},{argumentType:p.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:p.SCALAR,passSubtype:!0},{argumentType:p.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:p.INTEGER,minValue:1},{argumentType:p.SCALAR,passSubtype:!0}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class LZ extends Qe{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=256?new b(M.VALUE,H.CharacterCodeBounds):String.fromCharCode(Math.trunc(r)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=1114112?new b(M.VALUE,H.CharacterCodeBounds):String.fromCodePoint(Math.trunc(r)))}}LZ.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:p.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class HZ extends Qe{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),r=>r.length===0?new b(M.VALUE,H.EmptyString):r.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),r=>{var i;return(i=r.codePointAt(0))!==null&&i!==void 0?i:new b(M.VALUE,H.EmptyString)})}}HZ.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:p.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:p.STRING}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class DZ extends Qe{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...r)=>{let i=0;return r.forEach(s=>{s===ut&&i++}),i})}}DZ.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:p.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class FZ extends Qe{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...r)=>{const i=new Set,s=new Set;for(const o of r)o instanceof b?s.add(o.type):o!==""&&i.add(o);return i.size+s.size})}}FZ.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:p.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class kZ extends Qe{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),s=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i),o=s+((4-s)%7+7)%7,a=Math.floor((t-1)/7)-Math.floor((o-1)/7)+1;return a===0?this.isoweeknumCore(e-7)+1:a},this.days360Core=(e,t,r)=>{const i=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);let o,a;return r?(o=pY(i),a=pY(s)):[o,a]=this.dateTimeHelper.toBasisUS(i,s),360*(a.year-o.year)+30*(a.month-o.month)+a.day-o.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(r,i,s)=>{const o=Math.trunc(s);let a=Math.trunc(i),l=Math.trunc(r);l<this.dateTimeHelper.getEpochYearZero()&&(l+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((a-1)/12);l+=u,a-=u*12;const c={year:l,month:a,day:1};if(this.dateTimeHelper.isValidDate(c)){let h=this.dateTimeHelper.dateToNumber(c)+(o-1);return h=this.dateTimeHelper.getWithinBounds(h),h===void 0?new b(M.NUM,H.DateBounds):h}return new b(M.VALUE,H.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(r,i,s)=>{const o=Tp({hours:Math.trunc(r),minutes:Math.trunc(i),seconds:Math.trunc(s)});return o<0?new b(M.NUM,H.NegativeTime):o%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(r,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(r);let o=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(mY(s,i)));return o=this.dateTimeHelper.getWithinBounds(o),o===void 0?new b(M.NUM,H.DateBounds):o})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),r=>this.dateTimeHelper.numberToSimpleDate(r).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(r,i)=>Math.trunc(r)-Math.trunc(i))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),r=>this.dateTimeHelper.numberToSimpleDate(r).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),r=>this.dateTimeHelper.numberToSimpleDate(r).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),r=>Rp(X_(r)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),r=>Rp(X_(r)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),r=>Rp(X_(r)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(r,i)=>AYe(r,i,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(r,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r));if(i===3)return(s-1)%7;const o=_Y.get(i);return o===void 0?new b(M.NUM,H.BadMode):(s-o)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(r,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r)),o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.dateToNumber({year:o.year,month:1,day:1}),l=this.dateTimeHelper.relativeNumberToAbsoluteNumber(a);if(i===21)return this.isoweeknumCore(r);const u=_Y.get(i);return u===void 0?new b(M.NUM,H.BadMode):Math.floor((s-u)/7)-Math.floor((l-u)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),r=>{const{dateTime:i}=this.dateTimeHelper.parseDateTimeFromConfigFormats(r);return i===void 0?new b(M.VALUE,H.IncorrectDateTime):Uy(i)?(cZ(i)?Math.trunc(Tp(i)):0)+this.dateTimeHelper.dateToNumber(i):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),r=>{const i=this.dateTimeHelper.dateStringToDateNumber(r);return i===void 0?new b(M.VALUE,H.IncorrectDateTime):ge(i)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const r=new Date(Date.now());return Tp({hours:r.getHours(),minutes:r.getMinutes(),seconds:r.getSeconds()})+this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const r=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(r,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(r),o=SYe(mY(s,i));let a=this.dateTimeHelper.dateToNumber(o);return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new b(M.NUM,H.DateBounds):a})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(r,i,s)=>{if(r>i)return new b(M.NUM,H.StartEndDate);if(s==="D")return Math.floor(i)-Math.floor(r);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);switch(s){case"M":return(a.year-o.year)*12+(a.month-o.month)-(a.day<o.day?1:0);case"YM":return(12+(a.month-o.month)-(a.day<o.day?1:0))%12;case"Y":return a.month>o.month||a.month===o.month&&a.day>=o.day?a.year-o.year:a.year-o.year-1;case"MD":if(a.day>=o.day)return a.day-o.day;{const l=a.month===1?12:a.month-1,u=a.month===1?a.year-1:a.year;return this.dateTimeHelper.daysInMonth(u,l)+a.day-o.day}case"YD":return a.month>o.month||a.month===o.month&&a.day>=o.day?Math.floor(i)-this.dateTimeHelper.dateToNumber({year:a.year,month:o.month,day:o.day}):Math.floor(i)-Math.floor(r)-365*(a.year-o.year-1)-this.dateTimeHelper.leapYearsCount(a.year-1)+this.dateTimeHelper.leapYearsCount(o.year);default:return new b(M.NUM,H.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(r,i,s)=>{switch(r=Math.trunc(r),i=Math.trunc(i),r>i&&([r,i]=[i,r]),s){case 0:return this.days360Core(r,i,!1)/360;case 1:return(i-r)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(r),this.dateTimeHelper.numberToSimpleDate(i));case 2:return(i-r)/360;case 3:return(i-r)/365;case 4:return this.days360Core(r,i,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),r=>{r=Math.trunc(r);const i=r%60;r=Math.trunc(r/60);const s=r%60;r=Math.trunc(r/60);const o=r%24;r=Math.trunc(r/24);const a=r%30;r=Math.trunc(r/30);const l=r%12,u=Math.trunc(r/12);return"P"+(u>0?`${u}Y`:"")+(l>0?`${l}M`:"")+(a>0?`${a}D`:"")+"T"+(o>0?`${o}H`:"")+(s>0?`${s}M`:"")+(i>0?`${i}S`:"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(r,i,s)=>this.networkdayscore(r,i,1,s))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(r,i,s,o)=>this.networkdayscore(r,i,s,o))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(r,i,s)=>this.workdaycore(r,i,1,s))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(r,i,s,o)=>this.workdaycore(r,i,s,o))}networkdayscore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);let s=1;e>t&&([e,t]=[t,e],s=-1);const o=OY(r);if(o instanceof b)return o;const a=this.simpleRangeToFilteredHolidays(o,i);return a instanceof b?a:s*this.countWorkdays(e,t,o,a)}workdaycore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);const s=OY(r);if(s instanceof b)return s;const o=this.simpleRangeToFilteredHolidays(s,i);if(o instanceof b)return o;if(t>0){let a=1;for(;this.countWorkdays(e+1,e+a,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e+1,e+u,s,o)<t?l=u:a=u}return e+a}else if(t<0){t*=-1;let a=1;for(;this.countWorkdays(e-a,e-1,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e-u,e-1,s,o)<t?l=u:a=u}return e-a}else return e}countWorkdays(e,t,r,i){const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let a=0;for(let l=0;l<7;l++)r.charAt(l)==="0"&&(a+=Math.floor((s+6-l)/7),a-=Math.floor((o-1+6-l)/7));return a-=IY(t+1,i)-IY(e,i),a}simpleRangeToFilteredHolidays(e,t){var r;const i=(r=t==null?void 0:t.valuesFromTopLeftCorner())!==null&&r!==void 0?r:[];for(const o of i)if(o instanceof b)return o;const s=[];for(const o of i)if(o!==ut)if(It(o))s.push(Math.trunc(ge(o)));else return new b(M.VALUE,H.WrongType);return[...new Set(s)].sort((o,a)=>o-a).filter(o=>{const l=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(o)-1)%7;return e.charAt(l)==="0"})}}kZ.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER}],returnNumberType:Ae.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER}],returnNumberType:Ae.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:p.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:p.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:p.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:p.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:p.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:p.NUMBER},{argumentType:p.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER}],returnNumberType:Ae.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:p.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:p.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:p.STRING}],returnNumberType:Ae.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:p.STRING}],returnNumberType:Ae.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:Ae.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:Ae.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER}],returnNumberType:Ae.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:p.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.NOERROR,defaultValue:1},{argumentType:p.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER},{argumentType:p.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER},{argumentType:p.NOERROR,defaultValue:1},{argumentType:p.RANGE,optionalArg:!0}]}};function IY(n,e){if(e.length===0||n<=e[0])return 0;if(e[e.length-1]<n)return e.length;let t=0,r=e.length-1;for(;t+1<r;){const i=Math.floor((r+t)/2);e[i]>=n?r=i:t=i}return r}function OY(n){var e;return typeof n!="number"&&typeof n!="string"?new b(M.VALUE,H.WrongType):typeof n=="string"?n.length!==7||!/^(0|1)*$/.test(n)||n==="1111111"?new b(M.NUM,H.WeekendString):n:(e=$3e.get(n))!==null&&e!==void 0?e:new b(M.NUM,H.BadMode)}const _Y=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),$3e=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class VZ extends Qe{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),r=>r*(180/Math.PI))}}VZ.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class $Z extends Qe{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(r,i)=>r===i?1:0)}}$Z.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class UZ extends Qe{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}UZ.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class BZ extends Qe{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),h$)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),rL)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),PY)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),iL)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(r,i,s,o,a,l)=>{if(o>a)return new b(M.NUM,H.EndStartPeriod);let u=0;for(let c=o;c<=a;c++)u+=rL(r,c,i,s,0,l);return u})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(r,i,s,o,a,l)=>{if(o>a)return new b(M.NUM,H.EndStartPeriod);let u=0;for(let c=o;c<=a;c++)u+=PY(r,c,i,s,0,l);return u})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(r,i,s,o,a)=>{if(a===12&&o>s||o>s+1)return new b(M.NUM,H.PeriodLong);if(i>=r)return 0;const l=Math.round((1-Math.pow(i/r,1/s))*1e3)/1e3,u=r*l*a/12;if(o===1)return u;let c=u;for(let h=0;h<o-2;h++)c+=(r-c)*l;return o===s+1?(r-c)*l*(12-a)/12:(r-c)*l})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(r,i,s,o,a)=>{if(o>s)return new b(M.NUM);let l=a/s,u;l>=1?(l=1,o===1?u=r:u=0):u=r*Math.pow(1-l,o-1);const c=r*Math.pow(1-l,o);return Math.max(u-Math.max(i,c),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(r,i)=>{if(i<1)return new b(M.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(r)+(r-Math.trunc(r))*10/i})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(r,i)=>{if(i<1)return new b(M.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(r)+(r-Math.trunc(r))*i/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(r,i)=>(i=Math.trunc(i),Math.pow(1+r/i,i)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(r,i,s,o)=>s===0?new b(M.DIV_BY_ZERO):o*r*(i/s-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(r,i)=>(i=Math.trunc(i),(Math.pow(r+1,1/i)-1)*i))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(r,i,s,o,a)=>r===0?i===0?new b(M.DIV_BY_ZERO):(-s-o)/i:(a&&(i*=1+r),Math.log((i-o*r)/(s*r+i))/Math.log(1+r)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(r,i,s,o,a,l)=>{if(l<=-1)return new b(M.VALUE);const u=1e-7,c=50;let h=l;a=a?1:0;for(let d=0;d<c;d++){if(h<=-1)return new b(M.NUM);let f;if(Math.abs(h)<u)f=s*(1+r*h)+i*(1+h*a)*r+o;else{const g=Math.pow(1+h,r);f=s*g+i*(1/h+a)*(g-1)+o}if(Math.abs(f)<u)return h;let m;if(Math.abs(h)<u)m=s*r+i*a*r;else{const g=Math.pow(1+h,r),C=r*Math.pow(1+h,r-1);m=s*C+i*(1/h+a)*C+i*(-1/(h*h))*(g-1)}h-=f/m}return new b(M.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(r,i,s,o,a)=>(a=a?1:0,r===-1?i===0?new b(M.NUM):new b(M.DIV_BY_ZERO):r===0?-s*i-o:((1-Math.pow(1+r,i))*s*(1+r*a)/r-o)/Math.pow(1+r,i)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(r,i,s)=>i===0||s<0&&i>0||s>0&&i<0?new b(M.NUM):Math.pow(s/i,1/r)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(r,i,s)=>s===0?new b(M.DIV_BY_ZERO):(r-i)/s)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(r,i,s,o)=>o>s?new b(M.NUM):(r-i)*(s-o+1)*2/(s*(s+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new b(M.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new b(M.NUM);const l=360-s*(i-r);return l===0?0:l<0?new b(M.NUM):365*s/l})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new b(M.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new b(M.NUM);const l=360-s*(i-r);return l===0?0:l<0?new b(M.NUM):100*(1-s*(i-r)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new b(M.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);return a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day)?new b(M.NUM):(100-s)*360/(s*(i-r))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(r,i)=>{const s=i.valuesFromTopLeftCorner();for(const o of s)if(o instanceof b)return o;for(const o of s)if(It(o))r*=1+ge(o);else if(o!==ut)return new b(M.VALUE,H.NumberExpected);return r})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(r,...i)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(i);return s instanceof b?s:Z_(r,s)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(r,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(o instanceof b)return o;let a=!1,l=!1;const u=[],c=[];for(const m of o)m>0?(a=!0,u.push(m),c.push(0)):m<0?(l=!0,c.push(m),u.push(0)):(c.push(0),u.push(0));if(!a||!l)return new b(M.DIV_BY_ZERO);const h=o.length,d=Z_(s,u);if(d instanceof b)return d;const f=Z_(i,c);return f instanceof b?f:Math.pow(-d*Math.pow(1+s,h)/f/(1+i),1/(h-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(r,i,s)=>(Math.log(s)-Math.log(i))/Math.log(1+r))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(r,i,s)=>{const o=i.valuesFromTopLeftCorner();for(const d of o)if(typeof d!="number")return new b(M.VALUE,H.NumberExpected);const a=o,l=s.valuesFromTopLeftCorner();for(const d of l)if(typeof d!="number")return new b(M.VALUE,H.NumberExpected);const u=l;if(u.length!==a.length)return new b(M.NUM,H.EqualLength);const c=u.length;let h=0;if(u[0]<0)return new b(M.NUM,H.ValueSmall);for(let d=0;d<c;d++){if(u[d]=Math.floor(u[d]),u[d]<u[0])return new b(M.NUM,H.ValueSmall);h+=a[d]/Math.pow(1+r,(u[d]-u[0])/365)}return h})}}BZ.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0},{argumentType:p.NUMBER,defaultValue:0}],returnNumberType:Ae.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0},{argumentType:p.NUMBER,defaultValue:0}],returnNumberType:Ae.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0},{argumentType:p.NUMBER,defaultValue:0}],returnNumberType:Ae.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0},{argumentType:p.NUMBER,defaultValue:0}],returnNumberType:Ae.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.INTEGER,minValue:1},{argumentType:p.INTEGER,minValue:1},{argumentType:p.INTEGER,minValue:0,maxValue:1}],returnNumberType:Ae.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.INTEGER,minValue:1},{argumentType:p.INTEGER,minValue:1},{argumentType:p.INTEGER,minValue:0,maxValue:1}],returnNumberType:Ae.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.INTEGER,minValue:0},{argumentType:p.INTEGER,minValue:0},{argumentType:p.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:Ae.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.INTEGER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:Ae.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:1}],returnNumberType:Ae.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:1}],returnNumberType:Ae.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0},{argumentType:p.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0},{argumentType:p.NUMBER,defaultValue:0}],returnNumberType:Ae.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0},{argumentType:p.NUMBER,defaultValue:0},{argumentType:p.NUMBER,defaultValue:.1}],returnNumberType:Ae.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER},{argumentType:p.NUMBER}],returnNumberType:Ae.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER}],returnNumberType:Ae.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0}],returnNumberType:Ae.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,greaterThan:0}],returnNumberType:Ae.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,greaterThan:0}],returnNumberType:Ae.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,greaterThan:0}],returnNumberType:Ae.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:p.NUMBER},{argumentType:p.RANGE}],returnNumberType:Ae.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:p.NUMBER},{argumentType:p.ANY}],repeatLastArgs:1,returnNumberType:Ae.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:p.RANGE},{argumentType:p.NUMBER},{argumentType:p.NUMBER}],returnNumberType:Ae.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:p.NUMBER,greaterThan:-1},{argumentType:p.RANGE},{argumentType:p.RANGE}]}};function h$(n,e,t,r,i){if(n===0)return(-t-r)/e;{const s=Math.pow(1+n,e);return(r*n+t*n*s)*(i?1/(1+n):1)/(1-s)}}function rL(n,e,t,r,i,s){const o=h$(n,t,r,i,s);return e===1?n*(s?0:-r):n*(s?iL(n,e-2,o,r,s)-o:iL(n,e-1,o,r,s))}function iL(n,e,t,r,i){if(n===0)return-r-t*e;{const s=Math.pow(1+n,e);return t*(i?1+n:1)*(1-s)/n-r*s}}function PY(n,e,t,r,i,s){return h$(n,t,r,i,s)-rL(n,e,t,r,i,s)}function Z_(n,e){let t=0;for(let r=e.length-1;r>=0;r--){if(t+=e[r],n===-1){if(t===0)continue;return new b(M.DIV_BY_ZERO)}t/=1+n}return t}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class WZ extends Qe{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new b(M.NA,H.WrongArgNumber),r=>{var i;return(i=this.serialization.getCellFormula(r))!==null&&i!==void 0?i:new b(M.NA,H.Formula)})}}WZ.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:p.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class jZ extends Qe{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(r,i)=>(e.hyperlink=r,i??r))}}jZ.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:p.STRING},{argumentType:p.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class zZ extends Qe{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),r=>/^[01]{1,10}$/.test(r))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),r=>r instanceof b&&r.type!==M.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),r=>r instanceof b)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new b(M.NA,H.WrongArgNumber),r=>this.dependencyGraph.addressMapping.getCell(r)instanceof uo)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),r=>r===ut)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),r=>r instanceof b&&r.type==M.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),It)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),r=>typeof r=="boolean")}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),r=>r instanceof b&&(r.type==M.REF||r.type==M.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),r=>typeof r=="string")}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),r=>typeof r!="string")}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,r=>r.col+1)}columns(e,t){if(e.args.length!==1)return new b(M.NA,H.WrongArgNumber);if(e.args.some(i=>i.type===O.EMPTY))return new b(M.NUM,H.EmptyArg);let r=e.args[0];for(;r.type===O.PARENTHESIS;)r=r.expression;if(r.type===O.CELL_RANGE||r.type===O.COLUMN_RANGE)return r.end.col-r.start.col+1;if(r.type===O.CELL_REFERENCE)return 1;if(r.type===O.ROW_RANGE)return this.config.maxColumns;{const i=this.evaluateAst(r,t);return i instanceof Ne?i.width():i instanceof b?i:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,r=>r.row+1)}rows(e,t){if(e.args.length!==1)return new b(M.NA,H.WrongArgNumber);if(e.args.some(i=>i.type===O.EMPTY))return new b(M.NUM,H.EmptyArg);let r=e.args[0];for(;r.type===O.PARENTHESIS;)r=r.expression;if(r.type===O.CELL_RANGE||r.type===O.ROW_RANGE)return r.end.row-r.start.row+1;if(r.type===O.CELL_REFERENCE)return 1;if(r.type===O.COLUMN_RANGE)return this.config.maxRows;{const i=this.evaluateAst(r,t);return i instanceof Ne?i.height():i instanceof b?i:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(r,i,s)=>{var o,a,l,u,c,h;return s<1||i<1?new b(M.VALUE,H.LessThanOne):s>r.width()||i>r.height()?new b(M.NUM,H.ValueLarge):(h=(l=(a=(o=r==null?void 0:r.data)===null||o===void 0?void 0:o[i-1])===null||a===void 0?void 0:a[s-1])!==null&&l!==void 0?l:(c=(u=r==null?void 0:r.data)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c[0])!==null&&h!==void 0?h:new b(M.VALUE,H.CellRangeExpected)})}na(e,t){return new b(M.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,r=>r.sheet+1,r=>{const i=this.dependencyGraph.sheetMapping.get(r);return i!==void 0?i+1:new b(M.NA,H.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new b(M.VALUE,H.CellRefExpected))}}zZ.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:p.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:p.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:p.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:p.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:p.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:p.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:p.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:p.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:p.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:p.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:p.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:p.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:p.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:p.RANGE},{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:p.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:p.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:p.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:p.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class GZ extends Qe{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),r=>r%2===0)}}GZ.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class YZ extends Qe{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),r=>r%2===1)}}YZ.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class KZ extends Qe{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(r,i)=>Math.log(r)/Math.log(i))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}KZ.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:p.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const sL=parseFloat(Math.PI.toFixed(14));class XZ extends Qe{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>sL)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),r=>Math.sqrt(sL*r))}}XZ.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:p.NUMBER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function xY(n,e){return new gt(e.width,n.height)}function J_(n,e,t){return new gt(1+(n.width-e)/t,1+(n.height-e)/t)}class qZ extends Qe{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(r,i)=>{if(!r.hasOnlyNumbers()||!i.hasOnlyNumbers())return new b(M.VALUE,H.NumberRange);if(i.height()!==r.width())return new b(M.VALUE,H.ArrayDimensions);const s=xY(r.size,i.size),o=this.createKernel(function(a,l,u){let c=0;for(let h=0;h<u;++h)c+=a[this.thread.y][h]*l[h][this.thread.x];return c},s)(r.rawNumbers(),i.rawNumbers(),r.width());return Ne.onlyNumbers(o)})}mmultArraySize(e,t){if(e.args.length!==2)return gt.error();const r=this.metadata("MMULT"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new Ql(t.formulaAddress,t.arraysFlag||((l=r==null?void 0:r.arrayFunction)!==null&&l!==void 0?l:!1)))}),[s,o]=i;return xY(s,o)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(r,i,s=i)=>{if(!r.hasOnlyNumbers())return new b(M.VALUE,H.NumberRange);const o=J_(r.size,i,s),a=this.createKernel(function(l,u,c){const h=this.thread.x*c,d=this.thread.y*c;let f=l[d][h];for(let m=0;m<u;m++)for(let g=0;g<u;g++)f=Math.max(f,l[d+m][h+g]);return f},o)(r.rawNumbers(),i,s);return Ne.onlyNumbers(a)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(r,i,s=i)=>{if(!r.hasOnlyNumbers())return new b(M.VALUE,H.NumberRange);const o=J_(r.size,i,s),a=this.createKernel(function(l,u,c){const h=this.thread.x*c,d=this.thread.y*c;let f=l[d][h];for(let S=0;S<u;S++)for(let E=0;E<u;E++)f=Math.max(f,l[d+S][h+E]);let m=l[d][h];for(let S=0;S<u;S++)for(let E=0;E<u;E++)m=Math.min(m,l[d+S][h+E]);const g=u*u;let C=m,y=f,w=42;for(let S=0;S<32;S++){const E=(C+y)/2;let P=0;for(let _=0;_<u;_++)for(let I=0;I<u;I++)l[d+_][h+I]>E&&P++;if(u%2===0)if(P===g/2){w=E;break}else P>g/2?C=E:y=E;else if(P===(g-1)/2){w=E;break}else P>(g-1)/2?C=E:y=E}return w},o)(r.rawNumbers(),i,s);return Ne.onlyNumbers(a)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return gt.error();const r=this.metadata("MAXPOOL"),s=e.args.map(u=>{var c;return this.arraySizeForAst(u,new Ql(t.formulaAddress,t.arraysFlag||((c=r==null?void 0:r.arrayFunction)!==null&&c!==void 0?c:!1)))})[0],o=e.args[1];let a;o.type===O.NUMBER?a=o.value:a=1;let l=a;if(e.args.length===3){const u=e.args[2];u.type===O.NUMBER?l=u.value:l=1}return a>s.width||a>s.height||l>a||(s.width-a)%l!==0||(s.height-a)%l!==0?gt.error():J_(s,a,l)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),r=>{const i=r.rawData(),s=r.size,o=[];for(let a=0;a<s.width;++a){o[a]=[];for(let l=0;l<s.height;++l)o[a][l]=i[l][a]}return Ne.onlyValues(o)})}transposeArraySize(e,t){if(e.args.length!==1)return gt.error();const r=this.metadata("TRANSPOSE"),i=e.args.map(o=>{var a;return this.arraySizeForAst(o,new Ql(t.formulaAddress,t.arraysFlag||((a=r==null?void 0:r.arrayFunction)!==null&&a!==void 0?a:!1)))}),[s]=i;return new gt(s.height,s.width)}createKernel(e,t){return function(...r){const i=[];for(let s=0;s<t.height;++s){i.push([]);for(let o=0;o<t.width;++o)i[s][o]=e.apply({thread:{x:o,y:s}},r)}return i}}}qZ.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:p.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:p.RANGE},{argumentType:p.NUMBER},{argumentType:p.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:p.RANGE},{argumentType:p.NUMBER},{argumentType:p.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class QZ extends Qe{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof b?i:i.length===0?new b(M.NUM,H.OneValue):(i.sort((s,o)=>s-o),i.length%2===0?(i[i.length/2-1]+i[i.length/2])/2:i[Math.floor(i.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return s instanceof b?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new b(M.NUM,H.ValueLarge):s[s.length-i])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return s instanceof b?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new b(M.NUM,H.ValueLarge):s[i-1])})}}QZ.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:p.RANGE},{argumentType:p.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:p.RANGE},{argumentType:p.NUMBER,minValue:1}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ZZ extends Qe{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(r,i)=>i===0?new b(M.DIV_BY_ZERO):r%i)}}ZZ.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function eT(n){return It(n)&&!Number.isFinite(ge(n))?0:n}class Fa{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new Fa(e*e,e,1)}compose(e){return new Fa(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}Fa.empty=new Fa(0,0,0);class d$ extends Qe{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,r=>Math.pow(ge(r),2),fm)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const r=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(i,s)=>Math.max(i,s),ge,tT);return eT(r)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const r=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(i,s)=>Math.min(i,s),ge,tT);return eT(r)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var r;const i=this.reduce(e.args,t,Fa.empty,"_AGGREGATE_A",(s,o)=>s.compose(o),s=>Fa.single(ge(s)),tT);return i instanceof b?i:(r=i.averageValue())!==null&&r!==void 0?r:new b(M.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var r;const i=this.reduceAggregateA(e.args,t);return i instanceof b?i:(r=i.varSValue())!==null&&r!==void 0?r:new b(M.DIV_BY_ZERO)}varpa(e,t){var r;const i=this.reduceAggregateA(e.args,t);return i instanceof b?i:(r=i.varPValue())!==null&&r!==void 0?r:new b(M.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof b)return r;{const i=r.varSValue();return i===void 0?new b(M.DIV_BY_ZERO):Math.sqrt(i)}}stdevpa(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof b)return r;{const i=r.varPValue();return i===void 0?new b(M.DIV_BY_ZERO):Math.sqrt(i)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new b(M.NA,H.WrongArgNumber);const r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:p.NUMBER},t),i=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(i,t);case 2:case 102:return this.doCount(i,t);case 3:case 103:return this.doCounta(i,t);case 4:case 104:return this.doMax(i,t);case 5:case 105:return this.doMin(i,t);case 6:case 106:return this.doProduct(i,t);case 7:case 107:return this.doStdevS(i,t);case 8:case 108:return this.doStdevP(i,t);case 9:case 109:return this.doSum(i,t);case 10:case 110:return this.doVarS(i,t);case 11:case 111:return this.doVarP(i,t);default:return new b(M.VALUE,H.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,Fa.empty,"_AGGREGATE",(r,i)=>r.compose(i),r=>Fa.single(ge(r)),fm)}reduceAggregateA(e,t){return this.reduce(e,t,Fa.empty,"_AGGREGATE_A",(r,i)=>r.compose(i),r=>Fa.single(ge(r)),tT)}doAverage(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof b?i:(r=i.averageValue())!==null&&r!==void 0?r:new b(M.DIV_BY_ZERO)}doVarS(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof b?i:(r=i.varSValue())!==null&&r!==void 0?r:new b(M.DIV_BY_ZERO)}doVarP(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof b?i:(r=i.varPValue())!==null&&r!==void 0?r:new b(M.DIV_BY_ZERO)}doStdevS(e,t){const r=this.reduceAggregate(e,t);if(r instanceof b)return r;{const i=r.varSValue();return i===void 0?new b(M.DIV_BY_ZERO):Math.sqrt(i)}}doStdevP(e,t){const r=this.reduceAggregate(e,t);if(r instanceof b)return r;{const i=r.varPValue();return i===void 0?new b(M.DIV_BY_ZERO):Math.sqrt(i)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(r,i)=>r+i,ge,r=>It(r)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(r,i)=>r+i,ge,r=>r===ut?0:1)}doMax(e,t){const r=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(i,s)=>Math.max(i,s),ge,fm);return eT(r)}doMin(e,t){const r=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(i,s)=>Math.min(i,s),ge,fm);return eT(r)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,ge,fm)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(r,i)=>r*i,ge,fm)}reduce(e,t,r,i,s,o,a){return e.length<1?new b(M.NA,H.WrongArgNumber):e.reduce((l,u)=>{if(l instanceof b)return l;if(u.type===O.CELL_RANGE||u.type===O.COLUMN_RANGE||u.type===O.ROW_RANGE){const h=this.evaluateRange(u,t,r,i,s,o,a);return h instanceof b?h:s(h,l)}let c;if(c=this.evaluateAst(u,t),c instanceof Ne)return Array.from(c.valuesFromTopLeftCorner()).map(a).filter(d=>d!==void 0).map(d=>d instanceof b?d:o(d)).reduce((d,f)=>d instanceof b?d:f instanceof b?f:s(d,f),l);if(u.type===O.CELL_REFERENCE){if(c=a(c),c===void 0)return l}else if(c=this.coerceScalarToNumberOrError(c),c=a(c),c===void 0)return l;return c instanceof b?c:s(l,o(c))},r)}evaluateRange(e,t,r,i,s,o,a){let l;try{l=xe.fromAst(e,t.formulaAddress)}catch(h){if(h instanceof FS)return new b(M.REF,H.RangeManySheets);throw h}const u=this.dependencyGraph.getRange(l.start,l.end);if(u===void 0)throw new Error("Range does not exists in graph");let c=u.getFunctionValue(i);return c===void 0&&(c=this.getRangeValues(i,l,u,o,a).reduce((d,f)=>d instanceof b?d:f instanceof b?f:s(d,f),r),u.setFunctionValue(i,c)),c}getRangeValues(e,t,r,i,s){const o=[],{smallerRangeVertex:a,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let u;if(a!==void 0&&this.dependencyGraph.existsEdge(a,r)){const c=a.getFunctionValue(e);if(c!==void 0)o.push(c);else for(const h of a.range.addresses(this.dependencyGraph)){const d=s(this.dependencyGraph.getScalarValue(h));d instanceof b?o.push(d):d!==void 0&&o.push(i(d))}u=l}else u=t;for(const c of u.addresses(this.dependencyGraph)){const h=s(this.dependencyGraph.getScalarValue(c));h instanceof b?o.push(h):h!==void 0&&o.push(i(h))}return o}}d$.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:p.NUMBER},{argumentType:p.ANY}],repeatLastArgs:1}};d$.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function fm(n){if(It(n)||n instanceof b)return n}function tT(n){return typeof n=="boolean"?Y1(n):It(n)||n instanceof b?n:typeof n=="string"?0:void 0}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class JZ extends Qe{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}JZ.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class eJ extends Qe{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),r=>r*(Math.PI/180))}}eJ.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const jr=10,tJ=255,LY=2,HY=36,U3e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class nJ extends Qe{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(r,i)=>Mu(r,2,i))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(r,i)=>Mu(r,8,i))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(r,i)=>Mu(r,16,i))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),r=>{const i=Tl(r,2,jr);return i===void 0?new b(M.NUM,H.NotBinary):Iu(i,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(r,i)=>{const s=Tl(r,2,jr);return s===void 0?new b(M.NUM,H.NotBinary):Mu(Iu(s,2),8,i)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(r,i)=>{const s=Tl(r,2,jr);return s===void 0?new b(M.NUM,H.NotBinary):Mu(Iu(s,2),16,i)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),r=>{const i=Tl(r,8,jr);return i===void 0?new b(M.NUM,H.NotOctal):Iu(i,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(r,i)=>{const s=Tl(r,8,jr);return s===void 0?new b(M.NUM,H.NotOctal):Mu(Iu(s,8),2,i)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(r,i)=>{const s=Tl(r,8,jr);return s===void 0?new b(M.NUM,H.NotOctal):Mu(Iu(s,8),16,i)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),r=>{const i=Tl(r,16,jr);return i===void 0?new b(M.NUM,H.NotHex):Iu(i,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(r,i)=>{const s=Tl(r,16,jr);return s===void 0?new b(M.NUM,H.NotHex):Mu(Iu(s,16),2,i)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(r,i)=>{const s=Tl(r,16,jr);return s===void 0?new b(M.NUM,H.NotHex):Mu(Iu(s,16),8,i)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),W3e)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(r,i)=>{const s=Tl(r,i,tJ);return s===void 0?new b(M.NUM,H.NotHex):parseInt(s,i)})}}nJ.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:p.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER,optionalArg:!0,minValue:0,maxValue:jr}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER,optionalArg:!0,minValue:0,maxValue:jr}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:p.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER,optionalArg:!0,minValue:0,maxValue:jr}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER,optionalArg:!0,minValue:0,maxValue:jr}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:p.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER,optionalArg:!0,minValue:0,maxValue:jr}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER,optionalArg:!0,minValue:0,maxValue:jr}]},DECIMAL:{method:"decimal",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER,minValue:LY,maxValue:HY}]},BASE:{method:"base",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:LY,maxValue:HY},{argumentType:p.NUMBER,optionalArg:!0,minValue:0,maxValue:tJ}]}};function Tl(n,e,t){const r=U3e.substr(0,e),i=new RegExp(`^[${r}]+$`);if(!(n.length>t||!i.test(n)))return n}function Mu(n,e,t){if(n>B3e(e))return new b(M.NUM,H.ValueBaseLarge);if(n<rJ(e))return new b(M.NUM,H.ValueBaseSmall);const r=iJ(n,e);return t===void 0||n<0?r:r.length>t?new b(M.NUM,H.ValueBaseLong):ws(r,t)}function rJ(n){return-Math.pow(n,jr)/2}function B3e(n){return-rJ(n)-1}function W3e(n,e,t){const r=iJ(n,e);return t!==void 0&&t>r.length?ws(r,t):r}function iJ(n,e){const t=n<0?Math.pow(e,jr):0;return(n+t).toString(e).toUpperCase()}function Iu(n,e){const t=parseInt(n,e),r=Math.pow(e,jr);return t>=r/2?t-r:t}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class sJ extends Qe{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(r,i)=>i<r?new b(M.NUM,H.WrongOrder):(r=Math.ceil(r),i=Math.floor(i)+1,r===i&&(i+=1),r+Math.floor(Math.random()*(i-r))))}}sJ.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER}],isVolatile:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function DY(n){const e=Math.ceil(n);return e%2===1?e:e+1}function FY(n){const e=Math.ceil(n);return e%2===0?e:e+1}class f$ extends Qe{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.ceil(-r*s)/s:Math.ceil(r*s)/s})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.floor(-r*s)/s:Math.floor(r*s)/s})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.round(-r*s)/s:Math.round(r*s)/s})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),r=>r<0?-Math.floor(-r):Math.floor(r))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),r=>r<0?-FY(-r):FY(r))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),r=>r<0?-DY(-r):DY(r))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(r,i,s)=>i===0||r===0?0:(i=Math.abs(i),s===1&&r<0&&(i=-i),Math.ceil(r/i)*i))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(r,i)=>r===0?0:i===0?new b(M.DIV_BY_ZERO):r>0&&i<0?new b(M.NUM,H.DistinctSigns):Math.ceil(r/i)*i)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(r,i)=>i===0||r===0?0:(i=Math.abs(i),Math.ceil(r/i)*i))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(r,i,s)=>i===0||r===0?0:(i=Math.abs(i),s===1&&r<0&&(i*=-1),Math.floor(r/i)*i))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(r,i)=>r===0?0:i===0?new b(M.DIV_BY_ZERO):r>0&&i<0?new b(M.NUM,H.DistinctSigns):Math.floor(r/i)*i)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(r,i)=>i===0||r===0?0:(i=Math.abs(i),Math.floor(r/i)*i))}}f$.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:p.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:p.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:p.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:1},{argumentType:p.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:1},{argumentType:p.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,defaultValue:1}]}};f$.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class oJ extends Qe{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}oJ.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function*j3e(){}function z3e(n){const e=n[Symbol.iterator](),{done:t,value:r}=e.next();return t?{rest:j3e()}:{value:r,rest:e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const G3e=(n,e,t)=>{if(t.end.row>t.start.row){const r=ve(t.end.sheet,t.end.col,t.end.row-1),i=n.getRange(t.start,r);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:t.withStart(ve(t.start.sheet,t.start.col,t.end.row)),restConditionRanges:e.map(s=>s.withStart(ve(s.start.sheet,s.start.col,s.end.row)))}}return{restValuesRange:t,restConditionRanges:e}};class Y3e{constructor(e,t,r,i,s){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=i,this.mapFunction=s,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const s of t)if(!s.conditionRange.sameDimensionsAs(e))return new b(M.VALUE,H.EqualLength);const r=this.tryToGetRangeVertexForRangeValue(e),i=t.map(s=>this.tryToGetRangeVertexForRangeValue(s.conditionRange));if(r&&i.every(s=>s!==void 0)){const s=t.map(l=>l.criterionPackage.raw).join(","),o=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),s);if(o!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),o;const a=this.buildNewCriterionCache(this.cacheKey(t),t.map(l=>l.conditionRange.range),e.range);return a.has(s)||a.set(s,[this.evaluateRangeValue(e,t),t.map(l=>l.criterionPackage.lambda)]),r.setCriterionFunctionValues(this.cacheKey(t),a),i.forEach(l=>{l!==void 0&&l.addDependentCacheRange(r)}),a.get(s)[0]}else return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;if(t!==void 0)return this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){const r=t.map(a=>a.criterionPackage.lambda),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),s=t.map(a=>a.conditionRange.iterateValuesFromTopLeftCorner()),o=VY(r,s,i);return this.reduceFunction(o)}buildNewCriterionCache(e,t,r){const i=this.dependencyGraph.getRange(r.start,r.end),{smallerRangeVertex:s,restConditionRanges:o,restValuesRange:a}=G3e(this.dependencyGraph,t,r);let l;s!==void 0&&this.dependencyGraph.existsEdge(s,i)?l=s.getCriterionFunctionValues(e):l=new Map;const u=new Map;return l.forEach(([c,h],d)=>{const f=VY(h,o.map(g=>kY(this.dependencyGraph,g)),Array.from(kY(this.dependencyGraph,a)).map(this.mapFunction)[Symbol.iterator]()),m=this.composeFunction(c,this.reduceFunction(f));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),u.set(d,[m,h])}),u}}class K3e{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*kY(n,e){for(const t of e.addresses(n))yield ge(n.getScalarValue(t))}function*VY(n,e,t){for(const r of t){const i=e.map(o=>z3e(o));if(!i.every(o=>Object.prototype.hasOwnProperty.call(o,"value")))return;const s=i.map(o=>ge(o.value));X3e(s,n).every(([o,a])=>a(o))&&(yield r),e=i.map(o=>o.rest)}}function X3e(n,e){const t=[];for(let r=0;r<Math.min(n.length,e.length);r++)t.push([n[r],e[r]]);return t}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class jh{constructor(e,t){this.sum=e,this.count=t}static single(e){return new jh(e,1)}compose(e){return new jh(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}jh.empty=new jh(0,0);function q3e(n){return e=>{const t=e.map(r=>`${r.conditionRange.range.sheet},${r.conditionRange.range.start.col},${r.conditionRange.range.start.row}`);return[n,...t].join(",")}}function $Y(n){return It(n)&&!Number.isFinite(ge(n))?0:n}function nT(n){if(n instanceof b)return n;if(It(n))return ge(n)}class aJ extends Qe{sumif(e,t){const r="SUMIF",i=(s,o,a)=>this.computeConditionalAggregationFunction(a??s,[s,o],r,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),nT);return this.runFunction(e.args,t,this.metadata(r),i)}sumifs(e,t){const r="SUMIFS",i=(s,...o)=>this.computeConditionalAggregationFunction(s,o,r,0,(a,l)=>this.arithmeticHelper.nonstrictadd(a,l),nT);return this.runFunction(e.args,t,this.metadata(r),i)}averageif(e,t){const r="AVERAGEIF",i=(s,o,a)=>{const l=this.computeConditionalAggregationFunction(a??s,[s,o],r,jh.empty,(u,c)=>u.compose(c),u=>It(u)?jh.single(ge(u)):jh.empty);return l instanceof b?l:l.averageValue()||new b(M.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(r),i)}countif(e,t){const r="COUNTIF",i=(s,o)=>this.computeConditionalAggregationFunction(s,[s,o],r,0,(a,l)=>a+l,()=>1);return this.runFunction(e.args,t,this.metadata(r),i)}countifs(e,t){const r="COUNTIFS",i=(...s)=>this.computeConditionalAggregationFunction(s[0],s,r,0,(o,a)=>o+a,()=>1);return this.runFunction(e.args,t,this.metadata(r),i)}minifs(e,t){const r="MINIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.min(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,r,Number.POSITIVE_INFINITY,i,nT);return $Y(l)};return this.runFunction(e.args,t,this.metadata(r),s)}maxifs(e,t){const r="MAXIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.max(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,r,Number.NEGATIVE_INFINITY,i,nT);return $Y(l)};return this.runFunction(e.args,t,this.metadata(r),s)}computeConditionalAggregationFunction(e,t,r,i,s,o){const a=[];for(let l=0;l<t.length;l+=2){const u=t[l],c=this.interpreter.criterionBuilder.fromCellValue(t[l+1],this.arithmeticHelper);if(c===void 0)return new b(M.VALUE,H.BadCriterion);a.push(new K3e(u,c))}return new Y3e(this.interpreter,q3e(r),i,s,o).compute(e,a)}}aJ.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:p.RANGE},{argumentType:p.NOERROR},{argumentType:p.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:p.RANGE},{argumentType:p.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:p.RANGE},{argumentType:p.NOERROR},{argumentType:p.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE},{argumentType:p.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:p.RANGE},{argumentType:p.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE},{argumentType:p.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE},{argumentType:p.NOERROR}],repeatLastArgs:2}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class lJ extends Qe{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...r)=>{const i=r[0].width(),s=r[0].height();for(const l of r)if(l.width()!==i||l.height()!==s)return new b(M.VALUE,H.EqualLength);let o=0;const a=r.map(l=>l.iterateValuesFromTopLeftCorner());for(let l=0;l<i*s;l++){let u=1;for(const c of a){const h=c.next().value;if(h instanceof b)return h;const d=this.coerceScalarToNumberOrError(h);It(d)?u*=ge(d):u=0}o+=u}return o})}}lJ.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:p.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class uJ extends Qe{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...r)=>"".concat(...r))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(r,i)=>{const s=r.split(" ");return i>=s.length||i<0?new b(M.VALUE,H.IndexBounds):s[i]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),r=>r.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),r=>r.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),r=>r.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),r=>r.replace(new RegExp("\\p{L}+","gu"),i=>i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),r=>r.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(r,i)=>r===i)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(r,i)=>i<0?new b(M.VALUE,H.NegativeCount):r.repeat(i))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(r,i)=>i<0?new b(M.VALUE,H.NegativeLength):i===0?"":r.slice(-i))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(r,i)=>i<0?new b(M.VALUE,H.NegativeLength):r.slice(0,i))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(r,i,s)=>i<1?new b(M.VALUE,H.LessThanOne):s<0?new b(M.VALUE,H.NegativeLength):r.substring(i-1,i+s-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(r,i,s,o)=>i<1?new b(M.VALUE,H.LessThanOne):s<0?new b(M.VALUE,H.NegativeLength):r.substring(0,i-1)+o+r.substring(i+s-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(r,i,s)=>{if(s<1||s>i.length)return new b(M.VALUE,H.LengthBounds);const o=r.toLowerCase(),a=i.substring(s-1).toLowerCase(),l=this.arithmeticHelper.requiresRegex(o)?this.arithmeticHelper.searchString(o,a):a.indexOf(o);return l>-1?l+s:new b(M.VALUE,H.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(r,i,s,o)=>{const a=this.escapeRegExpSpecialCharacters(i),l=new RegExp(a,"g");if(o===void 0)return r.replace(l,s);if(o<1)return new b(M.VALUE,H.LessThanOne);let u,c=0;for(;(u=l.exec(r))!==null;)if(o===++c)return r.substring(0,u.index)+s+r.substring(l.lastIndex);return r})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(r,i,s)=>{if(s<1||s>i.length)return new b(M.VALUE,H.IndexBounds);const a=i.substring(s-1).indexOf(r)+s;return a>0?a:new b(M.VALUE,H.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),r=>r instanceof b||typeof r=="string"?r:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),r=>r.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}uJ.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:p.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:p.STRING},{argumentType:p.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:p.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:p.STRING}]},MID:{method:"mid",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER},{argumentType:p.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:p.STRING}]},T:{method:"t",parameters:[{argumentType:p.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:p.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:p.STRING}]},REPT:{method:"rept",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:p.STRING},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:p.STRING},{argumentType:p.STRING},{argumentType:p.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:p.STRING},{argumentType:p.STRING},{argumentType:p.STRING},{argumentType:p.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:p.STRING},{argumentType:p.STRING},{argumentType:p.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:p.STRING}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class cJ extends Qe{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(r,i)=>r===0&&i===0?new b(M.DIV_BY_ZERO):Math.atan2(i,r))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),r=>r===0?new b(M.DIV_BY_ZERO):1/Math.tan(r))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),r=>r===0?sL/2:Math.atan(1/r))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),r=>1/Math.cos(r))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),r=>r===0?new b(M.DIV_BY_ZERO):1/Math.sin(r))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),r=>r===0?new b(M.DIV_BY_ZERO):1/Math.tanh(r))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),r=>r===0?new b(M.NUM,H.NonZero):Math.atanh(1/r))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),r=>1/Math.cosh(r))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),r=>r===0?new b(M.DIV_BY_ZERO):1/Math.sinh(r))}}cJ.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:p.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:p.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:p.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:p.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:p.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:p.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:p.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:p.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:p.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:p.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:p.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:p.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:p.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:p.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:p.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:p.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:p.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:p.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:p.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:p.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Q3e extends CZ{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class hJ extends Qe{constructor(){super(...arguments),this.rowSearch=new Q3e(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(r,i,s,o)=>{const a=i.range;return a===void 0?new b(M.VALUE,H.WrongType):s<1?new b(M.VALUE,H.LessThanOne):s>a.width()?new b(M.REF,H.IndexLarge):this.doVlookup(K_(r),i,s-1,o)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(r,i,s,o)=>{const a=i.range;return a===void 0?new b(M.VALUE,H.WrongType):s<1?new b(M.VALUE,H.LessThanOne):s>a.height()?new b(M.REF,H.IndexLarge):this.doHlookup(K_(r),i,s-1,o)})}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(r,i,s)=>this.doMatch(K_(r),i,s))}searchInRange(e,t,r,i){if(!r&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e))return i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t);{const s=r?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return i.find(e,t,s)}}doVlookup(e,t,r,i){this.dependencyGraph.stats.start(Ge.VLOOKUP);const s=t.range;let o;s===void 0?o=Ne.onlyValues(t.data.map(u=>[u[0]])):o=Ne.onlyRange(xe.spanFrom(s.start,1,s.height()),this.dependencyGraph);const a=this.searchInRange(e,o,i,this.columnSearch);if(this.dependencyGraph.stats.end(Ge.VLOOKUP),a===-1)return new b(M.NA,H.ValueNotFound);let l;if(s===void 0)l=t.data[a][r];else{const u=ve(s.sheet,s.start.col+r,s.start.row+a);l=this.dependencyGraph.getCellValue(u)}return l instanceof Ne?new b(M.VALUE,H.WrongType):l}doHlookup(e,t,r,i){const s=t.range;let o;s===void 0?o=Ne.onlyValues([t.data[0]]):o=Ne.onlyRange(xe.spanFrom(s.start,s.width(),1),this.dependencyGraph);const a=this.searchInRange(e,o,i,this.rowSearch);if(a===-1)return new b(M.NA,H.ValueNotFound);let l;if(s===void 0)l=t.data[r][a];else{const u=ve(s.sheet,s.start.col+a,s.start.row+r);l=this.dependencyGraph.getCellValue(u)}return l instanceof Ne?new b(M.VALUE,H.WrongType):l}doMatch(e,t,r){if(![-1,0,1].includes(r))return new b(M.VALUE,H.BadMode);if(t.width()>1&&t.height()>1)return new b(M.NA);const i=t.width()===1?this.columnSearch:this.rowSearch,s=r===0?{ordering:"none",matchExactly:!0}:{ordering:r===-1?"desc":"asc"},o=i.find(e,t,s);return o===-1?new b(M.NA,H.ValueNotFound):o+1}}hJ.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:p.NOERROR},{argumentType:p.RANGE},{argumentType:p.NUMBER},{argumentType:p.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:p.NOERROR},{argumentType:p.RANGE},{argumentType:p.NUMBER},{argumentType:p.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:p.NOERROR},{argumentType:p.RANGE},{argumentType:p.NUMBER,defaultValue:1}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class dJ extends Qe{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(r,i)=>(r=Math.trunc(r),i===!1?i=4:i===!0&&(i=0),i=ge(this.coerceScalarToNumberOrError(i)),i instanceof b?i:(i=Math.trunc(i),i<0?new b(M.VALUE,H.ValueSmall):i>4?new b(M.VALUE,H.ValueLarge):Z3e(r,i))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),r=>{r=r.trim().toUpperCase();let i=!1;if(r.startsWith("-")&&(r=r.slice(1),i=!0,r===""))return new b(M.VALUE,H.InvalidRoman);const s={input:r,acc:0};return bl(s,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),bl(s,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),bl(s,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),bl(s,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),bl(s,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),bl(s,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),bl(s,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),bl(s,{token:"IX",val:9}),bl(s,{token:"V",val:5},{token:"IV",val:4}),bl(s,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),s.input!==""?new b(M.VALUE,H.InvalidRoman):i?-s.acc:s.acc})}}dJ.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:p.NUMBER,minValue:1,lessThan:4e3},{argumentType:p.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:p.STRING}]}};function bl(n,...e){for(const t of e)if(n.input.startsWith(t.token)){n.input=n.input.slice(t.token.length),n.acc+=t.val;break}}function Z3e(n,e){const t={val:n%1e3,acc:"M".repeat(Math.floor(n/1e3))};return e===4&&(Jn(t,"IM",999,1e3),Jn(t,"ID",499,500)),e>=3&&(Jn(t,"VM",995,1e3),Jn(t,"VD",495,500)),e>=2&&(Jn(t,"XM",990,1e3),Jn(t,"XD",490,500)),e>=1&&(Jn(t,"LM",950,1e3),Jn(t,"LD",450,500)),Jn(t,"CM",900,1e3),Jn(t,"CD",400,500),Jn(t,"D",500,900),t.acc+="C".repeat(Math.floor(t.val/100)),t.val%=100,e>=2&&(Jn(t,"IC",99,100),Jn(t,"IL",49,50)),e>=1&&(Jn(t,"VC",95,100),Jn(t,"VL",45,50)),Jn(t,"XC",90,100),Jn(t,"XL",40,50),Jn(t,"L",50,90),t.acc+="X".repeat(Math.floor(t.val/10)),t.val%=10,Jn(t,"IX",9,10),Jn(t,"IV",4,5),Jn(t,"V",5,9),t.acc+="I".repeat(t.val),t.acc}function Jn(n,e,t,r){n.val>=t&&n.val<r&&(n.val-=t,n.acc+=e)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class fJ extends Qe{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}fJ.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:p.NUMBER,passSubtype:!0},{argumentType:p.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:p.STRING,passSubtype:!0},{argumentType:p.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:p.NUMBER,passSubtype:!0},{argumentType:p.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:p.NOERROR,passSubtype:!0},{argumentType:p.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:p.NOERROR,passSubtype:!0},{argumentType:p.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:p.NOERROR,passSubtype:!0},{argumentType:p.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:p.NOERROR,passSubtype:!0},{argumentType:p.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:p.NOERROR,passSubtype:!0},{argumentType:p.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:p.NUMBER,passSubtype:!0},{argumentType:p.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:p.NUMBER,passSubtype:!0},{argumentType:p.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:p.NOERROR,passSubtype:!0},{argumentType:p.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:p.NUMBER,passSubtype:!0},{argumentType:p.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:p.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:p.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:p.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var it=Math;function Rn(n,e){for(var t=0,r=0;t<n.length;++t)r=e*r+n[t];return r}function gJ(n,e,t,r,i){if(e===0)return t;if(e===1)return r;for(var s=2/n,o=r,a=1;a<e;++a)o=r*a*s+i*t,t=r,r=o;return o}function mJ(n,e,t,r,i){return function(o,a){if(r){if(o===0)return r==1?-1/0:1/0;if(o<0)return NaN}if(a===0)return n(o);if(a===1)return e(o);if(a<0)return NaN;a|=0;var l=n(o),u=e(o);return gJ(o,a,l,u,i)}}var oL=function(){var n=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function s(h){var d=0,f=0,m=0,g=h*h;if(h<8)f=Rn(e,g),m=Rn(t,g),d=f/m;else{var C=h-.785398164;g=64/g,f=Rn(r,g),m=Rn(i,g),d=it.sqrt(n/h)*(it.cos(C)*f-it.sin(C)*m*8/h)}return d}var o=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),a=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(h){var d=0,f=0,m=0,g=h*h,C=it.abs(h)-2.356194491;return Math.abs(h)<8?(f=h*Rn(o,g),m=Rn(a,g),d=f/m):(g=64/g,f=Rn(l,g),m=Rn(u,g),d=it.sqrt(n/it.abs(h))*(it.cos(C)*f-it.sin(C)*m*8/it.abs(h)),h<0&&(d=-d)),d}return function h(d,f){if(f=Math.round(f),!isFinite(d))return isNaN(d)?d:0;if(f<0)return(f%2?-1:1)*h(d,-f);if(d<0)return(f%2?-1:1)*h(-d,f);if(f===0)return s(d);if(f===1)return c(d);if(d===0)return 0;var m=0;if(d>f)m=gJ(d,f,s(d),c(d),-1);else{for(var g=2*it.floor((f+it.floor(it.sqrt(40*f)))/2),C=!1,y=0,w=0,S=1,E=0,P=2/d,_=g;_>0;_--)E=_*P*S-y,y=S,S=E,it.abs(S)>1e10&&(S*=1e-10,y*=1e-10,m*=1e-10,w*=1e-10),C&&(w+=S),C=!C,_==f&&(m=y);w=2*w-S,m/=w}return m}}(),J3e=function(){var n=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),t=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function s(h){var d=0,f=0,m=0,g=h*h,C=h-.785398164;return h<8?(f=Rn(e,g),m=Rn(t,g),d=f/m+n*oL(h,0)*it.log(h)):(g=64/g,f=Rn(r,g),m=Rn(i,g),d=it.sqrt(n/h)*(it.sin(C)*f+it.cos(C)*m*8/h)),d}var o=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),a=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(h){var d=0,f=0,m=0,g=h*h,C=h-2.356194491;return h<8?(f=h*Rn(o,g),m=Rn(a,g),d=f/m+n*(oL(h,1)*it.log(h)-1/h)):(g=64/g,f=Rn(l,g),m=Rn(u,g),d=it.sqrt(n/h)*(it.sin(C)*f+it.cos(C)*m*8/h)),d}return mJ(s,c,"BESSELY",1,-1)}(),aL=function(){var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function t(o){return o<=3.75?Rn(n,o*o/(3.75*3.75)):it.exp(it.abs(o))/it.sqrt(it.abs(o))*Rn(e,3.75/it.abs(o))}var r=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function s(o){return o<3.75?o*Rn(r,o*o/(3.75*3.75)):(o<0?-1:1)*it.exp(it.abs(o))/it.sqrt(it.abs(o))*Rn(i,3.75/it.abs(o))}return function o(a,l){if(l=Math.round(l),l===0)return t(a);if(l===1)return s(a);if(l<0)return NaN;if(it.abs(a)===0)return 0;if(a==1/0)return 1/0;var u=0,c,h=2/it.abs(a),d=0,f=1,m=0,g=2*it.round((l+it.round(it.sqrt(40*l)))/2);for(c=g;c>0;c--)m=c*h*f+d,d=f,f=m,it.abs(f)>1e10&&(f*=1e-10,d*=1e-10,u*=1e-10),c==l&&(u=d);return u*=o(a,0)/f,a<0&&l%2?-u:u}}(),eKe=function(){var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function t(o){return o<=2?-it.log(o/2)*aL(o,0)+Rn(n,o*o/4):it.exp(-o)/it.sqrt(o)*Rn(e,2/o)}var r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function s(o){return o<=2?it.log(o/2)*aL(o,1)+1/o*Rn(r,o*o/4):it.exp(-o)/it.sqrt(o)*Rn(i,2/o)}return mJ(t,s,"BESSELK",2,1)}();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function bp(n){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let t=e.length-1,r=!1,i=0,s=0,o,a,l,u;if(n===0)return 0;for(n<0&&(n=-n,r=!0),o=2/(2+n),a=4*o-2;t>0;t--)l=i,i=a*i-s+e[t],s=l;return u=o*Math.exp(-n*n+.5*(e[0]+a*i)-s),r?u-1:1-u}function pJ(n){return 1-bp(n)}function vJ(n){let e=0,t,r,i,s;if(n>=2)return-100;if(n<=0)return 100;for(s=n<1?n:2-n,i=Math.sqrt(-2*Math.log(s/2)),t=-.70711*((2.30753+i*.27061)/(1+i*(.99229+i*.04481))-i);e<2;e++)r=pJ(t)-s,t+=r/(1.1283791670955126*Math.exp(-t*t)-t*r);return n<1?t:-t}const UY={pdf:(n,e)=>n<0?0:e*Math.exp(-e*n),cdf:(n,e)=>n<0?0:1-Math.exp(-e*n)};function Wy(n){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],t=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let r=!1,i=0,s=0,o=0,a=n,l,u,c,h;if(n>171.6243769536076)return 1/0;if(a<=0)if(h=a%1,h)r=(a&1?-1:1)*Math.PI/Math.sin(Math.PI*h),a=1-a;else return 1/0;for(c=a,a<1?u=a++:u=(a-=i=(a|0)-1)-1,l=0;l<8;++l)o=(o+e[l])*u,s=s*u+t[l];if(h=o/s+1,c<a)h/=c;else if(c>a)for(l=0;l<i;++l)h*=a,a++;return r&&(h=r/h),h}const eP={pdf:function(e,t,r){return e<0?0:e===0&&t===1?1/r:Math.exp((t-1)*Math.log(e)-e/r-Xr(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:g$(t,e/r)},inv:function(n,e,t){return wJ(n,e)*t}};function Xr(n){let e=0;const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let r=1.000000000190015,i,s,o;for(o=(s=i=n)+5.5,o-=(i+.5)*Math.log(o);e<6;e++)r+=t[e]/++s;return Math.log(2.5066282746310007*r/i)-o}function g$(n,e){const t=Xr(n);let r=n,i=1/n,s=i,o=e+1-n,a=1/1e-30,l=1/o,u=l,c=1;const h=-~(Math.log(n>=1?n:1/n)*8.5+n*.4+17);let d;if(e<0||n<=0)return NaN;if(e<n+1){for(;c<=h;c++)i+=s*=e/++r;return i*Math.exp(-e+n*Math.log(e)-t)}for(;c<=h;c++)d=-c*(c-n),o+=2,l=d*l+o,a=o+d/a,l=1/l,u*=l*a;return 1-u*Math.exp(-e+n*Math.log(e)-t)}function wJ(n,e){let t=0;const r=e-1,i=1e-8,s=Xr(e);let o,a,l,u,c,h,d;if(n>=1)return Math.max(100,e+100*Math.sqrt(e));if(n<=0)return 0;for(e>1?(h=Math.log(r),d=Math.exp(r*(h-1)-s),c=n<.5?n:1-n,l=Math.sqrt(-2*Math.log(c)),o=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,n<.5&&(o=-o),o=Math.max(.001,e*Math.pow(1-1/(9*e)-o/(3*Math.sqrt(e)),3))):(l=1-e*(.253+e*.12),n<l?o=Math.pow(n/l,1/e):o=1-Math.log(1-(n-l)/(1-l)));t<12;t++){if(o<=0)return 0;if(a=g$(e,o)-n,e>1?l=d*Math.exp(-(o-r)+r*(Math.log(o)-h)):l=Math.exp(-o+r*Math.log(o)-s),u=a/l,o-=l=u/(1-.5*Math.min(1,u*((e-1)/o-1))),o<=0&&(o=.5*(o+l)),Math.abs(l)<i*o)break}return o}const Oa={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return .5*(1+bp((e-t)/Math.sqrt(2*r*r)))},inv:function(n,e,t){return-1.4142135623730951*t*vJ(2*n)+e}},tP={pdf:function(e,t,r){return e>1||e<0?0:t==1&&r==1?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/m$(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-yJ(t,r))},cdf:function(e,t,r){return e>1||e<0?+(e>1):XN(e,t,r)},inv:function(e,t,r){return p$(e,t,r)}};function m$(n,e){if(!(n<=0||e<=0))return n+e>170?Math.exp(yJ(n,e)):Wy(n)*Wy(e)/Wy(n+e)}function yJ(n,e){return Xr(n)+Xr(e)-Xr(n+e)}function p$(n,e,t){var r=1e-8,i=e-1,s=t-1,o=0,a,l,u,c,h,d,f,m,g,C,y;if(n<=0)return 0;if(n>=1)return 1;for(e>=1&&t>=1?(u=n<.5?n:1-n,c=Math.sqrt(-2*Math.log(u)),f=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c,n<.5&&(f=-f),m=(f*f-3)/6,g=2/(1/(2*e-1)+1/(2*t-1)),C=f*Math.sqrt(m+g)/g-(1/(2*t-1)-1/(2*e-1))*(m+5/6-2/(3*g)),f=e/(e+t*Math.exp(2*C))):(a=Math.log(e/(e+t)),l=Math.log(t/(e+t)),c=Math.exp(e*a)/e,h=Math.exp(t*l)/t,C=c+h,n<c/C?f=Math.pow(e*C*n,1/e):f=1-Math.pow(t*C*(1-n),1/t)),y=-Xr(e)-Xr(t)+Xr(e+t);o<10;o++){if(f===0||f===1)return f;if(d=XN(f,e,t)-n,c=Math.exp(i*Math.log(f)+s*Math.log(1-f)+y),h=d/c,f-=c=h/(1-.5*Math.min(1,h*(i/f-s/(1-f)))),f<=0&&(f=.5*(f+c)),f>=1&&(f=.5*(f+c+1)),Math.abs(c)<r*f&&o>0)break}return f}function XN(n,e,t){var r=n===0||n===1?0:Math.exp(Xr(e+t)-Xr(e)-Xr(t)+e*Math.log(n)+t*Math.log(1-n));return n<0||n>1?!1:n<(e+1)/(e+t+2)?r*BY(n,e,t)/e:1-r*BY(1-n,t,e)/t}function BY(n,e,t){var r=1e-30,i=1,s=e+t,o=e+1,a=e-1,l=1,u=1-s*n/o,c,h,d,f;for(Math.abs(u)<r&&(u=r),u=1/u,f=u;i<=100&&(c=2*i,h=i*(t-i)*n/((a+c)*(e+c)),u=1+h*u,Math.abs(u)<r&&(u=r),l=1+h/l,Math.abs(l)<r&&(l=r),u=1/u,f*=u*l,h=-(e+i)*(s+i)*n/((e+c)*(o+c)),u=1+h*u,Math.abs(u)<r&&(u=r),l=1+h/l,Math.abs(l)<r&&(l=r),u=1/u,d=u*l,f*=d,!(Math.abs(d-1)<3e-7));i++);return f}const ib={pdf:function(n,e,t){return t===0||t===1?e*t===n?1:0:SJ(e,n)*Math.pow(t,n)*Math.pow(1-t,e-n)},cdf:function(n,e,t){var r,i=1e-10;if(n<0)return 0;if(n>=e)return 1;if(t<0||t>1||e<=0)return NaN;n=Math.floor(n);var s=t,o=n+1,a=e-n,l=o+a,u=Math.exp(Xr(l)-Xr(a)-Xr(o)+o*Math.log(s)+a*Math.log(1-s));return s<(o+1)/(l+2)?r=u*WY(s,o,a,i):r=1-u*WY(1-s,a,o,i),Math.round((1-r)*(1/i))/(1/i)}};function WY(n,e,t,r){for(var i=0,s=1,o=1,a=1,l=0,u=0,c;Math.abs((o-u)/o)>r;)u=o,c=-(e+l)*(e+t+l)*n/(e+2*l)/(e+2*l+1),i=o+c*i,s=a+c*s,l=l+1,c=l*(t-l)*n/(e+2*l-1)/(e+2*l),o=i+c*o,a=s+c*a,i=i/a,s=s/a,o=o/a,a=1;return o/e}function SJ(n,e){return n>170||e>170?Math.exp(tKe(n,e)):sb(n)/sb(e)/sb(n-e)}function tKe(n,e){return nP(n)-nP(e)-nP(n-e)}function nP(n){return n<0?NaN:Xr(n+1)}function sb(n){return n<0?NaN:Wy(n+1)}const Mm={pdf:function(e,t){return e<0?0:e===0&&t===2?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-Xr(t/2))},cdf:function(e,t){return e<0?0:g$(t/2,e/2)},inv:function(n,e){return 2*wJ(n,.5*e)}},Im={pdf:function(e,t,r){var i,s,o;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/m$(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):(i=t*e/(r+e*t),s=r/(r+e*t),o=t*s/2,o*ib.pdf((t-2)/2,(t+r-2)/2,i))},cdf:function(e,t,r){return e<0?0:XN(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/p$(e,t/2,r/2)-1))}},jY={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}},lL={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/sb(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var i=0;r<=e;r++)i+=lL.pdf(r,t);return i}},Bu={pdf:function(e,t,r,i){if(e<0||e<r-(t-i))return 0;if(e>i||e>r)return 0;if(r*2>t)return i*2>t?Bu.pdf(t-r-i+e,t,t-r,t-i):Bu.pdf(i-e,t,t-r,i);if(i*2>t)return Bu.pdf(r-e,t,r,t-i);if(r<i)return Bu.pdf(e,t,i,r);for(var s=1,o=0,a=0;a<e;a++){for(;s>1&&o<i;)s*=1-r/(t-o),o++;s*=(i-a)*(r-a)/((a+1)*(t-r-i+a+1))}for(;o<i;o++)s*=1-r/(t-o);return Math.min(1,Math.max(0,s))},cdf:function n(e,t,r,i){if(e<0||e<r-(t-i))return 0;if(e>=i||e>=r)return 1;if(r*2>t)return i*2>t?n(t-r-i+e,t,t-r,t-i):1-Bu.cdf(i-e-1,t,t-r,i);if(i*2>t)return 1-Bu.cdf(r-e-1,t,r,t-i);if(r<i)return Bu.cdf(e,t,i,r);for(var s=1,o=1,a=0,l=0;l<e;l++){for(;s>1&&a<i;){var u=1-r/(t-a);o*=u,s*=u,a++}o*=(i-l)*(r-l)/((l+1)*(t-r-i+l+1)),s+=o}for(;a<i;a++)s*=1-r/(t-a);return Math.min(1,Math.max(0,s))}},ko={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*m$(.5,t/2))*Math.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var r=t/2;return XN((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(n,e){var t=p$(2*Math.min(n,1-n),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),n>.5?t:-t}},rP={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*bp((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(n,e,t){return Math.exp(-1.4142135623730951*t*vJ(2*n)+e)}},uL={pdf:function(e,t,r){return e!==e>>>0?!1:e<0?0:SJ(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t)},cdf:function(e,t,r){var i=0,s=0;if(e<0)return 0;for(;s<=e;s++)i+=uL.pdf(s,t,r);return i}};function CJ(n){for(var e=0,t=n.length;--t>=0;)e+=n[t];return e}function _o(n){return CJ(n)/n.length}function df(n){for(var e=_o(n),t=0,r=n.length,i;--r>=0;)i=n[r]-e,t+=i*i;return t}function Qw(n,e){return df(n)/(n.length-(e?1:0))}function Ah(n,e){return Math.sqrt(Qw(n,e))}function nKe(){var n=[].slice.call(arguments),e=new Array(2),t;return n.length===4?t=Math.abs(Oa.inv(n[1]/2,0,1)*n[2]/Math.sqrt(n[3])):t=Math.abs(Oa.inv(n[1]/2,0,1)*Ah(n[2])/Math.sqrt(n[2].length)),e[0]=n[0]-t,e[1]=n[0]+t,e}function rKe(){var n=[].slice.call(arguments),e=new Array(2),t;return n.length===4?t=Math.abs(ko.inv(n[1]/2,n[3]-1)*n[2]/Math.sqrt(n[3])):t=Math.abs(ko.inv(n[1]/2,n[2].length-1)*Ah(n[2],!0)/Math.sqrt(n[2].length)),e[0]=n[0]-t,e[1]=n[0]+t,e}function iKe(n){for(var e=1,t=n.length;--t>=0;)e*=n[t];return e}function sKe(n){return Math.pow(iKe(n),1/n.length)}function Zw(n,e){var t=_o(n),r=_o(e),i=n.length,s=new Array(i),o;for(o=0;o<i;o++)s[o]=(n[o]-t)*(e[o]-r);return CJ(s)/(i-1)}function zY(n,e){return Zw(n,e)/Ah(n,1)/Ah(e,1)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class v$ extends Qe{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(r,i)=>i===void 0?bp(r):bp(i)-bp(r))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),pJ)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(r,i,s)=>s?UY.cdf(r,i):UY.pdf(r,i))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),r=>Math.log((1+r)/(1-r))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),r=>1-2/(Math.exp(2*r)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),Wy)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(r,i,s,o)=>o?eP.cdf(r,i,s):eP.pdf(r,i,s))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),Xr)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),eP.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),r=>Oa.cdf(r,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(r,i,s,o,a,l)=>r<=a?new b(M.NUM,H.ValueSmall):r>=l?new b(M.NUM,H.ValueLarge):(r=(r-a)/(l-a),o?tP.cdf(r,i,s):tP.pdf(r,i,s)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(r,i,s,o,a)=>o>=a?new b(M.NUM,H.WrongOrder):tP.inv(r,i,s)*(a-o)+o)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(r,i,s,o)=>r>i?new b(M.NUM,H.WrongOrder):(r=Math.trunc(r),i=Math.trunc(i),o?ib.cdf(r,i,s):ib.pdf(r,i,s)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(r,i,s)=>{r=Math.trunc(r);let o=-1,a=r;for(;a>o+1;){const l=Math.trunc((o+a)/2);ib.cdf(l,r,i)>=s?a=l:o=l}return a})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(r,i)=>aL(r,Math.trunc(i)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(r,i)=>oL(r,Math.trunc(i)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(r,i)=>eKe(r,Math.trunc(i)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(r,i)=>J3e(r,Math.trunc(i)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(r,i,s)=>(i=Math.trunc(i),s?Mm.cdf(r,i):Mm.pdf(r,i)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(r,i)=>1-Mm.cdf(r,Math.trunc(i)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(r,i)=>Mm.inv(r,Math.trunc(i)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(r,i)=>Mm.inv(1-r,Math.trunc(i)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(r,i,s,o)=>(i=Math.trunc(i),s=Math.trunc(s),o?Im.cdf(r,i,s):Im.pdf(r,i,s)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(r,i,s)=>1-Im.cdf(r,Math.trunc(i),Math.trunc(s)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(r,i,s)=>Im.inv(r,Math.trunc(i),Math.trunc(s)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(r,i,s)=>Im.inv(1-r,Math.trunc(i),Math.trunc(s)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(r,i,s,o)=>o?jY.cdf(r,s,i):jY.pdf(r,s,i))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(r,i,s)=>(r=Math.trunc(r),s?lL.cdf(r,i):lL.pdf(r,i)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(r,i,s,o,a)=>r>i||r>s||i>o||s>o?new b(M.NUM,H.ValueLarge):r+o<s+i?new b(M.NUM,H.ValueLarge):(r=Math.trunc(r),i=Math.trunc(i),s=Math.trunc(s),o=Math.trunc(o),a?Bu.cdf(r,o,s,i):Bu.pdf(r,o,s,i)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(r,i,s)=>(i=Math.trunc(i),s?ko.cdf(r,i):ko.pdf(r,i)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(r,i)=>(1-ko.cdf(r,Math.trunc(i)))*2)}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(r,i)=>1-ko.cdf(r,Math.trunc(i)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(r,i,s)=>s*(1-ko.cdf(r,Math.trunc(i))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(r,i)=>ko.inv(r,Math.trunc(i)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(r,i)=>ko.inv(1-r/2,Math.trunc(i)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(r,i,s,o)=>o?rP.cdf(r,i,s):rP.pdf(r,i,s))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(r,i,s)=>rP.inv(r,i,s))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(r,i,s,o)=>o?Oa.cdf(r,i,s):Oa.pdf(r,i,s))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(r,i,s)=>Oa.inv(r,i,s))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(r,i)=>i?Oa.cdf(r,0,1):Oa.pdf(r,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),r=>Oa.inv(r,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),r=>Oa.pdf(r,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(r,i,s,o)=>(r=Math.trunc(r),i=Math.trunc(i),o?uL.cdf(r,i,s):uL.pdf(r,i,s)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(r,i,s)=>nKe(1,r,i,Math.trunc(s))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(r,i,s)=>(s=Math.trunc(s),s===1?new b(M.DIV_BY_ZERO):rKe(1,r,i,s)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(r,i,s)=>(r-i)/s)}}v$.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:p.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:p.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:p.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:p.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:p.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:p.NUMBER,minValue:0,lessThan:1},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:p.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.BOOLEAN},{argumentType:p.NUMBER,defaultValue:0},{argumentType:p.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:p.NUMBER,greaterThan:0,maxValue:1},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,defaultValue:0},{argumentType:p.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0,maxValue:1},{argumentType:p.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0,maxValue:1},{argumentType:p.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,minValue:1,maxValue:1e10},{argumentType:p.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:p.NUMBER,minValue:0,maxValue:1},{argumentType:p.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:p.NUMBER,minValue:0,maxValue:1},{argumentType:p.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:1},{argumentType:p.NUMBER,minValue:1},{argumentType:p.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:1},{argumentType:p.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:p.NUMBER,minValue:0,maxValue:1},{argumentType:p.NUMBER,minValue:1},{argumentType:p.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:p.NUMBER,minValue:0,maxValue:1},{argumentType:p.NUMBER,minValue:1},{argumentType:p.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0},{argumentType:p.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,minValue:1},{argumentType:p.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:1},{argumentType:p.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:p.NUMBER,greaterThan:0,lessThan:1},{argumentType:p.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:p.NUMBER,greaterThan:0,maxValue:1},{argumentType:p.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:p.NUMBER,greaterThan:0,lessThan:1},{argumentType:p.NUMBER},{argumentType:p.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:p.NUMBER,greaterThan:0,lessThan:1},{argumentType:p.NUMBER},{argumentType:p.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:p.NUMBER},{argumentType:p.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:p.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:p.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:1},{argumentType:p.NUMBER,minValue:0,maxValue:1},{argumentType:p.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:p.NUMBER,greaterThan:0,lessThan:1},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:p.NUMBER,greaterThan:0,lessThan:1},{argumentType:p.NUMBER,greaterThan:0},{argumentType:p.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER,greaterThan:0}]}};v$.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class EJ extends Qe{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),r=>{r=Math.trunc(r);let i=1;for(let s=1;s<=r;s++)i*=s;return i})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),r=>{r=Math.trunc(r);let i=1;for(let s=r;s>=1;s-=2)i*=s;return i})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(r,i)=>i>r?new b(M.NUM,H.WrongOrder):(r=Math.trunc(r),i=Math.trunc(i),GY(r,i)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(r,i)=>(r=Math.trunc(r),i=Math.trunc(i),r+i-1>=1030?new b(M.NUM,H.ValueLarge):r===0&&i===0?1:GY(r+i-1,i)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(i instanceof b)return i;let s=0;for(const o of i){if(o<0)return new b(M.NUM,H.ValueSmall);s=RJ(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new b(M.NUM,H.ValueLarge):s})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(i instanceof b)return i;let s=1;for(const o of i){if(o<0)return new b(M.NUM,H.ValueSmall);s=oKe(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new b(M.NUM,H.ValueLarge):s})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(r,i)=>i===0?0:r>0&&i<0||r<0&&i>0?new b(M.NUM,H.DistinctSigns):Math.round(r/i)*i)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...r)=>{let i=0,s=1;for(let o of r){if(o<0)return new b(M.NUM,H.ValueSmall);o=Math.trunc(o);for(let a=1;a<=o;a++)s*=(i+a)/a;i+=o}return Math.round(s)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(r,i)=>i===0?new b(M.DIV_BY_ZERO):Math.trunc(r/i))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(r,i,s,o)=>{const a=this.arithmeticHelper.manyToOnlyNumbersDropNulls(o.valuesFromTopLeftCorner());if(a instanceof b)return a;let l=0;a.reverse();for(const u of a)l*=Math.pow(r,s),l+=u;return l*Math.pow(r,i)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),r=>r>0?1:r<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new b(M.NA,H.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const c=s[u],h=o[u];if(c instanceof b)return c;if(h instanceof b)return h;typeof c=="number"&&typeof h=="number"&&(l+=Math.pow(c,2)-Math.pow(h,2))}return l})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new b(M.NA,H.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const c=s[u],h=o[u];if(c instanceof b)return c;if(h instanceof b)return h;typeof c=="number"&&typeof h=="number"&&(l+=Math.pow(c,2)+Math.pow(h,2))}return l})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new b(M.NA,H.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const c=s[u],h=o[u];if(c instanceof b)return c;if(h instanceof b)return h;typeof c=="number"&&typeof h=="number"&&(l+=Math.pow(c-h,2))}return l})}}EJ.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:p.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:p.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:p.NUMBER,minValue:0,lessThan:1030},{argumentType:p.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:p.NUMBER,minValue:0},{argumentType:p.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:p.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:p.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]}};function GY(n,e){2*e>n&&(e=n-e);let t=1;for(let r=1;r<=e;r++)t*=(n-e+r)/r;return Math.round(t)}function RJ(n,e){for(n<e&&([n,e]=[e,n]);e>0;)[n,e]=[e,n%e];return n}function oKe(n,e){return n===0||e===0?0:n*(e/RJ(n,e))}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class TJ extends Qe{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(r,i,s)=>s!=="i"&&s!=="j"?new b(M.VALUE,H.ShouldBeIorJ):Un([r,i],s))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),NJ)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([r,i])=>i)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([r,i])=>r)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([r,i])=>r===0&&i===0?new b(M.DIV_BY_ZERO):Math.atan2(i,r))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([r,i])=>Un([r,-i]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),r=>Un(rT(r)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),r=>Un(YY(r)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),r=>Un(nf(rT(r),iT(r))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),r=>Un(nf([1,0],iT(r))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),r=>Un(nf([1,0],KY(r))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),r=>Un(nf([1,0],rT(r))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),r=>Un(nf([1,0],YY(r))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),r=>Un(iT(r)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),r=>Un(KY(r)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),r=>Un(nf(iT(r),rT(r))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(r,i)=>Un(nf(r,i)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...r)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(r);if(i instanceof b)return i;let s=[1,0];for(const o of i)s=bJ(s,o);return Un(s)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...r)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(r);if(i instanceof b)return i;let s=[0,0];for(const o of i)s=aKe(s,o);return Un(s)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(r,i)=>Un(lKe(r,i)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),r=>Un(AJ(r)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),r=>Un(ob(r)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),r=>{const[i,s]=ob(r),o=Math.log(10);return Un([i/o,s/o])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),r=>{const[i,s]=ob(r),o=Math.log(2);return Un([i/o,s/o])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(r,i)=>Un(XY(r,i)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),r=>Un(XY(r,.5)))}}TJ.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:p.NUMBER},{argumentType:p.NUMBER},{argumentType:p.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:p.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:p.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:p.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:p.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:p.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:p.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:p.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:p.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:p.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:p.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:p.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:p.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:p.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:p.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:p.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:p.COMPLEX},{argumentType:p.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:p.COMPLEX},{argumentType:p.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:p.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:p.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:p.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:p.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:p.COMPLEX},{argumentType:p.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:p.COMPLEX}]}};function aKe([n,e],[t,r]){return[n+t,e+r]}function lKe([n,e],[t,r]){return[n-t,e-r]}function bJ([n,e],[t,r]){return[n*t-e*r,n*r+t*e]}function nf([n,e],[t,r]){const i=Math.pow(t,2)+Math.pow(r,2),[s,o]=bJ([n,e],[t,-r]);return[s/i,o/i]}function rT([n,e]){return[Math.cos(n)*Math.cosh(e),-Math.sin(n)*Math.sinh(e)]}function YY([n,e]){return[Math.cosh(n)*Math.cos(e),Math.sinh(n)*Math.sin(e)]}function iT([n,e]){return[Math.sin(n)*Math.cosh(e),Math.cos(n)*Math.sinh(e)]}function KY([n,e]){return[Math.sinh(n)*Math.cos(e),Math.cosh(n)*Math.sin(e)]}function AJ([n,e]){return[Math.exp(n)*Math.cos(e),Math.exp(n)*Math.sin(e)]}function NJ([n,e]){return Math.sqrt(n*n+e*e)}function ob([n,e]){return[Math.log(NJ([n,e])),Math.atan2(e,n)]}function XY(n,e){const[t,r]=ob(n);return AJ([e*t,e*r])}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class w$ extends Qe{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof b)return i;if(i.length===0)return new b(M.DIV_BY_ZERO);const s=_o(i);return i.reduce((o,a)=>o+Math.abs(a-s),0)/i.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof b?i:i.length===0?0:df(i)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof b)return i;if(i.length===0)return new b(M.NUM,H.OneValue);for(const s of i)if(s<=0)return new b(M.NUM,H.ValueSmall);return sKe(i)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof b)return i;if(i.length===0)return new b(M.NUM,H.OneValue);for(const s of i)if(s<=0)return new b(M.NUM,H.ValueSmall);return i.length/i.reduce((s,o)=>s+1/o,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new b(M.NA,H.EqualLength);const s=rf(r,i);return s instanceof b?s:s[0].length<=1?new b(M.DIV_BY_ZERO,H.TwoValues):zY(s[0],s[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new b(M.NA,H.EqualLength);const s=rf(r,i);return s instanceof b?s:s[0].length<=1?new b(M.DIV_BY_ZERO,H.TwoValues):Math.pow(zY(s[0],s[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new b(M.NA,H.EqualLength);const s=rf(r,i);if(s instanceof b)return s;const o=s[0].length;return o<1?new b(M.DIV_BY_ZERO,H.OneValue):o===1?0:Zw(s[0],s[1])*(o-1)/o})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new b(M.NA,H.EqualLength);const s=rf(r,i);return s instanceof b?s:s[0].length<=1?new b(M.DIV_BY_ZERO,H.TwoValues):Zw(s[0],s[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(r,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(o instanceof b)return o;const a=o.length;if(s===void 0){if(a<2)return new b(M.DIV_BY_ZERO,H.TwoValues);s=Ah(o,!0)}return a<1?new b(M.NA,H.OneValue):s===0?new b(M.DIV_BY_ZERO):1-Oa.cdf((_o(o)-i)/(s/Math.sqrt(a)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(s instanceof b)return s;if(o instanceof b)return o;if(s.length<=1||o.length<=1)return new b(M.DIV_BY_ZERO);const a=Qw(s,!0),l=Qw(o,!0);if(a===0||l===0)return new b(M.DIV_BY_ZERO);const u=a/l,c=Im.cdf(u,s.length-1,o.length-1);return 2*Math.min(c,1-c)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new b(M.NA,H.EqualLength);const s=rf(r,i);if(s instanceof b)return s;const o=s[0].length;return o<=2?new b(M.DIV_BY_ZERO,H.ThreeValues):Math.sqrt((df(s[0])-Math.pow(Zw(s[0],s[1])*(o-1),2)/df(s[1]))/(o-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new b(M.NA,H.EqualLength);const s=rf(r,i);if(s instanceof b)return s;const o=s[0].length;return o<=1?new b(M.DIV_BY_ZERO,H.TwoValues):Zw(s[0],s[1])*(o-1)/df(s[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(r,i)=>{const s=r.height(),o=r.width();if(i.height()!==s||i.width()!==o)return new b(M.NA,H.EqualLength);const a=rf(r,i);if(a instanceof b)return a;if(a[0].length<=1)return new b(M.DIV_BY_ZERO,H.TwoValues);let l=0;for(let u=0;u<a[0].length;u++){if(a[1][u]===0)return new b(M.DIV_BY_ZERO);l+=Math.pow(a[0][u]-a[1][u],2)/a[1][u]}return l<0?new b(M.NUM,H.NaN):1-Mm.cdf(l,s>1&&o>1?(s-1)*(o-1):s*o-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(r,i,s,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),l=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(a instanceof b)return a;if(l instanceof b)return l;const u=a.length,c=l.length;if(o===1){if(c!==u)return new b(M.NA,H.EqualLength);if(u<=1)return new b(M.DIV_BY_ZERO,H.TwoValues);const h=Array(u);for(let m=0;m<u;m++)h[m]=a[m]-l[m];const d=Ah(h,!0);if(d===0)return new b(M.DIV_BY_ZERO);const f=Math.abs(Math.sqrt(u)*_o(h)/d);return s*(1-ko.cdf(f,u-1))}else if(o===2){if(u<=1||c<=1)return new b(M.DIV_BY_ZERO,H.TwoValues);const h=(df(a)+df(l))/(u+c-2);if(h===0)return new b(M.DIV_BY_ZERO);const d=Math.abs((_o(a)-_o(l))/Math.sqrt(h*(1/u+1/c)));return s*(1-ko.cdf(d,u+c-2))}else{if(u<=1||c<=1)return new b(M.DIV_BY_ZERO,H.TwoValues);const h=Qw(a,!0),d=Qw(l,!0);if(h===0&&d===0)return new b(M.DIV_BY_ZERO);const f=Math.abs((_o(a)-_o(l))/Math.sqrt(h/u+d/c)),m=Math.pow(h/u+d/c,2)/(Math.pow(h/u,2)/(u-1)+Math.pow(d/c,2)/(c-1));return s*(1-ko.cdf(f,m))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof b)return i;const s=i.length;if(s<3)return new b(M.DIV_BY_ZERO,H.ThreeValues);const o=_o(i),a=Ah(i,!0);return a===0?new b(M.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)*s/(s-1)/(s-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof b)return i;const s=i.length;if(s<3)return new b(M.DIV_BY_ZERO,H.ThreeValues);const o=_o(i),a=Ah(i,!1);return a===0?new b(M.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)/s})}}w$.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:p.RANGE},{argumentType:p.NUMBER},{argumentType:p.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:p.RANGE},{argumentType:p.RANGE},{argumentType:p.INTEGER,minValue:1,maxValue:2},{argumentType:p.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:p.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:p.ANY}],repeatLastArgs:1}};w$.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function rf(n,e){const t=n.iterateValuesFromTopLeftCorner(),r=e.iterateValuesFromTopLeftCorner();let i,s;const o=[],a=[];for(;i=t.next(),s=r.next(),!i.done&&!s.done;){const l=i.value,u=s.value;if(l instanceof b)return l;if(u instanceof b)return u;It(l)&&It(u)&&(o.push(ge(l)),a.push(ge(u)))}return[o,a]}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const qY=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:NZ,AddressPlugin:bZ,ArrayPlugin:AZ,BitShiftPlugin:MZ,BitwiseLogicOperationsPlugin:PZ,BooleanPlugin:xZ,CharPlugin:LZ,CodePlugin:HZ,ComplexPlugin:TJ,ConditionalAggregationPlugin:aJ,CountBlankPlugin:DZ,CountUniquePlugin:FZ,DateTimePlugin:kZ,DegreesPlugin:VZ,DeltaPlugin:$Z,ExpPlugin:UZ,FinancialPlugin:BZ,FormulaTextPlugin:WZ,HyperlinkPlugin:jZ,InformationPlugin:zZ,IsEvenPlugin:GZ,IsOddPlugin:YZ,LogarithmPlugin:KZ,LookupPlugin:hJ,MathConstantsPlugin:XZ,MathPlugin:EJ,MatrixPlugin:qZ,MedianPlugin:QZ,ModuloPlugin:ZZ,NumericAggregationPlugin:d$,PowerPlugin:JZ,RadiansPlugin:eJ,RadixConversionPlugin:nJ,RandomPlugin:sJ,RomanPlugin:dJ,RoundingPlugin:f$,SimpleArithmerticPlugin:fJ,SqrtPlugin:oJ,StatisticalAggregationPlugin:w$,StatisticalPlugin:v$,SumprodPlugin:lJ,TextPlugin:uJ,TrigonometryPlugin:cJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class st extends ci{}st.HyperFormula=ci;st.ErrorType=M;st.CellError=b;st.CellType=vs;st.CellValueType=Va;st.CellValueDetailedType=jGe;st.DetailedCellError=aZ;st.ExportedCellChange=tL;st.ExportedNamedExpressionChange=yZ;st.ConfigValueTooBigError=XQ;st.ConfigValueTooSmallError=KQ;st.EvaluationSuspendedError=QQ;st.ExpectedOneOfValuesError=qQ;st.ExpectedValueOfTypeError=Mt;st.ArraySize=gt;st.SimpleRangeValue=Ne;st.EmptyValue=ut;st.FunctionPlugin=Qe;st.FunctionArgumentType=p;st.FunctionPluginValidationError=Gp;st.InvalidAddressError=UQ;st.InvalidArgumentsError=gr;st.LanguageNotRegisteredError=j1;st.LanguageAlreadyRegisteredError=JQ;st.MissingTranslationError=Am;st.NamedExpressionDoesNotExistError=kS;st.NamedExpressionNameIsAlreadyTakenError=BQ;st.NamedExpressionNameIsInvalidError=WQ;st.NoOperationToRedoError=zQ;st.NoOperationToUndoError=jQ;st.NoRelativeAddressesAllowedError=o$;st.NoSheetWithIdError=In;st.NoSheetWithNameError=$Q;st.NotAFormulaError=eb;st.NothingToPasteError=GQ;st.ProtectedFunctionTranslationError=ZQ;st.SheetNameAlreadyTakenError=DS;st.SheetSizeLimitExceededError=kf;st.SourceLocationHasArrayError=np;st.TargetLocationHasArrayError=iA;st.UnableToParseError=YQ;const uKe=ii.defaultConfig.language;ci.registerLanguage(uKe,nL);ci.languages[nL.langCode]=nL;for(const n of Object.getOwnPropertyNames(qY))n.startsWith("_")||ci.registerFunctionPlugin(qY[n]);eq();function cKe({rows:n,columns:e,onChange:t}){const r=te.useRef(null),i=te.useRef(null),s=te.useRef(null),o=te.useRef(n.map(w=>w.rolId)),a=te.useRef(e.map(w=>w.id)),l=te.useRef(t),u=te.useRef({}),c=te.useRef(null),h=te.useRef({}),d=te.useRef(!1);te.useEffect(()=>{o.current=n.map(S=>S.rolId);const w={};n.forEach(S=>{w[S.rolId]=S.dirtyStates??[]}),u.current=w},[n]),te.useEffect(()=>{a.current=e.map(w=>w.id)},[e]),te.useEffect(()=>{l.current=t},[t]),te.useMemo(()=>new Intl.DateTimeFormat("es-AR",{month:"short"}),[]);const f=te.useMemo(()=>{const w=new Date;return`${w.getFullYear()}-${String(w.getMonth()+1).padStart(2,"0")}`},[]),m=te.useMemo(()=>["Rol",...e.map(w=>w.label)],[e]),g=te.useCallback((w,S)=>{if(!i.current||w<0||S<0){c.current=null,c.current=null;return}c.current={row:w,col:S}},[]),C=te.useCallback((w,S)=>{var Q,F,J,q,ie;const E=i.current;if(!E)return null;const P=E.getPlugin("formulas")??null;if(!P||P.sheetId==null)return null;const _=(F=(Q=P.rowAxisSyncer)==null?void 0:Q.getHfIndexFromVisualIndex)==null?void 0:F.call(Q,w),I=(q=(J=P.columnAxisSyncer)==null?void 0:J.getHfIndexFromVisualIndex)==null?void 0:q.call(J,S);if(!Number.isFinite(_)||!Number.isFinite(I))return null;const D=(ie=P.engine)==null?void 0:ie.getCellSerialized({sheet:P.sheetId,row:_,col:I});return typeof D=="string"&&D.trim().startsWith("=")?D.trim():null},[]),y=te.useCallback(()=>n.map(w=>{const S=h.current[w.rolId]??{},E=e.map((P,_)=>{const I=S[P.id];if(I)return I;const D=w.values[_];return typeof D=="number"?D:D??null});return[w.label,...E]}),[n,e]);return te.useEffect(()=>{if(!r.current)return;const w=st.buildEmpty({licenseKey:"gpl-v3"});s.current=w;const S=new Ye(r.current,{data:y(),rowHeaders:!0,colHeaders:m,formulas:{engine:w},licenseKey:"non-commercial-and-evaluation",height:"auto",stretchH:"all",cells(E,P){if(P===0)return{readOnly:!0,className:"role-cell"};const _=o.current[E],I=_?u.current[_]:void 0,D=I==null?void 0:I[P-1],Q=a.current[P-1],F=[];return Q&&Q===f&&F.push("current-month-cell"),D&&F.push(D==="added"?"dirty-cell new-value":D==="removed"?"dirty-cell removed-value":"dirty-cell"),F.length>0?{className:F.join(" ")}:{}},afterGetColHeader(E,P){if(P.classList.remove("current-month-header"),E<=0)return;const _=a.current[E-1];_&&_===f&&P.classList.add("current-month-header")},beforeOnCellMouseDown(E,P,_,I){var F;if(P.col<0)return;const D=this.getActiveEditor();if(!D||!D.isOpened()||E.target===D.TEXTAREA)return;const Q=D.TEXTAREA;if(Q&&(Q.value||"").trim().startsWith("=")){E.preventDefault(),E.stopPropagation(),(F=E.stopImmediatePropagation)==null||F.call(E),I&&(I.row=!1,I.column=!1,I.cell=!1,I.cells=!0);const J=`${Ye.helper.spreadsheetColumnLabel(P.col)}${P.row+1}`;Q.value+=J,setTimeout(()=>{Q.focus(),D.focus()},0)}},afterOnCellMouseUp(){const E=this.getActiveEditor();if(!E||!E.isOpened())return;const P=E.TEXTAREA,_=window.event;P&&(_==null?void 0:_.target)===P||E.focus()},afterSelectionEnd(E,P){g(E,P)},afterChange(E,P){!E||P==="loadData"||d.current||E.forEach(([_,I,,D])=>{var Ee,ke,be;const Q=typeof I=="number"?I:Number(I);if(!Number.isFinite(Q)||Q===0)return;const F=o.current[_],J=a.current[Q-1];if(!F||!J)return;const q=C(_,Q);if(q){const re=h.current[F]??{};re[J]=q,h.current[F]=re;return}else(Ee=h.current[F])!=null&&Ee[J]&&(delete h.current[F][J],Object.keys(h.current[F]).length===0&&delete h.current[F]);if(typeof D=="string"&&D.trim().startsWith("=")){const re=D.trim(),ae=h.current[F]??{};ae[J]=re,h.current[F]=ae;return}else(ke=h.current[F])!=null&&ke[J]&&(delete h.current[F][J],Object.keys(h.current[F]).length===0&&delete h.current[F]);const ie=D===null||D===""?null:Number(D),fe=ie===null||Number.isFinite(ie)?ie:null;(be=l.current)==null||be.call(l,F,J,fe)})},afterFormulasValuesUpdate(E){!E||d.current||E.forEach(({address:P,value:_})=>{var q;const I=P==null?void 0:P.col,D=P==null?void 0:P.row;if(!Number.isFinite(I)||!Number.isFinite(D)||I===0)return;const Q=o.current[D],F=a.current[I-1];if(!Q||!F)return;const J=typeof _=="number"&&Number.isFinite(_)?_:null;(q=l.current)==null||q.call(l,Q,F,J)})},afterBeginEditing(E,P){var J;if(P===0)return;const _=o.current[E],I=a.current[P-1];if(!_||!I)return;const D=(J=h.current[_])==null?void 0:J[I];if(!D)return;const Q=this.getActiveEditor();if(!Q||typeof Q.setValue!="function")return;Q.setValue(D);const F=Q.TEXTAREA;F&&requestAnimationFrame(()=>{F.selectionStart=D.length,F.selectionEnd=D.length})}});return i.current=S,()=>{S.destroy(),i.current=null,w.destroy(),s.current=null}},[]),te.useEffect(()=>{if(!i.current)return;const w=y();if(d.current=!0,i.current.updateSettings({colHeaders:m}),i.current.loadData(w),requestAnimationFrame(()=>{d.current=!1}),c.current){const{row:S,col:E}=c.current;g(S,E)}},[m,y,g]),Z.jsx("div",{id:"tariffs-grid",className:"handsontable ht-theme-horizon",ref:r})}const MJ=2,IJ=n=>n==null?null:n<=10?n*1e3:n;function hKe({message:n,type:e,onClose:t,duration:r}){const s=IJ(r??(e==="success"?MJ:null));return te.useEffect(()=>{if(!n||s===null)return;const o=setTimeout(t,s);return()=>clearTimeout(o)},[n,s,t]),n?Z.jsxs("div",{className:`toast toast-${e}`,children:[Z.jsx("span",{children:n}),Z.jsx("button",{onClick:t,"aria-label":"Cerrar notificacin",children:""})]}):null}function dKe(){const[n,e]=te.useState(null),[t,r]=te.useState("success"),[i,s]=te.useState(null),o=(l,u="success",c)=>{e(l),r(u);const h=IJ(c??(u==="success"?MJ:null));s(h)},a=te.useCallback(()=>{e(null)},[]);return{toastMessage:n,toastType:t,toastDuration:i,showToast:o,hideToast:a}}const iP=new Intl.DateTimeFormat("es-AR",{month:"short"}),Ap=(n,e)=>`${n}-${String(e).padStart(2,"0")}`,fKe=n=>{const e=[{id:Ap(n-1,12),year:n-1,month:12,label:`${iP.format(new Date(n-1,11))} ${n-1}`}];for(let t=1;t<=12;t++)e.push({id:Ap(n,t),year:n,month:t,label:iP.format(new Date(n,t-1))});return e.push({id:Ap(n+1,1),year:n+1,month:1,label:`${iP.format(new Date(n+1,0))} ${n+1}`}),e};function gKe({onDirtyChange:n}){const{toastMessage:e,toastType:t,toastDuration:r,showToast:i,hideToast:s}=dKe(),o=new Date().getFullYear(),[a,l]=te.useState(o),[u,c]=te.useState([]),[h,d]=te.useState({}),[f,m]=te.useState({}),[g,C]=te.useState({}),[y,w]=te.useState(!1),[S,E]=te.useState(null),P=te.useMemo(()=>fKe(a),[a]),_=te.useCallback(async q=>{w(!0);try{const[ie,fe,Ee]=await Promise.all([AM(q-1),AM(q),AM(q+1)]),ke=new Map,be={};[ie,fe,Ee].forEach(le=>{le.roles.forEach(ye=>{ke.has(ye.id)||ke.set(ye.id,ye);const ze=be[ye.id]??{};Object.entries(ye.valores).forEach(([et,v])=>{const R=Ap(le.anio,Number(et));ze[R]=typeof v=="number"?v:null}),be[ye.id]=ze})});const re=Array.from(ke.values()).sort((le,ye)=>le.nombre.localeCompare(ye.nombre)),ae={};re.forEach(le=>{const ye={...be[le.id]??{}};P.forEach(ze=>{ye[ze.id]===void 0&&(ye[ze.id]=null)}),ae[le.id]=ye}),c(re),d(ae),m(JSON.parse(JSON.stringify(ae))),C({}),E(null),n==null||n(!1)}catch{E("No pudimos obtener los datos")}finally{w(!1)}},[P,n]);te.useEffect(()=>{_(a)},[a,_]);const I=(q,ie,fe)=>{d(Ee=>{const ke={...Ee},be={...ke[q]??{}};return be[ie]=fe??null,ke[q]=be,ke}),C(Ee=>{var le;const ke={...Ee},be={...ke[q]??{}},re=((le=f[q])==null?void 0:le[ie])??null,ae=fe??null;return ae===(re??null)?delete be[ie]:be[ie]=ae,Object.keys(be).length>0?ke[q]=be:delete ke[q],ke})},D=Object.keys(g).length>0;te.useEffect(()=>{n==null||n(D);const q=ie=>{D&&(ie.preventDefault(),ie.returnValue="")};return window.addEventListener("beforeunload",q),()=>{window.removeEventListener("beforeunload",q)}},[D,n]),te.useEffect(()=>()=>{n==null||n(!1)},[n]);const Q=te.useCallback(async()=>{const q=[];if(Object.entries(g).forEach(([ie,fe])=>{const Ee={};Object.entries(fe).forEach(([ke,be])=>{const[re,ae]=ke.split("-"),le=Number(re),ye=Number(ae),ze=Ee[le]??{valores:{},eliminados:[]};typeof be=="number"?ze.valores[ye]=be:ze.eliminados.push(ye),Ee[le]=ze}),Object.entries(Ee).forEach(([ke,{valores:be,eliminados:re}])=>{Object.keys(be).length===0&&re.length===0||q.push({rolId:ie,anio:Number(ke),valores:be,eliminados:re})})}),q.length===0){i("No hay cambios para guardar","error");return}try{await mre(q),m(ie=>{const fe={...ie};return q.forEach(({rolId:Ee,anio:ke,valores:be,eliminados:re})=>{const ae={...fe[Ee]??{}};Object.entries(be).forEach(([le,ye])=>{ae[Ap(ke,Number(le))]=ye}),re==null||re.forEach(le=>{ae[Ap(ke,le)]=null}),fe[Ee]=ae}),fe}),C({}),n==null||n(!1),i("Cambios guardados","success")}catch{i("Error al guardar","error")}},[g,n,i]);mKe(D,"Tens cambios sin guardar. Guard o confirm si quers salir de esta pgina.");const F=q=>{const ie=a+q;D&&!window.confirm("Tens cambios sin guardar. Quers descartarlos para cambiar de ao?")||l(ie)},J=te.useMemo(()=>u.map(q=>{const ie=g[q.id]??{};return{rolId:q.id,label:`${q.nombre} (${q.experiencia})`,values:P.map(fe=>{var Ee;return((Ee=h[q.id])==null?void 0:Ee[fe.id])??null}),dirtyStates:P.map(fe=>{var be,re;if(ie[fe.id]===void 0)return;const Ee=((be=f[q.id])==null?void 0:be[fe.id])??null,ke=((re=h[q.id])==null?void 0:re[fe.id])??null;return Ee===null&&ke!==null?"added":Ee!==null&&ke===null?"removed":"modified"})}}),[u,P,h,g,f]);return te.useEffect(()=>{const q=ie=>{(ie.key==="s"||ie.key==="S")&&(ie.ctrlKey||ie.metaKey)&&(ie.preventDefault(),D&&Q())};return window.addEventListener("keydown",q),()=>{window.removeEventListener("keydown",q)}},[Q,D]),Z.jsxs("div",{className:"page-shell",children:[Z.jsxs("section",{className:"panel hero-panel",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"page-overline",children:"Finanzas  Planeamiento"}),Z.jsx("h1",{children:"Sueldos y tarifas"}),Z.jsx("p",{className:"hero-subtitle",children:"Actualiz los valores mensuales por rol usando frmulas estilo Excel."})]}),Z.jsx("div",{className:"hero-actions",children:Z.jsx("button",{className:"primary-button",onClick:Q,disabled:!D,children:"Guardar cambios"})})]}),S&&Z.jsx("div",{className:"banner banner-error",children:S}),Z.jsxs("section",{className:"panel content-panel",children:[Z.jsxs("header",{className:"content-header",children:[Z.jsxs("div",{children:[Z.jsx("h2",{children:"Plan anual"}),Z.jsx("p",{children:"Dic previo  Ao corriente  Ene prximo"})]}),Z.jsx("div",{className:"content-tools",children:Z.jsxs("div",{className:"year-pagination",children:[Z.jsxs("button",{onClick:()=>F(-1),"aria-label":"Ao anterior",children:[" ",a-1]}),Z.jsx("span",{className:"year-pagination__current",children:a}),Z.jsxs("button",{onClick:()=>F(1),"aria-label":"Ao siguiente",children:[a+1," "]})]})})]}),y&&Z.jsx("div",{className:"floating-loading",role:"status","aria-label":"Cargando datos",children:Z.jsx("span",{className:"floating-loading__spinner","aria-hidden":"true"})}),!S&&Z.jsx(cKe,{rows:J,columns:P,onChange:I},a)]}),Z.jsx(hKe,{message:e,type:t,duration:r,onClose:s})]})}function mKe(n,e){const t=te.useContext(nu);te.useEffect(()=>{if(!n)return;const r=t==null?void 0:t.navigator;if(!r||typeof r.block!="function")return;const i=r.block(s=>{window.confirm(e)&&(i(),s.retry())});return i},[e,t,n])}const QY=new Intl.NumberFormat("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2}),pKe=new Intl.NumberFormat("es-AR",{style:"currency",currency:"USD"}),sP=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],sT=n=>{if(n===0)return"0";const e=Math.abs(n);return e>=1e9?`${(n/1e9).toFixed(2)}B`:e>=1e6?`${(n/1e6).toFixed(2)}M`:e>=1e3?`${(n/1e3).toFixed(2)}K`:n.toFixed(2)};function vKe(){const[n,e]=te.useState([]),[t,r]=te.useState(!1),[i,s]=te.useState(null),[o,a]=te.useState({});te.useEffect(()=>{r(!0),gre().then(c=>{e(c),s(null)}).catch(()=>s("No pudimos obtener los costos")).finally(()=>r(!1))},[]);const l=te.useMemo(()=>n.map(c=>{const h={},d={};c.meses.forEach(m=>{h[m.mes]=m.costoTotal,d[m.mes]=m});const f=c.meses.reduce((m,g)=>m+g.costoTotal,0);return{...c,monthMap:h,detailMap:d,total:f}}),[n]),u=c=>{a(h=>({...h,[c]:!h[c]}))};return Z.jsxs("div",{className:"page-shell",children:[Z.jsxs("section",{className:"panel hero-panel",children:[Z.jsxs("div",{children:[Z.jsx("p",{className:"page-overline",children:"Finanzas  Seguimiento"}),Z.jsx("h1",{children:"Carga de costos mensual"}),Z.jsx("p",{className:"hero-subtitle",children:"Seguimiento consolidado de cada iniciativa  Valores en USD"})]}),Z.jsxs("div",{className:"hero-actions",children:[Z.jsx("button",{className:"secondary-button",children:"Guardar borrador"}),Z.jsx("button",{className:"primary-button",children:"Enviar para aprobacin"})]})]}),i&&Z.jsx("div",{className:"banner banner-error",children:i}),Z.jsxs("section",{className:"panel content-panel",children:[Z.jsxs("header",{className:"content-header",children:[Z.jsxs("div",{children:[Z.jsx("h2",{children:"Resumen por proyecto"}),Z.jsx("p",{children:"Compar mes a mes la evolucin del costo mensual."})]}),Z.jsx("div",{className:"content-tools",children:Z.jsx("button",{className:"secondary-button ghost",type:"button",children:"Exportar reporte"})})]}),t&&Z.jsx("p",{children:"Cargando costos..."}),Z.jsx("div",{className:"costs-table-scroll",children:Z.jsx("div",{className:"costs-table-wrapper",children:Z.jsxs("table",{className:"costs-table",children:[Z.jsx("thead",{children:Z.jsxs("tr",{children:[Z.jsx("th",{children:"Proyecto"}),sP.map(c=>Z.jsx("th",{children:c},c)),Z.jsx("th",{children:"Total"})]})}),Z.jsx("tbody",{children:l.map((c,h)=>Z.jsxs(te.Fragment,{children:[Z.jsxs("tr",{className:`project-row ${h%2===0?"is-odd":""}`,children:[Z.jsxs("td",{children:[Z.jsx("button",{className:"project-toggle",onClick:()=>u(c.proyectoId),"aria-label":"Alternar detalle",children:Z.jsx("span",{children:o[c.proyectoId]?"":""})}),Z.jsxs("div",{className:"project-info",children:[Z.jsx("strong",{children:c.proyectoNombre}),Z.jsx("span",{children:c.proyectoId})]})]}),sP.map((d,f)=>{const m=f+1,g=c.detailMap[m],C=(g==null?void 0:g.costoTotal)??null,y=(g==null?void 0:g.rolesSinTarifa)??[],w=["month-pill"];return C&&w.push("has-value"),y.length&&w.push("warning"),Z.jsx("td",{children:Z.jsx("div",{className:w.join(" "),children:C||y.length?Z.jsxs("span",{className:"amount-pill",onMouseEnter:S=>{const E=S.currentTarget.getBoundingClientRect(),P=E.top>window.innerHeight/2,_=P?E.top-8:E.bottom+8;S.currentTarget.style.setProperty("--tooltip-left",`${E.left+E.width/2}px`),S.currentTarget.style.setProperty("--tooltip-top",`${_}px`),S.currentTarget.style.setProperty("--tooltip-shift",P?"-100%":"0")},onMouseLeave:S=>{S.currentTarget.style.removeProperty("--tooltip-left"),S.currentTarget.style.removeProperty("--tooltip-top"),S.currentTarget.style.removeProperty("--tooltip-shift")},children:[C?sT(C):y.length?"!":"-",Z.jsx("span",{className:"amount-tooltip",children:(()=>{var _;const S=c.meses.find(I=>I.mes===m);if(!S)return null;const E=new Date(2e3,S.mes-1).toLocaleString("es-AR",{month:"long"}),P=E.charAt(0).toUpperCase()+E.slice(1);return Z.jsxs(Z.Fragment,{children:[Z.jsxs("strong",{children:[P," ",S.anio]}),Z.jsxs("div",{className:"month-hours",children:["Horas: ",S.horasTotales.toFixed(1)]}),Z.jsx("div",{className:"month-total",children:pKe.format(S.costoTotal)}),(_=S.rolesSinTarifa)!=null&&_.length?Z.jsxs("div",{className:"month-warning",children:["Roles sin tarifa: ",S.rolesSinTarifa.join(", ")]}):null,Z.jsx("ul",{children:S.recursos.map(I=>{const D=Math.trunc(I.tarifaHora),Q=Math.trunc(I.costo),F=D===0;return Z.jsxs("li",{children:[I.nombre,": ",I.horas.toFixed(1),"h x"," ",F?Z.jsx("span",{className:"tarifa-missing",children:"!?"}):sT(D)," ","= ",sT(Q)]},`${m}-${I.recursoId}`)})})]})})()})]}):"-"})},`${c.proyectoId}-${m}`)}),Z.jsx("td",{className:"cell-total",children:Z.jsx("span",{className:"month-pill has-value",children:sT(c.total)})})]}),o[c.proyectoId]&&Z.jsx("tr",{className:"project-detail",children:Z.jsx("td",{colSpan:sP.length+2,children:Z.jsxs("div",{className:"resources-grid",children:[Z.jsxs("div",{className:"resources-grid__header",children:[Z.jsx("span",{children:"Periodo"}),Z.jsx("span",{children:"Recurso"}),Z.jsx("span",{children:"Rol"}),Z.jsx("span",{children:"Seniority"}),Z.jsx("span",{children:"Horas"}),Z.jsx("span",{children:"Sueldo"}),Z.jsx("span",{children:"Costo"})]}),c.meses.flatMap(d=>d.recursos.map(f=>Z.jsxs("div",{className:"resources-grid__row",children:[Z.jsxs("span",{children:[d.mes.toString().padStart(2,"0"),"/",d.anio]}),Z.jsx("span",{className:"resource-name",children:f.nombre}),Z.jsx("span",{className:"resource-role",children:f.rol}),Z.jsx("span",{className:"resource-seniority",children:f.seniority}),Z.jsx("span",{children:f.horas.toFixed(1)}),Z.jsx("span",{children:QY.format(f.tarifaHora)}),Z.jsx("span",{children:QY.format(f.costo)})]},`${d.anio}-${d.mes}-${f.recursoId}`)))]})})})]},c.proyectoId))})]})})})]}),!t&&n.length===0&&Z.jsx("p",{children:"No hay costos registrados para mostrar."})]})}function wKe(){const[n,e]=te.useState(!0),[t]=te.useState("modern"),[r]=te.useState("light"),i=()=>e(a=>!a),s=`app-shell ${n?"nav-collapsed":"nav-expanded"}`,o=`layout-shell ${t==="classic"?"theme-classic":"theme-modern"}`;return Z.jsx(are,{children:Z.jsxs("div",{className:o,children:[Z.jsxs("aside",{className:`side-panel ${n?"is-collapsed":""}`,children:[Z.jsxs("button",{className:"panel-toggle",onClick:i,"aria-label":"Alternar men",children:[Z.jsx("span",{}),Z.jsx("span",{}),Z.jsx("span",{})]}),Z.jsxs("div",{className:"side-panel__header",children:[Z.jsx("div",{className:"avatar",children:"JD"}),!n&&Z.jsxs("div",{className:"profile-text",children:[Z.jsx("strong",{children:"John Doe"}),Z.jsx("span",{children:"Ing. de Software"})]})]}),Z.jsxs("div",{className:"side-panel__content",children:[Z.jsx("div",{className:"side-panel__section",children:"Finanzas"}),Z.jsxs("nav",{className:"side-panel__nav",children:[Z.jsxs(KU,{to:"/admin/sueldos",children:[Z.jsx("span",{className:"icon",children:""}),Z.jsx("span",{className:"label",children:"Sueldos"})]}),Z.jsxs(KU,{to:"/admin/costos",children:[Z.jsx("span",{className:"icon",children:""}),Z.jsx("span",{className:"label",children:"Costos"})]})]}),Z.jsx("div",{className:"side-panel__section",children:"Panel"}),Z.jsxs("div",{className:"side-panel__nav side-panel__nav--muted",children:[Z.jsxs("div",{className:"nav-placeholder",children:[Z.jsx("span",{className:"icon",children:""}),Z.jsx("span",{className:"label",children:"Proyectos"})]}),Z.jsxs("div",{className:"nav-placeholder",children:[Z.jsx("span",{className:"icon",children:""}),Z.jsx("span",{className:"label",children:"Reportes"})]}),Z.jsxs("div",{className:"nav-placeholder",children:[Z.jsx("span",{className:"icon",children:""}),Z.jsx("span",{className:"label",children:"Configuracin"})]})]})]}),Z.jsxs("div",{className:"side-panel__support",children:[Z.jsx("button",{type:"button",children:"Ayuda"}),Z.jsx("button",{type:"button",children:"Soporte"}),Z.jsx("button",{type:"button",className:"logout-button",children:"Cerrar sesin"})]}),Z.jsx("div",{className:"side-panel__footer"})]}),Z.jsx("div",{className:s,children:Z.jsxs(Jne,{children:[Z.jsx(Fw,{path:"/",element:Z.jsx(GU,{to:"/admin/sueldos",replace:!0})}),Z.jsx(Fw,{path:"/admin/sueldos",element:Z.jsx(gKe,{})}),Z.jsx(Fw,{path:"/admin/costos",element:Z.jsx(vKe,{})}),Z.jsx(Fw,{path:"*",element:Z.jsx(GU,{to:"/admin/sueldos",replace:!0})})]})})]})})}oP.createRoot(document.getElementById("root")).render(Z.jsx(l3.StrictMode,{children:Z.jsx(wKe,{})}))});export default yKe();
